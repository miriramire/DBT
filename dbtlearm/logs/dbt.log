

============================== 2023-02-16 14:32:22.917937 | 5d5ea53c-a3fe-403e-844a-cdeca27a2372 ==============================
[0m14:32:22.917937 [info ] [MainThread]: Running with dbt=1.4.1
[0m14:32:22.920215 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/mramirez/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m14:32:22.920592 [debug] [MainThread]: Tracking: tracking
[0m14:32:22.993528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc244db2be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc244da29d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc244da29a0>]}
[0m14:32:32.663184 [debug] [MainThread]: Executing "git --help"
[0m14:32:32.740387 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:32:32.741511 [debug] [MainThread]: STDERR: "b''"
[0m14:32:33.083500 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m14:32:33.086890 [debug] [MainThread]: Using snowflake connection "debug"
[0m14:32:33.087761 [debug] [MainThread]: On debug: select 1 as id
[0m14:32:33.088590 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:32:38.028912 [debug] [MainThread]: SQL status: SUCCESS 1 in 5 seconds
[0m14:32:38.030723 [debug] [MainThread]: On debug: Close
[0m14:32:38.305997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc245c5e220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc24509a6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc245e46730>]}
[0m14:32:38.306664 [debug] [MainThread]: Flushing usage events
[0m14:32:38.924354 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2023-02-18 11:25:26.629196 | 90a11ea6-ae00-4e7f-b563-4267e75a377e ==============================
[0m11:25:26.629196 [info ] [MainThread]: Running with dbt=1.4.1
[0m11:25:26.633583 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/mramirez/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:25:26.633925 [debug] [MainThread]: Tracking: tracking
[0m11:25:26.634492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7ff149100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7ff149be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7ff149af0>]}
[0m11:25:26.678991 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:25:26.679339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '90a11ea6-ae00-4e7f-b563-4267e75a377e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7ff138c40>]}
[0m11:25:27.807067 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m11:25:27.921883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '90a11ea6-ae00-4e7f-b563-4267e75a377e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7ff505250>]}
[0m11:25:27.930234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '90a11ea6-ae00-4e7f-b563-4267e75a377e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7ff138ca0>]}
[0m11:25:27.930717 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 304 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m11:25:27.931082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90a11ea6-ae00-4e7f-b563-4267e75a377e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7ff1497f0>]}
[0m11:25:27.932831 [info ] [MainThread]: 
[0m11:25:27.934785 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:25:27.935877 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb'
[0m11:25:27.955653 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m11:25:27.956083 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m11:25:27.956408 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:25:32.280807 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 4 seconds
[0m11:25:32.282669 [debug] [ThreadPool]: On list_airbnb: Close
[0m11:25:32.517300 [debug] [ThreadPool]: Acquiring new snowflake connection 'create_airbnb_dev'
[0m11:25:32.517907 [debug] [ThreadPool]: Acquiring new snowflake connection 'create_airbnb_dev'
[0m11:25:32.518212 [debug] [ThreadPool]: Creating schema "ReferenceKeyMsg(database='airbnb', schema='dev', identifier=None)"
[0m11:25:32.523049 [debug] [ThreadPool]: Using snowflake connection "create_airbnb_dev"
[0m11:25:32.523347 [debug] [ThreadPool]: On create_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "connection_name": "create_airbnb_dev"} */
create schema if not exists airbnb.dev
[0m11:25:32.523613 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:25:33.423837 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1 seconds
[0m11:25:33.424818 [debug] [ThreadPool]: On create_airbnb_dev: Close
[0m11:25:33.690688 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m11:25:33.696746 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m11:25:33.697011 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m11:25:33.697309 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:25:34.572568 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1 seconds
[0m11:25:34.573961 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m11:25:34.847203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90a11ea6-ae00-4e7f-b563-4267e75a377e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7ff526f70>]}
[0m11:25:34.848030 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:25:34.848376 [info ] [MainThread]: 
[0m11:25:34.904687 [debug] [Thread-1  ]: Began running node model.dbtlearm.src_listings
[0m11:25:34.905185 [info ] [Thread-1  ]: 1 of 1 START sql view model dev.src_listings ................................... [RUN]
[0m11:25:34.905947 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearm.src_listings'
[0m11:25:34.906254 [debug] [Thread-1  ]: Began compiling node model.dbtlearm.src_listings
[0m11:25:34.908032 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearm.src_listings"
[0m11:25:34.909615 [debug] [Thread-1  ]: Timing info for model.dbtlearm.src_listings (compile): 2023-02-18 11:25:34.906476 => 2023-02-18 11:25:34.909520
[0m11:25:34.909963 [debug] [Thread-1  ]: Began executing node model.dbtlearm.src_listings
[0m11:25:34.951257 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtlearm.src_listings"
[0m11:25:34.954093 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearm.src_listings"
[0m11:25:34.954399 [debug] [Thread-1  ]: On model.dbtlearm.src_listings: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.src_listings"} */
create or replace   view airbnb.dev.src_listings
  
   as (
    -- DBT knows this is a view
-- By default they are views
WITH raw_listings AS(
	SELECT * FROM AIRBNB.RAW.RAW_LISTINGS
)
SELECT
	id as listing_id,
    name as listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at
FROM
	raw_listings
  );
[0m11:25:34.954673 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:25:36.716906 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2 seconds
[0m11:25:36.738052 [debug] [Thread-1  ]: Timing info for model.dbtlearm.src_listings (execute): 2023-02-18 11:25:34.910184 => 2023-02-18 11:25:36.737989
[0m11:25:36.738380 [debug] [Thread-1  ]: On model.dbtlearm.src_listings: Close
[0m11:25:37.395894 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90a11ea6-ae00-4e7f-b563-4267e75a377e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7ffa5b550>]}
[0m11:25:37.396777 [info ] [Thread-1  ]: 1 of 1 OK created sql view model dev.src_listings .............................. [[32mSUCCESS 1[0m in 2.49s]
[0m11:25:37.398515 [debug] [Thread-1  ]: Finished running node model.dbtlearm.src_listings
[0m11:25:37.400730 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:25:37.401466 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:25:37.401720 [debug] [MainThread]: Connection 'model.dbtlearm.src_listings' was properly closed.
[0m11:25:37.402007 [info ] [MainThread]: 
[0m11:25:37.402347 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 9.47 seconds (9.47s).
[0m11:25:37.402777 [debug] [MainThread]: Command end result
[0m11:25:37.410032 [info ] [MainThread]: 
[0m11:25:37.410470 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:25:37.410790 [info ] [MainThread]: 
[0m11:25:37.411094 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:25:37.411482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7ff1495b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7ffbc3d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7ffb87610>]}
[0m11:25:37.411790 [debug] [MainThread]: Flushing usage events


============================== 2023-02-18 11:29:57.914856 | eaf97d5f-8d1e-419b-af8e-738e2be8c10f ==============================
[0m11:29:57.914856 [info ] [MainThread]: Running with dbt=1.4.1
[0m11:29:57.918082 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/mramirez/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:29:57.918474 [debug] [MainThread]: Tracking: tracking
[0m11:29:57.919152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe746348190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe746348e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe746348af0>]}
[0m11:29:58.040601 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m11:29:58.041017 [debug] [MainThread]: Partial parsing: added file: dbtlearm://models/src/src_reviews.sql
[0m11:29:58.057347 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m11:29:58.082045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eaf97d5f-8d1e-419b-af8e-738e2be8c10f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7464bcd30>]}
[0m11:29:58.102488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eaf97d5f-8d1e-419b-af8e-738e2be8c10f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe74649ae80>]}
[0m11:29:58.102895 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 304 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m11:29:58.103174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eaf97d5f-8d1e-419b-af8e-738e2be8c10f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe74649af10>]}
[0m11:29:58.104333 [info ] [MainThread]: 
[0m11:29:58.105821 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:29:58.106770 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb'
[0m11:29:58.119832 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m11:29:58.120386 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m11:29:58.120844 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:29:59.623617 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2 seconds
[0m11:29:59.625730 [debug] [ThreadPool]: On list_airbnb: Close
[0m11:29:59.886993 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m11:29:59.894255 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m11:29:59.894541 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m11:29:59.894747 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:30:01.004894 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1 seconds
[0m11:30:01.007505 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m11:30:01.248158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eaf97d5f-8d1e-419b-af8e-738e2be8c10f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe746337ee0>]}
[0m11:30:01.249043 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:30:01.249413 [info ] [MainThread]: 
[0m11:30:01.259203 [debug] [Thread-1  ]: Began running node model.dbtlearm.src_listings
[0m11:30:01.259590 [debug] [Thread-2  ]: Began running node model.dbtlearm.src_reviews
[0m11:30:01.260058 [info ] [Thread-1  ]: 1 of 2 START sql view model dev.src_listings ................................... [RUN]
[0m11:30:01.260600 [info ] [Thread-2  ]: 2 of 2 START sql view model dev.src_reviews .................................... [RUN]
[0m11:30:01.261436 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearm.src_listings'
[0m11:30:01.262101 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearm.src_reviews'
[0m11:30:01.262445 [debug] [Thread-1  ]: Began compiling node model.dbtlearm.src_listings
[0m11:30:01.262773 [debug] [Thread-2  ]: Began compiling node model.dbtlearm.src_reviews
[0m11:30:01.264631 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearm.src_listings"
[0m11:30:01.266314 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearm.src_reviews"
[0m11:30:01.267537 [debug] [Thread-2  ]: Timing info for model.dbtlearm.src_reviews (compile): 2023-02-18 11:30:01.264889 => 2023-02-18 11:30:01.267442
[0m11:30:01.267929 [debug] [Thread-2  ]: Began executing node model.dbtlearm.src_reviews
[0m11:30:01.273952 [debug] [Thread-1  ]: Timing info for model.dbtlearm.src_listings (compile): 2023-02-18 11:30:01.263025 => 2023-02-18 11:30:01.273855
[0m11:30:01.296399 [debug] [Thread-1  ]: Began executing node model.dbtlearm.src_listings
[0m11:30:01.305131 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtlearm.src_reviews"
[0m11:30:01.308868 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtlearm.src_listings"
[0m11:30:01.310251 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearm.src_reviews"
[0m11:30:01.310545 [debug] [Thread-2  ]: On model.dbtlearm.src_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.src_reviews"} */
create or replace   view airbnb.dev.src_reviews
  
   as (
    WITH raw_listings AS(
	SELECT * FROM AIRBNB.RAW.RAW_REVIEWS
)
SELECT
	listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
	raw_listings;
[0m11:30:01.311243 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearm.src_listings"
[0m11:30:01.311508 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m11:30:01.311741 [debug] [Thread-1  ]: On model.dbtlearm.src_listings: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.src_listings"} */
create or replace   view airbnb.dev.src_listings
  
   as (
    -- DBT knows this is a view
-- By default they are views
WITH raw_listings AS(
	SELECT * FROM AIRBNB.RAW.RAW_LISTINGS
)
SELECT
	id as listing_id,
    name as listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at
FROM
	raw_listings
  );
[0m11:30:01.313301 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:30:02.457162 [debug] [Thread-2  ]: Snowflake adapter: Snowflake query id: 01aa6972-0000-fabb-0000-000387ea60ad
[0m11:30:02.457486 [debug] [Thread-2  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 14 at position 13 unexpected ';'.
[0m11:30:02.457859 [debug] [Thread-2  ]: Timing info for model.dbtlearm.src_reviews (execute): 2023-02-18 11:30:01.268162 => 2023-02-18 11:30:02.457793
[0m11:30:02.458120 [debug] [Thread-2  ]: On model.dbtlearm.src_reviews: Close
[0m11:30:02.513882 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m11:30:02.539264 [debug] [Thread-1  ]: Timing info for model.dbtlearm.src_listings (execute): 2023-02-18 11:30:01.305434 => 2023-02-18 11:30:02.539199
[0m11:30:02.539599 [debug] [Thread-1  ]: On model.dbtlearm.src_listings: Close
[0m11:30:02.758030 [debug] [Thread-2  ]: Database Error in model src_reviews (models/src/src_reviews.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 13 unexpected ';'.
  compiled Code at target/run/dbtlearm/models/src/src_reviews.sql
[0m11:30:02.758544 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eaf97d5f-8d1e-419b-af8e-738e2be8c10f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe74671a250>]}
[0m11:30:02.759057 [error] [Thread-2  ]: 2 of 2 ERROR creating sql view model dev.src_reviews ........................... [[31mERROR[0m in 1.50s]
[0m11:30:02.760797 [debug] [Thread-2  ]: Finished running node model.dbtlearm.src_reviews
[0m11:30:02.794476 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eaf97d5f-8d1e-419b-af8e-738e2be8c10f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7462d62b0>]}
[0m11:30:02.795043 [info ] [Thread-1  ]: 1 of 2 OK created sql view model dev.src_listings .............................. [[32mSUCCESS 1[0m in 1.53s]
[0m11:30:02.795483 [debug] [Thread-1  ]: Finished running node model.dbtlearm.src_listings
[0m11:30:02.796922 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:30:02.797568 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:30:02.797821 [debug] [MainThread]: Connection 'model.dbtlearm.src_listings' was properly closed.
[0m11:30:02.798046 [debug] [MainThread]: Connection 'model.dbtlearm.src_reviews' was properly closed.
[0m11:30:02.798310 [info ] [MainThread]: 
[0m11:30:02.798647 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 4.69 seconds (4.69s).
[0m11:30:02.799099 [debug] [MainThread]: Command end result
[0m11:30:02.807195 [info ] [MainThread]: 
[0m11:30:02.807660 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:30:02.807994 [info ] [MainThread]: 
[0m11:30:02.808317 [error] [MainThread]: [33mDatabase Error in model src_reviews (models/src/src_reviews.sql)[0m
[0m11:30:02.808630 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m11:30:02.808934 [error] [MainThread]:   syntax error line 14 at position 13 unexpected ';'.
[0m11:30:02.809230 [error] [MainThread]:   compiled Code at target/run/dbtlearm/models/src/src_reviews.sql
[0m11:30:02.809533 [info ] [MainThread]: 
[0m11:30:02.809849 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m11:30:02.810255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe745617df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe746319ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe74649a970>]}
[0m11:30:02.810601 [debug] [MainThread]: Flushing usage events


============================== 2023-02-18 11:31:02.065741 | 8aa23539-6829-4536-baea-530561aa2dac ==============================
[0m11:31:02.065741 [info ] [MainThread]: Running with dbt=1.4.1
[0m11:31:02.068874 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/mramirez/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:31:02.069477 [debug] [MainThread]: Tracking: tracking
[0m11:31:02.070199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9146308190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9146308e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9146308af0>]}
[0m11:31:02.215494 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:31:02.228235 [debug] [MainThread]: Partial parsing: updated file: dbtlearm://models/src/src_reviews.sql
[0m11:31:02.251387 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m11:31:02.282946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8aa23539-6829-4536-baea-530561aa2dac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9146483fd0>]}
[0m11:31:02.307600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8aa23539-6829-4536-baea-530561aa2dac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91462c0520>]}
[0m11:31:02.308409 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 304 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m11:31:02.308844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8aa23539-6829-4536-baea-530561aa2dac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91462c0e50>]}
[0m11:31:02.310367 [info ] [MainThread]: 
[0m11:31:02.312218 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:31:02.313500 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb'
[0m11:31:02.331713 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m11:31:02.332137 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m11:31:02.332449 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:31:03.918485 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2 seconds
[0m11:31:03.920632 [debug] [ThreadPool]: On list_airbnb: Close
[0m11:31:04.178079 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m11:31:04.234341 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m11:31:04.234706 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m11:31:04.235030 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:31:05.285083 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1 seconds
[0m11:31:05.286705 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m11:31:05.521766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8aa23539-6829-4536-baea-530561aa2dac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91454eba90>]}
[0m11:31:05.522653 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:31:05.523087 [info ] [MainThread]: 
[0m11:31:05.528337 [debug] [Thread-1  ]: Began running node model.dbtlearm.src_listings
[0m11:31:05.528697 [debug] [Thread-2  ]: Began running node model.dbtlearm.src_reviews
[0m11:31:05.529150 [info ] [Thread-1  ]: 1 of 2 START sql view model dev.src_listings ................................... [RUN]
[0m11:31:05.529650 [info ] [Thread-2  ]: 2 of 2 START sql view model dev.src_reviews .................................... [RUN]
[0m11:31:05.530456 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearm.src_listings'
[0m11:31:05.531088 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearm.src_reviews'
[0m11:31:05.531401 [debug] [Thread-1  ]: Began compiling node model.dbtlearm.src_listings
[0m11:31:05.531698 [debug] [Thread-2  ]: Began compiling node model.dbtlearm.src_reviews
[0m11:31:05.533501 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearm.src_listings"
[0m11:31:05.535261 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearm.src_reviews"
[0m11:31:05.536379 [debug] [Thread-1  ]: Timing info for model.dbtlearm.src_listings (compile): 2023-02-18 11:31:05.531921 => 2023-02-18 11:31:05.536286
[0m11:31:05.536641 [debug] [Thread-2  ]: Timing info for model.dbtlearm.src_reviews (compile): 2023-02-18 11:31:05.533821 => 2023-02-18 11:31:05.536578
[0m11:31:05.536972 [debug] [Thread-1  ]: Began executing node model.dbtlearm.src_listings
[0m11:31:05.537289 [debug] [Thread-2  ]: Began executing node model.dbtlearm.src_reviews
[0m11:31:05.591063 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtlearm.src_listings"
[0m11:31:05.591606 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtlearm.src_reviews"
[0m11:31:05.605513 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearm.src_listings"
[0m11:31:05.607864 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearm.src_reviews"
[0m11:31:05.608212 [debug] [Thread-1  ]: On model.dbtlearm.src_listings: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.src_listings"} */
create or replace   view airbnb.dev.src_listings
  
   as (
    -- DBT knows this is a view
-- By default they are views
WITH raw_listings AS(
	SELECT * FROM AIRBNB.RAW.RAW_LISTINGS
)
SELECT
	id as listing_id,
    name as listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at
FROM
	raw_listings
  );
[0m11:31:05.608514 [debug] [Thread-2  ]: On model.dbtlearm.src_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.src_reviews"} */
create or replace   view airbnb.dev.src_reviews
  
   as (
    WITH raw_listings AS(
	SELECT * FROM AIRBNB.RAW.RAW_REVIEWS
)
SELECT
	listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
	raw_listings
  );
[0m11:31:05.608782 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:31:05.609031 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m11:31:06.810761 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m11:31:06.834348 [debug] [Thread-1  ]: Timing info for model.dbtlearm.src_listings (execute): 2023-02-18 11:31:05.537566 => 2023-02-18 11:31:06.834286
[0m11:31:06.834664 [debug] [Thread-1  ]: On model.dbtlearm.src_listings: Close
[0m11:31:06.864012 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1 seconds
[0m11:31:06.866433 [debug] [Thread-2  ]: Timing info for model.dbtlearm.src_reviews (execute): 2023-02-18 11:31:05.559234 => 2023-02-18 11:31:06.866377
[0m11:31:06.866705 [debug] [Thread-2  ]: On model.dbtlearm.src_reviews: Close
[0m11:31:07.086060 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8aa23539-6829-4536-baea-530561aa2dac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91463f07f0>]}
[0m11:31:07.086607 [info ] [Thread-1  ]: 1 of 2 OK created sql view model dev.src_listings .............................. [[32mSUCCESS 1[0m in 1.56s]
[0m11:31:07.088586 [debug] [Thread-1  ]: Finished running node model.dbtlearm.src_listings
[0m11:31:07.150737 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8aa23539-6829-4536-baea-530561aa2dac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91464fab80>]}
[0m11:31:07.151318 [info ] [Thread-2  ]: 2 of 2 OK created sql view model dev.src_reviews ............................... [[32mSUCCESS 1[0m in 1.62s]
[0m11:31:07.151754 [debug] [Thread-2  ]: Finished running node model.dbtlearm.src_reviews
[0m11:31:07.153170 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:31:07.153777 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:31:07.154132 [debug] [MainThread]: Connection 'model.dbtlearm.src_listings' was properly closed.
[0m11:31:07.154592 [debug] [MainThread]: Connection 'model.dbtlearm.src_reviews' was properly closed.
[0m11:31:07.155023 [info ] [MainThread]: 
[0m11:31:07.155548 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 4.84 seconds (4.84s).
[0m11:31:07.156205 [debug] [MainThread]: Command end result
[0m11:31:07.164427 [info ] [MainThread]: 
[0m11:31:07.164864 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:31:07.165190 [info ] [MainThread]: 
[0m11:31:07.165510 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m11:31:07.165906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91464d9820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91462d9790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91464e8a90>]}
[0m11:31:07.166241 [debug] [MainThread]: Flushing usage events


============================== 2023-02-18 11:35:36.248164 | 1b2f5cc7-c44d-40cb-b733-2d4ba4ea3aa0 ==============================
[0m11:35:36.248164 [info ] [MainThread]: Running with dbt=1.4.1
[0m11:35:36.250835 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/mramirez/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:35:36.251179 [debug] [MainThread]: Tracking: tracking
[0m11:35:36.251981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d32a4a190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d32a4ae80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d32a4aaf0>]}
[0m11:35:36.335820 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m11:35:36.336228 [debug] [MainThread]: Partial parsing: added file: dbtlearm://models/src/src_host.sql
[0m11:35:36.352087 [debug] [MainThread]: 1699: static parser successfully parsed src/src_host.sql
[0m11:35:36.373893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1b2f5cc7-c44d-40cb-b733-2d4ba4ea3aa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d32bc0670>]}
[0m11:35:36.380294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1b2f5cc7-c44d-40cb-b733-2d4ba4ea3aa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d32b9ee20>]}
[0m11:35:36.380671 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 304 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m11:35:36.380953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b2f5cc7-c44d-40cb-b733-2d4ba4ea3aa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d32b9edc0>]}
[0m11:35:36.382134 [info ] [MainThread]: 
[0m11:35:36.383548 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:35:36.384563 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb'
[0m11:35:36.398413 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m11:35:36.398733 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m11:35:36.398966 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:35:37.909184 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2 seconds
[0m11:35:37.910707 [debug] [ThreadPool]: On list_airbnb: Close
[0m11:35:38.168985 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m11:35:38.175222 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m11:35:38.175459 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m11:35:38.175661 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:35:38.994985 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1 seconds
[0m11:35:38.996358 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m11:35:39.232499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b2f5cc7-c44d-40cb-b733-2d4ba4ea3aa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d32b9edf0>]}
[0m11:35:39.233132 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:35:39.233399 [info ] [MainThread]: 
[0m11:35:39.243597 [debug] [Thread-1  ]: Began running node model.dbtlearm.src_host
[0m11:35:39.244018 [debug] [Thread-3  ]: Began running node model.dbtlearm.src_listings
[0m11:35:39.244279 [debug] [Thread-4  ]: Began running node model.dbtlearm.src_reviews
[0m11:35:39.244621 [info ] [Thread-1  ]: 1 of 3 START sql view model dev.src_host ....................................... [RUN]
[0m11:35:39.245154 [info ] [Thread-3  ]: 2 of 3 START sql view model dev.src_listings ................................... [RUN]
[0m11:35:39.245650 [info ] [Thread-4  ]: 3 of 3 START sql view model dev.src_reviews .................................... [RUN]
[0m11:35:39.246286 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearm.src_host'
[0m11:35:39.246769 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearm.src_listings'
[0m11:35:39.247248 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtlearm.src_reviews'
[0m11:35:39.247481 [debug] [Thread-1  ]: Began compiling node model.dbtlearm.src_host
[0m11:35:39.247704 [debug] [Thread-3  ]: Began compiling node model.dbtlearm.src_listings
[0m11:35:39.248045 [debug] [Thread-4  ]: Began compiling node model.dbtlearm.src_reviews
[0m11:35:39.249721 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearm.src_host"
[0m11:35:39.251023 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearm.src_listings"
[0m11:35:39.252484 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearm.src_reviews"
[0m11:35:39.253576 [debug] [Thread-1  ]: Timing info for model.dbtlearm.src_host (compile): 2023-02-18 11:35:39.248244 => 2023-02-18 11:35:39.253487
[0m11:35:39.253996 [debug] [Thread-1  ]: Began executing node model.dbtlearm.src_host
[0m11:35:39.254304 [debug] [Thread-4  ]: Timing info for model.dbtlearm.src_reviews (compile): 2023-02-18 11:35:39.251225 => 2023-02-18 11:35:39.254252
[0m11:35:39.254509 [debug] [Thread-3  ]: Timing info for model.dbtlearm.src_listings (compile): 2023-02-18 11:35:39.249938 => 2023-02-18 11:35:39.254459
[0m11:35:39.284391 [debug] [Thread-4  ]: Began executing node model.dbtlearm.src_reviews
[0m11:35:39.290464 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtlearm.src_host"
[0m11:35:39.290859 [debug] [Thread-3  ]: Began executing node model.dbtlearm.src_listings
[0m11:35:39.294805 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtlearm.src_reviews"
[0m11:35:39.300114 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtlearm.src_listings"
[0m11:35:39.315170 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearm.src_host"
[0m11:35:39.315545 [debug] [Thread-1  ]: On model.dbtlearm.src_host: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.src_host"} */
create or replace   view airbnb.dev.src_host
  
   as (
    WITH raw_listings AS(
	SELECT * FROM AIRBNB.RAW.RAW_HOSTS
)
SELECT
	id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
	raw_listings
  );
[0m11:35:39.316123 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearm.src_reviews"
[0m11:35:39.316370 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:35:39.316977 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearm.src_listings"
[0m11:35:39.317177 [debug] [Thread-4  ]: On model.dbtlearm.src_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.src_reviews"} */
create or replace   view airbnb.dev.src_reviews
  
   as (
    WITH raw_listings AS(
	SELECT * FROM AIRBNB.RAW.RAW_REVIEWS
)
SELECT
	listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
	raw_listings
  );
[0m11:35:39.317986 [debug] [Thread-3  ]: On model.dbtlearm.src_listings: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.src_listings"} */
create or replace   view airbnb.dev.src_listings
  
   as (
    -- DBT knows this is a view
-- By default they are views
WITH raw_listings AS(
	SELECT * FROM AIRBNB.RAW.RAW_LISTINGS
)
SELECT
	id as listing_id,
    name as listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at
FROM
	raw_listings
  );
[0m11:35:39.318617 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m11:35:39.318965 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m11:35:40.582077 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m11:35:40.597304 [debug] [Thread-1  ]: Timing info for model.dbtlearm.src_host (execute): 2023-02-18 11:35:39.254701 => 2023-02-18 11:35:40.597251
[0m11:35:40.597560 [debug] [Thread-1  ]: On model.dbtlearm.src_host: Close
[0m11:35:40.640411 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1 seconds
[0m11:35:40.645048 [debug] [Thread-4  ]: Timing info for model.dbtlearm.src_reviews (execute): 2023-02-18 11:35:39.291113 => 2023-02-18 11:35:40.645002
[0m11:35:40.645272 [debug] [Thread-4  ]: On model.dbtlearm.src_reviews: Close
[0m11:35:40.785517 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1 seconds
[0m11:35:40.788044 [debug] [Thread-3  ]: Timing info for model.dbtlearm.src_listings (execute): 2023-02-18 11:35:39.296313 => 2023-02-18 11:35:40.788000
[0m11:35:40.788264 [debug] [Thread-3  ]: On model.dbtlearm.src_listings: Close
[0m11:35:40.855040 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b2f5cc7-c44d-40cb-b733-2d4ba4ea3aa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d32fadcd0>]}
[0m11:35:40.855509 [info ] [Thread-1  ]: 1 of 3 OK created sql view model dev.src_host .................................. [[32mSUCCESS 1[0m in 1.61s]
[0m11:35:40.856912 [debug] [Thread-1  ]: Finished running node model.dbtlearm.src_host
[0m11:35:40.891141 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b2f5cc7-c44d-40cb-b733-2d4ba4ea3aa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d30e57af0>]}
[0m11:35:40.891645 [info ] [Thread-4  ]: 3 of 3 OK created sql view model dev.src_reviews ............................... [[32mSUCCESS 1[0m in 1.64s]
[0m11:35:40.892256 [debug] [Thread-4  ]: Finished running node model.dbtlearm.src_reviews
[0m11:35:41.042781 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b2f5cc7-c44d-40cb-b733-2d4ba4ea3aa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d32a91340>]}
[0m11:35:41.043211 [info ] [Thread-3  ]: 2 of 3 OK created sql view model dev.src_listings .............................. [[32mSUCCESS 1[0m in 1.80s]
[0m11:35:41.043546 [debug] [Thread-3  ]: Finished running node model.dbtlearm.src_listings
[0m11:35:41.044736 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:35:41.045174 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:35:41.045353 [debug] [MainThread]: Connection 'model.dbtlearm.src_host' was properly closed.
[0m11:35:41.045512 [debug] [MainThread]: Connection 'model.dbtlearm.src_listings' was properly closed.
[0m11:35:41.045667 [debug] [MainThread]: Connection 'model.dbtlearm.src_reviews' was properly closed.
[0m11:35:41.045861 [info ] [MainThread]: 
[0m11:35:41.046103 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 4.66 seconds (4.66s).
[0m11:35:41.046476 [debug] [MainThread]: Command end result
[0m11:35:41.052973 [info ] [MainThread]: 
[0m11:35:41.053298 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:35:41.053539 [info ] [MainThread]: 
[0m11:35:41.053772 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m11:35:41.054107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d30d62b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d30d62ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d32a38b80>]}
[0m11:35:41.054355 [debug] [MainThread]: Flushing usage events


============================== 2023-02-19 11:33:02.796964 | 7986d6e0-bf96-4a8f-8323-32a71b1f3ed9 ==============================
[0m11:33:02.796964 [info ] [MainThread]: Running with dbt=1.4.1
[0m11:33:02.800579 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/mramirez/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:33:02.801279 [debug] [MainThread]: Tracking: tracking
[0m11:33:02.801950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb00d349190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb00d349e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb00d349af0>]}
[0m11:33:03.051779 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
[0m11:33:03.052243 [debug] [MainThread]: Partial parsing: added file: dbtlearm://models/dim/dim_listings_cleansed.sql
[0m11:33:03.052599 [debug] [MainThread]: Partial parsing: updated file: dbtlearm://models/src/src_host.sql
[0m11:33:03.052931 [debug] [MainThread]: Partial parsing: updated file: dbtlearm://models/src/src_reviews.sql
[0m11:33:03.074022 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m11:33:03.099116 [debug] [MainThread]: 1699: static parser successfully parsed src/src_host.sql
[0m11:33:03.102770 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m11:33:03.118809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7986d6e0-bf96-4a8f-8323-32a71b1f3ed9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb00d4c1970>]}
[0m11:33:03.135976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7986d6e0-bf96-4a8f-8323-32a71b1f3ed9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb00d32c970>]}
[0m11:33:03.136504 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 304 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m11:33:03.136865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7986d6e0-bf96-4a8f-8323-32a71b1f3ed9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb00d32cc70>]}
[0m11:33:03.138420 [info ] [MainThread]: 
[0m11:33:03.140251 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:33:03.141514 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb'
[0m11:33:03.159008 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m11:33:03.159411 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m11:33:03.159706 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:33:05.835010 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 3 seconds
[0m11:33:05.837406 [debug] [ThreadPool]: On list_airbnb: Close
[0m11:33:06.077977 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m11:33:06.086973 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m11:33:06.087334 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m11:33:06.087613 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:33:06.963355 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m11:33:06.966078 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m11:33:07.215206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7986d6e0-bf96-4a8f-8323-32a71b1f3ed9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb00c757b50>]}
[0m11:33:07.216235 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:33:07.216863 [info ] [MainThread]: 
[0m11:33:07.245250 [debug] [Thread-1  ]: Began running node model.dbtlearm.src_host
[0m11:33:07.245709 [debug] [Thread-2  ]: Began running node model.dbtlearm.src_listings
[0m11:33:07.246093 [info ] [Thread-1  ]: 1 of 4 START sql view model dev.src_host ....................................... [RUN]
[0m11:33:07.246585 [debug] [Thread-3  ]: Began running node model.dbtlearm.src_reviews
[0m11:33:07.246960 [info ] [Thread-2  ]: 2 of 4 START sql view model dev.src_listings ................................... [RUN]
[0m11:33:07.247857 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearm.src_host'
[0m11:33:07.248264 [info ] [Thread-3  ]: 3 of 4 START sql view model dev.src_reviews .................................... [RUN]
[0m11:33:07.249049 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearm.src_listings'
[0m11:33:07.249375 [debug] [Thread-1  ]: Began compiling node model.dbtlearm.src_host
[0m11:33:07.249981 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearm.src_reviews'
[0m11:33:07.250294 [debug] [Thread-2  ]: Began compiling node model.dbtlearm.src_listings
[0m11:33:07.252214 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearm.src_host"
[0m11:33:07.252557 [debug] [Thread-3  ]: Began compiling node model.dbtlearm.src_reviews
[0m11:33:07.254262 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearm.src_listings"
[0m11:33:07.256178 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearm.src_reviews"
[0m11:33:07.257141 [debug] [Thread-1  ]: Timing info for model.dbtlearm.src_host (compile): 2023-02-19 11:33:07.250567 => 2023-02-19 11:33:07.257051
[0m11:33:07.257484 [debug] [Thread-1  ]: Began executing node model.dbtlearm.src_host
[0m11:33:07.298132 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtlearm.src_host"
[0m11:33:07.298491 [debug] [Thread-3  ]: Timing info for model.dbtlearm.src_reviews (compile): 2023-02-19 11:33:07.254638 => 2023-02-19 11:33:07.298412
[0m11:33:07.298918 [debug] [Thread-2  ]: Timing info for model.dbtlearm.src_listings (compile): 2023-02-19 11:33:07.252794 => 2023-02-19 11:33:07.298850
[0m11:33:07.299247 [debug] [Thread-3  ]: Began executing node model.dbtlearm.src_reviews
[0m11:33:07.299537 [debug] [Thread-2  ]: Began executing node model.dbtlearm.src_listings
[0m11:33:07.303338 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtlearm.src_reviews"
[0m11:33:07.307011 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtlearm.src_listings"
[0m11:33:07.308023 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearm.src_host"
[0m11:33:07.308282 [debug] [Thread-1  ]: On model.dbtlearm.src_host: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.src_host"} */
create or replace   view airbnb.dev.src_host
  
   as (
    WITH raw_hosts AS(
	SELECT * FROM AIRBNB.RAW.RAW_HOSTS
)
SELECT
	id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
	raw_listings
  );
[0m11:33:07.308517 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:33:07.314242 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearm.src_listings"
[0m11:33:07.315122 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearm.src_reviews"
[0m11:33:07.315420 [debug] [Thread-2  ]: On model.dbtlearm.src_listings: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.src_listings"} */
create or replace   view airbnb.dev.src_listings
  
   as (
    -- DBT knows this is a view
-- By default they are views
WITH raw_listings AS(
	SELECT * FROM AIRBNB.RAW.RAW_LISTINGS
)
SELECT
	id as listing_id,
    name as listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at
FROM
	raw_listings
  );
[0m11:33:07.315664 [debug] [Thread-3  ]: On model.dbtlearm.src_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.src_reviews"} */
create or replace   view airbnb.dev.src_reviews
  
   as (
    WITH raw_reviews AS(
	SELECT * FROM AIRBNB.RAW.RAW_REVIEWS
)
SELECT
	listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
	raw_listings
  );
[0m11:33:07.315914 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m11:33:07.316171 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m11:33:08.562718 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1 seconds
[0m11:33:08.596894 [debug] [Thread-2  ]: Timing info for model.dbtlearm.src_listings (execute): 2023-02-19 11:33:07.303583 => 2023-02-19 11:33:08.596819
[0m11:33:08.597292 [debug] [Thread-2  ]: On model.dbtlearm.src_listings: Close
[0m11:33:08.685967 [debug] [Thread-3  ]: Snowflake adapter: Snowflake query id: 01aa6f15-0000-fabc-0000-000387ea7151
[0m11:33:08.686300 [debug] [Thread-3  ]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'AIRBNB.DEV.RAW_LISTINGS' does not exist or not authorized.
[0m11:33:08.686743 [debug] [Thread-3  ]: Timing info for model.dbtlearm.src_reviews (execute): 2023-02-19 11:33:07.299762 => 2023-02-19 11:33:08.686617
[0m11:33:08.687060 [debug] [Thread-3  ]: On model.dbtlearm.src_reviews: Close
[0m11:33:08.783251 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01aa6f15-0000-fac7-0000-000387ea8011
[0m11:33:08.783940 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'AIRBNB.DEV.RAW_LISTINGS' does not exist or not authorized.
[0m11:33:08.784516 [debug] [Thread-1  ]: Timing info for model.dbtlearm.src_host (execute): 2023-02-19 11:33:07.257703 => 2023-02-19 11:33:08.784437
[0m11:33:08.784832 [debug] [Thread-1  ]: On model.dbtlearm.src_host: Close
[0m11:33:08.843002 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7986d6e0-bf96-4a8f-8323-32a71b1f3ed9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb00d6d52e0>]}
[0m11:33:08.844141 [info ] [Thread-2  ]: 2 of 4 OK created sql view model dev.src_listings .............................. [[32mSUCCESS 1[0m in 1.59s]
[0m11:33:08.846153 [debug] [Thread-2  ]: Finished running node model.dbtlearm.src_listings
[0m11:33:08.846893 [debug] [Thread-4  ]: Began running node model.dbtlearm.dim_listings_cleansed
[0m11:33:08.847425 [info ] [Thread-4  ]: 4 of 4 START sql view model dev.dim_listings_cleansed .......................... [RUN]
[0m11:33:08.848409 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtlearm.dim_listings_cleansed'
[0m11:33:08.848737 [debug] [Thread-4  ]: Began compiling node model.dbtlearm.dim_listings_cleansed
[0m11:33:08.852864 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearm.dim_listings_cleansed"
[0m11:33:08.854032 [debug] [Thread-4  ]: Timing info for model.dbtlearm.dim_listings_cleansed (compile): 2023-02-19 11:33:08.848958 => 2023-02-19 11:33:08.853954
[0m11:33:08.854355 [debug] [Thread-4  ]: Began executing node model.dbtlearm.dim_listings_cleansed
[0m11:33:08.858095 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtlearm.dim_listings_cleansed"
[0m11:33:08.859872 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearm.dim_listings_cleansed"
[0m11:33:08.860132 [debug] [Thread-4  ]: On model.dbtlearm.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.dim_listings_cleansed"} */
create or replace   view airbnb.dev.dim_listings_cleansed
  
   as (
    WITH src_listings AS (
    SELECT * FROM airbnb.dev.src_listings
)
SELECT 
    listing_id,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights = 0 THEN 1
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE(
        price_str,
        '$'
    ) :: NUMBER (
        10,
        2
    ) AS price,
    created_at,
    updated_at
FROM
    src_listings
  );
[0m11:33:08.860374 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m11:33:08.952212 [debug] [Thread-3  ]: Database Error in model src_reviews (models/src/src_reviews.sql)
  002003 (42S02): SQL compilation error:
  Object 'AIRBNB.DEV.RAW_LISTINGS' does not exist or not authorized.
  compiled Code at target/run/dbtlearm/models/src/src_reviews.sql
[0m11:33:08.952719 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7986d6e0-bf96-4a8f-8323-32a71b1f3ed9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb00da378e0>]}
[0m11:33:08.953212 [error] [Thread-3  ]: 3 of 4 ERROR creating sql view model dev.src_reviews ........................... [[31mERROR[0m in 1.70s]
[0m11:33:08.953634 [debug] [Thread-3  ]: Finished running node model.dbtlearm.src_reviews
[0m11:33:09.045300 [debug] [Thread-1  ]: Database Error in model src_host (models/src/src_host.sql)
  002003 (42S02): SQL compilation error:
  Object 'AIRBNB.DEV.RAW_LISTINGS' does not exist or not authorized.
  compiled Code at target/run/dbtlearm/models/src/src_host.sql
[0m11:33:09.045851 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7986d6e0-bf96-4a8f-8323-32a71b1f3ed9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb00d6cb250>]}
[0m11:33:09.046424 [error] [Thread-1  ]: 1 of 4 ERROR creating sql view model dev.src_host .............................. [[31mERROR[0m in 1.80s]
[0m11:33:09.046944 [debug] [Thread-1  ]: Finished running node model.dbtlearm.src_host
[0m11:33:09.875847 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1 seconds
[0m11:33:09.879851 [debug] [Thread-4  ]: Timing info for model.dbtlearm.dim_listings_cleansed (execute): 2023-02-19 11:33:08.854574 => 2023-02-19 11:33:09.879779
[0m11:33:09.880244 [debug] [Thread-4  ]: On model.dbtlearm.dim_listings_cleansed: Close
[0m11:33:10.121367 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7986d6e0-bf96-4a8f-8323-32a71b1f3ed9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb00d6d5910>]}
[0m11:33:10.122075 [info ] [Thread-4  ]: 4 of 4 OK created sql view model dev.dim_listings_cleansed ..................... [[32mSUCCESS 1[0m in 1.27s]
[0m11:33:10.122601 [debug] [Thread-4  ]: Finished running node model.dbtlearm.dim_listings_cleansed
[0m11:33:10.124267 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:33:10.124932 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:33:10.125198 [debug] [MainThread]: Connection 'model.dbtlearm.src_host' was properly closed.
[0m11:33:10.125431 [debug] [MainThread]: Connection 'model.dbtlearm.src_listings' was properly closed.
[0m11:33:10.125650 [debug] [MainThread]: Connection 'model.dbtlearm.src_reviews' was properly closed.
[0m11:33:10.125861 [debug] [MainThread]: Connection 'model.dbtlearm.dim_listings_cleansed' was properly closed.
[0m11:33:10.126151 [info ] [MainThread]: 
[0m11:33:10.126496 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 6.99 seconds (6.99s).
[0m11:33:10.127031 [debug] [MainThread]: Command end result
[0m11:33:10.142059 [info ] [MainThread]: 
[0m11:33:10.142523 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m11:33:10.142848 [info ] [MainThread]: 
[0m11:33:10.143183 [error] [MainThread]: [33mDatabase Error in model src_reviews (models/src/src_reviews.sql)[0m
[0m11:33:10.143492 [error] [MainThread]:   002003 (42S02): SQL compilation error:
[0m11:33:10.143784 [error] [MainThread]:   Object 'AIRBNB.DEV.RAW_LISTINGS' does not exist or not authorized.
[0m11:33:10.144072 [error] [MainThread]:   compiled Code at target/run/dbtlearm/models/src/src_reviews.sql
[0m11:33:10.144364 [info ] [MainThread]: 
[0m11:33:10.144905 [error] [MainThread]: [33mDatabase Error in model src_host (models/src/src_host.sql)[0m
[0m11:33:10.145228 [error] [MainThread]:   002003 (42S02): SQL compilation error:
[0m11:33:10.145523 [error] [MainThread]:   Object 'AIRBNB.DEV.RAW_LISTINGS' does not exist or not authorized.
[0m11:33:10.145814 [error] [MainThread]:   compiled Code at target/run/dbtlearm/models/src/src_host.sql
[0m11:33:10.146116 [info ] [MainThread]: 
[0m11:33:10.146433 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m11:33:10.146862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb00c757b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb00d6d3490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb00dadbe50>]}
[0m11:33:10.147210 [debug] [MainThread]: Flushing usage events


============================== 2023-02-19 11:33:49.595761 | 6928958f-be16-4e68-bc03-66ffc66ec18e ==============================
[0m11:33:49.595761 [info ] [MainThread]: Running with dbt=1.4.1
[0m11:33:49.597198 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/mramirez/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m11:33:49.597427 [debug] [MainThread]: Tracking: tracking
[0m11:33:49.613400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96d140bee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96d949e730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96d949e400>]}
[0m11:33:49.989191 [debug] [MainThread]: Executing "git --help"
[0m11:33:50.005467 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:33:50.006415 [debug] [MainThread]: STDERR: "b''"
[0m11:33:50.015936 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m11:33:50.017627 [debug] [MainThread]: Using snowflake connection "debug"
[0m11:33:50.017975 [debug] [MainThread]: On debug: select 1 as id
[0m11:33:50.018301 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:33:51.297014 [debug] [MainThread]: SQL status: SUCCESS 1 in 1 seconds
[0m11:33:51.298921 [debug] [MainThread]: On debug: Close
[0m11:33:51.536273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96da11fe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96da1295e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96da1294c0>]}
[0m11:33:51.536831 [debug] [MainThread]: Flushing usage events
[0m11:33:51.891348 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2023-02-19 11:35:11.972276 | c365d2dd-a031-446b-adc4-2fe29420767a ==============================
[0m11:35:11.972276 [info ] [MainThread]: Running with dbt=1.4.1
[0m11:35:11.975919 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/mramirez/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:35:11.976258 [debug] [MainThread]: Tracking: tracking
[0m11:35:11.976859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faff1488190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faff1488e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faff1488af0>]}
[0m11:35:12.052297 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m11:35:12.052869 [debug] [MainThread]: Partial parsing: updated file: dbtlearm://models/src/src_host.sql
[0m11:35:12.053151 [debug] [MainThread]: Partial parsing: updated file: dbtlearm://models/src/src_reviews.sql
[0m11:35:12.070276 [debug] [MainThread]: 1699: static parser successfully parsed src/src_host.sql
[0m11:35:12.085781 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m11:35:12.098048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c365d2dd-a031-446b-adc4-2fe29420767a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faff1603370>]}
[0m11:35:12.105880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c365d2dd-a031-446b-adc4-2fe29420767a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faff15e2af0>]}
[0m11:35:12.106328 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 304 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m11:35:12.106650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c365d2dd-a031-446b-adc4-2fe29420767a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faff15e2bb0>]}
[0m11:35:12.108008 [info ] [MainThread]: 
[0m11:35:12.109628 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:35:12.110790 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb'
[0m11:35:12.126752 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m11:35:12.127110 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m11:35:12.127376 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:35:13.608044 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1 seconds
[0m11:35:13.610469 [debug] [ThreadPool]: On list_airbnb: Close
[0m11:35:13.850042 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m11:35:13.859864 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m11:35:13.860224 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m11:35:13.860503 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:35:14.968096 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1 seconds
[0m11:35:14.970596 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m11:35:15.226183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c365d2dd-a031-446b-adc4-2fe29420767a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faff0787460>]}
[0m11:35:15.227145 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:35:15.227567 [info ] [MainThread]: 
[0m11:35:15.234322 [debug] [Thread-1  ]: Began running node model.dbtlearm.src_host
[0m11:35:15.234718 [debug] [Thread-2  ]: Began running node model.dbtlearm.src_listings
[0m11:35:15.235206 [info ] [Thread-1  ]: 1 of 4 START sql view model dev.src_host ....................................... [RUN]
[0m11:35:15.235667 [debug] [Thread-3  ]: Began running node model.dbtlearm.src_reviews
[0m11:35:15.236079 [info ] [Thread-2  ]: 2 of 4 START sql view model dev.src_listings ................................... [RUN]
[0m11:35:15.236868 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearm.src_host'
[0m11:35:15.237258 [info ] [Thread-3  ]: 3 of 4 START sql view model dev.src_reviews .................................... [RUN]
[0m11:35:15.237973 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearm.src_listings'
[0m11:35:15.238299 [debug] [Thread-1  ]: Began compiling node model.dbtlearm.src_host
[0m11:35:15.238934 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearm.src_reviews'
[0m11:35:15.239244 [debug] [Thread-2  ]: Began compiling node model.dbtlearm.src_listings
[0m11:35:15.241082 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearm.src_host"
[0m11:35:15.241405 [debug] [Thread-3  ]: Began compiling node model.dbtlearm.src_reviews
[0m11:35:15.243032 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearm.src_listings"
[0m11:35:15.244835 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearm.src_reviews"
[0m11:35:15.245386 [debug] [Thread-1  ]: Timing info for model.dbtlearm.src_host (compile): 2023-02-19 11:35:15.239477 => 2023-02-19 11:35:15.245296
[0m11:35:15.245767 [debug] [Thread-1  ]: Began executing node model.dbtlearm.src_host
[0m11:35:15.258058 [debug] [Thread-2  ]: Timing info for model.dbtlearm.src_listings (compile): 2023-02-19 11:35:15.241632 => 2023-02-19 11:35:15.257964
[0m11:35:15.264463 [debug] [Thread-3  ]: Timing info for model.dbtlearm.src_reviews (compile): 2023-02-19 11:35:15.243426 => 2023-02-19 11:35:15.264390
[0m11:35:15.276019 [debug] [Thread-2  ]: Began executing node model.dbtlearm.src_listings
[0m11:35:15.283803 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtlearm.src_host"
[0m11:35:15.284166 [debug] [Thread-3  ]: Began executing node model.dbtlearm.src_reviews
[0m11:35:15.287804 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtlearm.src_listings"
[0m11:35:15.292246 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtlearm.src_reviews"
[0m11:35:15.293049 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearm.src_host"
[0m11:35:15.293366 [debug] [Thread-1  ]: On model.dbtlearm.src_host: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.src_host"} */
create or replace   view airbnb.dev.src_host
  
   as (
    /*WITH raw_hosts AS(
	SELECT * FROM AIRBNB.RAW.RAW_HOSTS
)
SELECT
	id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
	raw_listings*/
  );
[0m11:35:15.293607 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:35:15.295026 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearm.src_listings"
[0m11:35:15.295286 [debug] [Thread-2  ]: On model.dbtlearm.src_listings: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.src_listings"} */
create or replace   view airbnb.dev.src_listings
  
   as (
    -- DBT knows this is a view
-- By default they are views
WITH raw_listings AS(
	SELECT * FROM AIRBNB.RAW.RAW_LISTINGS
)
SELECT
	id as listing_id,
    name as listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at
FROM
	raw_listings
  );
[0m11:35:15.295706 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearm.src_reviews"
[0m11:35:15.296508 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m11:35:15.296920 [debug] [Thread-3  ]: On model.dbtlearm.src_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.src_reviews"} */
create or replace   view airbnb.dev.src_reviews
  
   as (
    /*WITH raw_reviews AS(
	SELECT * FROM AIRBNB.RAW.RAW_REVIEWS
)
SELECT
	listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
	raw_listings*/
  );
[0m11:35:15.299138 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m11:35:16.411551 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01aa6f17-0000-fabc-0000-000387ea7189
[0m11:35:16.411898 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 15 at position 2 unexpected ')'.
[0m11:35:16.412304 [debug] [Thread-1  ]: Timing info for model.dbtlearm.src_host (execute): 2023-02-19 11:35:15.246078 => 2023-02-19 11:35:16.412232
[0m11:35:16.412583 [debug] [Thread-1  ]: On model.dbtlearm.src_host: Close
[0m11:35:16.522119 [debug] [Thread-3  ]: Snowflake adapter: Snowflake query id: 01aa6f17-0000-fac7-0000-000387ea803d
[0m11:35:16.522491 [debug] [Thread-3  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 15 at position 2 unexpected ')'.
[0m11:35:16.522953 [debug] [Thread-3  ]: Timing info for model.dbtlearm.src_reviews (execute): 2023-02-19 11:35:15.288166 => 2023-02-19 11:35:16.522876
[0m11:35:16.523272 [debug] [Thread-3  ]: On model.dbtlearm.src_reviews: Close
[0m11:35:16.558076 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1 seconds
[0m11:35:16.582945 [debug] [Thread-2  ]: Timing info for model.dbtlearm.src_listings (execute): 2023-02-19 11:35:15.284462 => 2023-02-19 11:35:16.582882
[0m11:35:16.583271 [debug] [Thread-2  ]: On model.dbtlearm.src_listings: Close
[0m11:35:16.661919 [debug] [Thread-1  ]: Database Error in model src_host (models/src/src_host.sql)
  001003 (42000): SQL compilation error:
  syntax error line 15 at position 2 unexpected ')'.
  compiled Code at target/run/dbtlearm/models/src/src_host.sql
[0m11:35:16.662494 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c365d2dd-a031-446b-adc4-2fe29420767a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faff28950d0>]}
[0m11:35:16.663090 [error] [Thread-1  ]: 1 of 4 ERROR creating sql view model dev.src_host .............................. [[31mERROR[0m in 1.43s]
[0m11:35:16.664981 [debug] [Thread-1  ]: Finished running node model.dbtlearm.src_host
[0m11:35:16.792757 [debug] [Thread-3  ]: Database Error in model src_reviews (models/src/src_reviews.sql)
  001003 (42000): SQL compilation error:
  syntax error line 15 at position 2 unexpected ')'.
  compiled Code at target/run/dbtlearm/models/src/src_reviews.sql
[0m11:35:16.793296 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c365d2dd-a031-446b-adc4-2fe29420767a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faff04b2940>]}
[0m11:35:16.793859 [error] [Thread-3  ]: 3 of 4 ERROR creating sql view model dev.src_reviews ........................... [[31mERROR[0m in 1.55s]
[0m11:35:16.794351 [debug] [Thread-3  ]: Finished running node model.dbtlearm.src_reviews
[0m11:35:16.821988 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c365d2dd-a031-446b-adc4-2fe29420767a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faff1639790>]}
[0m11:35:16.822657 [info ] [Thread-2  ]: 2 of 4 OK created sql view model dev.src_listings .............................. [[32mSUCCESS 1[0m in 1.58s]
[0m11:35:16.823185 [debug] [Thread-2  ]: Finished running node model.dbtlearm.src_listings
[0m11:35:16.823906 [debug] [Thread-4  ]: Began running node model.dbtlearm.dim_listings_cleansed
[0m11:35:16.824434 [info ] [Thread-4  ]: 4 of 4 START sql view model dev.dim_listings_cleansed .......................... [RUN]
[0m11:35:16.825236 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtlearm.dim_listings_cleansed'
[0m11:35:16.825558 [debug] [Thread-4  ]: Began compiling node model.dbtlearm.dim_listings_cleansed
[0m11:35:16.828761 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearm.dim_listings_cleansed"
[0m11:35:16.829750 [debug] [Thread-4  ]: Timing info for model.dbtlearm.dim_listings_cleansed (compile): 2023-02-19 11:35:16.825782 => 2023-02-19 11:35:16.829679
[0m11:35:16.830063 [debug] [Thread-4  ]: Began executing node model.dbtlearm.dim_listings_cleansed
[0m11:35:16.834023 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtlearm.dim_listings_cleansed"
[0m11:35:16.835811 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearm.dim_listings_cleansed"
[0m11:35:16.836227 [debug] [Thread-4  ]: On model.dbtlearm.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.dim_listings_cleansed"} */
create or replace   view airbnb.dev.dim_listings_cleansed
  
   as (
    WITH src_listings AS (
    SELECT * FROM airbnb.dev.src_listings
)
SELECT 
    listing_id,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights = 0 THEN 1
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE(
        price_str,
        '$'
    ) :: NUMBER (
        10,
        2
    ) AS price,
    created_at,
    updated_at
FROM
    src_listings
  );
[0m11:35:16.836558 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m11:35:17.921968 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1 seconds
[0m11:35:17.925830 [debug] [Thread-4  ]: Timing info for model.dbtlearm.dim_listings_cleansed (execute): 2023-02-19 11:35:16.830280 => 2023-02-19 11:35:17.925763
[0m11:35:17.926159 [debug] [Thread-4  ]: On model.dbtlearm.dim_listings_cleansed: Close
[0m11:35:18.168181 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c365d2dd-a031-446b-adc4-2fe29420767a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faff1639070>]}
[0m11:35:18.168857 [info ] [Thread-4  ]: 4 of 4 OK created sql view model dev.dim_listings_cleansed ..................... [[32mSUCCESS 1[0m in 1.34s]
[0m11:35:18.169403 [debug] [Thread-4  ]: Finished running node model.dbtlearm.dim_listings_cleansed
[0m11:35:18.171558 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:35:18.172222 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:35:18.172493 [debug] [MainThread]: Connection 'model.dbtlearm.src_host' was properly closed.
[0m11:35:18.172719 [debug] [MainThread]: Connection 'model.dbtlearm.src_listings' was properly closed.
[0m11:35:18.172934 [debug] [MainThread]: Connection 'model.dbtlearm.src_reviews' was properly closed.
[0m11:35:18.173147 [debug] [MainThread]: Connection 'model.dbtlearm.dim_listings_cleansed' was properly closed.
[0m11:35:18.173453 [info ] [MainThread]: 
[0m11:35:18.173800 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 6.07 seconds (6.07s).
[0m11:35:18.174342 [debug] [MainThread]: Command end result
[0m11:35:18.181904 [info ] [MainThread]: 
[0m11:35:18.182301 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m11:35:18.182630 [info ] [MainThread]: 
[0m11:35:18.182951 [error] [MainThread]: [33mDatabase Error in model src_host (models/src/src_host.sql)[0m
[0m11:35:18.183261 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m11:35:18.183563 [error] [MainThread]:   syntax error line 15 at position 2 unexpected ')'.
[0m11:35:18.183858 [error] [MainThread]:   compiled Code at target/run/dbtlearm/models/src/src_host.sql
[0m11:35:18.184149 [info ] [MainThread]: 
[0m11:35:18.184540 [error] [MainThread]: [33mDatabase Error in model src_reviews (models/src/src_reviews.sql)[0m
[0m11:35:18.184882 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m11:35:18.185216 [error] [MainThread]:   syntax error line 15 at position 2 unexpected ')'.
[0m11:35:18.185514 [error] [MainThread]:   compiled Code at target/run/dbtlearm/models/src/src_reviews.sql
[0m11:35:18.185819 [info ] [MainThread]: 
[0m11:35:18.186135 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m11:35:18.186544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faff163b040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faff14a3550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faff14f9100>]}
[0m11:35:18.186884 [debug] [MainThread]: Flushing usage events


============================== 2023-02-19 11:36:33.087492 | 34f7e9b7-fd2b-4313-8a33-648c873ec618 ==============================
[0m11:36:33.087492 [info ] [MainThread]: Running with dbt=1.4.1
[0m11:36:33.090445 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/mramirez/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:36:33.090759 [debug] [MainThread]: Tracking: tracking
[0m11:36:33.091283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd086b09190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd086b09e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd086b09af0>]}
[0m11:36:33.165331 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:36:33.165593 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:36:33.172435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '34f7e9b7-fd2b-4313-8a33-648c873ec618', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd086b5bf40>]}
[0m11:36:33.179714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '34f7e9b7-fd2b-4313-8a33-648c873ec618', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd086bf25e0>]}
[0m11:36:33.180133 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 304 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m11:36:33.180455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34f7e9b7-fd2b-4313-8a33-648c873ec618', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd086bf2670>]}
[0m11:36:33.181800 [info ] [MainThread]: 
[0m11:36:33.183427 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:36:33.184583 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb'
[0m11:36:33.200757 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m11:36:33.201106 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m11:36:33.201381 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:36:34.671986 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1 seconds
[0m11:36:34.674460 [debug] [ThreadPool]: On list_airbnb: Close
[0m11:36:34.939787 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m11:36:34.948898 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m11:36:34.949244 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m11:36:34.949672 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:36:36.057834 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1 seconds
[0m11:36:36.060138 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m11:36:36.321860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34f7e9b7-fd2b-4313-8a33-648c873ec618', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd086bf22b0>]}
[0m11:36:36.322842 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:36:36.323271 [info ] [MainThread]: 
[0m11:36:36.330422 [debug] [Thread-2  ]: Began running node model.dbtlearm.src_listings
[0m11:36:36.330987 [info ] [Thread-2  ]: 2 of 4 START sql view model dev.src_listings ................................... [RUN]
[0m11:36:36.331558 [debug] [Thread-1  ]: Began running node model.dbtlearm.src_host
[0m11:36:36.331893 [debug] [Thread-3  ]: Began running node model.dbtlearm.src_reviews
[0m11:36:36.332581 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearm.src_listings'
[0m11:36:36.333000 [info ] [Thread-1  ]: 1 of 4 START sql view model dev.src_host ....................................... [RUN]
[0m11:36:36.333518 [info ] [Thread-3  ]: 3 of 4 START sql view model dev.src_reviews .................................... [RUN]
[0m11:36:36.333959 [debug] [Thread-2  ]: Began compiling node model.dbtlearm.src_listings
[0m11:36:36.334617 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearm.src_host'
[0m11:36:36.335289 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearm.src_reviews'
[0m11:36:36.337136 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearm.src_listings"
[0m11:36:36.337507 [debug] [Thread-1  ]: Began compiling node model.dbtlearm.src_host
[0m11:36:36.337828 [debug] [Thread-3  ]: Began compiling node model.dbtlearm.src_reviews
[0m11:36:36.340041 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearm.src_host"
[0m11:36:36.341728 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearm.src_reviews"
[0m11:36:36.342276 [debug] [Thread-2  ]: Timing info for model.dbtlearm.src_listings (compile): 2023-02-19 11:36:36.335538 => 2023-02-19 11:36:36.342170
[0m11:36:36.342738 [debug] [Thread-2  ]: Began executing node model.dbtlearm.src_listings
[0m11:36:36.343086 [debug] [Thread-1  ]: Timing info for model.dbtlearm.src_host (compile): 2023-02-19 11:36:36.338164 => 2023-02-19 11:36:36.343022
[0m11:36:36.349465 [debug] [Thread-3  ]: Timing info for model.dbtlearm.src_reviews (compile): 2023-02-19 11:36:36.340353 => 2023-02-19 11:36:36.349386
[0m11:36:36.349890 [debug] [Thread-1  ]: Began executing node model.dbtlearm.src_host
[0m11:36:36.430122 [debug] [Thread-3  ]: Began executing node model.dbtlearm.src_reviews
[0m11:36:36.429969 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtlearm.src_listings"
[0m11:36:36.434032 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtlearm.src_host"
[0m11:36:36.437815 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtlearm.src_reviews"
[0m11:36:36.439486 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearm.src_listings"
[0m11:36:36.439785 [debug] [Thread-2  ]: On model.dbtlearm.src_listings: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.src_listings"} */
create or replace   view airbnb.dev.src_listings
  
   as (
    -- DBT knows this is a view
-- By default they are views
WITH raw_listings AS(
	SELECT * FROM AIRBNB.RAW.RAW_LISTINGS
)
SELECT
	id as listing_id,
    name as listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at
FROM
	raw_listings
  );
[0m11:36:36.440320 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearm.src_reviews"
[0m11:36:36.440771 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearm.src_host"
[0m11:36:36.440977 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m11:36:36.441241 [debug] [Thread-3  ]: On model.dbtlearm.src_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.src_reviews"} */
create or replace   view airbnb.dev.src_reviews
  
   as (
    /*WITH raw_reviews AS(
	SELECT * FROM AIRBNB.RAW.RAW_REVIEWS
)
SELECT
	listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
	raw_listings*/
  );
[0m11:36:36.441490 [debug] [Thread-1  ]: On model.dbtlearm.src_host: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.src_host"} */
create or replace   view airbnb.dev.src_host
  
   as (
    /*WITH raw_hosts AS(
	SELECT * FROM AIRBNB.RAW.RAW_HOSTS
)
SELECT
	id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
	raw_listings*/
  );
[0m11:36:36.442427 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m11:36:36.443427 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:36:37.561705 [debug] [Thread-3  ]: Snowflake adapter: Snowflake query id: 01aa6f18-0000-fac7-0000-000387ea8085
[0m11:36:37.562070 [debug] [Thread-3  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 15 at position 2 unexpected ')'.
[0m11:36:37.562483 [debug] [Thread-3  ]: Timing info for model.dbtlearm.src_reviews (execute): 2023-02-19 11:36:36.434299 => 2023-02-19 11:36:37.562410
[0m11:36:37.562769 [debug] [Thread-3  ]: On model.dbtlearm.src_reviews: Close
[0m11:36:37.659209 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01aa6f18-0000-fac7-0000-000387ea8089
[0m11:36:37.659700 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 15 at position 2 unexpected ')'.
[0m11:36:37.660187 [debug] [Thread-1  ]: Timing info for model.dbtlearm.src_host (execute): 2023-02-19 11:36:36.430575 => 2023-02-19 11:36:37.660109
[0m11:36:37.660517 [debug] [Thread-1  ]: On model.dbtlearm.src_host: Close
[0m11:36:37.774547 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1 seconds
[0m11:36:37.802522 [debug] [Thread-2  ]: Timing info for model.dbtlearm.src_listings (execute): 2023-02-19 11:36:36.343270 => 2023-02-19 11:36:37.802458
[0m11:36:37.803752 [debug] [Thread-2  ]: On model.dbtlearm.src_listings: Close
[0m11:36:37.808631 [debug] [Thread-3  ]: Database Error in model src_reviews (models/src/src_reviews.sql)
  001003 (42000): SQL compilation error:
  syntax error line 15 at position 2 unexpected ')'.
  compiled Code at target/run/dbtlearm/models/src/src_reviews.sql
[0m11:36:37.809064 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34f7e9b7-fd2b-4313-8a33-648c873ec618', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd086eff0a0>]}
[0m11:36:37.809552 [error] [Thread-3  ]: 3 of 4 ERROR creating sql view model dev.src_reviews ........................... [[31mERROR[0m in 1.47s]
[0m11:36:37.811227 [debug] [Thread-3  ]: Finished running node model.dbtlearm.src_reviews
[0m11:36:37.957644 [debug] [Thread-1  ]: Database Error in model src_host (models/src/src_host.sql)
  001003 (42000): SQL compilation error:
  syntax error line 15 at position 2 unexpected ')'.
  compiled Code at target/run/dbtlearm/models/src/src_host.sql
[0m11:36:37.958127 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34f7e9b7-fd2b-4313-8a33-648c873ec618', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd086eee2b0>]}
[0m11:36:37.958627 [error] [Thread-1  ]: 1 of 4 ERROR creating sql view model dev.src_host .............................. [[31mERROR[0m in 1.62s]
[0m11:36:37.959120 [debug] [Thread-1  ]: Finished running node model.dbtlearm.src_host
[0m11:36:38.075276 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34f7e9b7-fd2b-4313-8a33-648c873ec618', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd086bf22e0>]}
[0m11:36:38.075866 [info ] [Thread-2  ]: 2 of 4 OK created sql view model dev.src_listings .............................. [[32mSUCCESS 1[0m in 1.74s]
[0m11:36:38.076335 [debug] [Thread-2  ]: Finished running node model.dbtlearm.src_listings
[0m11:36:38.077061 [debug] [Thread-4  ]: Began running node model.dbtlearm.dim_listings_cleansed
[0m11:36:38.077531 [info ] [Thread-4  ]: 4 of 4 START sql view model dev.dim_listings_cleansed .......................... [RUN]
[0m11:36:38.078290 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtlearm.dim_listings_cleansed'
[0m11:36:38.078613 [debug] [Thread-4  ]: Began compiling node model.dbtlearm.dim_listings_cleansed
[0m11:36:38.082129 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearm.dim_listings_cleansed"
[0m11:36:38.083204 [debug] [Thread-4  ]: Timing info for model.dbtlearm.dim_listings_cleansed (compile): 2023-02-19 11:36:38.078848 => 2023-02-19 11:36:38.083123
[0m11:36:38.083543 [debug] [Thread-4  ]: Began executing node model.dbtlearm.dim_listings_cleansed
[0m11:36:38.087605 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtlearm.dim_listings_cleansed"
[0m11:36:38.089374 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearm.dim_listings_cleansed"
[0m11:36:38.089679 [debug] [Thread-4  ]: On model.dbtlearm.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.dim_listings_cleansed"} */
create or replace   view airbnb.dev.dim_listings_cleansed
  
   as (
    WITH src_listings AS (
    SELECT * FROM airbnb.dev.src_listings
)
SELECT 
    listing_id,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights = 0 THEN 1
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE(
        price_str,
        '$'
    ) :: NUMBER (
        10,
        2
    ) AS price,
    created_at,
    updated_at
FROM
    src_listings
  );
[0m11:36:38.089939 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m11:36:39.115312 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1 seconds
[0m11:36:39.119189 [debug] [Thread-4  ]: Timing info for model.dbtlearm.dim_listings_cleansed (execute): 2023-02-19 11:36:38.083764 => 2023-02-19 11:36:39.119120
[0m11:36:39.119525 [debug] [Thread-4  ]: On model.dbtlearm.dim_listings_cleansed: Close
[0m11:36:39.382705 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34f7e9b7-fd2b-4313-8a33-648c873ec618', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd086ed9e20>]}
[0m11:36:39.383386 [info ] [Thread-4  ]: 4 of 4 OK created sql view model dev.dim_listings_cleansed ..................... [[32mSUCCESS 1[0m in 1.30s]
[0m11:36:39.383956 [debug] [Thread-4  ]: Finished running node model.dbtlearm.dim_listings_cleansed
[0m11:36:39.385932 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:36:39.386571 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:36:39.386840 [debug] [MainThread]: Connection 'model.dbtlearm.src_host' was properly closed.
[0m11:36:39.387080 [debug] [MainThread]: Connection 'model.dbtlearm.src_listings' was properly closed.
[0m11:36:39.387423 [debug] [MainThread]: Connection 'model.dbtlearm.src_reviews' was properly closed.
[0m11:36:39.387662 [debug] [MainThread]: Connection 'model.dbtlearm.dim_listings_cleansed' was properly closed.
[0m11:36:39.387957 [info ] [MainThread]: 
[0m11:36:39.388315 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 6.21 seconds (6.21s).
[0m11:36:39.388866 [debug] [MainThread]: Command end result
[0m11:36:39.396517 [info ] [MainThread]: 
[0m11:36:39.396929 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m11:36:39.397264 [info ] [MainThread]: 
[0m11:36:39.397605 [error] [MainThread]: [33mDatabase Error in model src_reviews (models/src/src_reviews.sql)[0m
[0m11:36:39.397935 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m11:36:39.398254 [error] [MainThread]:   syntax error line 15 at position 2 unexpected ')'.
[0m11:36:39.398575 [error] [MainThread]:   compiled Code at target/run/dbtlearm/models/src/src_reviews.sql
[0m11:36:39.398880 [info ] [MainThread]: 
[0m11:36:39.399197 [error] [MainThread]: [33mDatabase Error in model src_host (models/src/src_host.sql)[0m
[0m11:36:39.399501 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m11:36:39.399826 [error] [MainThread]:   syntax error line 15 at position 2 unexpected ')'.
[0m11:36:39.400131 [error] [MainThread]:   compiled Code at target/run/dbtlearm/models/src/src_host.sql
[0m11:36:39.400519 [info ] [MainThread]: 
[0m11:36:39.400855 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m11:36:39.401250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd087047400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd086b5ba60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd086eee3a0>]}
[0m11:36:39.401584 [debug] [MainThread]: Flushing usage events


============================== 2023-02-19 11:36:58.671052 | 92cbc932-6937-4ef0-bec1-7912f9553063 ==============================
[0m11:36:58.671052 [info ] [MainThread]: Running with dbt=1.4.1
[0m11:36:58.674120 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/mramirez/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:36:58.674413 [debug] [MainThread]: Tracking: tracking
[0m11:36:58.675057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81b1949190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81b1949e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81b1949af0>]}
[0m11:36:58.745813 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m11:36:58.746295 [debug] [MainThread]: Partial parsing: updated file: dbtlearm://models/src/src_reviews.sql
[0m11:36:58.746581 [debug] [MainThread]: Partial parsing: updated file: dbtlearm://models/src/src_host.sql
[0m11:36:58.763218 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m11:36:58.777448 [debug] [MainThread]: 1699: static parser successfully parsed src/src_host.sql
[0m11:36:58.789537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '92cbc932-6937-4ef0-bec1-7912f9553063', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81b1cfa190>]}
[0m11:36:58.796471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '92cbc932-6937-4ef0-bec1-7912f9553063', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81b1cd9a60>]}
[0m11:36:58.796873 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 304 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m11:36:58.797189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92cbc932-6937-4ef0-bec1-7912f9553063', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81b1cd9b20>]}
[0m11:36:58.798586 [info ] [MainThread]: 
[0m11:36:58.800200 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:36:58.801342 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb'
[0m11:36:58.816881 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m11:36:58.817225 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m11:36:58.817490 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:37:00.200632 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1 seconds
[0m11:37:00.203043 [debug] [ThreadPool]: On list_airbnb: Close
[0m11:37:00.443578 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m11:37:00.453311 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m11:37:00.453707 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m11:37:00.500022 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:37:01.333114 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1 seconds
[0m11:37:01.335531 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m11:37:01.606587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92cbc932-6937-4ef0-bec1-7912f9553063', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81b18d4d00>]}
[0m11:37:01.607571 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:37:01.607992 [info ] [MainThread]: 
[0m11:37:01.614538 [debug] [Thread-1  ]: Began running node model.dbtlearm.src_host
[0m11:37:01.614903 [debug] [Thread-2  ]: Began running node model.dbtlearm.src_listings
[0m11:37:01.615234 [debug] [Thread-3  ]: Began running node model.dbtlearm.src_reviews
[0m11:37:01.615686 [info ] [Thread-1  ]: 1 of 4 START sql view model dev.src_host ....................................... [RUN]
[0m11:37:01.616198 [info ] [Thread-2  ]: 2 of 4 START sql view model dev.src_listings ................................... [RUN]
[0m11:37:01.616703 [info ] [Thread-3  ]: 3 of 4 START sql view model dev.src_reviews .................................... [RUN]
[0m11:37:01.617523 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearm.src_host'
[0m11:37:01.618184 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearm.src_listings'
[0m11:37:01.618833 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearm.src_reviews'
[0m11:37:01.619170 [debug] [Thread-1  ]: Began compiling node model.dbtlearm.src_host
[0m11:37:01.619496 [debug] [Thread-2  ]: Began compiling node model.dbtlearm.src_listings
[0m11:37:01.619807 [debug] [Thread-3  ]: Began compiling node model.dbtlearm.src_reviews
[0m11:37:01.621726 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearm.src_host"
[0m11:37:01.623387 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearm.src_listings"
[0m11:37:01.625013 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearm.src_reviews"
[0m11:37:01.626127 [debug] [Thread-1  ]: Timing info for model.dbtlearm.src_host (compile): 2023-02-19 11:37:01.620050 => 2023-02-19 11:37:01.626003
[0m11:37:01.626423 [debug] [Thread-2  ]: Timing info for model.dbtlearm.src_listings (compile): 2023-02-19 11:37:01.621984 => 2023-02-19 11:37:01.626357
[0m11:37:01.626792 [debug] [Thread-1  ]: Began executing node model.dbtlearm.src_host
[0m11:37:01.627145 [debug] [Thread-3  ]: Timing info for model.dbtlearm.src_reviews (compile): 2023-02-19 11:37:01.623641 => 2023-02-19 11:37:01.627086
[0m11:37:01.627395 [debug] [Thread-2  ]: Began executing node model.dbtlearm.src_listings
[0m11:37:01.634430 [debug] [Thread-3  ]: Began executing node model.dbtlearm.src_reviews
[0m11:37:01.670511 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtlearm.src_host"
[0m11:37:01.673982 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtlearm.src_listings"
[0m11:37:01.677689 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtlearm.src_reviews"
[0m11:37:01.679038 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearm.src_host"
[0m11:37:01.679695 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearm.src_reviews"
[0m11:37:01.679882 [debug] [Thread-1  ]: On model.dbtlearm.src_host: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.src_host"} */
create or replace   view airbnb.dev.src_host
  
   as (
    WITH raw_hosts AS(
	SELECT * FROM AIRBNB.RAW.RAW_HOSTS
)
SELECT
	id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
	raw_listings
  );
[0m11:37:01.680525 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearm.src_listings"
[0m11:37:01.680755 [debug] [Thread-3  ]: On model.dbtlearm.src_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.src_reviews"} */
create or replace   view airbnb.dev.src_reviews
  
   as (
    WITH raw_reviews AS(
	SELECT * FROM AIRBNB.RAW.RAW_REVIEWS
)
SELECT
	listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
	raw_listings
  );
[0m11:37:01.680986 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:37:01.681238 [debug] [Thread-2  ]: On model.dbtlearm.src_listings: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.src_listings"} */
create or replace   view airbnb.dev.src_listings
  
   as (
    -- DBT knows this is a view
-- By default they are views
WITH raw_listings AS(
	SELECT * FROM AIRBNB.RAW.RAW_LISTINGS
)
SELECT
	id as listing_id,
    name as listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at
FROM
	raw_listings
  );
[0m11:37:01.681477 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m11:37:01.682995 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m11:37:02.904108 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01aa6f19-0000-fac7-0000-000387ea8099
[0m11:37:02.904464 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'AIRBNB.DEV.RAW_LISTINGS' does not exist or not authorized.
[0m11:37:02.904878 [debug] [Thread-1  ]: Timing info for model.dbtlearm.src_host (execute): 2023-02-19 11:37:01.627618 => 2023-02-19 11:37:02.904805
[0m11:37:02.905168 [debug] [Thread-1  ]: On model.dbtlearm.src_host: Close
[0m11:37:02.980406 [debug] [Thread-3  ]: Snowflake adapter: Snowflake query id: 01aa6f19-0000-fac7-0000-000387ea809d
[0m11:37:02.980797 [debug] [Thread-3  ]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'AIRBNB.DEV.RAW_LISTINGS' does not exist or not authorized.
[0m11:37:02.981253 [debug] [Thread-3  ]: Timing info for model.dbtlearm.src_reviews (execute): 2023-02-19 11:37:01.674271 => 2023-02-19 11:37:02.981174
[0m11:37:02.981580 [debug] [Thread-3  ]: On model.dbtlearm.src_reviews: Close
[0m11:37:03.167084 [debug] [Thread-1  ]: Database Error in model src_host (models/src/src_host.sql)
  002003 (42S02): SQL compilation error:
  Object 'AIRBNB.DEV.RAW_LISTINGS' does not exist or not authorized.
  compiled Code at target/run/dbtlearm/models/src/src_host.sql
[0m11:37:03.167622 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92cbc932-6937-4ef0-bec1-7912f9553063', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81b19195b0>]}
[0m11:37:03.168159 [error] [Thread-1  ]: 1 of 4 ERROR creating sql view model dev.src_host .............................. [[31mERROR[0m in 1.55s]
[0m11:37:03.169840 [debug] [Thread-1  ]: Finished running node model.dbtlearm.src_host
[0m11:37:03.227754 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2 seconds
[0m11:37:03.253569 [debug] [Thread-2  ]: Timing info for model.dbtlearm.src_listings (execute): 2023-02-19 11:37:01.659166 => 2023-02-19 11:37:03.253500
[0m11:37:03.254043 [debug] [Thread-2  ]: On model.dbtlearm.src_listings: Close
[0m11:37:03.256903 [debug] [Thread-3  ]: Database Error in model src_reviews (models/src/src_reviews.sql)
  002003 (42S02): SQL compilation error:
  Object 'AIRBNB.DEV.RAW_LISTINGS' does not exist or not authorized.
  compiled Code at target/run/dbtlearm/models/src/src_reviews.sql
[0m11:37:03.257370 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92cbc932-6937-4ef0-bec1-7912f9553063', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81b19647f0>]}
[0m11:37:03.258495 [error] [Thread-3  ]: 3 of 4 ERROR creating sql view model dev.src_reviews ........................... [[31mERROR[0m in 1.64s]
[0m11:37:03.259050 [debug] [Thread-3  ]: Finished running node model.dbtlearm.src_reviews
[0m11:37:03.511800 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92cbc932-6937-4ef0-bec1-7912f9553063', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81b18f2190>]}
[0m11:37:03.512482 [info ] [Thread-2  ]: 2 of 4 OK created sql view model dev.src_listings .............................. [[32mSUCCESS 1[0m in 1.89s]
[0m11:37:03.513016 [debug] [Thread-2  ]: Finished running node model.dbtlearm.src_listings
[0m11:37:03.513902 [debug] [Thread-4  ]: Began running node model.dbtlearm.dim_listings_cleansed
[0m11:37:03.514335 [info ] [Thread-4  ]: 4 of 4 START sql view model dev.dim_listings_cleansed .......................... [RUN]
[0m11:37:03.515143 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtlearm.dim_listings_cleansed'
[0m11:37:03.515462 [debug] [Thread-4  ]: Began compiling node model.dbtlearm.dim_listings_cleansed
[0m11:37:03.519106 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearm.dim_listings_cleansed"
[0m11:37:03.520048 [debug] [Thread-4  ]: Timing info for model.dbtlearm.dim_listings_cleansed (compile): 2023-02-19 11:37:03.515687 => 2023-02-19 11:37:03.519975
[0m11:37:03.520382 [debug] [Thread-4  ]: Began executing node model.dbtlearm.dim_listings_cleansed
[0m11:37:03.524233 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtlearm.dim_listings_cleansed"
[0m11:37:03.525811 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearm.dim_listings_cleansed"
[0m11:37:03.526077 [debug] [Thread-4  ]: On model.dbtlearm.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.dim_listings_cleansed"} */
create or replace   view airbnb.dev.dim_listings_cleansed
  
   as (
    WITH src_listings AS (
    SELECT * FROM airbnb.dev.src_listings
)
SELECT 
    listing_id,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights = 0 THEN 1
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE(
        price_str,
        '$'
    ) :: NUMBER (
        10,
        2
    ) AS price,
    created_at,
    updated_at
FROM
    src_listings
  );
[0m11:37:03.526329 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m11:37:04.475028 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1 seconds
[0m11:37:04.478753 [debug] [Thread-4  ]: Timing info for model.dbtlearm.dim_listings_cleansed (execute): 2023-02-19 11:37:03.520606 => 2023-02-19 11:37:04.478684
[0m11:37:04.479104 [debug] [Thread-4  ]: On model.dbtlearm.dim_listings_cleansed: Close
[0m11:37:04.734887 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92cbc932-6937-4ef0-bec1-7912f9553063', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81b1d231f0>]}
[0m11:37:04.735606 [info ] [Thread-4  ]: 4 of 4 OK created sql view model dev.dim_listings_cleansed ..................... [[32mSUCCESS 1[0m in 1.22s]
[0m11:37:04.736148 [debug] [Thread-4  ]: Finished running node model.dbtlearm.dim_listings_cleansed
[0m11:37:04.738143 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:37:04.738819 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:37:04.739105 [debug] [MainThread]: Connection 'model.dbtlearm.src_host' was properly closed.
[0m11:37:04.739369 [debug] [MainThread]: Connection 'model.dbtlearm.src_listings' was properly closed.
[0m11:37:04.739598 [debug] [MainThread]: Connection 'model.dbtlearm.src_reviews' was properly closed.
[0m11:37:04.739822 [debug] [MainThread]: Connection 'model.dbtlearm.dim_listings_cleansed' was properly closed.
[0m11:37:04.740136 [info ] [MainThread]: 
[0m11:37:04.740493 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 5.94 seconds (5.94s).
[0m11:37:04.741042 [debug] [MainThread]: Command end result
[0m11:37:04.748769 [info ] [MainThread]: 
[0m11:37:04.749204 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m11:37:04.749540 [info ] [MainThread]: 
[0m11:37:04.749871 [error] [MainThread]: [33mDatabase Error in model src_host (models/src/src_host.sql)[0m
[0m11:37:04.750194 [error] [MainThread]:   002003 (42S02): SQL compilation error:
[0m11:37:04.750502 [error] [MainThread]:   Object 'AIRBNB.DEV.RAW_LISTINGS' does not exist or not authorized.
[0m11:37:04.750804 [error] [MainThread]:   compiled Code at target/run/dbtlearm/models/src/src_host.sql
[0m11:37:04.751107 [info ] [MainThread]: 
[0m11:37:04.751420 [error] [MainThread]: [33mDatabase Error in model src_reviews (models/src/src_reviews.sql)[0m
[0m11:37:04.751722 [error] [MainThread]:   002003 (42S02): SQL compilation error:
[0m11:37:04.752021 [error] [MainThread]:   Object 'AIRBNB.DEV.RAW_LISTINGS' does not exist or not authorized.
[0m11:37:04.752318 [error] [MainThread]:   compiled Code at target/run/dbtlearm/models/src/src_reviews.sql
[0m11:37:04.752624 [info ] [MainThread]: 
[0m11:37:04.752946 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m11:37:04.753353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81b30993d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81b3099730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81b1c62ee0>]}
[0m11:37:04.753702 [debug] [MainThread]: Flushing usage events


============================== 2023-02-19 11:43:33.951259 | 3d227855-7553-47e5-ad8a-f92152f2aecc ==============================
[0m11:43:33.951259 [info ] [MainThread]: Running with dbt=1.4.1
[0m11:43:33.954012 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/mramirez/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:43:33.954334 [debug] [MainThread]: Tracking: tracking
[0m11:43:33.954935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9c2449190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9c2449e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9c2449af0>]}
[0m11:43:34.196823 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
[0m11:43:34.197306 [debug] [MainThread]: Partial parsing: added file: dbtlearm://models/dim/dim_hosts_cleansed.sql
[0m11:43:34.197673 [debug] [MainThread]: Partial parsing: updated file: dbtlearm://models/src/src_reviews.sql
[0m11:43:34.197998 [debug] [MainThread]: Partial parsing: updated file: dbtlearm://models/src/src_host.sql
[0m11:43:34.217311 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m11:43:34.237172 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m11:43:34.240721 [debug] [MainThread]: 1699: static parser successfully parsed src/src_host.sql
[0m11:43:34.243245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9c25af130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9c252c8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9c248a5e0>]}
[0m11:43:34.243620 [debug] [MainThread]: Flushing usage events
[0m11:43:34.730045 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbtlearm.dim_hosts_cleansed' (models/dim/dim_hosts_cleansed.sql) depends on a node named 'src_hosts' which was not found


============================== 2023-02-19 11:48:40.759584 | 26c42399-23b0-4f75-a02a-be613c89f79e ==============================
[0m11:48:40.759584 [info ] [MainThread]: Running with dbt=1.4.1
[0m11:48:40.761332 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/mramirez/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'clean', 'indirect_selection': 'eager'}
[0m11:48:40.761578 [debug] [MainThread]: Tracking: tracking
[0m11:48:40.778295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe413b08100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe413b086a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe413b08d00>]}
[0m11:48:40.789953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe413b085b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe413b083a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe413b08130>]}
[0m11:48:40.790326 [debug] [MainThread]: Flushing usage events


============================== 2023-02-19 11:48:49.646550 | ecdbab14-3441-4a2d-ae3a-42e4709c0baf ==============================
[0m11:48:49.646550 [info ] [MainThread]: Running with dbt=1.4.1
[0m11:48:49.649311 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/mramirez/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:48:49.649657 [debug] [MainThread]: Tracking: tracking
[0m11:48:49.650220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d42348190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d42348e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d42348af0>]}
[0m11:48:49.664521 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:48:49.664902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ecdbab14-3441-4a2d-ae3a-42e4709c0baf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d42338970>]}
[0m11:48:50.310453 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m11:48:50.323281 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m11:48:50.326186 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m11:48:50.328935 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m11:48:50.331631 [debug] [MainThread]: 1699: static parser successfully parsed src/src_host.sql
[0m11:48:50.343290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d424ee6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d424cbfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d424cbfd0>]}
[0m11:48:50.343620 [debug] [MainThread]: Flushing usage events
[0m11:48:50.695731 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbtlearm.dim_hosts_cleansed' (models/dim/dim_hosts_cleansed.sql) depends on a node named 'src_hosts' which was not found


============================== 2023-02-19 11:49:22.336078 | 06fc3498-4b69-49d4-8bae-de143aff7b39 ==============================
[0m11:49:22.336078 [info ] [MainThread]: Running with dbt=1.4.1
[0m11:49:22.338710 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/mramirez/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:49:22.338999 [debug] [MainThread]: Tracking: tracking
[0m11:49:22.339548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7e0263160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7e0263e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7e0263ac0>]}
[0m11:49:22.353692 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:49:22.354075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '06fc3498-4b69-49d4-8bae-de143aff7b39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7e0252f70>]}
[0m11:49:22.992152 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m11:49:23.002914 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m11:49:23.005415 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m11:49:23.007909 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m11:49:23.010633 [debug] [MainThread]: 1699: static parser successfully parsed src/src_host.sql
[0m11:49:23.022460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7e0530400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7e051f400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7e04d6040>]}
[0m11:49:23.022777 [debug] [MainThread]: Flushing usage events
[0m11:49:23.410258 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbtlearm.dim_hosts_cleansed' (models/dim/dim_hosts_cleansed.sql) depends on a node named 'src_hosts' which was not found


============================== 2023-02-19 11:49:35.770544 | 53a8aeb4-92e0-4b86-9c6d-f0980a52d6c9 ==============================
[0m11:49:35.770544 [info ] [MainThread]: Running with dbt=1.4.1
[0m11:49:35.788703 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/mramirez/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m11:49:35.789045 [debug] [MainThread]: Tracking: tracking
[0m11:49:35.789572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9820b88190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9820b88e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9820b88af0>]}
[0m11:49:35.803476 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:49:35.803857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '53a8aeb4-92e0-4b86-9c6d-f0980a52d6c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9820b77f10>]}
[0m11:49:36.432670 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m11:49:36.444021 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m11:49:36.446651 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m11:49:36.449198 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m11:49:36.451841 [debug] [MainThread]: 1699: static parser successfully parsed src/src_host.sql
[0m11:49:36.463643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9820d2e700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9820d1d6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9820d0bf70>]}
[0m11:49:36.463954 [debug] [MainThread]: Flushing usage events
[0m11:49:36.821191 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbtlearm.dim_hosts_cleansed' (models/dim/dim_hosts_cleansed.sql) depends on a node named 'src_hosts' which was not found


============================== 2023-02-19 11:51:01.026810 | 9e32ac4f-aea1-40d7-a8de-fde64736bfe4 ==============================
[0m11:51:01.026810 [info ] [MainThread]: Running with dbt=1.4.1
[0m11:51:01.029890 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/mramirez/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m11:51:01.030181 [debug] [MainThread]: Tracking: tracking
[0m11:51:01.030684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f794b249190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f794b249e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f794b249af0>]}
[0m11:51:01.044260 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:51:01.044645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9e32ac4f-aea1-40d7-a8de-fde64736bfe4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f794b238970>]}
[0m11:51:01.687520 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m11:51:01.698998 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m11:51:01.701807 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m11:51:01.704222 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m11:51:01.706800 [debug] [MainThread]: 1699: static parser successfully parsed src/src_host.sql
[0m11:51:01.718583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f794b3ee6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f794b3cbfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f794b3cbfd0>]}
[0m11:51:01.718907 [debug] [MainThread]: Flushing usage events
[0m11:51:02.157406 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbtlearm.dim_hosts_cleansed' (models/dim/dim_hosts_cleansed.sql) depends on a node named 'src_hosts' which was not found


============================== 2023-02-19 11:52:36.158443 | 47f6cada-215b-4f45-8adc-549b46877fce ==============================
[0m11:52:36.158443 [info ] [MainThread]: Running with dbt=1.4.1
[0m11:52:36.161489 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/mramirez/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:52:36.161781 [debug] [MainThread]: Tracking: tracking
[0m11:52:36.162315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4a3a49190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4a3a49e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4a3a49af0>]}
[0m11:52:36.176421 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:52:36.176812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '47f6cada-215b-4f45-8adc-549b46877fce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4a3a39fa0>]}
[0m11:52:36.816045 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m11:52:36.827914 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m11:52:36.830396 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m11:52:36.832921 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m11:52:36.835461 [debug] [MainThread]: 1699: static parser successfully parsed src/src_host.sql
[0m11:52:36.847819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4a3bf0490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4a3bdf490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4a3bc2070>]}
[0m11:52:36.848189 [debug] [MainThread]: Flushing usage events
[0m11:52:37.374556 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbtlearm.dim_hosts_cleansed' (models/dim/dim_hosts_cleansed.sql) depends on a node named 'src_hosts' which was not found


============================== 2023-02-19 11:53:20.369784 | 158dcd93-0f36-4af0-911c-65749f128053 ==============================
[0m11:53:20.369784 [info ] [MainThread]: Running with dbt=1.4.1
[0m11:53:20.372821 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/mramirez/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:53:20.373183 [debug] [MainThread]: Tracking: tracking
[0m11:53:20.373863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82b5b4a190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82b5b4ae80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82b5b4aaf0>]}
[0m11:53:20.386927 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:53:20.387336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '158dcd93-0f36-4af0-911c-65749f128053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82b5b39850>]}
[0m11:53:21.081419 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m11:53:21.093097 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m11:53:21.096112 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m11:53:21.099158 [debug] [MainThread]: 1699: static parser successfully parsed src/src_host.sql
[0m11:53:21.320143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '158dcd93-0f36-4af0-911c-65749f128053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82b5bda3a0>]}
[0m11:53:21.326932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '158dcd93-0f36-4af0-911c-65749f128053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82b5af5370>]}
[0m11:53:21.327335 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 304 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m11:53:21.327668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '158dcd93-0f36-4af0-911c-65749f128053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82b5ae1fa0>]}
[0m11:53:21.328957 [info ] [MainThread]: 
[0m11:53:21.330590 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:53:21.331749 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb'
[0m11:53:21.351107 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m11:53:21.351476 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m11:53:21.351737 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:53:24.451673 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 3 seconds
[0m11:53:24.453289 [debug] [ThreadPool]: On list_airbnb: Close
[0m11:53:24.689925 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m11:53:24.697868 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m11:53:24.698234 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m11:53:24.698613 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:53:25.723347 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1 seconds
[0m11:53:25.724705 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m11:53:25.962643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '158dcd93-0f36-4af0-911c-65749f128053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82b5ae1fa0>]}
[0m11:53:25.963312 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:53:25.963594 [info ] [MainThread]: 
[0m11:53:26.055556 [debug] [Thread-1  ]: Began running node model.dbtlearm.src_host
[0m11:53:26.055866 [debug] [Thread-2  ]: Began running node model.dbtlearm.src_listings
[0m11:53:26.056131 [debug] [Thread-3  ]: Began running node model.dbtlearm.src_reviews
[0m11:53:26.056498 [info ] [Thread-1  ]: 1 of 4 START sql view model dev.src_host ....................................... [RUN]
[0m11:53:26.056971 [info ] [Thread-2  ]: 2 of 4 START sql view model dev.src_listings ................................... [RUN]
[0m11:53:26.057406 [info ] [Thread-3  ]: 3 of 4 START sql view model dev.src_reviews .................................... [RUN]
[0m11:53:26.058044 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearm.src_host'
[0m11:53:26.058648 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearm.src_listings'
[0m11:53:26.059145 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearm.src_reviews'
[0m11:53:26.059418 [debug] [Thread-1  ]: Began compiling node model.dbtlearm.src_host
[0m11:53:26.059674 [debug] [Thread-2  ]: Began compiling node model.dbtlearm.src_listings
[0m11:53:26.059917 [debug] [Thread-3  ]: Began compiling node model.dbtlearm.src_reviews
[0m11:53:26.061396 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearm.src_host"
[0m11:53:26.062770 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearm.src_listings"
[0m11:53:26.064070 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearm.src_reviews"
[0m11:53:26.065686 [debug] [Thread-2  ]: Timing info for model.dbtlearm.src_listings (compile): 2023-02-19 11:53:26.061616 => 2023-02-19 11:53:26.065536
[0m11:53:26.066030 [debug] [Thread-3  ]: Timing info for model.dbtlearm.src_reviews (compile): 2023-02-19 11:53:26.062977 => 2023-02-19 11:53:26.065949
[0m11:53:26.066315 [debug] [Thread-1  ]: Timing info for model.dbtlearm.src_host (compile): 2023-02-19 11:53:26.060110 => 2023-02-19 11:53:26.066259
[0m11:53:26.066617 [debug] [Thread-2  ]: Began executing node model.dbtlearm.src_listings
[0m11:53:26.066999 [debug] [Thread-3  ]: Began executing node model.dbtlearm.src_reviews
[0m11:53:26.067284 [debug] [Thread-1  ]: Began executing node model.dbtlearm.src_host
[0m11:53:26.109504 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtlearm.src_listings"
[0m11:53:26.113313 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtlearm.src_reviews"
[0m11:53:26.116473 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtlearm.src_host"
[0m11:53:26.118508 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearm.src_reviews"
[0m11:53:26.119262 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearm.src_listings"
[0m11:53:26.119878 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearm.src_host"
[0m11:53:26.120179 [debug] [Thread-3  ]: On model.dbtlearm.src_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.src_reviews"} */
create or replace   view airbnb.dev.src_reviews
  
   as (
    WITH raw_reviews AS(
	SELECT * FROM AIRBNB.RAW.RAW_REVIEWS
)
SELECT
	listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
	raw_reviews
  );
[0m11:53:26.120407 [debug] [Thread-2  ]: On model.dbtlearm.src_listings: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.src_listings"} */
create or replace   view airbnb.dev.src_listings
  
   as (
    -- DBT knows this is a view
-- By default they are views
WITH raw_listings AS(
	SELECT * FROM AIRBNB.RAW.RAW_LISTINGS
)
SELECT
	id as listing_id,
    name as listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at
FROM
	raw_listings
  );
[0m11:53:26.120625 [debug] [Thread-1  ]: On model.dbtlearm.src_host: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.src_host"} */
create or replace   view airbnb.dev.src_host
  
   as (
    WITH raw_hosts AS(
	SELECT * FROM AIRBNB.RAW.RAW_HOSTS
)
SELECT
	id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
	raw_hosts
  );
[0m11:53:26.120852 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m11:53:26.121069 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m11:53:26.121275 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:53:27.253416 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1 seconds
[0m11:53:27.269462 [debug] [Thread-3  ]: Timing info for model.dbtlearm.src_reviews (execute): 2023-02-19 11:53:26.089117 => 2023-02-19 11:53:27.269409
[0m11:53:27.269739 [debug] [Thread-3  ]: On model.dbtlearm.src_reviews: Close
[0m11:53:27.417113 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m11:53:27.419173 [debug] [Thread-1  ]: Timing info for model.dbtlearm.src_host (execute): 2023-02-19 11:53:26.113555 => 2023-02-19 11:53:27.419125
[0m11:53:27.419458 [debug] [Thread-1  ]: On model.dbtlearm.src_host: Close
[0m11:53:27.437280 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1 seconds
[0m11:53:27.442425 [debug] [Thread-2  ]: Timing info for model.dbtlearm.src_listings (execute): 2023-02-19 11:53:26.067487 => 2023-02-19 11:53:27.442374
[0m11:53:27.442688 [debug] [Thread-2  ]: On model.dbtlearm.src_listings: Close
[0m11:53:27.510347 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '158dcd93-0f36-4af0-911c-65749f128053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82b602aa90>]}
[0m11:53:27.510808 [info ] [Thread-3  ]: 3 of 4 OK created sql view model dev.src_reviews ............................... [[32mSUCCESS 1[0m in 1.45s]
[0m11:53:27.512687 [debug] [Thread-3  ]: Finished running node model.dbtlearm.src_reviews
[0m11:53:27.655578 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '158dcd93-0f36-4af0-911c-65749f128053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82b5f48640>]}
[0m11:53:27.656283 [info ] [Thread-1  ]: 1 of 4 OK created sql view model dev.src_host .................................. [[32mSUCCESS 1[0m in 1.60s]
[0m11:53:27.656736 [debug] [Thread-1  ]: Finished running node model.dbtlearm.src_host
[0m11:53:27.709706 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '158dcd93-0f36-4af0-911c-65749f128053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82b5f6b9d0>]}
[0m11:53:27.710179 [info ] [Thread-2  ]: 2 of 4 OK created sql view model dev.src_listings .............................. [[32mSUCCESS 1[0m in 1.65s]
[0m11:53:27.710594 [debug] [Thread-2  ]: Finished running node model.dbtlearm.src_listings
[0m11:53:27.711160 [debug] [Thread-4  ]: Began running node model.dbtlearm.dim_listings_cleansed
[0m11:53:27.711675 [info ] [Thread-4  ]: 4 of 4 START sql view model dev.dim_listings_cleansed .......................... [RUN]
[0m11:53:27.712357 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtlearm.dim_listings_cleansed'
[0m11:53:27.712620 [debug] [Thread-4  ]: Began compiling node model.dbtlearm.dim_listings_cleansed
[0m11:53:27.715352 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearm.dim_listings_cleansed"
[0m11:53:27.716268 [debug] [Thread-4  ]: Timing info for model.dbtlearm.dim_listings_cleansed (compile): 2023-02-19 11:53:27.712791 => 2023-02-19 11:53:27.716197
[0m11:53:27.716529 [debug] [Thread-4  ]: Began executing node model.dbtlearm.dim_listings_cleansed
[0m11:53:27.720292 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtlearm.dim_listings_cleansed"
[0m11:53:27.721675 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearm.dim_listings_cleansed"
[0m11:53:27.721931 [debug] [Thread-4  ]: On model.dbtlearm.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.dim_listings_cleansed"} */
create or replace   view airbnb.dev.dim_listings_cleansed
  
   as (
    WITH src_listings AS (
    SELECT * FROM airbnb.dev.src_listings
)
SELECT 
    listing_id,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights = 0 THEN 1
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE(
        price_str,
        '$'
    ) :: NUMBER (
        10,
        2
    ) AS price,
    created_at,
    updated_at
FROM
    src_listings
  );
[0m11:53:27.722239 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m11:53:28.654328 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1 seconds
[0m11:53:28.657500 [debug] [Thread-4  ]: Timing info for model.dbtlearm.dim_listings_cleansed (execute): 2023-02-19 11:53:27.716693 => 2023-02-19 11:53:28.657437
[0m11:53:28.657819 [debug] [Thread-4  ]: On model.dbtlearm.dim_listings_cleansed: Close
[0m11:53:28.913246 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '158dcd93-0f36-4af0-911c-65749f128053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82b609ac40>]}
[0m11:53:28.913714 [info ] [Thread-4  ]: 4 of 4 OK created sql view model dev.dim_listings_cleansed ..................... [[32mSUCCESS 1[0m in 1.20s]
[0m11:53:28.914068 [debug] [Thread-4  ]: Finished running node model.dbtlearm.dim_listings_cleansed
[0m11:53:28.915561 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:53:28.916060 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:53:28.916264 [debug] [MainThread]: Connection 'model.dbtlearm.src_host' was properly closed.
[0m11:53:28.916438 [debug] [MainThread]: Connection 'model.dbtlearm.src_listings' was properly closed.
[0m11:53:28.916605 [debug] [MainThread]: Connection 'model.dbtlearm.src_reviews' was properly closed.
[0m11:53:28.916768 [debug] [MainThread]: Connection 'model.dbtlearm.dim_listings_cleansed' was properly closed.
[0m11:53:28.917006 [info ] [MainThread]: 
[0m11:53:28.917269 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 7.59 seconds (7.59s).
[0m11:53:28.917698 [debug] [MainThread]: Command end result
[0m11:53:28.924140 [info ] [MainThread]: 
[0m11:53:28.924488 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:53:28.924742 [info ] [MainThread]: 
[0m11:53:28.924985 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m11:53:28.925370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82b6071bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82b3bfc880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82b605f460>]}
[0m11:53:28.925639 [debug] [MainThread]: Flushing usage events


============================== 2023-02-19 11:54:01.824228 | 02e6a561-07fc-4cde-8c35-095cf95d30be ==============================
[0m11:54:01.824228 [info ] [MainThread]: Running with dbt=1.4.1
[0m11:54:01.826839 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/mramirez/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:54:01.827136 [debug] [MainThread]: Tracking: tracking
[0m11:54:01.827865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd357123190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd357123e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd357123af0>]}
[0m11:54:01.912337 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m11:54:01.912748 [debug] [MainThread]: Partial parsing: added file: dbtlearm://models/dim/dim_hosts_cleansed.sql
[0m11:54:01.928704 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m11:54:01.944072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd35715c070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd357427bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd357427b20>]}
[0m11:54:01.944443 [debug] [MainThread]: Flushing usage events
[0m11:54:02.440295 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbtlearm.dim_hosts_cleansed' (models/dim/dim_hosts_cleansed.sql) depends on a node named 'src_hosts' which was not found


============================== 2023-02-19 11:54:22.225162 | d9242ae7-5262-491f-89e4-95e38c04e337 ==============================
[0m11:54:22.225162 [info ] [MainThread]: Running with dbt=1.4.1
[0m11:54:22.228051 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/mramirez/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:54:22.228457 [debug] [MainThread]: Tracking: tracking
[0m11:54:22.228946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd32a88190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd32a88e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd32a88af0>]}
[0m11:54:22.300845 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m11:54:22.301263 [debug] [MainThread]: Partial parsing: added file: dbtlearm://models/dim/dim_hosts_cleansed.sql
[0m11:54:22.317192 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m11:54:22.338177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd9242ae7-5262-491f-89e4-95e38c04e337', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd32cf7100>]}
[0m11:54:22.346363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd9242ae7-5262-491f-89e4-95e38c04e337', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd32cec9d0>]}
[0m11:54:22.346819 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 304 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m11:54:22.347113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9242ae7-5262-491f-89e4-95e38c04e337', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd32ceca60>]}
[0m11:54:22.348447 [info ] [MainThread]: 
[0m11:54:22.349948 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:54:22.351212 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb'
[0m11:54:22.365070 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m11:54:22.365396 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m11:54:22.365631 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:54:23.847445 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1 seconds
[0m11:54:23.848890 [debug] [ThreadPool]: On list_airbnb: Close
[0m11:54:24.187387 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m11:54:24.193810 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m11:54:24.194065 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m11:54:24.194364 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:54:25.483424 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1 seconds
[0m11:54:25.484803 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m11:54:25.734162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9242ae7-5262-491f-89e4-95e38c04e337', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd32cf7790>]}
[0m11:54:25.734771 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:54:25.735041 [info ] [MainThread]: 
[0m11:54:25.742251 [debug] [Thread-1  ]: Began running node model.dbtlearm.src_host
[0m11:54:25.742587 [debug] [Thread-2  ]: Began running node model.dbtlearm.src_listings
[0m11:54:25.742847 [debug] [Thread-3  ]: Began running node model.dbtlearm.src_reviews
[0m11:54:25.743252 [info ] [Thread-1  ]: 1 of 5 START sql view model dev.src_host ....................................... [RUN]
[0m11:54:25.743652 [info ] [Thread-2  ]: 2 of 5 START sql view model dev.src_listings ................................... [RUN]
[0m11:54:25.744000 [info ] [Thread-3  ]: 3 of 5 START sql view model dev.src_reviews .................................... [RUN]
[0m11:54:25.744669 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearm.src_host'
[0m11:54:25.745208 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearm.src_listings'
[0m11:54:25.745715 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearm.src_reviews'
[0m11:54:25.745985 [debug] [Thread-1  ]: Began compiling node model.dbtlearm.src_host
[0m11:54:25.746258 [debug] [Thread-2  ]: Began compiling node model.dbtlearm.src_listings
[0m11:54:25.746503 [debug] [Thread-3  ]: Began compiling node model.dbtlearm.src_reviews
[0m11:54:25.748067 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearm.src_host"
[0m11:54:25.749522 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearm.src_listings"
[0m11:54:25.750971 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearm.src_reviews"
[0m11:54:25.751868 [debug] [Thread-1  ]: Timing info for model.dbtlearm.src_host (compile): 2023-02-19 11:54:25.746701 => 2023-02-19 11:54:25.751786
[0m11:54:25.752098 [debug] [Thread-2  ]: Timing info for model.dbtlearm.src_listings (compile): 2023-02-19 11:54:25.748303 => 2023-02-19 11:54:25.752039
[0m11:54:25.752319 [debug] [Thread-3  ]: Timing info for model.dbtlearm.src_reviews (compile): 2023-02-19 11:54:25.749740 => 2023-02-19 11:54:25.752262
[0m11:54:25.752623 [debug] [Thread-1  ]: Began executing node model.dbtlearm.src_host
[0m11:54:25.752935 [debug] [Thread-2  ]: Began executing node model.dbtlearm.src_listings
[0m11:54:25.753242 [debug] [Thread-3  ]: Began executing node model.dbtlearm.src_reviews
[0m11:54:25.801141 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtlearm.src_listings"
[0m11:54:25.801575 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtlearm.src_host"
[0m11:54:25.804687 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtlearm.src_reviews"
[0m11:54:25.806185 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearm.src_listings"
[0m11:54:25.806756 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearm.src_host"
[0m11:54:25.807289 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearm.src_reviews"
[0m11:54:25.807489 [debug] [Thread-2  ]: On model.dbtlearm.src_listings: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.src_listings"} */
create or replace   view airbnb.dev.src_listings
  
   as (
    -- DBT knows this is a view
-- By default they are views
WITH raw_listings AS(
	SELECT * FROM AIRBNB.RAW.RAW_LISTINGS
)
SELECT
	id as listing_id,
    name as listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at
FROM
	raw_listings
  );
[0m11:54:25.807700 [debug] [Thread-1  ]: On model.dbtlearm.src_host: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.src_host"} */
create or replace   view airbnb.dev.src_host
  
   as (
    WITH raw_hosts AS(
	SELECT * FROM AIRBNB.RAW.RAW_HOSTS
)
SELECT
	id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
	raw_hosts
  );
[0m11:54:25.807906 [debug] [Thread-3  ]: On model.dbtlearm.src_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.src_reviews"} */
create or replace   view airbnb.dev.src_reviews
  
   as (
    WITH raw_reviews AS(
	SELECT * FROM AIRBNB.RAW.RAW_REVIEWS
)
SELECT
	listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
	raw_reviews
  );
[0m11:54:25.808122 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m11:54:25.808341 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:54:25.808556 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m11:54:27.012299 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1 seconds
[0m11:54:27.031620 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m11:54:27.034594 [debug] [Thread-2  ]: Timing info for model.dbtlearm.src_listings (execute): 2023-02-19 11:54:25.775130 => 2023-02-19 11:54:27.034544
[0m11:54:27.036623 [debug] [Thread-1  ]: Timing info for model.dbtlearm.src_host (execute): 2023-02-19 11:54:25.753468 => 2023-02-19 11:54:27.036584
[0m11:54:27.037238 [debug] [Thread-2  ]: On model.dbtlearm.src_listings: Close
[0m11:54:27.037605 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1 seconds
[0m11:54:27.037837 [debug] [Thread-1  ]: On model.dbtlearm.src_host: Close
[0m11:54:27.040687 [debug] [Thread-3  ]: Timing info for model.dbtlearm.src_reviews (execute): 2023-02-19 11:54:25.801784 => 2023-02-19 11:54:27.040647
[0m11:54:27.042769 [debug] [Thread-3  ]: On model.dbtlearm.src_reviews: Close
[0m11:54:27.282283 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9242ae7-5262-491f-89e4-95e38c04e337', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd33200c40>]}
[0m11:54:27.282820 [info ] [Thread-1  ]: 1 of 5 OK created sql view model dev.src_host .................................. [[32mSUCCESS 1[0m in 1.54s]
[0m11:54:27.284402 [debug] [Thread-1  ]: Finished running node model.dbtlearm.src_host
[0m11:54:27.285092 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9242ae7-5262-491f-89e4-95e38c04e337', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd31b9f130>]}
[0m11:54:27.286344 [debug] [Thread-4  ]: Began running node model.dbtlearm.dim_hosts_cleansed
[0m11:54:27.286767 [info ] [Thread-2  ]: 2 of 5 OK created sql view model dev.src_listings .............................. [[32mSUCCESS 1[0m in 1.54s]
[0m11:54:27.287872 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9242ae7-5262-491f-89e4-95e38c04e337', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd31b9f280>]}
[0m11:54:27.287262 [info ] [Thread-4  ]: 4 of 5 START sql view model dev.dim_hosts_cleansed ............................. [RUN]
[0m11:54:27.288319 [debug] [Thread-2  ]: Finished running node model.dbtlearm.src_listings
[0m11:54:27.288770 [info ] [Thread-3  ]: 3 of 5 OK created sql view model dev.src_reviews ............................... [[32mSUCCESS 1[0m in 1.54s]
[0m11:54:27.289417 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtlearm.dim_hosts_cleansed'
[0m11:54:27.289944 [debug] [Thread-1  ]: Began running node model.dbtlearm.dim_listings_cleansed
[0m11:54:27.290255 [debug] [Thread-3  ]: Finished running node model.dbtlearm.src_reviews
[0m11:54:27.290534 [debug] [Thread-4  ]: Began compiling node model.dbtlearm.dim_hosts_cleansed
[0m11:54:27.290886 [info ] [Thread-1  ]: 5 of 5 START sql view model dev.dim_listings_cleansed .......................... [RUN]
[0m11:54:27.294269 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearm.dim_hosts_cleansed"
[0m11:54:27.294899 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearm.dim_listings_cleansed'
[0m11:54:27.295335 [debug] [Thread-1  ]: Began compiling node model.dbtlearm.dim_listings_cleansed
[0m11:54:27.298052 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearm.dim_listings_cleansed"
[0m11:54:27.298358 [debug] [Thread-4  ]: Timing info for model.dbtlearm.dim_hosts_cleansed (compile): 2023-02-19 11:54:27.291382 => 2023-02-19 11:54:27.298287
[0m11:54:27.298717 [debug] [Thread-4  ]: Began executing node model.dbtlearm.dim_hosts_cleansed
[0m11:54:27.302350 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtlearm.dim_hosts_cleansed"
[0m11:54:27.302788 [debug] [Thread-1  ]: Timing info for model.dbtlearm.dim_listings_cleansed (compile): 2023-02-19 11:54:27.295588 => 2023-02-19 11:54:27.302706
[0m11:54:27.303129 [debug] [Thread-1  ]: Began executing node model.dbtlearm.dim_listings_cleansed
[0m11:54:27.307402 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtlearm.dim_listings_cleansed"
[0m11:54:27.308179 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearm.dim_hosts_cleansed"
[0m11:54:27.308538 [debug] [Thread-4  ]: On model.dbtlearm.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.dim_hosts_cleansed"} */
create or replace   view airbnb.dev.dim_hosts_cleansed
  
   as (
    WITH src_hosts AS(
    SELECT * FROM  airbnb.dev.src_host
)
SELECT
    host_id,
    NVL(
        host_name, 
        'Anonymous'
    ) AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
	src_hosts
  );
[0m11:54:27.308821 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m11:54:27.310057 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearm.dim_listings_cleansed"
[0m11:54:27.310774 [debug] [Thread-1  ]: On model.dbtlearm.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.dim_listings_cleansed"} */
create or replace   view airbnb.dev.dim_listings_cleansed
  
   as (
    WITH src_listings AS (
    SELECT * FROM airbnb.dev.src_listings
)
SELECT 
    listing_id,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights = 0 THEN 1
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE(
        price_str,
        '$'
    ) :: NUMBER (
        10,
        2
    ) AS price,
    created_at,
    updated_at
FROM
    src_listings
  );
[0m11:54:27.311621 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:54:28.402069 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1 seconds
[0m11:54:28.405026 [debug] [Thread-4  ]: Timing info for model.dbtlearm.dim_hosts_cleansed (execute): 2023-02-19 11:54:27.298949 => 2023-02-19 11:54:28.404967
[0m11:54:28.405327 [debug] [Thread-4  ]: On model.dbtlearm.dim_hosts_cleansed: Close
[0m11:54:28.411240 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m11:54:28.414148 [debug] [Thread-1  ]: Timing info for model.dbtlearm.dim_listings_cleansed (execute): 2023-02-19 11:54:27.303388 => 2023-02-19 11:54:28.414091
[0m11:54:28.414447 [debug] [Thread-1  ]: On model.dbtlearm.dim_listings_cleansed: Close
[0m11:54:28.652128 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9242ae7-5262-491f-89e4-95e38c04e337', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd3302bf40>]}
[0m11:54:28.653465 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9242ae7-5262-491f-89e4-95e38c04e337', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd31b9f3d0>]}
[0m11:54:28.652741 [info ] [Thread-4  ]: 4 of 5 OK created sql view model dev.dim_hosts_cleansed ........................ [[32mSUCCESS 1[0m in 1.36s]
[0m11:54:28.654151 [info ] [Thread-1  ]: 5 of 5 OK created sql view model dev.dim_listings_cleansed ..................... [[32mSUCCESS 1[0m in 1.36s]
[0m11:54:28.654723 [debug] [Thread-4  ]: Finished running node model.dbtlearm.dim_hosts_cleansed
[0m11:54:28.655080 [debug] [Thread-1  ]: Finished running node model.dbtlearm.dim_listings_cleansed
[0m11:54:28.656736 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:54:28.657343 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:54:28.657592 [debug] [MainThread]: Connection 'model.dbtlearm.dim_listings_cleansed' was properly closed.
[0m11:54:28.657817 [debug] [MainThread]: Connection 'model.dbtlearm.src_listings' was properly closed.
[0m11:54:28.658035 [debug] [MainThread]: Connection 'model.dbtlearm.src_reviews' was properly closed.
[0m11:54:28.658253 [debug] [MainThread]: Connection 'model.dbtlearm.dim_hosts_cleansed' was properly closed.
[0m11:54:28.658533 [info ] [MainThread]: 
[0m11:54:28.658926 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 6.31 seconds (6.31s).
[0m11:54:28.659536 [debug] [MainThread]: Command end result
[0m11:54:28.668268 [info ] [MainThread]: 
[0m11:54:28.668752 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:54:28.669104 [info ] [MainThread]: 
[0m11:54:28.669438 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m11:54:28.669837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd32cecac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd3322ff10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd3322f100>]}
[0m11:54:28.670178 [debug] [MainThread]: Flushing usage events


============================== 2023-02-20 13:30:15.983389 | 4196de13-9fee-4249-9c42-3fcd4827ddcc ==============================
[0m13:30:15.983389 [info ] [MainThread]: Running with dbt=1.4.1
[0m13:30:15.987341 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/mramirez/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:30:15.987835 [debug] [MainThread]: Tracking: tracking
[0m13:30:15.988634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d211f0fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d211f05b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d211f04c0>]}
[0m13:30:16.021503 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:30:16.021963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4196de13-9fee-4249-9c42-3fcd4827ddcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d21209ee0>]}
[0m13:30:16.860329 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m13:30:16.872361 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m13:30:16.875157 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m13:30:16.877773 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m13:30:16.880505 [debug] [MainThread]: 1699: static parser successfully parsed src/src_host.sql
[0m13:30:16.971046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4196de13-9fee-4249-9c42-3fcd4827ddcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d212e2850>]}
[0m13:30:16.984742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4196de13-9fee-4249-9c42-3fcd4827ddcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d212a3e80>]}
[0m13:30:16.985303 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 304 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m13:30:16.985720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4196de13-9fee-4249-9c42-3fcd4827ddcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d1f6794c0>]}
[0m13:30:16.987243 [info ] [MainThread]: 
[0m13:30:16.989162 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:30:16.990509 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb'
[0m13:30:17.006965 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m13:30:17.007330 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m13:30:17.007591 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:30:19.116395 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2 seconds
[0m13:30:19.119402 [debug] [ThreadPool]: On list_airbnb: Close
[0m13:30:19.394386 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m13:30:19.402598 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m13:30:19.402955 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m13:30:19.403222 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:30:20.538017 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1 seconds
[0m13:30:20.540073 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m13:30:20.789212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4196de13-9fee-4249-9c42-3fcd4827ddcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d21403b20>]}
[0m13:30:20.790050 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:30:20.790422 [info ] [MainThread]: 
[0m13:30:20.803888 [debug] [Thread-1  ]: Began running node model.dbtlearm.src_host
[0m13:30:20.804249 [debug] [Thread-2  ]: Began running node model.dbtlearm.src_listings
[0m13:30:20.804565 [debug] [Thread-3  ]: Began running node model.dbtlearm.src_reviews
[0m13:30:20.805005 [info ] [Thread-1  ]: 1 of 5 START sql view model dev.src_host ....................................... [RUN]
[0m13:30:20.805496 [info ] [Thread-2  ]: 2 of 5 START sql view model dev.src_listings ................................... [RUN]
[0m13:30:20.805974 [info ] [Thread-3  ]: 3 of 5 START sql view model dev.src_reviews .................................... [RUN]
[0m13:30:20.806737 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearm.src_host'
[0m13:30:20.807357 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearm.src_listings'
[0m13:30:20.807961 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearm.src_reviews'
[0m13:30:20.808272 [debug] [Thread-1  ]: Began compiling node model.dbtlearm.src_host
[0m13:30:20.808577 [debug] [Thread-2  ]: Began compiling node model.dbtlearm.src_listings
[0m13:30:20.808941 [debug] [Thread-3  ]: Began compiling node model.dbtlearm.src_reviews
[0m13:30:20.810866 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearm.src_host"
[0m13:30:20.812603 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearm.src_listings"
[0m13:30:20.814343 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearm.src_reviews"
[0m13:30:20.816639 [debug] [Thread-1  ]: Timing info for model.dbtlearm.src_host (compile): 2023-02-20 13:30:20.809172 => 2023-02-20 13:30:20.816533
[0m13:30:20.817015 [debug] [Thread-1  ]: Began executing node model.dbtlearm.src_host
[0m13:30:20.817269 [debug] [Thread-3  ]: Timing info for model.dbtlearm.src_reviews (compile): 2023-02-20 13:30:20.812860 => 2023-02-20 13:30:20.817215
[0m13:30:20.829078 [debug] [Thread-2  ]: Timing info for model.dbtlearm.src_listings (compile): 2023-02-20 13:30:20.811135 => 2023-02-20 13:30:20.828986
[0m13:30:20.840695 [debug] [Thread-3  ]: Began executing node model.dbtlearm.src_reviews
[0m13:30:20.856904 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtlearm.src_host"
[0m13:30:20.857302 [debug] [Thread-2  ]: Began executing node model.dbtlearm.src_listings
[0m13:30:20.860726 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtlearm.src_reviews"
[0m13:30:20.864404 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtlearm.src_listings"
[0m13:30:20.865522 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearm.src_host"
[0m13:30:20.865775 [debug] [Thread-1  ]: On model.dbtlearm.src_host: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.src_host"} */
create or replace   view airbnb.dev.src_host
  
   as (
    WITH raw_hosts AS(
	SELECT * FROM AIRBNB.RAW.RAW_HOSTS
)
SELECT
	id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
	raw_hosts
  );
[0m13:30:20.865996 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:30:20.877523 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearm.src_reviews"
[0m13:30:20.877861 [debug] [Thread-3  ]: On model.dbtlearm.src_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.src_reviews"} */
create or replace   view airbnb.dev.src_reviews
  
   as (
    WITH raw_reviews AS(
	SELECT * FROM AIRBNB.RAW.RAW_REVIEWS
)
SELECT
	listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
	raw_reviews
  );
[0m13:30:20.878674 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearm.src_listings"
[0m13:30:20.878905 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:30:20.879152 [debug] [Thread-2  ]: On model.dbtlearm.src_listings: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.src_listings"} */
create or replace   view airbnb.dev.src_listings
  
   as (
    -- DBT knows this is a view
-- By default they are views
WITH raw_listings AS(
	SELECT * FROM AIRBNB.RAW.RAW_LISTINGS
)
SELECT
	id as listing_id,
    name as listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at
FROM
	raw_listings
  );
[0m13:30:20.880128 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m13:30:22.239772 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1 seconds
[0m13:30:22.265401 [debug] [Thread-3  ]: Timing info for model.dbtlearm.src_reviews (execute): 2023-02-20 13:30:20.857511 => 2023-02-20 13:30:22.265332
[0m13:30:22.265745 [debug] [Thread-3  ]: On model.dbtlearm.src_reviews: Close
[0m13:30:22.301836 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m13:30:22.305225 [debug] [Thread-1  ]: Timing info for model.dbtlearm.src_host (execute): 2023-02-20 13:30:20.817533 => 2023-02-20 13:30:22.305165
[0m13:30:22.305516 [debug] [Thread-1  ]: On model.dbtlearm.src_host: Close
[0m13:30:22.396817 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2 seconds
[0m13:30:22.402487 [debug] [Thread-2  ]: Timing info for model.dbtlearm.src_listings (execute): 2023-02-20 13:30:20.861085 => 2023-02-20 13:30:22.402392
[0m13:30:22.402848 [debug] [Thread-2  ]: On model.dbtlearm.src_listings: Close
[0m13:30:22.501284 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4196de13-9fee-4249-9c42-3fcd4827ddcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d218a4c40>]}
[0m13:30:22.502016 [info ] [Thread-3  ]: 3 of 5 OK created sql view model dev.src_reviews ............................... [[32mSUCCESS 1[0m in 1.69s]
[0m13:30:22.503810 [debug] [Thread-3  ]: Finished running node model.dbtlearm.src_reviews
[0m13:30:22.553327 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4196de13-9fee-4249-9c42-3fcd4827ddcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d2187f1f0>]}
[0m13:30:22.554071 [info ] [Thread-1  ]: 1 of 5 OK created sql view model dev.src_host .................................. [[32mSUCCESS 1[0m in 1.75s]
[0m13:30:22.554603 [debug] [Thread-1  ]: Finished running node model.dbtlearm.src_host
[0m13:30:22.555266 [debug] [Thread-4  ]: Began running node model.dbtlearm.dim_hosts_cleansed
[0m13:30:22.555743 [info ] [Thread-4  ]: 4 of 5 START sql table model dev.dim_hosts_cleansed ............................ [RUN]
[0m13:30:22.556512 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtlearm.dim_hosts_cleansed'
[0m13:30:22.556805 [debug] [Thread-4  ]: Began compiling node model.dbtlearm.dim_hosts_cleansed
[0m13:30:22.560029 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearm.dim_hosts_cleansed"
[0m13:30:22.563917 [debug] [Thread-4  ]: Timing info for model.dbtlearm.dim_hosts_cleansed (compile): 2023-02-20 13:30:22.557013 => 2023-02-20 13:30:22.563778
[0m13:30:22.564332 [debug] [Thread-4  ]: Began executing node model.dbtlearm.dim_hosts_cleansed
[0m13:30:22.577267 [debug] [Thread-4  ]: Dropping relation "AIRBNB"."DEV"."DIM_HOSTS_CLEANSED" because it is of type view
[0m13:30:22.586878 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearm.dim_hosts_cleansed"
[0m13:30:22.587511 [debug] [Thread-4  ]: On model.dbtlearm.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.dim_hosts_cleansed"} */
drop view if exists "AIRBNB"."DEV"."DIM_HOSTS_CLEANSED" cascade
[0m13:30:22.587850 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m13:30:22.672266 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4196de13-9fee-4249-9c42-3fcd4827ddcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d218ea880>]}
[0m13:30:22.672879 [info ] [Thread-2  ]: 2 of 5 OK created sql view model dev.src_listings .............................. [[32mSUCCESS 1[0m in 1.87s]
[0m13:30:22.673332 [debug] [Thread-2  ]: Finished running node model.dbtlearm.src_listings
[0m13:30:22.673885 [debug] [Thread-1  ]: Began running node model.dbtlearm.dim_listings_cleansed
[0m13:30:22.674267 [info ] [Thread-1  ]: 5 of 5 START sql table model dev.dim_listings_cleansed ......................... [RUN]
[0m13:30:22.674941 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearm.dim_listings_cleansed'
[0m13:30:22.675234 [debug] [Thread-1  ]: Began compiling node model.dbtlearm.dim_listings_cleansed
[0m13:30:22.678236 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearm.dim_listings_cleansed"
[0m13:30:22.681192 [debug] [Thread-1  ]: Timing info for model.dbtlearm.dim_listings_cleansed (compile): 2023-02-20 13:30:22.675442 => 2023-02-20 13:30:22.681093
[0m13:30:22.681562 [debug] [Thread-1  ]: Began executing node model.dbtlearm.dim_listings_cleansed
[0m13:30:22.684339 [debug] [Thread-1  ]: Dropping relation "AIRBNB"."DEV"."DIM_LISTINGS_CLEANSED" because it is of type view
[0m13:30:22.687491 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearm.dim_listings_cleansed"
[0m13:30:22.688433 [debug] [Thread-1  ]: On model.dbtlearm.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.dim_listings_cleansed"} */
drop view if exists "AIRBNB"."DEV"."DIM_LISTINGS_CLEANSED" cascade
[0m13:30:22.688791 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:30:23.489336 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1 seconds
[0m13:30:23.506373 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtlearm.dim_hosts_cleansed"
[0m13:30:23.510903 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearm.dim_hosts_cleansed"
[0m13:30:23.511242 [debug] [Thread-4  ]: On model.dbtlearm.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.dim_hosts_cleansed"} */
create or replace transient table airbnb.dev.dim_hosts_cleansed  as
        (WITH src_hosts AS(
    SELECT * FROM  airbnb.dev.src_host
)
SELECT
    host_id,
    NVL(
        host_name, 
        'Anonymous'
    ) AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
	src_hosts
        );
[0m13:30:23.647396 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m13:30:23.649816 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtlearm.dim_listings_cleansed"
[0m13:30:23.654392 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearm.dim_listings_cleansed"
[0m13:30:23.654768 [debug] [Thread-1  ]: On model.dbtlearm.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.dim_listings_cleansed"} */
create or replace transient table airbnb.dev.dim_listings_cleansed  as
        (WITH src_listings AS (
    SELECT * FROM airbnb.dev.src_listings
)
SELECT 
    listing_id,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights = 0 THEN 1
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE(
        price_str,
        '$'
    ) :: NUMBER (
        10,
        2
    ) AS price,
    created_at,
    updated_at
FROM
    src_listings
        );
[0m13:30:25.370965 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 2 seconds
[0m13:30:25.380345 [debug] [Thread-4  ]: Timing info for model.dbtlearm.dim_hosts_cleansed (execute): 2023-02-20 13:30:22.564564 => 2023-02-20 13:30:25.380280
[0m13:30:25.380663 [debug] [Thread-4  ]: On model.dbtlearm.dim_hosts_cleansed: Close
[0m13:30:25.555898 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2 seconds
[0m13:30:25.559736 [debug] [Thread-1  ]: Timing info for model.dbtlearm.dim_listings_cleansed (execute): 2023-02-20 13:30:22.681841 => 2023-02-20 13:30:25.559669
[0m13:30:25.560787 [debug] [Thread-1  ]: On model.dbtlearm.dim_listings_cleansed: Close
[0m13:30:25.699960 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4196de13-9fee-4249-9c42-3fcd4827ddcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d21bf0100>]}
[0m13:30:25.700640 [info ] [Thread-4  ]: 4 of 5 OK created sql table model dev.dim_hosts_cleansed ....................... [[32mSUCCESS 1[0m in 3.14s]
[0m13:30:25.701265 [debug] [Thread-4  ]: Finished running node model.dbtlearm.dim_hosts_cleansed
[0m13:30:25.819335 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4196de13-9fee-4249-9c42-3fcd4827ddcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d21bf0d30>]}
[0m13:30:25.820021 [info ] [Thread-1  ]: 5 of 5 OK created sql table model dev.dim_listings_cleansed .................... [[32mSUCCESS 1[0m in 3.14s]
[0m13:30:25.820567 [debug] [Thread-1  ]: Finished running node model.dbtlearm.dim_listings_cleansed
[0m13:30:25.822446 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:30:25.823070 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:30:25.823333 [debug] [MainThread]: Connection 'model.dbtlearm.dim_listings_cleansed' was properly closed.
[0m13:30:25.823568 [debug] [MainThread]: Connection 'model.dbtlearm.src_listings' was properly closed.
[0m13:30:25.823804 [debug] [MainThread]: Connection 'model.dbtlearm.src_reviews' was properly closed.
[0m13:30:25.824019 [debug] [MainThread]: Connection 'model.dbtlearm.dim_hosts_cleansed' was properly closed.
[0m13:30:25.824302 [info ] [MainThread]: 
[0m13:30:25.824655 [info ] [MainThread]: Finished running 3 view models, 2 table models in 0 hours 0 minutes and 8.84 seconds (8.84s).
[0m13:30:25.825257 [debug] [MainThread]: Command end result
[0m13:30:25.839184 [info ] [MainThread]: 
[0m13:30:25.839649 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:30:25.839991 [info ] [MainThread]: 
[0m13:30:25.840314 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m13:30:25.840836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d21bc4b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d21bc4c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d21bbbcd0>]}
[0m13:30:25.841194 [debug] [MainThread]: Flushing usage events


============================== 2023-02-20 13:38:59.887765 | 2d7a6a6b-4a4a-4d4a-8401-102f7ef708a9 ==============================
[0m13:38:59.887765 [info ] [MainThread]: Running with dbt=1.4.1
[0m13:38:59.890866 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/mramirez/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:38:59.891182 [debug] [MainThread]: Tracking: tracking
[0m13:38:59.891713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba1b2f0fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba1b2f0640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba1b2f04c0>]}
[0m13:38:59.974038 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m13:38:59.974512 [debug] [MainThread]: Partial parsing: added file: dbtlearm://models/fct/fct_reviews.sql
[0m13:38:59.991100 [debug] [MainThread]: 1603: static parser failed on fct/fct_reviews.sql
[0m13:39:00.003122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba1b3f1f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba1b35dd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba1b35dd90>]}
[0m13:39:00.003564 [debug] [MainThread]: Flushing usage events
[0m13:39:00.549625 [error] [MainThread]: Encountered an error:
Compilation Error in model fct_reviews (models/fct/fct_reviews.sql)
  unexpected '%'
    line 14
      {% if {% if is_incremental() %}


============================== 2023-02-20 13:39:16.096156 | 72e7ffd7-dea2-4644-9d2f-2daf189c7192 ==============================
[0m13:39:16.096156 [info ] [MainThread]: Running with dbt=1.4.1
[0m13:39:16.100352 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/mramirez/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:39:16.100832 [debug] [MainThread]: Tracking: tracking
[0m13:39:16.101605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce17ef1460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce17ef1310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce17ef1fa0>]}
[0m13:39:16.178063 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m13:39:16.178504 [debug] [MainThread]: Partial parsing: added file: dbtlearm://models/fct/fct_reviews.sql
[0m13:39:16.193578 [debug] [MainThread]: 1603: static parser failed on fct/fct_reviews.sql
[0m13:39:16.214669 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fct/fct_reviews.sql
[0m13:39:16.225732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '72e7ffd7-dea2-4644-9d2f-2daf189c7192', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce17f4f0d0>]}
[0m13:39:16.233291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '72e7ffd7-dea2-4644-9d2f-2daf189c7192', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce181a3d00>]}
[0m13:39:16.233887 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 304 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m13:39:16.234279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72e7ffd7-dea2-4644-9d2f-2daf189c7192', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce181a3e50>]}
[0m13:39:16.235814 [info ] [MainThread]: 
[0m13:39:16.237434 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:39:16.238658 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb'
[0m13:39:16.254676 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m13:39:16.255029 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m13:39:16.255320 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:39:17.845768 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2 seconds
[0m13:39:17.848398 [debug] [ThreadPool]: On list_airbnb: Close
[0m13:39:18.115478 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m13:39:18.123868 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m13:39:18.124219 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m13:39:18.124502 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:39:19.182841 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1 seconds
[0m13:39:19.185269 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m13:39:19.429760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72e7ffd7-dea2-4644-9d2f-2daf189c7192', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce17f4fdc0>]}
[0m13:39:19.430723 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:39:19.431161 [info ] [MainThread]: 
[0m13:39:19.438411 [debug] [Thread-1  ]: Began running node model.dbtlearm.src_host
[0m13:39:19.438892 [debug] [Thread-2  ]: Began running node model.dbtlearm.src_listings
[0m13:39:19.439632 [debug] [Thread-3  ]: Began running node model.dbtlearm.src_reviews
[0m13:39:19.439335 [info ] [Thread-1  ]: 1 of 6 START sql view model dev.src_host ....................................... [RUN]
[0m13:39:19.440153 [info ] [Thread-2  ]: 2 of 6 START sql view model dev.src_listings ................................... [RUN]
[0m13:39:19.440613 [info ] [Thread-3  ]: 3 of 6 START sql view model dev.src_reviews .................................... [RUN]
[0m13:39:19.441440 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearm.src_host'
[0m13:39:19.442093 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearm.src_listings'
[0m13:39:19.442732 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearm.src_reviews'
[0m13:39:19.443054 [debug] [Thread-1  ]: Began compiling node model.dbtlearm.src_host
[0m13:39:19.443359 [debug] [Thread-2  ]: Began compiling node model.dbtlearm.src_listings
[0m13:39:19.443704 [debug] [Thread-3  ]: Began compiling node model.dbtlearm.src_reviews
[0m13:39:19.445564 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearm.src_host"
[0m13:39:19.447197 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearm.src_listings"
[0m13:39:19.448874 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearm.src_reviews"
[0m13:39:19.450045 [debug] [Thread-1  ]: Timing info for model.dbtlearm.src_host (compile): 2023-02-20 13:39:19.443956 => 2023-02-20 13:39:19.449939
[0m13:39:19.450476 [debug] [Thread-1  ]: Began executing node model.dbtlearm.src_host
[0m13:39:19.457135 [debug] [Thread-3  ]: Timing info for model.dbtlearm.src_reviews (compile): 2023-02-20 13:39:19.447440 => 2023-02-20 13:39:19.457065
[0m13:39:19.463703 [debug] [Thread-2  ]: Timing info for model.dbtlearm.src_listings (compile): 2023-02-20 13:39:19.445812 => 2023-02-20 13:39:19.463634
[0m13:39:19.470181 [debug] [Thread-3  ]: Began executing node model.dbtlearm.src_reviews
[0m13:39:19.488915 [debug] [Thread-2  ]: Began executing node model.dbtlearm.src_listings
[0m13:39:19.488678 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtlearm.src_host"
[0m13:39:19.492715 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtlearm.src_reviews"
[0m13:39:19.496202 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtlearm.src_listings"
[0m13:39:19.497507 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearm.src_host"
[0m13:39:19.497773 [debug] [Thread-1  ]: On model.dbtlearm.src_host: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.src_host"} */
create or replace   view airbnb.dev.src_host
  
   as (
    WITH raw_hosts AS(
	SELECT * FROM AIRBNB.RAW.RAW_HOSTS
)
SELECT
	id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
	raw_hosts
  );
[0m13:39:19.498440 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearm.src_reviews"
[0m13:39:19.499097 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearm.src_listings"
[0m13:39:19.499284 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:39:19.499520 [debug] [Thread-3  ]: On model.dbtlearm.src_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.src_reviews"} */
create or replace   view airbnb.dev.src_reviews
  
   as (
    WITH raw_reviews AS(
	SELECT * FROM AIRBNB.RAW.RAW_REVIEWS
)
SELECT
	listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
	raw_reviews
  );
[0m13:39:19.499751 [debug] [Thread-2  ]: On model.dbtlearm.src_listings: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.src_listings"} */
create or replace   view airbnb.dev.src_listings
  
   as (
    -- DBT knows this is a view
-- By default they are views
WITH raw_listings AS(
	SELECT * FROM AIRBNB.RAW.RAW_LISTINGS
)
SELECT
	id as listing_id,
    name as listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at
FROM
	raw_listings
  );
[0m13:39:19.501263 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:39:19.501682 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m13:39:20.685479 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m13:39:20.709547 [debug] [Thread-1  ]: Timing info for model.dbtlearm.src_host (execute): 2023-02-20 13:39:19.450775 => 2023-02-20 13:39:20.709484
[0m13:39:20.709882 [debug] [Thread-1  ]: On model.dbtlearm.src_host: Close
[0m13:39:20.821845 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1 seconds
[0m13:39:20.825384 [debug] [Thread-3  ]: Timing info for model.dbtlearm.src_reviews (execute): 2023-02-20 13:39:19.489374 => 2023-02-20 13:39:20.825317
[0m13:39:20.825743 [debug] [Thread-3  ]: On model.dbtlearm.src_reviews: Close
[0m13:39:20.826658 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1 seconds
[0m13:39:20.831030 [debug] [Thread-2  ]: Timing info for model.dbtlearm.src_listings (execute): 2023-02-20 13:39:19.492934 => 2023-02-20 13:39:20.830976
[0m13:39:20.831976 [debug] [Thread-2  ]: On model.dbtlearm.src_listings: Close
[0m13:39:20.988078 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72e7ffd7-dea2-4644-9d2f-2daf189c7192', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce185689d0>]}
[0m13:39:20.988754 [info ] [Thread-1  ]: 1 of 6 OK created sql view model dev.src_host .................................. [[32mSUCCESS 1[0m in 1.55s]
[0m13:39:20.990769 [debug] [Thread-1  ]: Finished running node model.dbtlearm.src_host
[0m13:39:20.991568 [debug] [Thread-4  ]: Began running node model.dbtlearm.dim_hosts_cleansed
[0m13:39:20.991974 [info ] [Thread-4  ]: 4 of 6 START sql table model dev.dim_hosts_cleansed ............................ [RUN]
[0m13:39:20.992742 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtlearm.dim_hosts_cleansed'
[0m13:39:20.993048 [debug] [Thread-4  ]: Began compiling node model.dbtlearm.dim_hosts_cleansed
[0m13:39:20.996275 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearm.dim_hosts_cleansed"
[0m13:39:20.997227 [debug] [Thread-4  ]: Timing info for model.dbtlearm.dim_hosts_cleansed (compile): 2023-02-20 13:39:20.993264 => 2023-02-20 13:39:20.997155
[0m13:39:20.997551 [debug] [Thread-4  ]: Began executing node model.dbtlearm.dim_hosts_cleansed
[0m13:39:21.029232 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtlearm.dim_hosts_cleansed"
[0m13:39:21.030745 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearm.dim_hosts_cleansed"
[0m13:39:21.031096 [debug] [Thread-4  ]: On model.dbtlearm.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.dim_hosts_cleansed"} */
create or replace transient table airbnb.dev.dim_hosts_cleansed  as
        (WITH src_hosts AS(
    SELECT * FROM  airbnb.dev.src_host
)
SELECT
    host_id,
    NVL(
        host_name, 
        'Anonymous'
    ) AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
	src_hosts
        );
[0m13:39:21.031375 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m13:39:21.099300 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72e7ffd7-dea2-4644-9d2f-2daf189c7192', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce1879e460>]}
[0m13:39:21.100075 [info ] [Thread-3  ]: 3 of 6 OK created sql view model dev.src_reviews ............................... [[32mSUCCESS 1[0m in 1.66s]
[0m13:39:21.100675 [debug] [Thread-3  ]: Finished running node model.dbtlearm.src_reviews
[0m13:39:21.102117 [debug] [Thread-1  ]: Began running node model.dbtlearm.fct_reviews
[0m13:39:21.102589 [info ] [Thread-1  ]: 5 of 6 START sql incremental model dev.fct_reviews ............................. [RUN]
[0m13:39:21.103380 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearm.fct_reviews'
[0m13:39:21.104109 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72e7ffd7-dea2-4644-9d2f-2daf189c7192', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce1879eac0>]}
[0m13:39:21.104369 [debug] [Thread-1  ]: Began compiling node model.dbtlearm.fct_reviews
[0m13:39:21.104841 [info ] [Thread-2  ]: 2 of 6 OK created sql view model dev.src_listings .............................. [[32mSUCCESS 1[0m in 1.66s]
[0m13:39:21.109402 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearm.fct_reviews"
[0m13:39:21.109855 [debug] [Thread-2  ]: Finished running node model.dbtlearm.src_listings
[0m13:39:21.110750 [debug] [Thread-3  ]: Began running node model.dbtlearm.dim_listings_cleansed
[0m13:39:21.111210 [info ] [Thread-3  ]: 6 of 6 START sql table model dev.dim_listings_cleansed ......................... [RUN]
[0m13:39:21.112011 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearm.dim_listings_cleansed'
[0m13:39:21.112255 [debug] [Thread-1  ]: Timing info for model.dbtlearm.fct_reviews (compile): 2023-02-20 13:39:21.105223 => 2023-02-20 13:39:21.112189
[0m13:39:21.112569 [debug] [Thread-3  ]: Began compiling node model.dbtlearm.dim_listings_cleansed
[0m13:39:21.112909 [debug] [Thread-1  ]: Began executing node model.dbtlearm.fct_reviews
[0m13:39:21.115863 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearm.dim_listings_cleansed"
[0m13:39:21.162546 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtlearm.fct_reviews"
[0m13:39:21.163681 [debug] [Thread-3  ]: Timing info for model.dbtlearm.dim_listings_cleansed (compile): 2023-02-20 13:39:21.113150 => 2023-02-20 13:39:21.163611
[0m13:39:21.164008 [debug] [Thread-3  ]: Began executing node model.dbtlearm.dim_listings_cleansed
[0m13:39:21.167080 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtlearm.dim_listings_cleansed"
[0m13:39:21.167862 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m13:39:21.168324 [debug] [Thread-1  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
create or replace transient table airbnb.dev.fct_reviews  as
        (-- Incremental Materialization

WITH src_reviews AS (
    SELECt * FROM airbnb.dev.src_reviews
)
SELECT *
FROM src_reviews
WHERE review_text IS NOT NULL
%}
        );
[0m13:39:21.168644 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:39:21.171141 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearm.dim_listings_cleansed"
[0m13:39:21.172040 [debug] [Thread-3  ]: On model.dbtlearm.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.dim_listings_cleansed"} */
create or replace transient table airbnb.dev.dim_listings_cleansed  as
        (WITH src_listings AS (
    SELECT * FROM airbnb.dev.src_listings
)
SELECT 
    listing_id,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights = 0 THEN 1
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE(
        price_str,
        '$'
    ) :: NUMBER (
        10,
        2
    ) AS price,
    created_at,
    updated_at
FROM
    src_listings
        );
[0m13:39:21.172299 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m13:39:22.248891 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01aa7533-0000-fb2e-0000-000387eaa051
[0m13:39:22.249354 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 10 at position 0 unexpected '%'.
[0m13:39:22.249764 [debug] [Thread-1  ]: Timing info for model.dbtlearm.fct_reviews (execute): 2023-02-20 13:39:21.116139 => 2023-02-20 13:39:22.249691
[0m13:39:22.250043 [debug] [Thread-1  ]: On model.dbtlearm.fct_reviews: Close
[0m13:39:22.520363 [debug] [Thread-1  ]: Database Error in model fct_reviews (models/fct/fct_reviews.sql)
  001003 (42000): SQL compilation error:
  syntax error line 10 at position 0 unexpected '%'.
  compiled Code at target/run/dbtlearm/models/fct/fct_reviews.sql
[0m13:39:22.520919 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72e7ffd7-dea2-4644-9d2f-2daf189c7192', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce187d6c10>]}
[0m13:39:22.521457 [error] [Thread-1  ]: 5 of 6 ERROR creating sql incremental model dev.fct_reviews .................... [[31mERROR[0m in 1.42s]
[0m13:39:22.521907 [debug] [Thread-1  ]: Finished running node model.dbtlearm.fct_reviews
[0m13:39:23.102754 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 2 seconds
[0m13:39:23.112123 [debug] [Thread-4  ]: Timing info for model.dbtlearm.dim_hosts_cleansed (execute): 2023-02-20 13:39:20.997773 => 2023-02-20 13:39:23.112063
[0m13:39:23.112445 [debug] [Thread-4  ]: On model.dbtlearm.dim_hosts_cleansed: Close
[0m13:39:23.289728 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2 seconds
[0m13:39:23.293720 [debug] [Thread-3  ]: Timing info for model.dbtlearm.dim_listings_cleansed (execute): 2023-02-20 13:39:21.164246 => 2023-02-20 13:39:23.293601
[0m13:39:23.294072 [debug] [Thread-3  ]: On model.dbtlearm.dim_listings_cleansed: Close
[0m13:39:23.364916 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72e7ffd7-dea2-4644-9d2f-2daf189c7192', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce18568b20>]}
[0m13:39:23.365551 [info ] [Thread-4  ]: 4 of 6 OK created sql table model dev.dim_hosts_cleansed ....................... [[32mSUCCESS 1[0m in 2.37s]
[0m13:39:23.366153 [debug] [Thread-4  ]: Finished running node model.dbtlearm.dim_hosts_cleansed
[0m13:39:23.558353 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72e7ffd7-dea2-4644-9d2f-2daf189c7192', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce1932c430>]}
[0m13:39:23.559005 [info ] [Thread-3  ]: 6 of 6 OK created sql table model dev.dim_listings_cleansed .................... [[32mSUCCESS 1[0m in 2.45s]
[0m13:39:23.559527 [debug] [Thread-3  ]: Finished running node model.dbtlearm.dim_listings_cleansed
[0m13:39:23.561502 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:39:23.562142 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:39:23.562405 [debug] [MainThread]: Connection 'model.dbtlearm.fct_reviews' was properly closed.
[0m13:39:23.562639 [debug] [MainThread]: Connection 'model.dbtlearm.src_listings' was properly closed.
[0m13:39:23.562865 [debug] [MainThread]: Connection 'model.dbtlearm.dim_listings_cleansed' was properly closed.
[0m13:39:23.563089 [debug] [MainThread]: Connection 'model.dbtlearm.dim_hosts_cleansed' was properly closed.
[0m13:39:23.563388 [info ] [MainThread]: 
[0m13:39:23.563739 [info ] [MainThread]: Finished running 3 view models, 1 incremental model, 2 table models in 0 hours 0 minutes and 7.33 seconds (7.33s).
[0m13:39:23.564404 [debug] [MainThread]: Command end result
[0m13:39:23.573285 [info ] [MainThread]: 
[0m13:39:23.573728 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:39:23.574053 [info ] [MainThread]: 
[0m13:39:23.574376 [error] [MainThread]: [33mDatabase Error in model fct_reviews (models/fct/fct_reviews.sql)[0m
[0m13:39:23.574689 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m13:39:23.574995 [error] [MainThread]:   syntax error line 10 at position 0 unexpected '%'.
[0m13:39:23.575291 [error] [MainThread]:   compiled Code at target/run/dbtlearm/models/fct/fct_reviews.sql
[0m13:39:23.575598 [info ] [MainThread]: 
[0m13:39:23.575917 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m13:39:23.576332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce181a3eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce18561b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce18558a90>]}
[0m13:39:23.576731 [debug] [MainThread]: Flushing usage events


============================== 2023-02-20 13:39:34.873845 | 1ae074de-2875-4362-9297-ad3877c23d34 ==============================
[0m13:39:34.873845 [info ] [MainThread]: Running with dbt=1.4.1
[0m13:39:34.877024 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/mramirez/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:39:34.877365 [debug] [MainThread]: Tracking: tracking
[0m13:39:34.877913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2ad46efd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2ad46e5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2ad46e4c0>]}
[0m13:39:34.960970 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:39:34.961805 [debug] [MainThread]: Partial parsing: updated file: dbtlearm://models/fct/fct_reviews.sql
[0m13:39:34.982898 [debug] [MainThread]: 1603: static parser failed on fct/fct_reviews.sql
[0m13:39:35.005055 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fct/fct_reviews.sql
[0m13:39:35.016531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1ae074de-2875-4362-9297-ad3877c23d34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2ad4c20d0>]}
[0m13:39:35.024416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1ae074de-2875-4362-9297-ad3877c23d34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2ad482cd0>]}
[0m13:39:35.024872 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 304 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m13:39:35.025228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ae074de-2875-4362-9297-ad3877c23d34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2ad482f40>]}
[0m13:39:35.026804 [info ] [MainThread]: 
[0m13:39:35.028640 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:39:35.030147 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb'
[0m13:39:35.047226 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m13:39:35.047596 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m13:39:35.047900 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:39:36.300593 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1 seconds
[0m13:39:36.303146 [debug] [ThreadPool]: On list_airbnb: Close
[0m13:39:36.550348 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m13:39:36.559076 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m13:39:36.559445 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m13:39:36.559731 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:39:37.746476 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1 seconds
[0m13:39:37.749114 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m13:39:38.025335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ae074de-2875-4362-9297-ad3877c23d34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2ad4c2790>]}
[0m13:39:38.026321 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:39:38.026694 [info ] [MainThread]: 
[0m13:39:38.031476 [debug] [Thread-1  ]: Began running node model.dbtlearm.src_host
[0m13:39:38.031914 [debug] [Thread-2  ]: Began running node model.dbtlearm.src_listings
[0m13:39:38.032266 [debug] [Thread-3  ]: Began running node model.dbtlearm.src_reviews
[0m13:39:38.032673 [info ] [Thread-1  ]: 1 of 6 START sql view model dev.src_host ....................................... [RUN]
[0m13:39:38.033238 [info ] [Thread-2  ]: 2 of 6 START sql view model dev.src_listings ................................... [RUN]
[0m13:39:38.033930 [info ] [Thread-3  ]: 3 of 6 START sql view model dev.src_reviews .................................... [RUN]
[0m13:39:38.034739 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearm.src_host'
[0m13:39:38.035375 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearm.src_listings'
[0m13:39:38.036020 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearm.src_reviews'
[0m13:39:38.036345 [debug] [Thread-1  ]: Began compiling node model.dbtlearm.src_host
[0m13:39:38.036648 [debug] [Thread-2  ]: Began compiling node model.dbtlearm.src_listings
[0m13:39:38.036951 [debug] [Thread-3  ]: Began compiling node model.dbtlearm.src_reviews
[0m13:39:38.038734 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearm.src_host"
[0m13:39:38.040321 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearm.src_listings"
[0m13:39:38.041866 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearm.src_reviews"
[0m13:39:38.042854 [debug] [Thread-1  ]: Timing info for model.dbtlearm.src_host (compile): 2023-02-20 13:39:38.037177 => 2023-02-20 13:39:38.042771
[0m13:39:38.043150 [debug] [Thread-3  ]: Timing info for model.dbtlearm.src_reviews (compile): 2023-02-20 13:39:38.040559 => 2023-02-20 13:39:38.043084
[0m13:39:38.043407 [debug] [Thread-1  ]: Began executing node model.dbtlearm.src_host
[0m13:39:38.043625 [debug] [Thread-2  ]: Timing info for model.dbtlearm.src_listings (compile): 2023-02-20 13:39:38.038976 => 2023-02-20 13:39:38.043577
[0m13:39:38.043930 [debug] [Thread-3  ]: Began executing node model.dbtlearm.src_reviews
[0m13:39:38.061278 [debug] [Thread-2  ]: Began executing node model.dbtlearm.src_listings
[0m13:39:38.082152 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtlearm.src_host"
[0m13:39:38.086076 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtlearm.src_reviews"
[0m13:39:38.089759 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtlearm.src_listings"
[0m13:39:38.091161 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearm.src_host"
[0m13:39:38.091863 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearm.src_reviews"
[0m13:39:38.092558 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearm.src_listings"
[0m13:39:38.092742 [debug] [Thread-1  ]: On model.dbtlearm.src_host: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.src_host"} */
create or replace   view airbnb.dev.src_host
  
   as (
    WITH raw_hosts AS(
	SELECT * FROM AIRBNB.RAW.RAW_HOSTS
)
SELECT
	id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
	raw_hosts
  );
[0m13:39:38.092994 [debug] [Thread-3  ]: On model.dbtlearm.src_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.src_reviews"} */
create or replace   view airbnb.dev.src_reviews
  
   as (
    WITH raw_reviews AS(
	SELECT * FROM AIRBNB.RAW.RAW_REVIEWS
)
SELECT
	listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
	raw_reviews
  );
[0m13:39:38.093217 [debug] [Thread-2  ]: On model.dbtlearm.src_listings: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.src_listings"} */
create or replace   view airbnb.dev.src_listings
  
   as (
    -- DBT knows this is a view
-- By default they are views
WITH raw_listings AS(
	SELECT * FROM AIRBNB.RAW.RAW_LISTINGS
)
SELECT
	id as listing_id,
    name as listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at
FROM
	raw_listings
  );
[0m13:39:38.093444 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:39:38.093710 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:39:38.093930 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m13:39:39.368715 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1 seconds
[0m13:39:39.393380 [debug] [Thread-2  ]: Timing info for model.dbtlearm.src_listings (execute): 2023-02-20 13:39:38.086367 => 2023-02-20 13:39:39.393314
[0m13:39:39.393750 [debug] [Thread-2  ]: On model.dbtlearm.src_listings: Close
[0m13:39:39.395733 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1 seconds
[0m13:39:39.398452 [debug] [Thread-3  ]: Timing info for model.dbtlearm.src_reviews (execute): 2023-02-20 13:39:38.082442 => 2023-02-20 13:39:39.398400
[0m13:39:39.399460 [debug] [Thread-3  ]: On model.dbtlearm.src_reviews: Close
[0m13:39:39.516302 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m13:39:39.519888 [debug] [Thread-1  ]: Timing info for model.dbtlearm.src_host (execute): 2023-02-20 13:39:38.044155 => 2023-02-20 13:39:39.519829
[0m13:39:39.520191 [debug] [Thread-1  ]: On model.dbtlearm.src_host: Close
[0m13:39:39.669256 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ae074de-2875-4362-9297-ad3877c23d34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2ad9f1e80>]}
[0m13:39:39.670212 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ae074de-2875-4362-9297-ad3877c23d34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2ad9dec70>]}
[0m13:39:39.670883 [info ] [Thread-3  ]: 3 of 6 OK created sql view model dev.src_reviews ............................... [[32mSUCCESS 1[0m in 1.63s]
[0m13:39:39.671545 [info ] [Thread-2  ]: 2 of 6 OK created sql view model dev.src_listings .............................. [[32mSUCCESS 1[0m in 1.64s]
[0m13:39:39.673254 [debug] [Thread-3  ]: Finished running node model.dbtlearm.src_reviews
[0m13:39:39.673628 [debug] [Thread-2  ]: Finished running node model.dbtlearm.src_listings
[0m13:39:39.674234 [debug] [Thread-4  ]: Began running node model.dbtlearm.fct_reviews
[0m13:39:39.674874 [info ] [Thread-4  ]: 4 of 6 START sql incremental model dev.fct_reviews ............................. [RUN]
[0m13:39:39.675714 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtlearm.fct_reviews'
[0m13:39:39.676118 [debug] [Thread-2  ]: Began running node model.dbtlearm.dim_listings_cleansed
[0m13:39:39.676446 [debug] [Thread-4  ]: Began compiling node model.dbtlearm.fct_reviews
[0m13:39:39.676823 [info ] [Thread-2  ]: 5 of 6 START sql table model dev.dim_listings_cleansed ......................... [RUN]
[0m13:39:39.681900 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearm.fct_reviews"
[0m13:39:39.682609 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearm.dim_listings_cleansed'
[0m13:39:39.683100 [debug] [Thread-2  ]: Began compiling node model.dbtlearm.dim_listings_cleansed
[0m13:39:39.686143 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearm.dim_listings_cleansed"
[0m13:39:39.686594 [debug] [Thread-4  ]: Timing info for model.dbtlearm.fct_reviews (compile): 2023-02-20 13:39:39.677150 => 2023-02-20 13:39:39.686522
[0m13:39:39.686928 [debug] [Thread-4  ]: Began executing node model.dbtlearm.fct_reviews
[0m13:39:39.703790 [debug] [Thread-2  ]: Timing info for model.dbtlearm.dim_listings_cleansed (compile): 2023-02-20 13:39:39.683338 => 2023-02-20 13:39:39.703677
[0m13:39:39.721726 [debug] [Thread-2  ]: Began executing node model.dbtlearm.dim_listings_cleansed
[0m13:39:39.775458 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtlearm.dim_listings_cleansed"
[0m13:39:39.775931 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtlearm.fct_reviews"
[0m13:39:39.777615 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearm.dim_listings_cleansed"
[0m13:39:39.778230 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m13:39:39.778416 [debug] [Thread-2  ]: On model.dbtlearm.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.dim_listings_cleansed"} */
create or replace transient table airbnb.dev.dim_listings_cleansed  as
        (WITH src_listings AS (
    SELECT * FROM airbnb.dev.src_listings
)
SELECT 
    listing_id,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights = 0 THEN 1
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE(
        price_str,
        '$'
    ) :: NUMBER (
        10,
        2
    ) AS price,
    created_at,
    updated_at
FROM
    src_listings
        );
[0m13:39:39.778643 [debug] [Thread-4  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
create or replace transient table airbnb.dev.fct_reviews  as
        (-- Incremental Materialization

WITH src_reviews AS (
    SELECt * FROM airbnb.dev.src_reviews
)
SELECT *
FROM src_reviews
WHERE review_text IS NOT NULL

        );
[0m13:39:39.778870 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m13:39:39.779087 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m13:39:39.785140 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ae074de-2875-4362-9297-ad3877c23d34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2ad9ced60>]}
[0m13:39:39.785765 [info ] [Thread-1  ]: 1 of 6 OK created sql view model dev.src_host .................................. [[32mSUCCESS 1[0m in 1.75s]
[0m13:39:39.786180 [debug] [Thread-1  ]: Finished running node model.dbtlearm.src_host
[0m13:39:39.786705 [debug] [Thread-3  ]: Began running node model.dbtlearm.dim_hosts_cleansed
[0m13:39:39.787072 [info ] [Thread-3  ]: 6 of 6 START sql table model dev.dim_hosts_cleansed ............................ [RUN]
[0m13:39:39.787723 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearm.dim_hosts_cleansed'
[0m13:39:39.788027 [debug] [Thread-3  ]: Began compiling node model.dbtlearm.dim_hosts_cleansed
[0m13:39:39.790799 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearm.dim_hosts_cleansed"
[0m13:39:39.791760 [debug] [Thread-3  ]: Timing info for model.dbtlearm.dim_hosts_cleansed (compile): 2023-02-20 13:39:39.788222 => 2023-02-20 13:39:39.791686
[0m13:39:39.792074 [debug] [Thread-3  ]: Began executing node model.dbtlearm.dim_hosts_cleansed
[0m13:39:39.795157 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtlearm.dim_hosts_cleansed"
[0m13:39:39.796495 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearm.dim_hosts_cleansed"
[0m13:39:39.796767 [debug] [Thread-3  ]: On model.dbtlearm.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.dim_hosts_cleansed"} */
create or replace transient table airbnb.dev.dim_hosts_cleansed  as
        (WITH src_hosts AS(
    SELECT * FROM  airbnb.dev.src_host
)
SELECT
    host_id,
    NVL(
        host_name, 
        'Anonymous'
    ) AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
	src_hosts
        );
[0m13:39:39.797005 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m13:39:41.395786 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2 seconds
[0m13:39:41.407204 [debug] [Thread-3  ]: Timing info for model.dbtlearm.dim_hosts_cleansed (execute): 2023-02-20 13:39:39.792277 => 2023-02-20 13:39:41.407129
[0m13:39:41.407607 [debug] [Thread-3  ]: On model.dbtlearm.dim_hosts_cleansed: Close
[0m13:39:41.649423 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ae074de-2875-4362-9297-ad3877c23d34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2adbaaa90>]}
[0m13:39:41.650184 [info ] [Thread-3  ]: 6 of 6 OK created sql table model dev.dim_hosts_cleansed ....................... [[32mSUCCESS 1[0m in 1.86s]
[0m13:39:41.650777 [debug] [Thread-3  ]: Finished running node model.dbtlearm.dim_hosts_cleansed
[0m13:39:41.862568 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2 seconds
[0m13:39:41.866759 [debug] [Thread-2  ]: Timing info for model.dbtlearm.dim_listings_cleansed (execute): 2023-02-20 13:39:39.728334 => 2023-02-20 13:39:41.866684
[0m13:39:41.867329 [debug] [Thread-2  ]: On model.dbtlearm.dim_listings_cleansed: Close
[0m13:39:42.145469 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ae074de-2875-4362-9297-ad3877c23d34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2adb737c0>]}
[0m13:39:42.146161 [info ] [Thread-2  ]: 5 of 6 OK created sql table model dev.dim_listings_cleansed .................... [[32mSUCCESS 1[0m in 2.46s]
[0m13:39:42.146697 [debug] [Thread-2  ]: Finished running node model.dbtlearm.dim_listings_cleansed
[0m13:39:45.064809 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 5 seconds
[0m13:39:45.075358 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m13:39:45.075706 [debug] [Thread-4  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
drop view if exists airbnb.dev.fct_reviews__dbt_tmp cascade
[0m13:39:45.220078 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m13:39:45.223729 [debug] [Thread-4  ]: Timing info for model.dbtlearm.fct_reviews (execute): 2023-02-20 13:39:39.687149 => 2023-02-20 13:39:45.223667
[0m13:39:45.224043 [debug] [Thread-4  ]: On model.dbtlearm.fct_reviews: Close
[0m13:39:45.488597 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ae074de-2875-4362-9297-ad3877c23d34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2ad9fab20>]}
[0m13:39:45.489203 [info ] [Thread-4  ]: 4 of 6 OK created sql incremental model dev.fct_reviews ........................ [[32mSUCCESS 1[0m in 5.81s]
[0m13:39:45.489668 [debug] [Thread-4  ]: Finished running node model.dbtlearm.fct_reviews
[0m13:39:45.491381 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:39:45.492027 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:39:45.492290 [debug] [MainThread]: Connection 'model.dbtlearm.src_host' was properly closed.
[0m13:39:45.492519 [debug] [MainThread]: Connection 'model.dbtlearm.dim_listings_cleansed' was properly closed.
[0m13:39:45.492755 [debug] [MainThread]: Connection 'model.dbtlearm.dim_hosts_cleansed' was properly closed.
[0m13:39:45.492974 [debug] [MainThread]: Connection 'model.dbtlearm.fct_reviews' was properly closed.
[0m13:39:45.493273 [info ] [MainThread]: 
[0m13:39:45.493623 [info ] [MainThread]: Finished running 3 view models, 2 table models, 1 incremental model in 0 hours 0 minutes and 10.47 seconds (10.47s).
[0m13:39:45.494265 [debug] [MainThread]: Command end result
[0m13:39:45.503226 [info ] [MainThread]: 
[0m13:39:45.503667 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:39:45.504005 [info ] [MainThread]: 
[0m13:39:45.504326 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m13:39:45.504727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2adafabb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2ad482c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2adb1c3a0>]}
[0m13:39:45.505060 [debug] [MainThread]: Flushing usage events


============================== 2023-02-20 13:43:13.681578 | e0b31108-2803-4a5c-b335-93221e4939cb ==============================
[0m13:43:13.681578 [info ] [MainThread]: Running with dbt=1.4.1
[0m13:43:13.684918 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/mramirez/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:43:13.685223 [debug] [MainThread]: Tracking: tracking
[0m13:43:13.685860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd13cb30460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd13cb30310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd13cb30fa0>]}
[0m13:43:13.774691 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:43:13.775042 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:43:13.782843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e0b31108-2803-4a5c-b335-93221e4939cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd13cb990d0>]}
[0m13:43:13.792844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e0b31108-2803-4a5c-b335-93221e4939cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd13cc33d90>]}
[0m13:43:13.793338 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 304 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m13:43:13.793691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0b31108-2803-4a5c-b335-93221e4939cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd13cc33e20>]}
[0m13:43:13.795292 [info ] [MainThread]: 
[0m13:43:13.797117 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:43:13.798492 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb'
[0m13:43:13.816340 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m13:43:13.816685 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m13:43:13.816961 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:43:15.301100 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1 seconds
[0m13:43:15.303328 [debug] [ThreadPool]: On list_airbnb: Close
[0m13:43:15.558549 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m13:43:15.567059 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m13:43:15.567417 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m13:43:15.567824 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:43:16.507558 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1 seconds
[0m13:43:16.509796 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m13:43:16.761154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0b31108-2803-4a5c-b335-93221e4939cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd13cd661c0>]}
[0m13:43:16.762104 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:43:16.762488 [info ] [MainThread]: 
[0m13:43:16.769249 [debug] [Thread-1  ]: Began running node model.dbtlearm.src_host
[0m13:43:16.770265 [debug] [Thread-2  ]: Began running node model.dbtlearm.src_listings
[0m13:43:16.769941 [info ] [Thread-1  ]: 1 of 6 START sql view model dev.src_host ....................................... [RUN]
[0m13:43:16.770938 [debug] [Thread-3  ]: Began running node model.dbtlearm.src_reviews
[0m13:43:16.771314 [info ] [Thread-2  ]: 2 of 6 START sql view model dev.src_listings ................................... [RUN]
[0m13:43:16.772208 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearm.src_host'
[0m13:43:16.773293 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearm.src_listings'
[0m13:43:16.772616 [info ] [Thread-3  ]: 3 of 6 START sql view model dev.src_reviews .................................... [RUN]
[0m13:43:16.773800 [debug] [Thread-1  ]: Began compiling node model.dbtlearm.src_host
[0m13:43:16.774498 [debug] [Thread-2  ]: Began compiling node model.dbtlearm.src_listings
[0m13:43:16.775156 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearm.src_reviews'
[0m13:43:16.777036 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearm.src_host"
[0m13:43:16.778641 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearm.src_listings"
[0m13:43:16.778954 [debug] [Thread-3  ]: Began compiling node model.dbtlearm.src_reviews
[0m13:43:16.781879 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearm.src_reviews"
[0m13:43:16.782487 [debug] [Thread-2  ]: Timing info for model.dbtlearm.src_listings (compile): 2023-02-20 13:43:16.777281 => 2023-02-20 13:43:16.782347
[0m13:43:16.782762 [debug] [Thread-1  ]: Timing info for model.dbtlearm.src_host (compile): 2023-02-20 13:43:16.775408 => 2023-02-20 13:43:16.782686
[0m13:43:16.783142 [debug] [Thread-2  ]: Began executing node model.dbtlearm.src_listings
[0m13:43:16.783392 [debug] [Thread-3  ]: Timing info for model.dbtlearm.src_reviews (compile): 2023-02-20 13:43:16.779436 => 2023-02-20 13:43:16.783328
[0m13:43:16.783743 [debug] [Thread-1  ]: Began executing node model.dbtlearm.src_host
[0m13:43:16.848830 [debug] [Thread-3  ]: Began executing node model.dbtlearm.src_reviews
[0m13:43:16.871255 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtlearm.src_listings"
[0m13:43:16.875400 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtlearm.src_host"
[0m13:43:16.879254 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtlearm.src_reviews"
[0m13:43:16.880903 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearm.src_listings"
[0m13:43:16.881596 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearm.src_host"
[0m13:43:16.882270 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearm.src_reviews"
[0m13:43:16.882471 [debug] [Thread-2  ]: On model.dbtlearm.src_listings: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.src_listings"} */
create or replace   view airbnb.dev.src_listings
  
   as (
    -- DBT knows this is a view
-- By default they are views
WITH raw_listings AS(
	SELECT * FROM AIRBNB.RAW.RAW_LISTINGS
)
SELECT
	id as listing_id,
    name as listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at
FROM
	raw_listings
  );
[0m13:43:16.882722 [debug] [Thread-1  ]: On model.dbtlearm.src_host: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.src_host"} */
create or replace   view airbnb.dev.src_host
  
   as (
    WITH raw_hosts AS(
	SELECT * FROM AIRBNB.RAW.RAW_HOSTS
)
SELECT
	id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
	raw_hosts
  );
[0m13:43:16.882965 [debug] [Thread-3  ]: On model.dbtlearm.src_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.src_reviews"} */
create or replace   view airbnb.dev.src_reviews
  
   as (
    WITH raw_reviews AS(
	SELECT * FROM AIRBNB.RAW.RAW_REVIEWS
)
SELECT
	listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
	raw_reviews
  );
[0m13:43:16.883217 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m13:43:16.883459 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:43:16.883694 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:43:18.084417 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1 seconds
[0m13:43:18.110237 [debug] [Thread-3  ]: Timing info for model.dbtlearm.src_reviews (execute): 2023-02-20 13:43:16.875702 => 2023-02-20 13:43:18.110172
[0m13:43:18.110587 [debug] [Thread-3  ]: On model.dbtlearm.src_reviews: Close
[0m13:43:18.175373 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m13:43:18.178979 [debug] [Thread-1  ]: Timing info for model.dbtlearm.src_host (execute): 2023-02-20 13:43:16.871557 => 2023-02-20 13:43:18.178912
[0m13:43:18.179311 [debug] [Thread-1  ]: On model.dbtlearm.src_host: Close
[0m13:43:18.339887 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0b31108-2803-4a5c-b335-93221e4939cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd13cf5e850>]}
[0m13:43:18.340671 [info ] [Thread-3  ]: 3 of 6 OK created sql view model dev.src_reviews ............................... [[32mSUCCESS 1[0m in 1.56s]
[0m13:43:18.343339 [debug] [Thread-3  ]: Finished running node model.dbtlearm.src_reviews
[0m13:43:18.343969 [debug] [Thread-4  ]: Began running node model.dbtlearm.fct_reviews
[0m13:43:18.344370 [info ] [Thread-4  ]: 4 of 6 START sql incremental model dev.fct_reviews ............................. [RUN]
[0m13:43:18.345110 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtlearm.fct_reviews'
[0m13:43:18.345413 [debug] [Thread-4  ]: Began compiling node model.dbtlearm.fct_reviews
[0m13:43:18.356495 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearm.fct_reviews"
[0m13:43:18.358036 [debug] [Thread-4  ]: Timing info for model.dbtlearm.fct_reviews (compile): 2023-02-20 13:43:18.345629 => 2023-02-20 13:43:18.357959
[0m13:43:18.358357 [debug] [Thread-4  ]: Began executing node model.dbtlearm.fct_reviews
[0m13:43:18.380869 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1 seconds
[0m13:43:18.391435 [debug] [Thread-2  ]: Timing info for model.dbtlearm.src_listings (execute): 2023-02-20 13:43:16.783969 => 2023-02-20 13:43:18.391326
[0m13:43:18.410531 [debug] [Thread-2  ]: On model.dbtlearm.src_listings: Close
[0m13:43:18.415890 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m13:43:18.417222 [debug] [Thread-4  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
create or replace  temporary view airbnb.dev.fct_reviews__dbt_tmp
  
   as (
    -- Incremental Materialization

WITH src_reviews AS (
    SELECt * FROM airbnb.dev.src_reviews
)
SELECT *
FROM src_reviews
WHERE review_text IS NOT NULL

  AND review_date > (SELECT MAX(review_date) FROM airbnb.dev.fct_reviews)

  );
[0m13:43:18.418019 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m13:43:18.462512 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0b31108-2803-4a5c-b335-93221e4939cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd13cf5e130>]}
[0m13:43:18.463089 [info ] [Thread-1  ]: 1 of 6 OK created sql view model dev.src_host .................................. [[32mSUCCESS 1[0m in 1.69s]
[0m13:43:18.463537 [debug] [Thread-1  ]: Finished running node model.dbtlearm.src_host
[0m13:43:18.464099 [debug] [Thread-3  ]: Began running node model.dbtlearm.dim_hosts_cleansed
[0m13:43:18.464479 [info ] [Thread-3  ]: 5 of 6 START sql table model dev.dim_hosts_cleansed ............................ [RUN]
[0m13:43:18.465190 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearm.dim_hosts_cleansed'
[0m13:43:18.465491 [debug] [Thread-3  ]: Began compiling node model.dbtlearm.dim_hosts_cleansed
[0m13:43:18.468552 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearm.dim_hosts_cleansed"
[0m13:43:18.469819 [debug] [Thread-3  ]: Timing info for model.dbtlearm.dim_hosts_cleansed (compile): 2023-02-20 13:43:18.465698 => 2023-02-20 13:43:18.469738
[0m13:43:18.470140 [debug] [Thread-3  ]: Began executing node model.dbtlearm.dim_hosts_cleansed
[0m13:43:18.498573 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtlearm.dim_hosts_cleansed"
[0m13:43:18.500077 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearm.dim_hosts_cleansed"
[0m13:43:18.500331 [debug] [Thread-3  ]: On model.dbtlearm.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.dim_hosts_cleansed"} */
create or replace transient table airbnb.dev.dim_hosts_cleansed  as
        (WITH src_hosts AS(
    SELECT * FROM  airbnb.dev.src_host
)
SELECT
    host_id,
    NVL(
        host_name, 
        'Anonymous'
    ) AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
	src_hosts
        );
[0m13:43:18.500562 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m13:43:18.694185 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0b31108-2803-4a5c-b335-93221e4939cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd13cf62940>]}
[0m13:43:18.694655 [info ] [Thread-2  ]: 2 of 6 OK created sql view model dev.src_listings .............................. [[32mSUCCESS 1[0m in 1.92s]
[0m13:43:18.694988 [debug] [Thread-2  ]: Finished running node model.dbtlearm.src_listings
[0m13:43:18.695400 [debug] [Thread-1  ]: Began running node model.dbtlearm.dim_listings_cleansed
[0m13:43:18.695669 [info ] [Thread-1  ]: 6 of 6 START sql table model dev.dim_listings_cleansed ......................... [RUN]
[0m13:43:18.696209 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearm.dim_listings_cleansed'
[0m13:43:18.696433 [debug] [Thread-1  ]: Began compiling node model.dbtlearm.dim_listings_cleansed
[0m13:43:18.698899 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearm.dim_listings_cleansed"
[0m13:43:18.699677 [debug] [Thread-1  ]: Timing info for model.dbtlearm.dim_listings_cleansed (compile): 2023-02-20 13:43:18.696590 => 2023-02-20 13:43:18.699613
[0m13:43:18.699949 [debug] [Thread-1  ]: Began executing node model.dbtlearm.dim_listings_cleansed
[0m13:43:18.703976 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtlearm.dim_listings_cleansed"
[0m13:43:18.705690 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearm.dim_listings_cleansed"
[0m13:43:18.706002 [debug] [Thread-1  ]: On model.dbtlearm.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.dim_listings_cleansed"} */
create or replace transient table airbnb.dev.dim_listings_cleansed  as
        (WITH src_listings AS (
    SELECT * FROM airbnb.dev.src_listings
)
SELECT 
    listing_id,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights = 0 THEN 1
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE(
        price_str,
        '$'
    ) :: NUMBER (
        10,
        2
    ) AS price,
    created_at,
    updated_at
FROM
    src_listings
        );
[0m13:43:18.706236 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:43:19.473086 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1 seconds
[0m13:43:19.482458 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m13:43:19.482729 [debug] [Thread-4  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
describe table airbnb.dev.fct_reviews__dbt_tmp
[0m13:43:19.630013 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0 seconds
[0m13:43:19.633496 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m13:43:19.633716 [debug] [Thread-4  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
describe table airbnb.dev.fct_reviews
[0m13:43:19.780726 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0 seconds
[0m13:43:19.794614 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m13:43:19.794894 [debug] [Thread-4  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
describe table airbnb.dev.fct_reviews__dbt_tmp
[0m13:43:19.930581 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0 seconds
[0m13:43:19.934745 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m13:43:19.935060 [debug] [Thread-4  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m13:43:20.069277 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0 seconds
[0m13:43:20.081815 [debug] [Thread-4  ]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m13:43:20.104171 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtlearm.fct_reviews"
[0m13:43:20.105721 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m13:43:20.106031 [debug] [Thread-4  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m13:43:20.168835 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2 seconds
[0m13:43:20.176917 [debug] [Thread-3  ]: Timing info for model.dbtlearm.dim_hosts_cleansed (execute): 2023-02-20 13:43:18.470349 => 2023-02-20 13:43:20.176858
[0m13:43:20.177246 [debug] [Thread-3  ]: On model.dbtlearm.dim_hosts_cleansed: Close
[0m13:43:20.262401 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m13:43:20.262887 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m13:43:20.263185 [debug] [Thread-4  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
insert into airbnb.dev.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from airbnb.dev.fct_reviews__dbt_tmp
        );
[0m13:43:20.344951 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2 seconds
[0m13:43:20.348288 [debug] [Thread-1  ]: Timing info for model.dbtlearm.dim_listings_cleansed (execute): 2023-02-20 13:43:18.700128 => 2023-02-20 13:43:20.348229
[0m13:43:20.348591 [debug] [Thread-1  ]: On model.dbtlearm.dim_listings_cleansed: Close
[0m13:43:20.483989 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0b31108-2803-4a5c-b335-93221e4939cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd13cf7b9a0>]}
[0m13:43:20.484514 [info ] [Thread-3  ]: 5 of 6 OK created sql table model dev.dim_hosts_cleansed ....................... [[32mSUCCESS 1[0m in 2.02s]
[0m13:43:20.484911 [debug] [Thread-3  ]: Finished running node model.dbtlearm.dim_hosts_cleansed
[0m13:43:20.600033 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0b31108-2803-4a5c-b335-93221e4939cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd13d5870a0>]}
[0m13:43:20.600508 [info ] [Thread-1  ]: 6 of 6 OK created sql table model dev.dim_listings_cleansed .................... [[32mSUCCESS 1[0m in 1.90s]
[0m13:43:20.600869 [debug] [Thread-1  ]: Finished running node model.dbtlearm.dim_listings_cleansed
[0m13:43:20.821758 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1 seconds
[0m13:43:20.822356 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m13:43:20.822677 [debug] [Thread-4  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
COMMIT
[0m13:43:21.118739 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m13:43:21.128500 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m13:43:21.128834 [debug] [Thread-4  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
drop view if exists airbnb.dev.fct_reviews__dbt_tmp cascade
[0m13:43:21.281487 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m13:43:21.285299 [debug] [Thread-4  ]: Timing info for model.dbtlearm.fct_reviews (execute): 2023-02-20 13:43:18.358563 => 2023-02-20 13:43:21.285236
[0m13:43:21.285621 [debug] [Thread-4  ]: On model.dbtlearm.fct_reviews: Close
[0m13:43:21.535697 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0b31108-2803-4a5c-b335-93221e4939cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd13d062d60>]}
[0m13:43:21.553435 [info ] [Thread-4  ]: 4 of 6 OK created sql incremental model dev.fct_reviews ........................ [[32mSUCCESS 1[0m in 3.19s]
[0m13:43:21.554600 [debug] [Thread-4  ]: Finished running node model.dbtlearm.fct_reviews
[0m13:43:21.557352 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:43:21.558149 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:43:21.558461 [debug] [MainThread]: Connection 'model.dbtlearm.dim_listings_cleansed' was properly closed.
[0m13:43:21.558730 [debug] [MainThread]: Connection 'model.dbtlearm.src_listings' was properly closed.
[0m13:43:21.558990 [debug] [MainThread]: Connection 'model.dbtlearm.dim_hosts_cleansed' was properly closed.
[0m13:43:21.559247 [debug] [MainThread]: Connection 'model.dbtlearm.fct_reviews' was properly closed.
[0m13:43:21.559588 [info ] [MainThread]: 
[0m13:43:21.559931 [info ] [MainThread]: Finished running 3 view models, 2 table models, 1 incremental model in 0 hours 0 minutes and 7.76 seconds (7.76s).
[0m13:43:21.560579 [debug] [MainThread]: Command end result
[0m13:43:21.568418 [info ] [MainThread]: 
[0m13:43:21.568837 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:43:21.569171 [info ] [MainThread]: 
[0m13:43:21.569494 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m13:43:21.569889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd13cc33eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd13cf64f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd13be75790>]}
[0m13:43:21.570222 [debug] [MainThread]: Flushing usage events


============================== 2023-02-22 13:34:51.296700 | 5dd27a0f-a761-470f-8158-992f7e7b0baa ==============================
[0m13:34:51.296700 [info ] [MainThread]: Running with dbt=1.4.1
[0m13:34:51.300753 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/mramirez/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:34:51.301103 [debug] [MainThread]: Tracking: tracking
[0m13:34:51.301772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd9bb36fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd9bb365b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd9bb364c0>]}
[0m13:34:51.586175 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m13:34:51.586668 [debug] [MainThread]: Partial parsing: added file: dbtlearm://models/dim/dim_listings_with_hosts.sql
[0m13:34:51.606589 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_with_hosts.sql
[0m13:34:51.638429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5dd27a0f-a761-470f-8158-992f7e7b0baa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd9bb90550>]}
[0m13:34:51.659161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5dd27a0f-a761-470f-8158-992f7e7b0baa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd9bde3d90>]}
[0m13:34:51.659694 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 304 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m13:34:51.660134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5dd27a0f-a761-470f-8158-992f7e7b0baa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd9bde3e80>]}
[0m13:34:51.661825 [info ] [MainThread]: 
[0m13:34:51.663665 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:34:51.665180 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb'
[0m13:34:51.682688 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m13:34:51.683087 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m13:34:51.683383 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:34:54.167852 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2 seconds
[0m13:34:54.170211 [debug] [ThreadPool]: On list_airbnb: Close
[0m13:34:54.462481 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m13:34:54.482617 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m13:34:54.482975 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m13:34:54.483243 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:34:55.422701 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1 seconds
[0m13:34:55.424865 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m13:34:55.791053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5dd27a0f-a761-470f-8158-992f7e7b0baa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd9bb90f40>]}
[0m13:34:55.791927 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:34:55.792284 [info ] [MainThread]: 
[0m13:34:55.814409 [debug] [Thread-1  ]: Began running node model.dbtlearm.src_host
[0m13:34:55.814968 [debug] [Thread-2  ]: Began running node model.dbtlearm.src_listings
[0m13:34:55.815414 [debug] [Thread-3  ]: Began running node model.dbtlearm.src_reviews
[0m13:34:55.816127 [info ] [Thread-1  ]: 1 of 7 START sql view model dev.src_host ....................................... [RUN]
[0m13:34:55.816706 [info ] [Thread-2  ]: 2 of 7 START sql view model dev.src_listings ................................... [RUN]
[0m13:34:55.817201 [info ] [Thread-3  ]: 3 of 7 START sql view model dev.src_reviews .................................... [RUN]
[0m13:34:55.818067 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearm.src_host'
[0m13:34:55.818698 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearm.src_listings'
[0m13:34:55.819334 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearm.src_reviews'
[0m13:34:55.819663 [debug] [Thread-1  ]: Began compiling node model.dbtlearm.src_host
[0m13:34:55.819975 [debug] [Thread-2  ]: Began compiling node model.dbtlearm.src_listings
[0m13:34:55.820278 [debug] [Thread-3  ]: Began compiling node model.dbtlearm.src_reviews
[0m13:34:55.822090 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearm.src_host"
[0m13:34:55.823704 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearm.src_listings"
[0m13:34:55.825344 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearm.src_reviews"
[0m13:34:55.828252 [debug] [Thread-3  ]: Timing info for model.dbtlearm.src_reviews (compile): 2023-02-22 13:34:55.823953 => 2023-02-22 13:34:55.828128
[0m13:34:55.828549 [debug] [Thread-1  ]: Timing info for model.dbtlearm.src_host (compile): 2023-02-22 13:34:55.820508 => 2023-02-22 13:34:55.828476
[0m13:34:55.828950 [debug] [Thread-3  ]: Began executing node model.dbtlearm.src_reviews
[0m13:34:55.829205 [debug] [Thread-2  ]: Timing info for model.dbtlearm.src_listings (compile): 2023-02-22 13:34:55.822337 => 2023-02-22 13:34:55.829146
[0m13:34:55.829514 [debug] [Thread-1  ]: Began executing node model.dbtlearm.src_host
[0m13:34:55.853685 [debug] [Thread-2  ]: Began executing node model.dbtlearm.src_listings
[0m13:34:55.867812 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtlearm.src_reviews"
[0m13:34:55.871763 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtlearm.src_host"
[0m13:34:55.875316 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtlearm.src_listings"
[0m13:34:55.879665 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearm.src_host"
[0m13:34:55.880443 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearm.src_reviews"
[0m13:34:55.880781 [debug] [Thread-1  ]: On model.dbtlearm.src_host: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.src_host"} */
create or replace   view airbnb.dev.src_host
  
   as (
    WITH raw_hosts AS(
	SELECT * FROM AIRBNB.RAW.RAW_HOSTS
)
SELECT
	id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
	raw_hosts
  );
[0m13:34:55.881730 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearm.src_listings"
[0m13:34:55.881966 [debug] [Thread-3  ]: On model.dbtlearm.src_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.src_reviews"} */
create or replace   view airbnb.dev.src_reviews
  
   as (
    WITH raw_reviews AS(
	SELECT * FROM AIRBNB.RAW.RAW_REVIEWS
)
SELECT
	listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
	raw_reviews
  );
[0m13:34:55.882250 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:34:55.882526 [debug] [Thread-2  ]: On model.dbtlearm.src_listings: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.src_listings"} */
create or replace   view airbnb.dev.src_listings
  
   as (
    -- DBT knows this is a view
-- By default they are views
WITH raw_listings AS(
	SELECT * FROM AIRBNB.RAW.RAW_LISTINGS
)
SELECT
	id as listing_id,
    name as listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at
FROM
	raw_listings
  );
[0m13:34:55.882770 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:34:55.884319 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m13:34:57.208337 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1 seconds
[0m13:34:57.233128 [debug] [Thread-3  ]: Timing info for model.dbtlearm.src_reviews (execute): 2023-02-22 13:34:55.829738 => 2023-02-22 13:34:57.233060
[0m13:34:57.233480 [debug] [Thread-3  ]: On model.dbtlearm.src_reviews: Close
[0m13:34:57.301415 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m13:34:57.304425 [debug] [Thread-1  ]: Timing info for model.dbtlearm.src_host (execute): 2023-02-22 13:34:55.868164 => 2023-02-22 13:34:57.304366
[0m13:34:57.304715 [debug] [Thread-1  ]: On model.dbtlearm.src_host: Close
[0m13:34:57.439842 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2 seconds
[0m13:34:57.444240 [debug] [Thread-2  ]: Timing info for model.dbtlearm.src_listings (execute): 2023-02-22 13:34:55.872019 => 2023-02-22 13:34:57.444181
[0m13:34:57.444587 [debug] [Thread-2  ]: On model.dbtlearm.src_listings: Close
[0m13:34:57.468603 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5dd27a0f-a761-470f-8158-992f7e7b0baa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd9c51caf0>]}
[0m13:34:57.470191 [info ] [Thread-3  ]: 3 of 7 OK created sql view model dev.src_reviews ............................... [[32mSUCCESS 1[0m in 1.65s]
[0m13:34:57.472201 [debug] [Thread-3  ]: Finished running node model.dbtlearm.src_reviews
[0m13:34:57.473072 [debug] [Thread-4  ]: Began running node model.dbtlearm.fct_reviews
[0m13:34:57.473534 [info ] [Thread-4  ]: 4 of 7 START sql incremental model dev.fct_reviews ............................. [RUN]
[0m13:34:57.474345 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtlearm.fct_reviews'
[0m13:34:57.474645 [debug] [Thread-4  ]: Began compiling node model.dbtlearm.fct_reviews
[0m13:34:57.486016 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearm.fct_reviews"
[0m13:34:57.489908 [debug] [Thread-4  ]: Timing info for model.dbtlearm.fct_reviews (compile): 2023-02-22 13:34:57.474856 => 2023-02-22 13:34:57.489812
[0m13:34:57.490270 [debug] [Thread-4  ]: Began executing node model.dbtlearm.fct_reviews
[0m13:34:57.535585 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m13:34:57.535907 [debug] [Thread-4  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
create or replace  temporary view airbnb.dev.fct_reviews__dbt_tmp
  
   as (
    -- Incremental Materialization

WITH src_reviews AS (
    SELECt * FROM airbnb.dev.src_reviews
)
SELECT *
FROM src_reviews
WHERE review_text IS NOT NULL

  AND review_date > (SELECT MAX(review_date) FROM airbnb.dev.fct_reviews)

  );
[0m13:34:57.536138 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m13:34:57.543550 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5dd27a0f-a761-470f-8158-992f7e7b0baa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd9c341340>]}
[0m13:34:57.544097 [info ] [Thread-1  ]: 1 of 7 OK created sql view model dev.src_host .................................. [[32mSUCCESS 1[0m in 1.73s]
[0m13:34:57.544530 [debug] [Thread-1  ]: Finished running node model.dbtlearm.src_host
[0m13:34:57.545131 [debug] [Thread-3  ]: Began running node model.dbtlearm.dim_hosts_cleansed
[0m13:34:57.545492 [info ] [Thread-3  ]: 5 of 7 START sql table model dev.dim_hosts_cleansed ............................ [RUN]
[0m13:34:57.546247 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearm.dim_hosts_cleansed'
[0m13:34:57.546546 [debug] [Thread-3  ]: Began compiling node model.dbtlearm.dim_hosts_cleansed
[0m13:34:57.549971 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearm.dim_hosts_cleansed"
[0m13:34:57.558417 [debug] [Thread-3  ]: Timing info for model.dbtlearm.dim_hosts_cleansed (compile): 2023-02-22 13:34:57.546809 => 2023-02-22 13:34:57.558320
[0m13:34:57.559001 [debug] [Thread-3  ]: Began executing node model.dbtlearm.dim_hosts_cleansed
[0m13:34:57.587187 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtlearm.dim_hosts_cleansed"
[0m13:34:57.591128 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearm.dim_hosts_cleansed"
[0m13:34:57.591393 [debug] [Thread-3  ]: On model.dbtlearm.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.dim_hosts_cleansed"} */
create or replace transient table airbnb.dev.dim_hosts_cleansed  as
        (WITH src_hosts AS(
    SELECT * FROM  airbnb.dev.src_host
)
SELECT
    host_id,
    NVL(
        host_name, 
        'Anonymous'
    ) AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
	src_hosts
        );
[0m13:34:57.591625 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m13:34:57.688614 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5dd27a0f-a761-470f-8158-992f7e7b0baa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd9c2db0d0>]}
[0m13:34:57.689163 [info ] [Thread-2  ]: 2 of 7 OK created sql view model dev.src_listings .............................. [[32mSUCCESS 1[0m in 1.87s]
[0m13:34:57.689574 [debug] [Thread-2  ]: Finished running node model.dbtlearm.src_listings
[0m13:34:57.690097 [debug] [Thread-1  ]: Began running node model.dbtlearm.dim_listings_cleansed
[0m13:34:57.690462 [info ] [Thread-1  ]: 6 of 7 START sql table model dev.dim_listings_cleansed ......................... [RUN]
[0m13:34:57.691097 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearm.dim_listings_cleansed'
[0m13:34:57.691370 [debug] [Thread-1  ]: Began compiling node model.dbtlearm.dim_listings_cleansed
[0m13:34:57.694213 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearm.dim_listings_cleansed"
[0m13:34:57.698442 [debug] [Thread-1  ]: Timing info for model.dbtlearm.dim_listings_cleansed (compile): 2023-02-22 13:34:57.691564 => 2023-02-22 13:34:57.698339
[0m13:34:57.698831 [debug] [Thread-1  ]: Began executing node model.dbtlearm.dim_listings_cleansed
[0m13:34:57.701953 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtlearm.dim_listings_cleansed"
[0m13:34:57.705908 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearm.dim_listings_cleansed"
[0m13:34:57.706181 [debug] [Thread-1  ]: On model.dbtlearm.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.dim_listings_cleansed"} */
create or replace transient table airbnb.dev.dim_listings_cleansed  as
        (WITH src_listings AS (
    SELECT * FROM airbnb.dev.src_listings
)
SELECT 
    listing_id,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights = 0 THEN 1
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE(
        price_str,
        '$'
    ) :: NUMBER (
        10,
        2
    ) AS price,
    created_at,
    updated_at
FROM
    src_listings
        );
[0m13:34:57.706404 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:34:58.983436 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1 seconds
[0m13:34:58.995904 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m13:34:58.996246 [debug] [Thread-4  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
describe table airbnb.dev.fct_reviews__dbt_tmp
[0m13:34:59.150355 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0 seconds
[0m13:34:59.155209 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m13:34:59.155498 [debug] [Thread-4  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
describe table airbnb.dev.fct_reviews
[0m13:34:59.399023 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0 seconds
[0m13:34:59.418234 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m13:34:59.418573 [debug] [Thread-4  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
describe table airbnb.dev.fct_reviews__dbt_tmp
[0m13:34:59.565417 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0 seconds
[0m13:34:59.570697 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m13:34:59.571029 [debug] [Thread-4  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m13:34:59.705963 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0 seconds
[0m13:34:59.719753 [debug] [Thread-4  ]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m13:34:59.740157 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtlearm.fct_reviews"
[0m13:34:59.744678 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m13:34:59.745004 [debug] [Thread-4  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m13:34:59.923179 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m13:34:59.923768 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m13:34:59.924133 [debug] [Thread-4  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
insert into airbnb.dev.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from airbnb.dev.fct_reviews__dbt_tmp
        );
[0m13:35:00.277798 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 3 seconds
[0m13:35:00.286991 [debug] [Thread-3  ]: Timing info for model.dbtlearm.dim_hosts_cleansed (execute): 2023-02-22 13:34:57.559572 => 2023-02-22 13:35:00.286923
[0m13:35:00.287358 [debug] [Thread-3  ]: On model.dbtlearm.dim_hosts_cleansed: Close
[0m13:35:00.317284 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3 seconds
[0m13:35:00.320558 [debug] [Thread-1  ]: Timing info for model.dbtlearm.dim_listings_cleansed (execute): 2023-02-22 13:34:57.699032 => 2023-02-22 13:35:00.320499
[0m13:35:00.320862 [debug] [Thread-1  ]: On model.dbtlearm.dim_listings_cleansed: Close
[0m13:35:00.552282 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5dd27a0f-a761-470f-8158-992f7e7b0baa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd9c341460>]}
[0m13:35:00.553154 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5dd27a0f-a761-470f-8158-992f7e7b0baa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd9c354550>]}
[0m13:35:00.553814 [info ] [Thread-3  ]: 5 of 7 OK created sql table model dev.dim_hosts_cleansed ....................... [[32mSUCCESS 1[0m in 3.01s]
[0m13:35:00.554445 [info ] [Thread-1  ]: 6 of 7 OK created sql table model dev.dim_listings_cleansed .................... [[32mSUCCESS 1[0m in 2.86s]
[0m13:35:00.554957 [debug] [Thread-3  ]: Finished running node model.dbtlearm.dim_hosts_cleansed
[0m13:35:00.555322 [debug] [Thread-1  ]: Finished running node model.dbtlearm.dim_listings_cleansed
[0m13:35:00.556147 [debug] [Thread-2  ]: Began running node model.dbtlearm.dim_listings_with_hosts
[0m13:35:00.556541 [info ] [Thread-2  ]: 7 of 7 START sql table model dev.dim_listings_with_hosts ....................... [RUN]
[0m13:35:00.557283 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearm.dim_listings_with_hosts'
[0m13:35:00.557590 [debug] [Thread-2  ]: Began compiling node model.dbtlearm.dim_listings_with_hosts
[0m13:35:00.562178 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearm.dim_listings_with_hosts"
[0m13:35:00.563061 [debug] [Thread-2  ]: Timing info for model.dbtlearm.dim_listings_with_hosts (compile): 2023-02-22 13:35:00.557808 => 2023-02-22 13:35:00.562988
[0m13:35:00.563431 [debug] [Thread-2  ]: Began executing node model.dbtlearm.dim_listings_with_hosts
[0m13:35:00.566771 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtlearm.dim_listings_with_hosts"
[0m13:35:00.568453 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearm.dim_listings_with_hosts"
[0m13:35:00.568717 [debug] [Thread-2  ]: On model.dbtlearm.dim_listings_with_hosts: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.dim_listings_with_hosts"} */
create or replace transient table airbnb.dev.dim_listings_with_hosts  as
        (WITH
l AS (
    SELECT *
    FROM airbnb.dev.dim_listings_cleansed
),
h AS (
    SELECT *
    FROM airbnb.dev.dim_hosts_cleansed
)
SELECT
    l.listing_id,
    l.listing_name,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhots AS host_is_superhost,
    l.created_at,
    GREATEST(l.updated_at, h.updated_at) AS updated_at
FROM l
LEFT JOIN h 
ON h.host_id = l.host_id
        );
[0m13:35:00.568959 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m13:35:00.880338 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 1 seconds
[0m13:35:00.880972 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m13:35:00.881353 [debug] [Thread-4  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
COMMIT
[0m13:35:01.102030 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m13:35:01.110573 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m13:35:01.110916 [debug] [Thread-4  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
drop view if exists airbnb.dev.fct_reviews__dbt_tmp cascade
[0m13:35:01.285642 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m13:35:01.288992 [debug] [Thread-4  ]: Timing info for model.dbtlearm.fct_reviews (execute): 2023-02-22 13:34:57.490481 => 2023-02-22 13:35:01.288934
[0m13:35:01.289283 [debug] [Thread-4  ]: On model.dbtlearm.fct_reviews: Close
[0m13:35:01.490402 [debug] [Thread-2  ]: Snowflake adapter: Snowflake query id: 01aa806f-0000-fba3-0000-000387eac00d
[0m13:35:01.490751 [debug] [Thread-2  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 18 at position 4
invalid identifier 'H.IS_SUPERHOTS'
[0m13:35:01.491136 [debug] [Thread-2  ]: Timing info for model.dbtlearm.dim_listings_with_hosts (execute): 2023-02-22 13:35:00.563658 => 2023-02-22 13:35:01.491069
[0m13:35:01.491405 [debug] [Thread-2  ]: On model.dbtlearm.dim_listings_with_hosts: Close
[0m13:35:01.552307 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5dd27a0f-a761-470f-8158-992f7e7b0baa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd9c5712e0>]}
[0m13:35:01.552977 [info ] [Thread-4  ]: 4 of 7 OK created sql incremental model dev.fct_reviews ........................ [[32mSUCCESS 0[0m in 4.08s]
[0m13:35:01.553436 [debug] [Thread-4  ]: Finished running node model.dbtlearm.fct_reviews
[0m13:35:01.728508 [debug] [Thread-2  ]: Database Error in model dim_listings_with_hosts (models/dim/dim_listings_with_hosts.sql)
  000904 (42000): SQL compilation error: error line 18 at position 4
  invalid identifier 'H.IS_SUPERHOTS'
  compiled Code at target/run/dbtlearm/models/dim/dim_listings_with_hosts.sql
[0m13:35:01.729033 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5dd27a0f-a761-470f-8158-992f7e7b0baa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd9c354340>]}
[0m13:35:01.729541 [error] [Thread-2  ]: 7 of 7 ERROR creating sql table model dev.dim_listings_with_hosts .............. [[31mERROR[0m in 1.17s]
[0m13:35:01.730085 [debug] [Thread-2  ]: Finished running node model.dbtlearm.dim_listings_with_hosts
[0m13:35:01.732011 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:35:01.732777 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:35:01.733085 [debug] [MainThread]: Connection 'model.dbtlearm.dim_listings_cleansed' was properly closed.
[0m13:35:01.733322 [debug] [MainThread]: Connection 'model.dbtlearm.dim_listings_with_hosts' was properly closed.
[0m13:35:01.733550 [debug] [MainThread]: Connection 'model.dbtlearm.dim_hosts_cleansed' was properly closed.
[0m13:35:01.733770 [debug] [MainThread]: Connection 'model.dbtlearm.fct_reviews' was properly closed.
[0m13:35:01.734075 [info ] [MainThread]: 
[0m13:35:01.734430 [info ] [MainThread]: Finished running 3 view models, 3 table models, 1 incremental model in 0 hours 0 minutes and 10.07 seconds (10.07s).
[0m13:35:01.735124 [debug] [MainThread]: Command end result
[0m13:35:01.751096 [info ] [MainThread]: 
[0m13:35:01.751565 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:35:01.751890 [info ] [MainThread]: 
[0m13:35:01.752361 [error] [MainThread]: [33mDatabase Error in model dim_listings_with_hosts (models/dim/dim_listings_with_hosts.sql)[0m
[0m13:35:01.752695 [error] [MainThread]:   000904 (42000): SQL compilation error: error line 18 at position 4
[0m13:35:01.752998 [error] [MainThread]:   invalid identifier 'H.IS_SUPERHOTS'
[0m13:35:01.753296 [error] [MainThread]:   compiled Code at target/run/dbtlearm/models/dim/dim_listings_with_hosts.sql
[0m13:35:01.753608 [info ] [MainThread]: 
[0m13:35:01.753931 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m13:35:01.754342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd9c5139a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd9c525820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd9c3089d0>]}
[0m13:35:01.754681 [debug] [MainThread]: Flushing usage events


============================== 2023-02-22 13:35:23.590294 | 50c86cd6-1111-4003-9919-75b812ce5be2 ==============================
[0m13:35:23.590294 [info ] [MainThread]: Running with dbt=1.4.1
[0m13:35:23.593468 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/mramirez/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:35:23.593816 [debug] [MainThread]: Tracking: tracking
[0m13:35:23.594353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8225b2f490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8225b2f340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8225b2fca0>]}
[0m13:35:23.676540 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:35:23.677101 [debug] [MainThread]: Partial parsing: updated file: dbtlearm://models/dim/dim_listings_with_hosts.sql
[0m13:35:23.693129 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_with_hosts.sql
[0m13:35:23.718008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '50c86cd6-1111-4003-9919-75b812ce5be2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8225b8c280>]}
[0m13:35:23.725763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '50c86cd6-1111-4003-9919-75b812ce5be2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8225b42f10>]}
[0m13:35:23.726237 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 304 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m13:35:23.726602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50c86cd6-1111-4003-9919-75b812ce5be2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8225b551c0>]}
[0m13:35:23.728152 [info ] [MainThread]: 
[0m13:35:23.729885 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:35:23.731353 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb'
[0m13:35:23.747951 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m13:35:23.748395 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m13:35:23.748750 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:35:25.255992 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2 seconds
[0m13:35:25.258001 [debug] [ThreadPool]: On list_airbnb: Close
[0m13:35:25.531002 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m13:35:25.587838 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m13:35:25.588271 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m13:35:25.588601 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:35:26.786552 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1 seconds
[0m13:35:26.788736 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m13:35:27.047241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50c86cd6-1111-4003-9919-75b812ce5be2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8225047490>]}
[0m13:35:27.048300 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:35:27.048750 [info ] [MainThread]: 
[0m13:35:27.055454 [debug] [Thread-1  ]: Began running node model.dbtlearm.src_host
[0m13:35:27.055816 [debug] [Thread-2  ]: Began running node model.dbtlearm.src_listings
[0m13:35:27.056144 [debug] [Thread-3  ]: Began running node model.dbtlearm.src_reviews
[0m13:35:27.056599 [info ] [Thread-1  ]: 1 of 7 START sql view model dev.src_host ....................................... [RUN]
[0m13:35:27.057099 [info ] [Thread-2  ]: 2 of 7 START sql view model dev.src_listings ................................... [RUN]
[0m13:35:27.057590 [info ] [Thread-3  ]: 3 of 7 START sql view model dev.src_reviews .................................... [RUN]
[0m13:35:27.058374 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearm.src_host'
[0m13:35:27.059033 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearm.src_listings'
[0m13:35:27.059679 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearm.src_reviews'
[0m13:35:27.060014 [debug] [Thread-1  ]: Began compiling node model.dbtlearm.src_host
[0m13:35:27.060335 [debug] [Thread-2  ]: Began compiling node model.dbtlearm.src_listings
[0m13:35:27.060641 [debug] [Thread-3  ]: Began compiling node model.dbtlearm.src_reviews
[0m13:35:27.062475 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearm.src_host"
[0m13:35:27.064237 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearm.src_listings"
[0m13:35:27.066008 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearm.src_reviews"
[0m13:35:27.067135 [debug] [Thread-1  ]: Timing info for model.dbtlearm.src_host (compile): 2023-02-22 13:35:27.060880 => 2023-02-22 13:35:27.067045
[0m13:35:27.067404 [debug] [Thread-2  ]: Timing info for model.dbtlearm.src_listings (compile): 2023-02-22 13:35:27.062718 => 2023-02-22 13:35:27.067335
[0m13:35:27.067687 [debug] [Thread-3  ]: Timing info for model.dbtlearm.src_reviews (compile): 2023-02-22 13:35:27.064518 => 2023-02-22 13:35:27.067624
[0m13:35:27.067967 [debug] [Thread-1  ]: Began executing node model.dbtlearm.src_host
[0m13:35:27.068302 [debug] [Thread-2  ]: Began executing node model.dbtlearm.src_listings
[0m13:35:27.068621 [debug] [Thread-3  ]: Began executing node model.dbtlearm.src_reviews
[0m13:35:27.116419 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtlearm.src_host"
[0m13:35:27.121071 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtlearm.src_listings"
[0m13:35:27.125894 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtlearm.src_reviews"
[0m13:35:27.169148 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearm.src_host"
[0m13:35:27.170079 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearm.src_reviews"
[0m13:35:27.170973 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearm.src_listings"
[0m13:35:27.187538 [debug] [Thread-1  ]: On model.dbtlearm.src_host: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.src_host"} */
create or replace   view airbnb.dev.src_host
  
   as (
    WITH raw_hosts AS(
	SELECT * FROM AIRBNB.RAW.RAW_HOSTS
)
SELECT
	id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
	raw_hosts
  );
[0m13:35:27.188166 [debug] [Thread-3  ]: On model.dbtlearm.src_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.src_reviews"} */
create or replace   view airbnb.dev.src_reviews
  
   as (
    WITH raw_reviews AS(
	SELECT * FROM AIRBNB.RAW.RAW_REVIEWS
)
SELECT
	listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
	raw_reviews
  );
[0m13:35:27.188556 [debug] [Thread-2  ]: On model.dbtlearm.src_listings: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.src_listings"} */
create or replace   view airbnb.dev.src_listings
  
   as (
    -- DBT knows this is a view
-- By default they are views
WITH raw_listings AS(
	SELECT * FROM AIRBNB.RAW.RAW_LISTINGS
)
SELECT
	id as listing_id,
    name as listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at
FROM
	raw_listings
  );
[0m13:35:27.188876 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:35:27.189178 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:35:27.189473 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m13:35:28.440187 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1 seconds
[0m13:35:28.465809 [debug] [Thread-3  ]: Timing info for model.dbtlearm.src_reviews (execute): 2023-02-22 13:35:27.122338 => 2023-02-22 13:35:28.465740
[0m13:35:28.466163 [debug] [Thread-3  ]: On model.dbtlearm.src_reviews: Close
[0m13:35:28.652422 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m13:35:28.655705 [debug] [Thread-1  ]: Timing info for model.dbtlearm.src_host (execute): 2023-02-22 13:35:27.068849 => 2023-02-22 13:35:28.655645
[0m13:35:28.656013 [debug] [Thread-1  ]: On model.dbtlearm.src_host: Close
[0m13:35:28.717499 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50c86cd6-1111-4003-9919-75b812ce5be2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8224e92ac0>]}
[0m13:35:28.718195 [info ] [Thread-3  ]: 3 of 7 OK created sql view model dev.src_reviews ............................... [[32mSUCCESS 1[0m in 1.66s]
[0m13:35:28.720697 [debug] [Thread-3  ]: Finished running node model.dbtlearm.src_reviews
[0m13:35:28.721518 [debug] [Thread-4  ]: Began running node model.dbtlearm.fct_reviews
[0m13:35:28.721983 [info ] [Thread-4  ]: 4 of 7 START sql incremental model dev.fct_reviews ............................. [RUN]
[0m13:35:28.722785 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtlearm.fct_reviews'
[0m13:35:28.723097 [debug] [Thread-4  ]: Began compiling node model.dbtlearm.fct_reviews
[0m13:35:28.735216 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearm.fct_reviews"
[0m13:35:28.736218 [debug] [Thread-4  ]: Timing info for model.dbtlearm.fct_reviews (compile): 2023-02-22 13:35:28.723324 => 2023-02-22 13:35:28.736142
[0m13:35:28.736546 [debug] [Thread-4  ]: Began executing node model.dbtlearm.fct_reviews
[0m13:35:28.783605 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m13:35:28.784657 [debug] [Thread-4  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
create or replace  temporary view airbnb.dev.fct_reviews__dbt_tmp
  
   as (
    -- Incremental Materialization

WITH src_reviews AS (
    SELECt * FROM airbnb.dev.src_reviews
)
SELECT *
FROM src_reviews
WHERE review_text IS NOT NULL

  AND review_date > (SELECT MAX(review_date) FROM airbnb.dev.fct_reviews)

  );
[0m13:35:28.784978 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m13:35:28.785763 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2 seconds
[0m13:35:28.789325 [debug] [Thread-2  ]: Timing info for model.dbtlearm.src_listings (execute): 2023-02-22 13:35:27.092129 => 2023-02-22 13:35:28.789271
[0m13:35:28.790122 [debug] [Thread-2  ]: On model.dbtlearm.src_listings: Close
[0m13:35:28.971308 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50c86cd6-1111-4003-9919-75b812ce5be2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8225ce2e20>]}
[0m13:35:28.971896 [info ] [Thread-1  ]: 1 of 7 OK created sql view model dev.src_host .................................. [[32mSUCCESS 1[0m in 1.91s]
[0m13:35:28.972337 [debug] [Thread-1  ]: Finished running node model.dbtlearm.src_host
[0m13:35:28.972869 [debug] [Thread-3  ]: Began running node model.dbtlearm.dim_hosts_cleansed
[0m13:35:28.973271 [info ] [Thread-3  ]: 5 of 7 START sql table model dev.dim_hosts_cleansed ............................ [RUN]
[0m13:35:28.973972 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearm.dim_hosts_cleansed'
[0m13:35:28.974277 [debug] [Thread-3  ]: Began compiling node model.dbtlearm.dim_hosts_cleansed
[0m13:35:28.977258 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearm.dim_hosts_cleansed"
[0m13:35:28.978146 [debug] [Thread-3  ]: Timing info for model.dbtlearm.dim_hosts_cleansed (compile): 2023-02-22 13:35:28.974488 => 2023-02-22 13:35:28.978078
[0m13:35:28.978464 [debug] [Thread-3  ]: Began executing node model.dbtlearm.dim_hosts_cleansed
[0m13:35:29.006592 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtlearm.dim_hosts_cleansed"
[0m13:35:29.008051 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearm.dim_hosts_cleansed"
[0m13:35:29.008306 [debug] [Thread-3  ]: On model.dbtlearm.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.dim_hosts_cleansed"} */
create or replace transient table airbnb.dev.dim_hosts_cleansed  as
        (WITH src_hosts AS(
    SELECT * FROM  airbnb.dev.src_host
)
SELECT
    host_id,
    NVL(
        host_name, 
        'Anonymous'
    ) AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
	src_hosts
        );
[0m13:35:29.008543 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m13:35:29.042481 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50c86cd6-1111-4003-9919-75b812ce5be2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8224e927c0>]}
[0m13:35:29.043186 [info ] [Thread-2  ]: 2 of 7 OK created sql view model dev.src_listings .............................. [[32mSUCCESS 1[0m in 1.98s]
[0m13:35:29.043801 [debug] [Thread-2  ]: Finished running node model.dbtlearm.src_listings
[0m13:35:29.044495 [debug] [Thread-1  ]: Began running node model.dbtlearm.dim_listings_cleansed
[0m13:35:29.044944 [info ] [Thread-1  ]: 6 of 7 START sql table model dev.dim_listings_cleansed ......................... [RUN]
[0m13:35:29.045824 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearm.dim_listings_cleansed'
[0m13:35:29.046172 [debug] [Thread-1  ]: Began compiling node model.dbtlearm.dim_listings_cleansed
[0m13:35:29.049606 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearm.dim_listings_cleansed"
[0m13:35:29.050730 [debug] [Thread-1  ]: Timing info for model.dbtlearm.dim_listings_cleansed (compile): 2023-02-22 13:35:29.046421 => 2023-02-22 13:35:29.050645
[0m13:35:29.051179 [debug] [Thread-1  ]: Began executing node model.dbtlearm.dim_listings_cleansed
[0m13:35:29.054452 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtlearm.dim_listings_cleansed"
[0m13:35:29.056049 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearm.dim_listings_cleansed"
[0m13:35:29.056308 [debug] [Thread-1  ]: On model.dbtlearm.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.dim_listings_cleansed"} */
create or replace transient table airbnb.dev.dim_listings_cleansed  as
        (WITH src_listings AS (
    SELECT * FROM airbnb.dev.src_listings
)
SELECT 
    listing_id,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights = 0 THEN 1
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE(
        price_str,
        '$'
    ) :: NUMBER (
        10,
        2
    ) AS price,
    created_at,
    updated_at
FROM
    src_listings
        );
[0m13:35:29.056559 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:35:29.801397 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1 seconds
[0m13:35:29.812432 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m13:35:29.812733 [debug] [Thread-4  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
describe table airbnb.dev.fct_reviews__dbt_tmp
[0m13:35:29.973692 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0 seconds
[0m13:35:29.978733 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m13:35:29.979011 [debug] [Thread-4  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
describe table airbnb.dev.fct_reviews
[0m13:35:30.128805 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0 seconds
[0m13:35:30.148116 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m13:35:30.148461 [debug] [Thread-4  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
describe table airbnb.dev.fct_reviews__dbt_tmp
[0m13:35:30.282374 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0 seconds
[0m13:35:30.286754 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m13:35:30.287076 [debug] [Thread-4  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m13:35:30.431307 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0 seconds
[0m13:35:30.444573 [debug] [Thread-4  ]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m13:35:30.465741 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtlearm.fct_reviews"
[0m13:35:30.467118 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m13:35:30.467394 [debug] [Thread-4  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m13:35:30.623408 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m13:35:30.623986 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m13:35:30.624347 [debug] [Thread-4  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
insert into airbnb.dev.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from airbnb.dev.fct_reviews__dbt_tmp
        );
[0m13:35:30.986238 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 0 seconds
[0m13:35:30.986743 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m13:35:30.987039 [debug] [Thread-4  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
COMMIT
[0m13:35:31.123895 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2 seconds
[0m13:35:31.134028 [debug] [Thread-3  ]: Timing info for model.dbtlearm.dim_hosts_cleansed (execute): 2023-02-22 13:35:28.978688 => 2023-02-22 13:35:31.133962
[0m13:35:31.134397 [debug] [Thread-3  ]: On model.dbtlearm.dim_hosts_cleansed: Close
[0m13:35:31.184397 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2 seconds
[0m13:35:31.188382 [debug] [Thread-1  ]: Timing info for model.dbtlearm.dim_listings_cleansed (execute): 2023-02-22 13:35:29.051447 => 2023-02-22 13:35:31.188322
[0m13:35:31.188673 [debug] [Thread-1  ]: On model.dbtlearm.dim_listings_cleansed: Close
[0m13:35:31.266000 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m13:35:31.275834 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m13:35:31.276157 [debug] [Thread-4  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
drop view if exists airbnb.dev.fct_reviews__dbt_tmp cascade
[0m13:35:31.379074 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50c86cd6-1111-4003-9919-75b812ce5be2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8225ce2ee0>]}
[0m13:35:31.379757 [info ] [Thread-3  ]: 5 of 7 OK created sql table model dev.dim_hosts_cleansed ....................... [[32mSUCCESS 1[0m in 2.41s]
[0m13:35:31.380361 [debug] [Thread-3  ]: Finished running node model.dbtlearm.dim_hosts_cleansed
[0m13:35:31.438639 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m13:35:31.442206 [debug] [Thread-4  ]: Timing info for model.dbtlearm.fct_reviews (execute): 2023-02-22 13:35:28.736759 => 2023-02-22 13:35:31.442140
[0m13:35:31.442561 [debug] [Thread-4  ]: On model.dbtlearm.fct_reviews: Close
[0m13:35:31.447640 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50c86cd6-1111-4003-9919-75b812ce5be2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82262b9280>]}
[0m13:35:31.448242 [info ] [Thread-1  ]: 6 of 7 OK created sql table model dev.dim_listings_cleansed .................... [[32mSUCCESS 1[0m in 2.40s]
[0m13:35:31.448705 [debug] [Thread-1  ]: Finished running node model.dbtlearm.dim_listings_cleansed
[0m13:35:31.449316 [debug] [Thread-2  ]: Began running node model.dbtlearm.dim_listings_with_hosts
[0m13:35:31.449714 [info ] [Thread-2  ]: 7 of 7 START sql table model dev.dim_listings_with_hosts ....................... [RUN]
[0m13:35:31.450477 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearm.dim_listings_with_hosts'
[0m13:35:31.450872 [debug] [Thread-2  ]: Began compiling node model.dbtlearm.dim_listings_with_hosts
[0m13:35:31.455768 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearm.dim_listings_with_hosts"
[0m13:35:31.456779 [debug] [Thread-2  ]: Timing info for model.dbtlearm.dim_listings_with_hosts (compile): 2023-02-22 13:35:31.451102 => 2023-02-22 13:35:31.456710
[0m13:35:31.457094 [debug] [Thread-2  ]: Began executing node model.dbtlearm.dim_listings_with_hosts
[0m13:35:31.460174 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtlearm.dim_listings_with_hosts"
[0m13:35:31.461778 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearm.dim_listings_with_hosts"
[0m13:35:31.462043 [debug] [Thread-2  ]: On model.dbtlearm.dim_listings_with_hosts: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.dim_listings_with_hosts"} */
create or replace transient table airbnb.dev.dim_listings_with_hosts  as
        (WITH
l AS (
    SELECT *
    FROM airbnb.dev.dim_listings_cleansed
),
h AS (
    SELECT *
    FROM airbnb.dev.dim_hosts_cleansed
)
SELECT
    l.listing_id,
    l.listing_name,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost AS host_is_superhost,
    l.created_at,
    GREATEST(l.updated_at, h.updated_at) AS updated_at
FROM l
LEFT JOIN h 
ON h.host_id = l.host_id
        );
[0m13:35:31.462289 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m13:35:31.673594 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50c86cd6-1111-4003-9919-75b812ce5be2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8226352190>]}
[0m13:35:31.674204 [info ] [Thread-4  ]: 4 of 7 OK created sql incremental model dev.fct_reviews ........................ [[32mSUCCESS 0[0m in 2.95s]
[0m13:35:31.674655 [debug] [Thread-4  ]: Finished running node model.dbtlearm.fct_reviews
[0m13:35:33.229663 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2 seconds
[0m13:35:33.233365 [debug] [Thread-2  ]: Timing info for model.dbtlearm.dim_listings_with_hosts (execute): 2023-02-22 13:35:31.457307 => 2023-02-22 13:35:33.233299
[0m13:35:33.233756 [debug] [Thread-2  ]: On model.dbtlearm.dim_listings_with_hosts: Close
[0m13:35:33.508607 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50c86cd6-1111-4003-9919-75b812ce5be2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8224e92340>]}
[0m13:35:33.509276 [info ] [Thread-2  ]: 7 of 7 OK created sql table model dev.dim_listings_with_hosts .................. [[32mSUCCESS 1[0m in 2.06s]
[0m13:35:33.509791 [debug] [Thread-2  ]: Finished running node model.dbtlearm.dim_listings_with_hosts
[0m13:35:33.511620 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:35:33.512254 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:35:33.512516 [debug] [MainThread]: Connection 'model.dbtlearm.dim_listings_cleansed' was properly closed.
[0m13:35:33.512750 [debug] [MainThread]: Connection 'model.dbtlearm.dim_listings_with_hosts' was properly closed.
[0m13:35:33.512973 [debug] [MainThread]: Connection 'model.dbtlearm.dim_hosts_cleansed' was properly closed.
[0m13:35:33.513191 [debug] [MainThread]: Connection 'model.dbtlearm.fct_reviews' was properly closed.
[0m13:35:33.513488 [info ] [MainThread]: 
[0m13:35:33.513846 [info ] [MainThread]: Finished running 3 view models, 3 table models, 1 incremental model in 0 hours 0 minutes and 9.78 seconds (9.78s).
[0m13:35:33.514592 [debug] [MainThread]: Command end result
[0m13:35:33.523115 [info ] [MainThread]: 
[0m13:35:33.523573 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:35:33.523915 [info ] [MainThread]: 
[0m13:35:33.524240 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m13:35:33.524644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8225047490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8225d55d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82261b71f0>]}
[0m13:35:33.524971 [debug] [MainThread]: Flushing usage events


============================== 2023-02-22 13:38:34.110622 | 25bad687-0422-4b40-8124-1b9f092e9fd5 ==============================
[0m13:38:34.110622 [info ] [MainThread]: Running with dbt=1.4.1
[0m13:38:34.113860 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/mramirez/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:38:34.114693 [debug] [MainThread]: Tracking: tracking
[0m13:38:34.115562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a32b1c100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a32b1cdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a32b1cd00>]}
[0m13:38:34.139741 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:38:34.140183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '25bad687-0422-4b40-8124-1b9f092e9fd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a32b1c7c0>]}
[0m13:38:34.807999 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_with_hosts.sql
[0m13:38:34.822110 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m13:38:34.825441 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m13:38:34.828646 [debug] [MainThread]: 1603: static parser failed on fct/fct_reviews.sql
[0m13:38:34.838428 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fct/fct_reviews.sql
[0m13:38:34.839961 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m13:38:34.843133 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m13:38:34.846411 [debug] [MainThread]: 1699: static parser successfully parsed src/src_host.sql
[0m13:38:34.937989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '25bad687-0422-4b40-8124-1b9f092e9fd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a32bfa340>]}
[0m13:38:34.946523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '25bad687-0422-4b40-8124-1b9f092e9fd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a32ca5700>]}
[0m13:38:34.947015 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 304 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m13:38:34.947443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25bad687-0422-4b40-8124-1b9f092e9fd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a32c77220>]}
[0m13:38:34.948989 [info ] [MainThread]: 
[0m13:38:34.950822 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:38:34.952118 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb'
[0m13:38:34.969183 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m13:38:34.969568 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m13:38:34.969837 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:38:36.514336 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2 seconds
[0m13:38:36.517017 [debug] [ThreadPool]: On list_airbnb: Close
[0m13:38:36.786663 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m13:38:36.794987 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m13:38:36.795344 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m13:38:36.795634 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:38:37.680545 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1 seconds
[0m13:38:37.683227 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m13:38:37.917575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25bad687-0422-4b40-8124-1b9f092e9fd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a30dab1f0>]}
[0m13:38:37.918631 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:38:37.919065 [info ] [MainThread]: 
[0m13:38:37.925560 [debug] [Thread-1  ]: Began running node model.dbtlearm.src_host
[0m13:38:37.925983 [debug] [Thread-2  ]: Began running node model.dbtlearm.src_listings
[0m13:38:37.926317 [debug] [Thread-3  ]: Began running node model.dbtlearm.src_reviews
[0m13:38:37.926959 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearm.src_host'
[0m13:38:37.927718 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearm.src_listings'
[0m13:38:37.928376 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearm.src_reviews'
[0m13:38:37.928726 [debug] [Thread-1  ]: Began compiling node model.dbtlearm.src_host
[0m13:38:37.929052 [debug] [Thread-2  ]: Began compiling node model.dbtlearm.src_listings
[0m13:38:37.929381 [debug] [Thread-3  ]: Began compiling node model.dbtlearm.src_reviews
[0m13:38:37.931290 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearm.src_host"
[0m13:38:37.933090 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearm.src_listings"
[0m13:38:37.934810 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearm.src_reviews"
[0m13:38:37.935816 [debug] [Thread-1  ]: Timing info for model.dbtlearm.src_host (compile): 2023-02-22 13:38:37.929640 => 2023-02-22 13:38:37.935729
[0m13:38:37.936112 [debug] [Thread-2  ]: Timing info for model.dbtlearm.src_listings (compile): 2023-02-22 13:38:37.931547 => 2023-02-22 13:38:37.936045
[0m13:38:37.936354 [debug] [Thread-3  ]: Timing info for model.dbtlearm.src_reviews (compile): 2023-02-22 13:38:37.933357 => 2023-02-22 13:38:37.936288
[0m13:38:37.938514 [debug] [Thread-1  ]: Finished running node model.dbtlearm.src_host
[0m13:38:37.939340 [debug] [Thread-2  ]: Finished running node model.dbtlearm.src_listings
[0m13:38:37.940136 [debug] [Thread-3  ]: Finished running node model.dbtlearm.src_reviews
[0m13:38:37.940789 [debug] [Thread-4  ]: Began running node model.dbtlearm.dim_hosts_cleansed
[0m13:38:37.941488 [debug] [Thread-1  ]: Began running node model.dbtlearm.dim_listings_cleansed
[0m13:38:37.941852 [debug] [Thread-2  ]: Began running node model.dbtlearm.fct_reviews
[0m13:38:37.942259 [info ] [Thread-4  ]: 1 of 4 START sql table model dev.dim_hosts_cleansed ............................ [RUN]
[0m13:38:37.942756 [info ] [Thread-1  ]: 2 of 4 START sql table model dev.dim_listings_cleansed ......................... [RUN]
[0m13:38:37.943256 [info ] [Thread-2  ]: 3 of 4 START sql incremental model dev.fct_reviews ............................. [RUN]
[0m13:38:37.944019 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtlearm.dim_hosts_cleansed'
[0m13:38:37.944656 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearm.dim_listings_cleansed'
[0m13:38:37.945253 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearm.fct_reviews'
[0m13:38:37.945578 [debug] [Thread-4  ]: Began compiling node model.dbtlearm.dim_hosts_cleansed
[0m13:38:37.945923 [debug] [Thread-1  ]: Began compiling node model.dbtlearm.dim_listings_cleansed
[0m13:38:37.946231 [debug] [Thread-2  ]: Began compiling node model.dbtlearm.fct_reviews
[0m13:38:37.953932 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearm.dim_hosts_cleansed"
[0m13:38:37.965059 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearm.dim_listings_cleansed"
[0m13:38:37.975230 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearm.fct_reviews"
[0m13:38:37.976275 [debug] [Thread-4  ]: Timing info for model.dbtlearm.dim_hosts_cleansed (compile): 2023-02-22 13:38:37.946463 => 2023-02-22 13:38:37.976199
[0m13:38:37.976556 [debug] [Thread-2  ]: Timing info for model.dbtlearm.fct_reviews (compile): 2023-02-22 13:38:37.965401 => 2023-02-22 13:38:37.976493
[0m13:38:37.976765 [debug] [Thread-1  ]: Timing info for model.dbtlearm.dim_listings_cleansed (compile): 2023-02-22 13:38:37.954325 => 2023-02-22 13:38:37.976720
[0m13:38:37.977005 [debug] [Thread-4  ]: Began executing node model.dbtlearm.dim_hosts_cleansed
[0m13:38:37.977305 [debug] [Thread-2  ]: Began executing node model.dbtlearm.fct_reviews
[0m13:38:37.977586 [debug] [Thread-1  ]: Began executing node model.dbtlearm.dim_listings_cleansed
[0m13:38:38.037126 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtlearm.dim_hosts_cleansed"
[0m13:38:38.040164 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtlearm.dim_listings_cleansed"
[0m13:38:38.061762 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m13:38:38.062308 [debug] [Thread-2  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
create or replace  temporary view airbnb.dev.fct_reviews__dbt_tmp
  
   as (
    -- Incremental Materialization

WITH  __dbt__cte__src_reviews as (
WITH raw_reviews AS(
	SELECT * FROM AIRBNB.RAW.RAW_REVIEWS
)
SELECT
	listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
	raw_reviews
),src_reviews AS (
    SELECt * FROM __dbt__cte__src_reviews
)
SELECT *
FROM src_reviews
WHERE review_text IS NOT NULL

  AND review_date > (SELECT MAX(review_date) FROM airbnb.dev.fct_reviews)

  );
[0m13:38:38.062608 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m13:38:38.065242 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearm.dim_listings_cleansed"
[0m13:38:38.065690 [debug] [Thread-1  ]: On model.dbtlearm.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.dim_listings_cleansed"} */
create or replace transient table airbnb.dev.dim_listings_cleansed  as
        (WITH  __dbt__cte__src_listings as (
-- DBT knows this is a view
-- By default they are views
WITH raw_listings AS(
	SELECT * FROM AIRBNB.RAW.RAW_LISTINGS
)
SELECT
	id as listing_id,
    name as listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at
FROM
	raw_listings
),src_listings AS (
    SELECT * FROM __dbt__cte__src_listings
)
SELECT 
    listing_id,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights = 0 THEN 1
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE(
        price_str,
        '$'
    ) :: NUMBER (
        10,
        2
    ) AS price,
    created_at,
    updated_at
FROM
    src_listings
        );
[0m13:38:38.066682 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearm.dim_hosts_cleansed"
[0m13:38:38.067573 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:38:38.067846 [debug] [Thread-4  ]: On model.dbtlearm.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.dim_hosts_cleansed"} */
create or replace transient table airbnb.dev.dim_hosts_cleansed  as
        (WITH  __dbt__cte__src_host as (
WITH raw_hosts AS(
	SELECT * FROM AIRBNB.RAW.RAW_HOSTS
)
SELECT
	id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
	raw_hosts
),src_hosts AS(
    SELECT * FROM  __dbt__cte__src_host
)
SELECT
    host_id,
    NVL(
        host_name, 
        'Anonymous'
    ) AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
	src_hosts
        );
[0m13:38:38.068887 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m13:38:39.383965 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1 seconds
[0m13:38:39.394104 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m13:38:39.394413 [debug] [Thread-2  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
describe table airbnb.dev.fct_reviews__dbt_tmp
[0m13:38:39.546675 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0 seconds
[0m13:38:39.552117 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m13:38:39.552467 [debug] [Thread-2  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
describe table airbnb.dev.fct_reviews
[0m13:38:39.675919 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0 seconds
[0m13:38:39.696349 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m13:38:39.696694 [debug] [Thread-2  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
describe table airbnb.dev.fct_reviews__dbt_tmp
[0m13:38:39.849431 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0 seconds
[0m13:38:39.854101 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m13:38:39.854389 [debug] [Thread-2  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m13:38:39.984823 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0 seconds
[0m13:38:39.985979 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 2 seconds
[0m13:38:40.005510 [debug] [Thread-2  ]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m13:38:40.018783 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2 seconds
[0m13:38:40.052964 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtlearm.fct_reviews"
[0m13:38:40.057365 [debug] [Thread-4  ]: Timing info for model.dbtlearm.dim_hosts_cleansed (execute): 2023-02-22 13:38:37.977793 => 2023-02-22 13:38:40.057308
[0m13:38:40.058980 [debug] [Thread-1  ]: Timing info for model.dbtlearm.dim_listings_cleansed (execute): 2023-02-22 13:38:38.037338 => 2023-02-22 13:38:40.058939
[0m13:38:40.059381 [debug] [Thread-4  ]: On model.dbtlearm.dim_hosts_cleansed: Close
[0m13:38:40.059641 [debug] [Thread-1  ]: On model.dbtlearm.dim_listings_cleansed: Close
[0m13:38:40.061165 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m13:38:40.062829 [debug] [Thread-2  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m13:38:40.216548 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m13:38:40.217178 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m13:38:40.217539 [debug] [Thread-2  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
insert into airbnb.dev.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from airbnb.dev.fct_reviews__dbt_tmp
        );
[0m13:38:40.341254 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25bad687-0422-4b40-8124-1b9f092e9fd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a3333b850>]}
[0m13:38:40.341973 [info ] [Thread-1  ]: 2 of 4 OK created sql table model dev.dim_listings_cleansed .................... [[32mSUCCESS 1[0m in 2.40s]
[0m13:38:40.342514 [debug] [Thread-1  ]: Finished running node model.dbtlearm.dim_listings_cleansed
[0m13:38:40.345926 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25bad687-0422-4b40-8124-1b9f092e9fd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a32afa400>]}
[0m13:38:40.346497 [info ] [Thread-4  ]: 1 of 4 OK created sql table model dev.dim_hosts_cleansed ....................... [[32mSUCCESS 1[0m in 2.40s]
[0m13:38:40.346940 [debug] [Thread-4  ]: Finished running node model.dbtlearm.dim_hosts_cleansed
[0m13:38:40.347625 [debug] [Thread-3  ]: Began running node model.dbtlearm.dim_listings_with_hosts
[0m13:38:40.348050 [info ] [Thread-3  ]: 4 of 4 START sql table model dev.dim_listings_with_hosts ....................... [RUN]
[0m13:38:40.348982 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearm.dim_listings_with_hosts'
[0m13:38:40.349322 [debug] [Thread-3  ]: Began compiling node model.dbtlearm.dim_listings_with_hosts
[0m13:38:40.353016 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearm.dim_listings_with_hosts"
[0m13:38:40.353934 [debug] [Thread-3  ]: Timing info for model.dbtlearm.dim_listings_with_hosts (compile): 2023-02-22 13:38:40.349543 => 2023-02-22 13:38:40.353858
[0m13:38:40.354256 [debug] [Thread-3  ]: Began executing node model.dbtlearm.dim_listings_with_hosts
[0m13:38:40.357431 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtlearm.dim_listings_with_hosts"
[0m13:38:40.359021 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearm.dim_listings_with_hosts"
[0m13:38:40.359281 [debug] [Thread-3  ]: On model.dbtlearm.dim_listings_with_hosts: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.dim_listings_with_hosts"} */
create or replace transient table airbnb.dev.dim_listings_with_hosts  as
        (WITH
l AS (
    SELECT *
    FROM airbnb.dev.dim_listings_cleansed
),
h AS (
    SELECT *
    FROM airbnb.dev.dim_hosts_cleansed
)
SELECT
    l.listing_id,
    l.listing_name,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost AS host_is_superhost,
    l.created_at,
    GREATEST(l.updated_at, h.updated_at) AS updated_at
FROM l
LEFT JOIN h 
ON h.host_id = l.host_id
        );
[0m13:38:40.359527 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:38:40.696595 [debug] [Thread-2  ]: SQL status: SUCCESS 0 in 0 seconds
[0m13:38:40.697280 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m13:38:40.697741 [debug] [Thread-2  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
COMMIT
[0m13:38:40.930444 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m13:38:40.939938 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m13:38:40.940286 [debug] [Thread-2  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
drop view if exists airbnb.dev.fct_reviews__dbt_tmp cascade
[0m13:38:41.095053 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m13:38:41.098780 [debug] [Thread-2  ]: Timing info for model.dbtlearm.fct_reviews (execute): 2023-02-22 13:38:37.989089 => 2023-02-22 13:38:41.098710
[0m13:38:41.099131 [debug] [Thread-2  ]: On model.dbtlearm.fct_reviews: Close
[0m13:38:41.334641 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25bad687-0422-4b40-8124-1b9f092e9fd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a3303d820>]}
[0m13:38:41.335395 [info ] [Thread-2  ]: 3 of 4 OK created sql incremental model dev.fct_reviews ........................ [[32mSUCCESS 0[0m in 3.39s]
[0m13:38:41.335896 [debug] [Thread-2  ]: Finished running node model.dbtlearm.fct_reviews
[0m13:38:42.283813 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2 seconds
[0m13:38:42.287697 [debug] [Thread-3  ]: Timing info for model.dbtlearm.dim_listings_with_hosts (execute): 2023-02-22 13:38:40.354477 => 2023-02-22 13:38:42.287638
[0m13:38:42.288003 [debug] [Thread-3  ]: On model.dbtlearm.dim_listings_with_hosts: Close
[0m13:38:42.564110 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25bad687-0422-4b40-8124-1b9f092e9fd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a33064a30>]}
[0m13:38:42.564865 [info ] [Thread-3  ]: 4 of 4 OK created sql table model dev.dim_listings_with_hosts .................. [[32mSUCCESS 1[0m in 2.22s]
[0m13:38:42.565520 [debug] [Thread-3  ]: Finished running node model.dbtlearm.dim_listings_with_hosts
[0m13:38:42.567531 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:38:42.568245 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:38:42.568511 [debug] [MainThread]: Connection 'model.dbtlearm.dim_listings_cleansed' was properly closed.
[0m13:38:42.568738 [debug] [MainThread]: Connection 'model.dbtlearm.fct_reviews' was properly closed.
[0m13:38:42.568968 [debug] [MainThread]: Connection 'model.dbtlearm.dim_listings_with_hosts' was properly closed.
[0m13:38:42.569193 [debug] [MainThread]: Connection 'model.dbtlearm.dim_hosts_cleansed' was properly closed.
[0m13:38:42.569477 [info ] [MainThread]: 
[0m13:38:42.569821 [info ] [MainThread]: Finished running 3 table models, 1 incremental model in 0 hours 0 minutes and 7.62 seconds (7.62s).
[0m13:38:42.570391 [debug] [MainThread]: Command end result
[0m13:38:42.579316 [info ] [MainThread]: 
[0m13:38:42.579776 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:38:42.580131 [info ] [MainThread]: 
[0m13:38:42.580581 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m13:38:42.581011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a32c6d3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a31526970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a28f83e50>]}
[0m13:38:42.581383 [debug] [MainThread]: Flushing usage events


============================== 2023-02-22 13:47:48.962079 | 5f2e1629-65f6-44bb-bd42-2fbacc79f495 ==============================
[0m13:47:48.962079 [info ] [MainThread]: Running with dbt=1.4.1
[0m13:47:48.965175 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/mramirez/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:47:48.965499 [debug] [MainThread]: Tracking: tracking
[0m13:47:48.966268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3a2a43100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3a2a43df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3a2a43d00>]}
[0m13:47:48.996491 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:47:48.996912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5f2e1629-65f6-44bb-bd42-2fbacc79f495', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3a2a431f0>]}
[0m13:47:49.826706 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_with_hosts.sql
[0m13:47:49.840568 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m13:47:49.844115 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m13:47:49.847312 [debug] [MainThread]: 1603: static parser failed on fct/fct_reviews.sql
[0m13:47:49.857131 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fct/fct_reviews.sql
[0m13:47:49.858650 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m13:47:49.861826 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m13:47:49.865024 [debug] [MainThread]: 1699: static parser successfully parsed src/src_host.sql
[0m13:47:49.955874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f2e1629-65f6-44bb-bd42-2fbacc79f495', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3a2b60820>]}
[0m13:47:49.975127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f2e1629-65f6-44bb-bd42-2fbacc79f495', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3a2abe790>]}
[0m13:47:49.975618 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 304 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m13:47:49.975968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f2e1629-65f6-44bb-bd42-2fbacc79f495', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3a1c86af0>]}
[0m13:47:49.977614 [info ] [MainThread]: 
[0m13:47:49.979425 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:47:49.980652 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb'
[0m13:47:49.997681 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m13:47:49.998153 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m13:47:49.998513 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:47:51.703103 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2 seconds
[0m13:47:51.705270 [debug] [ThreadPool]: On list_airbnb: Close
[0m13:47:51.959388 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m13:47:51.968091 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m13:47:51.968457 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m13:47:51.968731 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:47:53.067675 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1 seconds
[0m13:47:53.070045 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m13:47:53.344949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f2e1629-65f6-44bb-bd42-2fbacc79f495', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3a2aa3af0>]}
[0m13:47:53.345831 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:47:53.346250 [info ] [MainThread]: 
[0m13:47:53.367824 [debug] [Thread-1  ]: Began running node model.dbtlearm.src_host
[0m13:47:53.368207 [debug] [Thread-2  ]: Began running node model.dbtlearm.src_listings
[0m13:47:53.368601 [debug] [Thread-3  ]: Began running node model.dbtlearm.src_reviews
[0m13:47:53.369230 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearm.src_host'
[0m13:47:53.369908 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearm.src_listings'
[0m13:47:53.370544 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearm.src_reviews'
[0m13:47:53.370856 [debug] [Thread-1  ]: Began compiling node model.dbtlearm.src_host
[0m13:47:53.371149 [debug] [Thread-2  ]: Began compiling node model.dbtlearm.src_listings
[0m13:47:53.371424 [debug] [Thread-3  ]: Began compiling node model.dbtlearm.src_reviews
[0m13:47:53.373203 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearm.src_host"
[0m13:47:53.374880 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearm.src_listings"
[0m13:47:53.376513 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearm.src_reviews"
[0m13:47:53.378761 [debug] [Thread-1  ]: Timing info for model.dbtlearm.src_host (compile): 2023-02-22 13:47:53.371639 => 2023-02-22 13:47:53.378672
[0m13:47:53.380849 [debug] [Thread-1  ]: Finished running node model.dbtlearm.src_host
[0m13:47:53.381116 [debug] [Thread-3  ]: Timing info for model.dbtlearm.src_reviews (compile): 2023-02-22 13:47:53.375129 => 2023-02-22 13:47:53.381047
[0m13:47:53.381750 [debug] [Thread-2  ]: Timing info for model.dbtlearm.src_listings (compile): 2023-02-22 13:47:53.373443 => 2023-02-22 13:47:53.381665
[0m13:47:53.382505 [debug] [Thread-3  ]: Finished running node model.dbtlearm.src_reviews
[0m13:47:53.382917 [debug] [Thread-4  ]: Began running node model.dbtlearm.dim_hosts_cleansed
[0m13:47:53.383700 [debug] [Thread-2  ]: Finished running node model.dbtlearm.src_listings
[0m13:47:53.384242 [debug] [Thread-1  ]: Began running node model.dbtlearm.fct_reviews
[0m13:47:53.384652 [info ] [Thread-4  ]: 1 of 4 START sql view model dev.dim_hosts_cleansed ............................. [RUN]
[0m13:47:53.385337 [info ] [Thread-1  ]: 2 of 4 START sql incremental model dev.fct_reviews ............................. [RUN]
[0m13:47:53.386065 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtlearm.dim_hosts_cleansed'
[0m13:47:53.386463 [debug] [Thread-3  ]: Began running node model.dbtlearm.dim_listings_cleansed
[0m13:47:53.387052 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearm.fct_reviews'
[0m13:47:53.387375 [debug] [Thread-4  ]: Began compiling node model.dbtlearm.dim_hosts_cleansed
[0m13:47:53.387735 [info ] [Thread-3  ]: 3 of 4 START sql view model dev.dim_listings_cleansed .......................... [RUN]
[0m13:47:53.388137 [debug] [Thread-1  ]: Began compiling node model.dbtlearm.fct_reviews
[0m13:47:53.395514 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearm.dim_hosts_cleansed"
[0m13:47:53.396187 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearm.dim_listings_cleansed'
[0m13:47:53.407229 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearm.fct_reviews"
[0m13:47:53.407780 [debug] [Thread-3  ]: Began compiling node model.dbtlearm.dim_listings_cleansed
[0m13:47:53.417214 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearm.dim_listings_cleansed"
[0m13:47:53.417766 [debug] [Thread-1  ]: Timing info for model.dbtlearm.fct_reviews (compile): 2023-02-22 13:47:53.396419 => 2023-02-22 13:47:53.417692
[0m13:47:53.418031 [debug] [Thread-4  ]: Timing info for model.dbtlearm.dim_hosts_cleansed (compile): 2023-02-22 13:47:53.388390 => 2023-02-22 13:47:53.417969
[0m13:47:53.418300 [debug] [Thread-1  ]: Began executing node model.dbtlearm.fct_reviews
[0m13:47:53.418605 [debug] [Thread-4  ]: Began executing node model.dbtlearm.dim_hosts_cleansed
[0m13:47:53.447644 [debug] [Thread-3  ]: Timing info for model.dbtlearm.dim_listings_cleansed (compile): 2023-02-22 13:47:53.408111 => 2023-02-22 13:47:53.447561
[0m13:47:53.483031 [debug] [Thread-4  ]: Dropping relation "AIRBNB"."DEV"."DIM_HOSTS_CLEANSED" because it is of type table
[0m13:47:53.483296 [debug] [Thread-3  ]: Began executing node model.dbtlearm.dim_listings_cleansed
[0m13:47:53.491167 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m13:47:53.501705 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearm.dim_hosts_cleansed"
[0m13:47:53.518886 [debug] [Thread-3  ]: Dropping relation "AIRBNB"."DEV"."DIM_LISTINGS_CLEANSED" because it is of type table
[0m13:47:53.519252 [debug] [Thread-1  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
create or replace  temporary view airbnb.dev.fct_reviews__dbt_tmp
  
   as (
    -- Incremental Materialization

WITH  __dbt__cte__src_reviews as (
WITH raw_reviews AS(
	SELECT * FROM AIRBNB.RAW.RAW_REVIEWS
)
SELECT
	listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
	raw_reviews
),src_reviews AS (
    SELECt * FROM __dbt__cte__src_reviews
)
SELECT *
FROM src_reviews
WHERE review_text IS NOT NULL

  AND review_date > (SELECT MAX(review_date) FROM airbnb.dev.fct_reviews)

  );
[0m13:47:53.519518 [debug] [Thread-4  ]: On model.dbtlearm.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.dim_hosts_cleansed"} */
drop table if exists "AIRBNB"."DEV"."DIM_HOSTS_CLEANSED" cascade
[0m13:47:53.522013 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearm.dim_listings_cleansed"
[0m13:47:53.522299 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:47:53.522547 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m13:47:53.522839 [debug] [Thread-3  ]: On model.dbtlearm.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.dim_listings_cleansed"} */
drop table if exists "AIRBNB"."DEV"."DIM_LISTINGS_CLEANSED" cascade
[0m13:47:53.526220 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:47:54.890676 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1 seconds
[0m13:47:54.899379 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtlearm.dim_listings_cleansed"
[0m13:47:54.905324 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearm.dim_listings_cleansed"
[0m13:47:54.905656 [debug] [Thread-3  ]: On model.dbtlearm.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.dim_listings_cleansed"} */
create or replace   view airbnb.dev.dim_listings_cleansed
  
   as (
    -- Change Tables for views

WITH  __dbt__cte__src_listings as (
-- DBT knows this is a view
-- By default they are views
WITH raw_listings AS(
	SELECT * FROM AIRBNB.RAW.RAW_LISTINGS
)
SELECT
	id as listing_id,
    name as listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at
FROM
	raw_listings
),src_listings AS (
    SELECT * FROM __dbt__cte__src_listings
)
SELECT 
    listing_id,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights = 0 THEN 1
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE(
        price_str,
        '$'
    ) :: NUMBER (
        10,
        2
    ) AS price,
    created_at,
    updated_at
FROM
    src_listings
  );
[0m13:47:54.960224 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1 seconds
[0m13:47:54.963245 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtlearm.dim_hosts_cleansed"
[0m13:47:54.968778 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearm.dim_hosts_cleansed"
[0m13:47:54.969102 [debug] [Thread-4  ]: On model.dbtlearm.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.dim_hosts_cleansed"} */
create or replace   view airbnb.dev.dim_hosts_cleansed
  
   as (
    -- Change Tables for views

WITH  __dbt__cte__src_host as (
WITH raw_hosts AS(
	SELECT * FROM AIRBNB.RAW.RAW_HOSTS
)
SELECT
	id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
	raw_hosts
),src_hosts AS(
    SELECT * FROM  __dbt__cte__src_host
)
SELECT
    host_id,
    NVL(
        host_name, 
        'Anonymous'
    ) AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
	src_hosts
  );
[0m13:47:55.020304 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m13:47:55.031833 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m13:47:55.032195 [debug] [Thread-1  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
describe table airbnb.dev.fct_reviews__dbt_tmp
[0m13:47:55.140521 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m13:47:55.162018 [debug] [Thread-3  ]: Timing info for model.dbtlearm.dim_listings_cleansed (execute): 2023-02-22 13:47:53.515608 => 2023-02-22 13:47:55.161952
[0m13:47:55.162375 [debug] [Thread-3  ]: On model.dbtlearm.dim_listings_cleansed: Close
[0m13:47:55.188055 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0 seconds
[0m13:47:55.193439 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m13:47:55.193715 [debug] [Thread-1  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
describe table airbnb.dev.fct_reviews
[0m13:47:55.238470 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m13:47:55.241719 [debug] [Thread-4  ]: Timing info for model.dbtlearm.dim_hosts_cleansed (execute): 2023-02-22 13:47:53.441552 => 2023-02-22 13:47:55.241653
[0m13:47:55.242084 [debug] [Thread-4  ]: On model.dbtlearm.dim_hosts_cleansed: Close
[0m13:47:55.398377 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f2e1629-65f6-44bb-bd42-2fbacc79f495', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3a2d27ee0>]}
[0m13:47:55.399165 [info ] [Thread-3  ]: 3 of 4 OK created sql view model dev.dim_listings_cleansed ..................... [[32mSUCCESS 1[0m in 2.00s]
[0m13:47:55.399693 [debug] [Thread-3  ]: Finished running node model.dbtlearm.dim_listings_cleansed
[0m13:47:55.596304 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0 seconds
[0m13:47:55.615827 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m13:47:55.616175 [debug] [Thread-1  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
describe table airbnb.dev.fct_reviews__dbt_tmp
[0m13:47:55.716284 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f2e1629-65f6-44bb-bd42-2fbacc79f495', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3a30ad9d0>]}
[0m13:47:55.716988 [info ] [Thread-4  ]: 1 of 4 OK created sql view model dev.dim_hosts_cleansed ........................ [[32mSUCCESS 1[0m in 2.33s]
[0m13:47:55.717528 [debug] [Thread-4  ]: Finished running node model.dbtlearm.dim_hosts_cleansed
[0m13:47:55.718165 [debug] [Thread-2  ]: Began running node model.dbtlearm.dim_listings_with_hosts
[0m13:47:55.718608 [info ] [Thread-2  ]: 4 of 4 START sql table model dev.dim_listings_with_hosts ....................... [RUN]
[0m13:47:55.719394 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearm.dim_listings_with_hosts'
[0m13:47:55.719688 [debug] [Thread-2  ]: Began compiling node model.dbtlearm.dim_listings_with_hosts
[0m13:47:55.723802 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearm.dim_listings_with_hosts"
[0m13:47:55.727776 [debug] [Thread-2  ]: Timing info for model.dbtlearm.dim_listings_with_hosts (compile): 2023-02-22 13:47:55.719896 => 2023-02-22 13:47:55.727666
[0m13:47:55.728160 [debug] [Thread-2  ]: Began executing node model.dbtlearm.dim_listings_with_hosts
[0m13:47:55.756340 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtlearm.dim_listings_with_hosts"
[0m13:47:55.760527 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearm.dim_listings_with_hosts"
[0m13:47:55.760843 [debug] [Thread-2  ]: On model.dbtlearm.dim_listings_with_hosts: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.dim_listings_with_hosts"} */
create or replace transient table airbnb.dev.dim_listings_with_hosts  as
        (WITH
l AS (
    SELECT *
    FROM airbnb.dev.dim_listings_cleansed
),
h AS (
    SELECT *
    FROM airbnb.dev.dim_hosts_cleansed
)
SELECT
    l.listing_id,
    l.listing_name,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost AS host_is_superhost,
    l.created_at,
    GREATEST(l.updated_at, h.updated_at) AS updated_at
FROM l
LEFT JOIN h 
ON h.host_id = l.host_id
        );
[0m13:47:55.761144 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m13:47:55.762284 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0 seconds
[0m13:47:55.767891 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m13:47:55.768223 [debug] [Thread-1  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m13:47:55.903763 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0 seconds
[0m13:47:55.915635 [debug] [Thread-1  ]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m13:47:55.933698 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtlearm.fct_reviews"
[0m13:47:55.937383 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m13:47:55.937642 [debug] [Thread-1  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m13:47:56.097002 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m13:47:56.097592 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m13:47:56.097958 [debug] [Thread-1  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
insert into airbnb.dev.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from airbnb.dev.fct_reviews__dbt_tmp
        );
[0m13:47:56.845917 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 1 seconds
[0m13:47:56.846581 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m13:47:56.846955 [debug] [Thread-1  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
COMMIT
[0m13:47:57.049208 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m13:47:57.055748 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m13:47:57.056064 [debug] [Thread-1  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
drop view if exists airbnb.dev.fct_reviews__dbt_tmp cascade
[0m13:47:57.224345 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m13:47:57.233384 [debug] [Thread-1  ]: Timing info for model.dbtlearm.fct_reviews (execute): 2023-02-22 13:47:53.418810 => 2023-02-22 13:47:57.233318
[0m13:47:57.233721 [debug] [Thread-1  ]: On model.dbtlearm.fct_reviews: Close
[0m13:47:57.482291 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f2e1629-65f6-44bb-bd42-2fbacc79f495', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3a30f5fa0>]}
[0m13:47:57.483057 [info ] [Thread-1  ]: 2 of 4 OK created sql incremental model dev.fct_reviews ........................ [[32mSUCCESS 0[0m in 4.10s]
[0m13:47:57.483617 [debug] [Thread-1  ]: Finished running node model.dbtlearm.fct_reviews
[0m13:47:57.631537 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2 seconds
[0m13:47:57.639278 [debug] [Thread-2  ]: Timing info for model.dbtlearm.dim_listings_with_hosts (execute): 2023-02-22 13:47:55.728379 => 2023-02-22 13:47:57.639217
[0m13:47:57.639608 [debug] [Thread-2  ]: On model.dbtlearm.dim_listings_with_hosts: Close
[0m13:47:57.890566 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f2e1629-65f6-44bb-bd42-2fbacc79f495', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3a3083430>]}
[0m13:47:57.891263 [info ] [Thread-2  ]: 4 of 4 OK created sql table model dev.dim_listings_with_hosts .................. [[32mSUCCESS 1[0m in 2.17s]
[0m13:47:57.891802 [debug] [Thread-2  ]: Finished running node model.dbtlearm.dim_listings_with_hosts
[0m13:47:57.893533 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:47:57.894155 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:47:57.894414 [debug] [MainThread]: Connection 'model.dbtlearm.fct_reviews' was properly closed.
[0m13:47:57.894644 [debug] [MainThread]: Connection 'model.dbtlearm.dim_listings_with_hosts' was properly closed.
[0m13:47:57.894867 [debug] [MainThread]: Connection 'model.dbtlearm.dim_listings_cleansed' was properly closed.
[0m13:47:57.895086 [debug] [MainThread]: Connection 'model.dbtlearm.dim_hosts_cleansed' was properly closed.
[0m13:47:57.895394 [info ] [MainThread]: 
[0m13:47:57.895747 [info ] [MainThread]: Finished running 2 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 7.92 seconds (7.92s).
[0m13:47:57.896324 [debug] [MainThread]: Command end result
[0m13:47:57.912723 [info ] [MainThread]: 
[0m13:47:57.913202 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:47:57.913540 [info ] [MainThread]: 
[0m13:47:57.913862 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m13:47:57.914265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3a3263e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3a3263f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3a3263fa0>]}
[0m13:47:57.914663 [debug] [MainThread]: Flushing usage events


============================== 2023-02-25 11:23:30.224753 | 3ddb431b-1d00-4486-95d9-1e27247102c6 ==============================
[0m11:23:30.224753 [info ] [MainThread]: Running with dbt=1.4.1
[0m11:23:30.227643 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/mramirez/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'show': False, 'which': 'seed', 'rpc_method': 'seed', 'indirect_selection': 'eager'}
[0m11:23:30.227945 [debug] [MainThread]: Tracking: tracking
[0m11:23:30.228470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe37c383100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe37c383df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe37c383d00>]}
[0m11:23:30.478947 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m11:23:30.479420 [debug] [MainThread]: Partial parsing: added file: dbtlearm://seeds/seed_full_moon_dates.csv
[0m11:23:30.536389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3ddb431b-1d00-4486-95d9-1e27247102c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe37c3c9cd0>]}
[0m11:23:30.552887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3ddb431b-1d00-4486-95d9-1e27247102c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe37c4efaf0>]}
[0m11:23:30.553358 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 304 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m11:23:30.553709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ddb431b-1d00-4486-95d9-1e27247102c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe37c4eff40>]}
[0m11:23:30.555342 [info ] [MainThread]: 
[0m11:23:30.557157 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:23:30.558262 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb'
[0m11:23:30.575310 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m11:23:30.575720 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m11:23:30.576022 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:23:33.105015 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 3 seconds
[0m11:23:33.107250 [debug] [ThreadPool]: On list_airbnb: Close
[0m11:23:33.417432 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m11:23:33.425972 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m11:23:33.426331 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m11:23:33.426611 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:23:34.337426 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1 seconds
[0m11:23:34.339277 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m11:23:34.566204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ddb431b-1d00-4486-95d9-1e27247102c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe37c4efd00>]}
[0m11:23:34.567118 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:23:34.567591 [info ] [MainThread]: 
[0m11:23:34.579304 [debug] [Thread-1  ]: Began running node seed.dbtlearm.seed_full_moon_dates
[0m11:23:34.579821 [info ] [Thread-1  ]: 1 of 1 START seed file dev.seed_full_moon_dates ................................ [RUN]
[0m11:23:34.580635 [debug] [Thread-1  ]: Acquiring new snowflake connection 'seed.dbtlearm.seed_full_moon_dates'
[0m11:23:34.580948 [debug] [Thread-1  ]: Began compiling node seed.dbtlearm.seed_full_moon_dates
[0m11:23:34.581240 [debug] [Thread-1  ]: Timing info for seed.dbtlearm.seed_full_moon_dates (compile): 2023-02-25 11:23:34.581170 => 2023-02-25 11:23:34.581175
[0m11:23:34.581529 [debug] [Thread-1  ]: Began executing node seed.dbtlearm.seed_full_moon_dates
[0m11:23:34.629961 [debug] [Thread-1  ]: Using snowflake connection "seed.dbtlearm.seed_full_moon_dates"
[0m11:23:34.630311 [debug] [Thread-1  ]: On seed.dbtlearm.seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "seed.dbtlearm.seed_full_moon_dates"} */
create table airbnb.dev.seed_full_moon_dates (full_moon_date date)
[0m11:23:34.630547 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:23:35.810074 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m11:23:35.835927 [debug] [Thread-1  ]: Using snowflake connection "seed.dbtlearm.seed_full_moon_dates"
[0m11:23:35.836300 [debug] [Thread-1  ]: On seed.dbtlearm.seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "seed.dbtlearm.seed_full_moon_dates"} */
BEGIN
[0m11:23:36.057001 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m11:23:36.061104 [debug] [Thread-1  ]: Using snowflake connection "seed.dbtlearm.seed_full_moon_dates"
[0m11:23:36.061427 [debug] [Thread-1  ]: On seed.dbtlearm.seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "seed.dbtlearm.seed_full_moon_dates"} */
insert into airbnb.dev.seed_full_moon_dates (full_moon_date) values
            (%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s...
[0m11:23:37.479256 [debug] [Thread-1  ]: SQL status: SUCCESS 272 in 1 seconds
[0m11:23:37.479901 [debug] [Thread-1  ]: Using snowflake connection "seed.dbtlearm.seed_full_moon_dates"
[0m11:23:37.480210 [debug] [Thread-1  ]: On seed.dbtlearm.seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "seed.dbtlearm.seed_full_moon_dates"} */
COMMIT
[0m11:23:38.195052 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m11:23:38.203699 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.dbtlearm.seed_full_moon_dates"
[0m11:23:38.231632 [debug] [Thread-1  ]: Timing info for seed.dbtlearm.seed_full_moon_dates (execute): 2023-02-25 11:23:34.581742 => 2023-02-25 11:23:38.231571
[0m11:23:38.231979 [debug] [Thread-1  ]: On seed.dbtlearm.seed_full_moon_dates: Close
[0m11:23:38.548030 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ddb431b-1d00-4486-95d9-1e27247102c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe37d1a8ee0>]}
[0m11:23:38.548956 [info ] [Thread-1  ]: 1 of 1 OK loaded seed file dev.seed_full_moon_dates ............................ [[32mINSERT 272[0m in 3.97s]
[0m11:23:38.550888 [debug] [Thread-1  ]: Finished running node seed.dbtlearm.seed_full_moon_dates
[0m11:23:38.555031 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:23:38.556016 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:23:38.556590 [debug] [MainThread]: Connection 'seed.dbtlearm.seed_full_moon_dates' was properly closed.
[0m11:23:38.557089 [info ] [MainThread]: 
[0m11:23:38.557700 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 8.00 seconds (8.00s).
[0m11:23:38.558823 [debug] [MainThread]: Command end result
[0m11:23:38.578886 [info ] [MainThread]: 
[0m11:23:38.579425 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:23:38.579849 [info ] [MainThread]: 
[0m11:23:38.580268 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:23:38.580720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe37d065f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe37d040250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe37d040430>]}
[0m11:23:38.581170 [debug] [MainThread]: Flushing usage events


============================== 2023-02-25 11:32:27.587823 | cb85f211-032c-4ac0-bc70-e2e2fda15679 ==============================
[0m11:32:27.587823 [info ] [MainThread]: Running with dbt=1.4.1
[0m11:32:27.590441 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/mramirez/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:32:27.590814 [debug] [MainThread]: Tracking: tracking
[0m11:32:27.591301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe24f447100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe24f447df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe24f447d00>]}
[0m11:32:27.678220 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m11:32:27.678650 [debug] [MainThread]: Partial parsing: added file: dbtlearm://models/mart/mart_fullmoon_review.sql
[0m11:32:27.693715 [debug] [MainThread]: 1699: static parser successfully parsed mart/mart_fullmoon_review.sql
[0m11:32:27.718906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cb85f211-032c-4ac0-bc70-e2e2fda15679', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe24f60a0d0>]}
[0m11:32:27.726521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cb85f211-032c-4ac0-bc70-e2e2fda15679', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe24f5bae50>]}
[0m11:32:27.727060 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 304 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m11:32:27.727428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb85f211-032c-4ac0-bc70-e2e2fda15679', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe24f5baee0>]}
[0m11:32:27.729084 [info ] [MainThread]: 
[0m11:32:27.730820 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:32:27.732053 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb'
[0m11:32:27.748051 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m11:32:27.748407 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m11:32:27.748682 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:32:29.210080 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1 seconds
[0m11:32:29.212618 [debug] [ThreadPool]: On list_airbnb: Close
[0m11:32:29.581728 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m11:32:29.638760 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m11:32:29.639165 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m11:32:29.639500 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:32:30.702108 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1 seconds
[0m11:32:30.704571 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m11:32:30.941534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb85f211-032c-4ac0-bc70-e2e2fda15679', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe24e8484c0>]}
[0m11:32:30.942555 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:32:30.943089 [info ] [MainThread]: 
[0m11:32:30.952251 [debug] [Thread-1  ]: Began running node model.dbtlearm.src_host
[0m11:32:30.952673 [debug] [Thread-2  ]: Began running node model.dbtlearm.src_listings
[0m11:32:30.953067 [debug] [Thread-3  ]: Began running node model.dbtlearm.src_reviews
[0m11:32:30.953727 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearm.src_host'
[0m11:32:30.954428 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearm.src_listings'
[0m11:32:30.955087 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearm.src_reviews'
[0m11:32:30.955424 [debug] [Thread-1  ]: Began compiling node model.dbtlearm.src_host
[0m11:32:30.955742 [debug] [Thread-2  ]: Began compiling node model.dbtlearm.src_listings
[0m11:32:30.956043 [debug] [Thread-3  ]: Began compiling node model.dbtlearm.src_reviews
[0m11:32:30.957928 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearm.src_host"
[0m11:32:30.959782 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearm.src_listings"
[0m11:32:30.961724 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearm.src_reviews"
[0m11:32:30.966054 [debug] [Thread-3  ]: Timing info for model.dbtlearm.src_reviews (compile): 2023-02-25 11:32:30.960061 => 2023-02-25 11:32:30.965933
[0m11:32:30.966359 [debug] [Thread-1  ]: Timing info for model.dbtlearm.src_host (compile): 2023-02-25 11:32:30.956284 => 2023-02-25 11:32:30.966286
[0m11:32:30.968555 [debug] [Thread-3  ]: Finished running node model.dbtlearm.src_reviews
[0m11:32:30.969359 [debug] [Thread-1  ]: Finished running node model.dbtlearm.src_host
[0m11:32:30.970181 [debug] [Thread-4  ]: Began running node model.dbtlearm.fct_reviews
[0m11:32:30.970621 [debug] [Thread-1  ]: Began running node model.dbtlearm.dim_hosts_cleansed
[0m11:32:30.970976 [info ] [Thread-4  ]: 1 of 5 START sql incremental model dev.fct_reviews ............................. [RUN]
[0m11:32:30.971486 [info ] [Thread-1  ]: 2 of 5 START sql view model dev.dim_hosts_cleansed ............................. [RUN]
[0m11:32:30.972243 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtlearm.fct_reviews'
[0m11:32:30.972864 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearm.dim_hosts_cleansed'
[0m11:32:30.973190 [debug] [Thread-4  ]: Began compiling node model.dbtlearm.fct_reviews
[0m11:32:30.973498 [debug] [Thread-1  ]: Began compiling node model.dbtlearm.dim_hosts_cleansed
[0m11:32:30.989282 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearm.fct_reviews"
[0m11:32:30.996828 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearm.dim_hosts_cleansed"
[0m11:32:30.997114 [debug] [Thread-2  ]: Timing info for model.dbtlearm.src_listings (compile): 2023-02-25 11:32:30.958193 => 2023-02-25 11:32:30.997048
[0m11:32:30.998167 [debug] [Thread-2  ]: Finished running node model.dbtlearm.src_listings
[0m11:32:30.998724 [debug] [Thread-3  ]: Began running node model.dbtlearm.dim_listings_cleansed
[0m11:32:30.999117 [info ] [Thread-3  ]: 3 of 5 START sql view model dev.dim_listings_cleansed .......................... [RUN]
[0m11:32:30.999817 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearm.dim_listings_cleansed'
[0m11:32:31.000192 [debug] [Thread-3  ]: Began compiling node model.dbtlearm.dim_listings_cleansed
[0m11:32:31.011482 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearm.dim_listings_cleansed"
[0m11:32:31.011828 [debug] [Thread-4  ]: Timing info for model.dbtlearm.fct_reviews (compile): 2023-02-25 11:32:30.973732 => 2023-02-25 11:32:31.011760
[0m11:32:31.012173 [debug] [Thread-1  ]: Timing info for model.dbtlearm.dim_hosts_cleansed (compile): 2023-02-25 11:32:30.989675 => 2023-02-25 11:32:31.012105
[0m11:32:31.012586 [debug] [Thread-4  ]: Began executing node model.dbtlearm.fct_reviews
[0m11:32:31.012965 [debug] [Thread-1  ]: Began executing node model.dbtlearm.dim_hosts_cleansed
[0m11:32:31.037604 [debug] [Thread-3  ]: Timing info for model.dbtlearm.dim_listings_cleansed (compile): 2023-02-25 11:32:31.000459 => 2023-02-25 11:32:31.037519
[0m11:32:31.074097 [debug] [Thread-3  ]: Began executing node model.dbtlearm.dim_listings_cleansed
[0m11:32:31.087369 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m11:32:31.087638 [debug] [Thread-4  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
create or replace  temporary view airbnb.dev.fct_reviews__dbt_tmp
  
   as (
    -- Incremental Materialization

WITH  __dbt__cte__src_reviews as (
WITH raw_reviews AS(
	SELECT * FROM AIRBNB.RAW.RAW_REVIEWS
)
SELECT
	listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
	raw_reviews
),src_reviews AS (
    SELECt * FROM __dbt__cte__src_reviews
)
SELECT *
FROM src_reviews
WHERE review_text IS NOT NULL

  AND review_date > (SELECT MAX(review_date) FROM airbnb.dev.fct_reviews)

  );
[0m11:32:31.095546 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtlearm.dim_hosts_cleansed"
[0m11:32:31.095761 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m11:32:31.096899 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtlearm.dim_listings_cleansed"
[0m11:32:31.101832 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearm.dim_hosts_cleansed"
[0m11:32:31.102881 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearm.dim_listings_cleansed"
[0m11:32:31.103105 [debug] [Thread-1  ]: On model.dbtlearm.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.dim_hosts_cleansed"} */
create or replace   view airbnb.dev.dim_hosts_cleansed
  
   as (
    -- Change Tables for views

WITH  __dbt__cte__src_host as (
WITH raw_hosts AS(
	SELECT * FROM AIRBNB.RAW.RAW_HOSTS
)
SELECT
	id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
	raw_hosts
),src_hosts AS(
    SELECT * FROM  __dbt__cte__src_host
)
SELECT
    host_id,
    NVL(
        host_name, 
        'Anonymous'
    ) AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
	src_hosts
  );
[0m11:32:31.103319 [debug] [Thread-3  ]: On model.dbtlearm.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.dim_listings_cleansed"} */
create or replace   view airbnb.dev.dim_listings_cleansed
  
   as (
    -- Change Tables for views

WITH  __dbt__cte__src_listings as (
-- DBT knows this is a view
-- By default they are views
WITH raw_listings AS(
	SELECT * FROM AIRBNB.RAW.RAW_LISTINGS
)
SELECT
	id as listing_id,
    name as listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at
FROM
	raw_listings
),src_listings AS (
    SELECT * FROM __dbt__cte__src_listings
)
SELECT 
    listing_id,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights = 0 THEN 1
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE(
        price_str,
        '$'
    ) :: NUMBER (
        10,
        2
    ) AS price,
    created_at,
    updated_at
FROM
    src_listings
  );
[0m11:32:31.103521 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:32:31.103716 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m11:32:32.520083 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m11:32:32.544740 [debug] [Thread-1  ]: Timing info for model.dbtlearm.dim_hosts_cleansed (execute): 2023-02-25 11:32:31.037811 => 2023-02-25 11:32:32.544674
[0m11:32:32.545116 [debug] [Thread-1  ]: On model.dbtlearm.dim_hosts_cleansed: Close
[0m11:32:32.700325 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 2 seconds
[0m11:32:32.712745 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m11:32:32.713114 [debug] [Thread-4  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
describe table airbnb.dev.fct_reviews__dbt_tmp
[0m11:32:32.767065 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2 seconds
[0m11:32:32.770924 [debug] [Thread-3  ]: Timing info for model.dbtlearm.dim_listings_cleansed (execute): 2023-02-25 11:32:31.080663 => 2023-02-25 11:32:32.770854
[0m11:32:32.771284 [debug] [Thread-3  ]: On model.dbtlearm.dim_listings_cleansed: Close
[0m11:32:32.812317 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb85f211-032c-4ac0-bc70-e2e2fda15679', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe24f9b0ca0>]}
[0m11:32:32.813032 [info ] [Thread-1  ]: 2 of 5 OK created sql view model dev.dim_hosts_cleansed ........................ [[32mSUCCESS 1[0m in 1.84s]
[0m11:32:32.813812 [debug] [Thread-1  ]: Finished running node model.dbtlearm.dim_hosts_cleansed
[0m11:32:32.868147 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0 seconds
[0m11:32:32.873828 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m11:32:32.874117 [debug] [Thread-4  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
describe table airbnb.dev.fct_reviews
[0m11:32:33.031073 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0 seconds
[0m11:32:33.049689 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m11:32:33.050793 [debug] [Thread-4  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
describe table airbnb.dev.fct_reviews__dbt_tmp
[0m11:32:33.052544 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb85f211-032c-4ac0-bc70-e2e2fda15679', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe24f60a7f0>]}
[0m11:32:33.053275 [info ] [Thread-3  ]: 3 of 5 OK created sql view model dev.dim_listings_cleansed ..................... [[32mSUCCESS 1[0m in 2.05s]
[0m11:32:33.054022 [debug] [Thread-3  ]: Finished running node model.dbtlearm.dim_listings_cleansed
[0m11:32:33.055242 [debug] [Thread-2  ]: Began running node model.dbtlearm.dim_listings_with_hosts
[0m11:32:33.055790 [info ] [Thread-2  ]: 4 of 5 START sql table model dev.dim_listings_with_hosts ....................... [RUN]
[0m11:32:33.056601 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearm.dim_listings_with_hosts'
[0m11:32:33.056913 [debug] [Thread-2  ]: Began compiling node model.dbtlearm.dim_listings_with_hosts
[0m11:32:33.060348 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearm.dim_listings_with_hosts"
[0m11:32:33.065169 [debug] [Thread-2  ]: Timing info for model.dbtlearm.dim_listings_with_hosts (compile): 2023-02-25 11:32:33.057135 => 2023-02-25 11:32:33.065075
[0m11:32:33.065541 [debug] [Thread-2  ]: Began executing node model.dbtlearm.dim_listings_with_hosts
[0m11:32:33.094534 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtlearm.dim_listings_with_hosts"
[0m11:32:33.099392 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearm.dim_listings_with_hosts"
[0m11:32:33.099738 [debug] [Thread-2  ]: On model.dbtlearm.dim_listings_with_hosts: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.dim_listings_with_hosts"} */
create or replace transient table airbnb.dev.dim_listings_with_hosts  as
        (WITH
l AS (
    SELECT *
    FROM airbnb.dev.dim_listings_cleansed
),
h AS (
    SELECT *
    FROM airbnb.dev.dim_hosts_cleansed
)
SELECT
    l.listing_id,
    l.listing_name,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost AS host_is_superhost,
    l.created_at,
    GREATEST(l.updated_at, h.updated_at) AS updated_at
FROM l
LEFT JOIN h 
ON h.host_id = l.host_id
        );
[0m11:32:33.099997 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m11:32:33.203393 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0 seconds
[0m11:32:33.207700 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m11:32:33.208016 [debug] [Thread-4  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m11:32:33.350871 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0 seconds
[0m11:32:33.363760 [debug] [Thread-4  ]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m11:32:33.384369 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtlearm.fct_reviews"
[0m11:32:33.387910 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m11:32:33.388205 [debug] [Thread-4  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m11:32:33.556088 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m11:32:33.574395 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m11:32:33.574664 [debug] [Thread-4  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
insert into airbnb.dev.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from airbnb.dev.fct_reviews__dbt_tmp
        );
[0m11:32:34.091535 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 1 seconds
[0m11:32:34.092133 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m11:32:34.092461 [debug] [Thread-4  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
COMMIT
[0m11:32:34.305949 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m11:32:34.316373 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m11:32:34.316731 [debug] [Thread-4  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
drop view if exists airbnb.dev.fct_reviews__dbt_tmp cascade
[0m11:32:34.463731 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m11:32:34.473002 [debug] [Thread-4  ]: Timing info for model.dbtlearm.fct_reviews (execute): 2023-02-25 11:32:31.013218 => 2023-02-25 11:32:34.472939
[0m11:32:34.473337 [debug] [Thread-4  ]: On model.dbtlearm.fct_reviews: Close
[0m11:32:34.730316 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb85f211-032c-4ac0-bc70-e2e2fda15679', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe24f5c4850>]}
[0m11:32:34.731006 [info ] [Thread-4  ]: 1 of 5 OK created sql incremental model dev.fct_reviews ........................ [[32mSUCCESS 0[0m in 3.76s]
[0m11:32:34.731555 [debug] [Thread-4  ]: Finished running node model.dbtlearm.fct_reviews
[0m11:32:34.732304 [debug] [Thread-3  ]: Began running node model.dbtlearm.mart_fullmoon_review
[0m11:32:34.732805 [info ] [Thread-3  ]: 5 of 5 START sql table model dev.mart_fullmoon_review .......................... [RUN]
[0m11:32:34.733750 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearm.mart_fullmoon_review'
[0m11:32:34.734097 [debug] [Thread-3  ]: Began compiling node model.dbtlearm.mart_fullmoon_review
[0m11:32:34.737829 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearm.mart_fullmoon_review"
[0m11:32:34.739007 [debug] [Thread-3  ]: Timing info for model.dbtlearm.mart_fullmoon_review (compile): 2023-02-25 11:32:34.734333 => 2023-02-25 11:32:34.738933
[0m11:32:34.739350 [debug] [Thread-3  ]: Began executing node model.dbtlearm.mart_fullmoon_review
[0m11:32:34.742680 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtlearm.mart_fullmoon_review"
[0m11:32:34.744679 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearm.mart_fullmoon_review"
[0m11:32:34.744991 [debug] [Thread-3  ]: On model.dbtlearm.mart_fullmoon_review: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.mart_fullmoon_review"} */
create or replace transient table airbnb.dev.mart_fullmoon_review  as
        (

WITH fct_reviews AS (
    SELECT * FROM airbnb.dev.fct_reviews
),

full_moon_dates AS (
    SELECT * FROM airbnb.dev.seed_full_moon_dates
)

SELECT
    r.*,
    CASE
        WHEN fm.full_moon_date IS NULL THEN 'not full moon'
        ELSE 'full moon'
    END AS is_full_moon
FROM
    fct_reviews r
    LEFT JOIN full_moon_dates fm
    ON (TO_DATE(r.review_date) = DATEADD(DAY, 1, fm.full_moon_date))
        );
[0m11:32:34.745259 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m11:32:35.327091 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2 seconds
[0m11:32:35.331364 [debug] [Thread-2  ]: Timing info for model.dbtlearm.dim_listings_with_hosts (execute): 2023-02-25 11:32:33.065770 => 2023-02-25 11:32:35.331295
[0m11:32:35.331729 [debug] [Thread-2  ]: On model.dbtlearm.dim_listings_with_hosts: Close
[0m11:32:35.700164 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb85f211-032c-4ac0-bc70-e2e2fda15679', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe24f60a580>]}
[0m11:32:35.700917 [info ] [Thread-2  ]: 4 of 5 OK created sql table model dev.dim_listings_with_hosts .................. [[32mSUCCESS 1[0m in 2.64s]
[0m11:32:35.701502 [debug] [Thread-2  ]: Finished running node model.dbtlearm.dim_listings_with_hosts
[0m11:32:39.167164 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 4 seconds
[0m11:32:39.171072 [debug] [Thread-3  ]: Timing info for model.dbtlearm.mart_fullmoon_review (execute): 2023-02-25 11:32:34.739585 => 2023-02-25 11:32:39.171004
[0m11:32:39.171429 [debug] [Thread-3  ]: On model.dbtlearm.mart_fullmoon_review: Close
[0m11:32:39.410823 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb85f211-032c-4ac0-bc70-e2e2fda15679', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe24f5c4ca0>]}
[0m11:32:39.411576 [info ] [Thread-3  ]: 5 of 5 OK created sql table model dev.mart_fullmoon_review ..................... [[32mSUCCESS 1[0m in 4.68s]
[0m11:32:39.412133 [debug] [Thread-3  ]: Finished running node model.dbtlearm.mart_fullmoon_review
[0m11:32:39.414378 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:32:39.415108 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:32:39.415389 [debug] [MainThread]: Connection 'model.dbtlearm.dim_hosts_cleansed' was properly closed.
[0m11:32:39.415632 [debug] [MainThread]: Connection 'model.dbtlearm.dim_listings_with_hosts' was properly closed.
[0m11:32:39.415868 [debug] [MainThread]: Connection 'model.dbtlearm.mart_fullmoon_review' was properly closed.
[0m11:32:39.416100 [debug] [MainThread]: Connection 'model.dbtlearm.fct_reviews' was properly closed.
[0m11:32:39.416409 [info ] [MainThread]: 
[0m11:32:39.416776 [info ] [MainThread]: Finished running 2 view models, 1 incremental model, 2 table models in 0 hours 0 minutes and 11.69 seconds (11.69s).
[0m11:32:39.417416 [debug] [MainThread]: Command end result
[0m11:32:39.426782 [info ] [MainThread]: 
[0m11:32:39.427245 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:32:39.427602 [info ] [MainThread]: 
[0m11:32:39.427934 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m11:32:39.428485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe24f517ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe24e6917f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe24e6912b0>]}
[0m11:32:39.428912 [debug] [MainThread]: Flushing usage events


============================== 2023-02-25 11:39:08.598196 | 0480632f-925a-4650-b15c-3ca326793f34 ==============================
[0m11:39:08.598196 [info ] [MainThread]: Running with dbt=1.4.1
[0m11:39:08.601627 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/mramirez/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
[0m11:39:08.601967 [debug] [MainThread]: Tracking: tracking
[0m11:39:08.602800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd799b05100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd799b05df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd799b05d00>]}
[0m11:39:08.694776 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 3 files changed.
[0m11:39:08.695276 [debug] [MainThread]: Partial parsing: added file: dbtlearm://models/sources.yml
[0m11:39:08.695660 [debug] [MainThread]: Partial parsing: updated file: dbtlearm://models/src/src_listings.sql
[0m11:39:08.695990 [debug] [MainThread]: Partial parsing: updated file: dbtlearm://models/src/src_reviews.sql
[0m11:39:08.696350 [debug] [MainThread]: Partial parsing: updated file: dbtlearm://models/src/src_host.sql
[0m11:39:08.716080 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m11:39:08.731708 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m11:39:08.735352 [debug] [MainThread]: 1699: static parser successfully parsed src/src_host.sql
[0m11:39:08.766181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0480632f-925a-4650-b15c-3ca326793f34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd799d2b0d0>]}
[0m11:39:08.774895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0480632f-925a-4650-b15c-3ca326793f34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd799c63d60>]}
[0m11:39:08.775345 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 304 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m11:39:08.775688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0480632f-925a-4650-b15c-3ca326793f34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd799c63be0>]}
[0m11:39:08.777496 [info ] [MainThread]: 
[0m11:39:08.779299 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:39:08.780772 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m11:39:08.796542 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m11:39:08.797306 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m11:39:08.798002 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:39:10.555139 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2 seconds
[0m11:39:10.557630 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m11:39:10.840049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0480632f-925a-4650-b15c-3ca326793f34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd799af4580>]}
[0m11:39:10.841012 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:39:10.841399 [info ] [MainThread]: 
[0m11:39:10.848366 [debug] [Thread-1  ]: Began running node model.dbtlearm.src_host
[0m11:39:10.848805 [debug] [Thread-2  ]: Began running node model.dbtlearm.src_listings
[0m11:39:10.849120 [debug] [Thread-3  ]: Began running node model.dbtlearm.src_reviews
[0m11:39:10.849464 [debug] [Thread-4  ]: Began running node seed.dbtlearm.seed_full_moon_dates
[0m11:39:10.850314 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearm.src_host'
[0m11:39:10.851008 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearm.src_listings'
[0m11:39:10.851703 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearm.src_reviews'
[0m11:39:10.852488 [debug] [Thread-4  ]: Acquiring new snowflake connection 'seed.dbtlearm.seed_full_moon_dates'
[0m11:39:10.852848 [debug] [Thread-1  ]: Began compiling node model.dbtlearm.src_host
[0m11:39:10.853197 [debug] [Thread-2  ]: Began compiling node model.dbtlearm.src_listings
[0m11:39:10.853533 [debug] [Thread-3  ]: Began compiling node model.dbtlearm.src_reviews
[0m11:39:10.853863 [debug] [Thread-4  ]: Began compiling node seed.dbtlearm.seed_full_moon_dates
[0m11:39:10.857144 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearm.src_host"
[0m11:39:10.860020 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearm.src_listings"
[0m11:39:10.863055 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearm.src_reviews"
[0m11:39:10.866876 [debug] [Thread-4  ]: Timing info for seed.dbtlearm.seed_full_moon_dates (compile): 2023-02-25 11:39:10.863401 => 2023-02-25 11:39:10.866775
[0m11:39:10.867678 [debug] [Thread-4  ]: Began executing node seed.dbtlearm.seed_full_moon_dates
[0m11:39:10.868083 [debug] [Thread-4  ]: Timing info for seed.dbtlearm.seed_full_moon_dates (execute): 2023-02-25 11:39:10.867996 => 2023-02-25 11:39:10.868021
[0m11:39:10.868600 [debug] [Thread-3  ]: Timing info for model.dbtlearm.src_reviews (compile): 2023-02-25 11:39:10.860287 => 2023-02-25 11:39:10.868528
[0m11:39:10.870501 [debug] [Thread-4  ]: Finished running node seed.dbtlearm.seed_full_moon_dates
[0m11:39:10.870744 [debug] [Thread-2  ]: Timing info for model.dbtlearm.src_listings (compile): 2023-02-25 11:39:10.857415 => 2023-02-25 11:39:10.870681
[0m11:39:10.870964 [debug] [Thread-1  ]: Timing info for model.dbtlearm.src_host (compile): 2023-02-25 11:39:10.854118 => 2023-02-25 11:39:10.870918
[0m11:39:10.871837 [debug] [Thread-3  ]: Finished running node model.dbtlearm.src_reviews
[0m11:39:10.872754 [debug] [Thread-2  ]: Finished running node model.dbtlearm.src_listings
[0m11:39:10.873488 [debug] [Thread-1  ]: Finished running node model.dbtlearm.src_host
[0m11:39:10.874080 [debug] [Thread-4  ]: Began running node model.dbtlearm.fct_reviews
[0m11:39:10.874723 [debug] [Thread-3  ]: Began running node model.dbtlearm.dim_listings_cleansed
[0m11:39:10.875279 [debug] [Thread-1  ]: Began running node model.dbtlearm.dim_hosts_cleansed
[0m11:39:10.875842 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtlearm.fct_reviews'
[0m11:39:10.876472 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearm.dim_listings_cleansed'
[0m11:39:10.877085 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearm.dim_hosts_cleansed'
[0m11:39:10.877407 [debug] [Thread-4  ]: Began compiling node model.dbtlearm.fct_reviews
[0m11:39:10.877717 [debug] [Thread-3  ]: Began compiling node model.dbtlearm.dim_listings_cleansed
[0m11:39:10.878035 [debug] [Thread-1  ]: Began compiling node model.dbtlearm.dim_hosts_cleansed
[0m11:39:10.893123 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearm.fct_reviews"
[0m11:39:10.902873 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearm.dim_listings_cleansed"
[0m11:39:10.909913 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearm.dim_hosts_cleansed"
[0m11:39:10.910915 [debug] [Thread-3  ]: Timing info for model.dbtlearm.dim_listings_cleansed (compile): 2023-02-25 11:39:10.893413 => 2023-02-25 11:39:10.910842
[0m11:39:10.911190 [debug] [Thread-4  ]: Timing info for model.dbtlearm.fct_reviews (compile): 2023-02-25 11:39:10.878332 => 2023-02-25 11:39:10.911130
[0m11:39:10.911447 [debug] [Thread-1  ]: Timing info for model.dbtlearm.dim_hosts_cleansed (compile): 2023-02-25 11:39:10.903193 => 2023-02-25 11:39:10.911387
[0m11:39:10.911707 [debug] [Thread-3  ]: Began executing node model.dbtlearm.dim_listings_cleansed
[0m11:39:10.912027 [debug] [Thread-4  ]: Began executing node model.dbtlearm.fct_reviews
[0m11:39:10.912327 [debug] [Thread-1  ]: Began executing node model.dbtlearm.dim_hosts_cleansed
[0m11:39:10.912621 [debug] [Thread-3  ]: Timing info for model.dbtlearm.dim_listings_cleansed (execute): 2023-02-25 11:39:10.912561 => 2023-02-25 11:39:10.912573
[0m11:39:10.912969 [debug] [Thread-4  ]: Timing info for model.dbtlearm.fct_reviews (execute): 2023-02-25 11:39:10.912898 => 2023-02-25 11:39:10.912910
[0m11:39:10.913261 [debug] [Thread-1  ]: Timing info for model.dbtlearm.dim_hosts_cleansed (execute): 2023-02-25 11:39:10.913203 => 2023-02-25 11:39:10.913212
[0m11:39:10.914021 [debug] [Thread-3  ]: Finished running node model.dbtlearm.dim_listings_cleansed
[0m11:39:10.914914 [debug] [Thread-4  ]: Finished running node model.dbtlearm.fct_reviews
[0m11:39:10.915712 [debug] [Thread-1  ]: Finished running node model.dbtlearm.dim_hosts_cleansed
[0m11:39:10.916436 [debug] [Thread-2  ]: Began running node model.dbtlearm.mart_fullmoon_review
[0m11:39:10.916931 [debug] [Thread-4  ]: Began running node model.dbtlearm.dim_listings_with_hosts
[0m11:39:10.917507 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearm.mart_fullmoon_review'
[0m11:39:10.918109 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtlearm.dim_listings_with_hosts'
[0m11:39:10.918428 [debug] [Thread-2  ]: Began compiling node model.dbtlearm.mart_fullmoon_review
[0m11:39:10.918715 [debug] [Thread-4  ]: Began compiling node model.dbtlearm.dim_listings_with_hosts
[0m11:39:10.922000 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearm.mart_fullmoon_review"
[0m11:39:10.924807 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearm.dim_listings_with_hosts"
[0m11:39:10.925755 [debug] [Thread-2  ]: Timing info for model.dbtlearm.mart_fullmoon_review (compile): 2023-02-25 11:39:10.918930 => 2023-02-25 11:39:10.925691
[0m11:39:10.926010 [debug] [Thread-4  ]: Timing info for model.dbtlearm.dim_listings_with_hosts (compile): 2023-02-25 11:39:10.922244 => 2023-02-25 11:39:10.925952
[0m11:39:10.926282 [debug] [Thread-2  ]: Began executing node model.dbtlearm.mart_fullmoon_review
[0m11:39:10.926572 [debug] [Thread-4  ]: Began executing node model.dbtlearm.dim_listings_with_hosts
[0m11:39:10.926840 [debug] [Thread-2  ]: Timing info for model.dbtlearm.mart_fullmoon_review (execute): 2023-02-25 11:39:10.926784 => 2023-02-25 11:39:10.926794
[0m11:39:10.927100 [debug] [Thread-4  ]: Timing info for model.dbtlearm.dim_listings_with_hosts (execute): 2023-02-25 11:39:10.927047 => 2023-02-25 11:39:10.927055
[0m11:39:10.927864 [debug] [Thread-2  ]: Finished running node model.dbtlearm.mart_fullmoon_review
[0m11:39:10.928555 [debug] [Thread-4  ]: Finished running node model.dbtlearm.dim_listings_with_hosts
[0m11:39:10.930047 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:39:10.930348 [debug] [MainThread]: Connection 'model.dbtlearm.dim_hosts_cleansed' was properly closed.
[0m11:39:10.930579 [debug] [MainThread]: Connection 'model.dbtlearm.mart_fullmoon_review' was properly closed.
[0m11:39:10.930791 [debug] [MainThread]: Connection 'model.dbtlearm.dim_listings_cleansed' was properly closed.
[0m11:39:10.931090 [debug] [MainThread]: Connection 'model.dbtlearm.dim_listings_with_hosts' was properly closed.
[0m11:39:10.931611 [debug] [MainThread]: Command end result
[0m11:39:10.939114 [info ] [MainThread]: Done.
[0m11:39:10.939543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd799b18c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd799ff64f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd79a015280>]}
[0m11:39:10.939872 [debug] [MainThread]: Flushing usage events


============================== 2023-02-25 11:42:49.108816 | 4720457c-a93d-4d92-8e55-371c3db751df ==============================
[0m11:42:49.108816 [info ] [MainThread]: Running with dbt=1.4.1
[0m11:42:49.111584 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/mramirez/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'source-freshness', 'rpc_method': 'source-freshness', 'indirect_selection': 'eager'}
[0m11:42:49.111901 [debug] [MainThread]: Tracking: tracking
[0m11:42:49.112434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe212b86100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe212b86df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe212b86d00>]}
[0m11:42:49.200045 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:42:49.200990 [debug] [MainThread]: Partial parsing: updated file: dbtlearm://models/sources.yml
[0m11:42:49.219047 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_with_hosts.sql
[0m11:42:49.235353 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m11:42:49.238705 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m11:42:49.242160 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m11:42:49.245525 [debug] [MainThread]: 1699: static parser successfully parsed src/src_host.sql
[0m11:42:49.248781 [debug] [MainThread]: 1699: static parser successfully parsed mart/mart_fullmoon_review.sql
[0m11:42:49.252295 [debug] [MainThread]: 1603: static parser failed on fct/fct_reviews.sql
[0m11:42:49.262542 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fct/fct_reviews.sql
[0m11:42:49.264078 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m11:42:49.295735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4720457c-a93d-4d92-8e55-371c3db751df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe212da8ee0>]}
[0m11:42:49.304078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4720457c-a93d-4d92-8e55-371c3db751df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe212d61760>]}
[0m11:42:49.304479 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 304 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m11:42:49.304810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4720457c-a93d-4d92-8e55-371c3db751df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe212bd0f10>]}
[0m11:42:49.306347 [info ] [MainThread]: 
[0m11:42:49.308169 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:42:49.309384 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m11:42:49.324350 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m11:42:49.324726 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m11:42:49.325012 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:42:50.965430 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2 seconds
[0m11:42:50.967935 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m11:42:51.223311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4720457c-a93d-4d92-8e55-371c3db751df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe212d4dac0>]}
[0m11:42:51.224270 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:42:51.224649 [info ] [MainThread]: 
[0m11:42:51.230950 [debug] [Thread-1  ]: Began running node source.dbtlearm.airbnb.reviews
[0m11:42:51.231336 [info ] [Thread-1  ]: 1 of 1 START freshness of airbnb.reviews ....................................... [RUN]
[0m11:42:51.232165 [debug] [Thread-1  ]: Acquiring new snowflake connection 'source.dbtlearm.airbnb.reviews'
[0m11:42:51.232499 [debug] [Thread-1  ]: Began compiling node source.dbtlearm.airbnb.reviews
[0m11:42:51.232819 [debug] [Thread-1  ]: Timing info for source.dbtlearm.airbnb.reviews (compile): 2023-02-25 11:42:51.232744 => 2023-02-25 11:42:51.232750
[0m11:42:51.233131 [debug] [Thread-1  ]: Began executing node source.dbtlearm.airbnb.reviews
[0m11:42:51.233819 [debug] [Thread-1  ]: Acquiring new snowflake connection 'source.dbtlearm.airbnb.reviews'
[0m11:42:51.245098 [debug] [Thread-1  ]: Using snowflake connection "source.dbtlearm.airbnb.reviews"
[0m11:42:51.245439 [debug] [Thread-1  ]: On source.dbtlearm.airbnb.reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "source.dbtlearm.airbnb.reviews"} */
select
      max(date) as max_loaded_at,
      convert_timezone('UTC', current_timestamp()) as snapshotted_at
    from airbnb.raw.raw_reviews
[0m11:42:51.245702 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:42:52.971178 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2 seconds
[0m11:42:52.984099 [debug] [Thread-1  ]: On source.dbtlearm.airbnb.reviews: Close
[0m11:42:53.227892 [debug] [Thread-1  ]: Timing info for source.dbtlearm.airbnb.reviews (execute): 2023-02-25 11:42:51.233359 => 2023-02-25 11:42:53.227787
[0m11:42:53.228905 [error] [Thread-1  ]: 1 of 1 ERROR STALE freshness of airbnb.reviews ................................. [[31mERROR STALE[0m in 2.00s]
[0m11:42:53.230697 [debug] [Thread-1  ]: Finished running node source.dbtlearm.airbnb.reviews
[0m11:42:53.231949 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:42:53.232240 [debug] [MainThread]: Connection 'source.dbtlearm.airbnb.reviews' was properly closed.
[0m11:42:53.240654 [info ] [MainThread]: 
[0m11:42:53.241085 [info ] [MainThread]: Done.
[0m11:42:53.241497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe212d77250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe212b1ed60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe212d64130>]}
[0m11:42:53.241855 [debug] [MainThread]: Flushing usage events


============================== 2023-02-26 11:26:45.543021 | 21ba7d32-8fff-4c7c-879b-d695a57618c9 ==============================
[0m11:26:45.543021 [info ] [MainThread]: Running with dbt=1.4.1
[0m11:26:45.545588 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/mramirez/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'snapshot', 'rpc_method': 'snapshot', 'indirect_selection': 'eager'}
[0m11:26:45.545884 [debug] [MainThread]: Tracking: tracking
[0m11:26:45.546457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe508c47100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe508c47df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe508c47d00>]}
[0m11:26:45.807721 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m11:26:45.808208 [debug] [MainThread]: Partial parsing: added file: dbtlearm://snapshots/scd_raw_listings.sql
[0m11:26:45.808653 [debug] [MainThread]: Partial parsing: updated file: dbtlearm://models/sources.yml
[0m11:26:45.866510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '21ba7d32-8fff-4c7c-879b-d695a57618c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe508e659a0>]}
[0m11:26:45.883375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '21ba7d32-8fff-4c7c-879b-d695a57618c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe508c62760>]}
[0m11:26:45.883855 [info ] [MainThread]: Found 8 models, 0 tests, 1 snapshot, 0 analyses, 304 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m11:26:45.884221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21ba7d32-8fff-4c7c-879b-d695a57618c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe508c62460>]}
[0m11:26:45.885910 [info ] [MainThread]: 
[0m11:26:45.887699 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:26:45.888799 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb'
[0m11:26:45.906579 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m11:26:45.906951 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m11:26:45.907232 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:26:48.657167 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 3 seconds
[0m11:26:48.659574 [debug] [ThreadPool]: On list_airbnb: Close
[0m11:26:48.907519 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m11:26:48.916462 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m11:26:48.916834 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m11:26:48.917123 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:26:49.927676 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1 seconds
[0m11:26:49.929914 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m11:26:50.191819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21ba7d32-8fff-4c7c-879b-d695a57618c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe508ca2880>]}
[0m11:26:50.192811 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:26:50.193231 [info ] [MainThread]: 
[0m11:26:50.205224 [debug] [Thread-1  ]: Began running node snapshot.dbtlearm.scd_raw_listings
[0m11:26:50.205721 [info ] [Thread-1  ]: 1 of 1 START snapshot dev.scd_raw_listings ..................................... [RUN]
[0m11:26:50.206497 [debug] [Thread-1  ]: Acquiring new snowflake connection 'snapshot.dbtlearm.scd_raw_listings'
[0m11:26:50.206823 [debug] [Thread-1  ]: Began compiling node snapshot.dbtlearm.scd_raw_listings
[0m11:26:50.210840 [debug] [Thread-1  ]: Timing info for snapshot.dbtlearm.scd_raw_listings (compile): 2023-02-26 11:26:50.207065 => 2023-02-26 11:26:50.210761
[0m11:26:50.211197 [debug] [Thread-1  ]: Began executing node snapshot.dbtlearm.scd_raw_listings
[0m11:26:50.279401 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.dbtlearm.scd_raw_listings"
[0m11:26:50.281080 [debug] [Thread-1  ]: Using snowflake connection "snapshot.dbtlearm.scd_raw_listings"
[0m11:26:50.281317 [debug] [Thread-1  ]: On snapshot.dbtlearm.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "snapshot.dbtlearm.scd_raw_listings"} */
create or replace transient table airbnb.dev.scd_raw_listings  as
        (

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        nullif(updated_at, updated_at) as dbt_valid_to
    from (
        



SELECT * FROM airbnb.raw.raw_listings

    ) sbq



        );
[0m11:26:50.281506 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:26:52.744750 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2 seconds
[0m11:26:52.775376 [debug] [Thread-1  ]: Timing info for snapshot.dbtlearm.scd_raw_listings (execute): 2023-02-26 11:26:50.211437 => 2023-02-26 11:26:52.775314
[0m11:26:52.775767 [debug] [Thread-1  ]: On snapshot.dbtlearm.scd_raw_listings: Close
[0m11:26:53.028363 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21ba7d32-8fff-4c7c-879b-d695a57618c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5091fb040>]}
[0m11:26:53.029128 [info ] [Thread-1  ]: 1 of 1 OK snapshotted dev.scd_raw_listings ..................................... [[32msuccess[0m in 2.82s]
[0m11:26:53.031620 [debug] [Thread-1  ]: Finished running node snapshot.dbtlearm.scd_raw_listings
[0m11:26:53.033329 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:26:53.033960 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:26:53.034223 [debug] [MainThread]: Connection 'snapshot.dbtlearm.scd_raw_listings' was properly closed.
[0m11:26:53.034490 [info ] [MainThread]: 
[0m11:26:53.034840 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 7.15 seconds (7.15s).
[0m11:26:53.035290 [debug] [MainThread]: Command end result
[0m11:26:53.049426 [info ] [MainThread]: 
[0m11:26:53.049913 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:26:53.050282 [info ] [MainThread]: 
[0m11:26:53.050632 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:26:53.051191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe508c47430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5091e2640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5091e2100>]}
[0m11:26:53.051551 [debug] [MainThread]: Flushing usage events


============================== 2023-02-26 11:29:44.782411 | 41b9bd28-eb70-420a-855a-d24bc0e6f9ce ==============================
[0m11:29:44.782411 [info ] [MainThread]: Running with dbt=1.4.1
[0m11:29:44.785256 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/mramirez/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'snapshot', 'rpc_method': 'snapshot', 'indirect_selection': 'eager'}
[0m11:29:44.785553 [debug] [MainThread]: Tracking: tracking
[0m11:29:44.786254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc50bb08100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc50bb08df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc50bb08d00>]}
[0m11:29:44.883655 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:29:44.883969 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:29:44.894731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '41b9bd28-eb70-420a-855a-d24bc0e6f9ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc50bcc70d0>]}
[0m11:29:44.904036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '41b9bd28-eb70-420a-855a-d24bc0e6f9ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc50bbe72b0>]}
[0m11:29:44.904448 [info ] [MainThread]: Found 8 models, 0 tests, 1 snapshot, 0 analyses, 304 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m11:29:44.904801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41b9bd28-eb70-420a-855a-d24bc0e6f9ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc50bbe70a0>]}
[0m11:29:44.906354 [info ] [MainThread]: 
[0m11:29:44.908065 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:29:44.909199 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb'
[0m11:29:44.926571 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m11:29:44.926972 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m11:29:44.927264 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:29:46.247415 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1 seconds
[0m11:29:46.249866 [debug] [ThreadPool]: On list_airbnb: Close
[0m11:29:46.503438 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m11:29:46.512049 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m11:29:46.512442 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m11:29:46.512783 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:29:47.915564 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1 seconds
[0m11:29:47.917878 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m11:29:48.212249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41b9bd28-eb70-420a-855a-d24bc0e6f9ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc50bb087f0>]}
[0m11:29:48.213305 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:29:48.213697 [info ] [MainThread]: 
[0m11:29:48.222309 [debug] [Thread-1  ]: Began running node snapshot.dbtlearm.scd_raw_listings
[0m11:29:48.223119 [info ] [Thread-1  ]: 1 of 1 START snapshot dev.scd_raw_listings ..................................... [RUN]
[0m11:29:48.223897 [debug] [Thread-1  ]: Acquiring new snowflake connection 'snapshot.dbtlearm.scd_raw_listings'
[0m11:29:48.224246 [debug] [Thread-1  ]: Began compiling node snapshot.dbtlearm.scd_raw_listings
[0m11:29:48.276045 [debug] [Thread-1  ]: Timing info for snapshot.dbtlearm.scd_raw_listings (compile): 2023-02-26 11:29:48.224503 => 2023-02-26 11:29:48.275929
[0m11:29:48.276573 [debug] [Thread-1  ]: Began executing node snapshot.dbtlearm.scd_raw_listings
[0m11:29:48.348248 [debug] [Thread-1  ]: Using snowflake connection "snapshot.dbtlearm.scd_raw_listings"
[0m11:29:48.348629 [debug] [Thread-1  ]: On snapshot.dbtlearm.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "snapshot.dbtlearm.scd_raw_listings"} */
describe table "AIRBNB"."DEV"."SCD_RAW_LISTINGS"
[0m11:29:48.348885 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:29:49.803114 [debug] [Thread-1  ]: SQL status: SUCCESS 13 in 1 seconds
[0m11:29:49.846939 [debug] [Thread-1  ]: Using snowflake connection "snapshot.dbtlearm.scd_raw_listings"
[0m11:29:49.847301 [debug] [Thread-1  ]: On snapshot.dbtlearm.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "snapshot.dbtlearm.scd_raw_listings"} */
create or replace temporary table "AIRBNB"."DEV"."SCD_RAW_LISTINGS__dbt_tmp"  as
        (with snapshot_query as (

        



SELECT * FROM airbnb.raw.raw_listings


    ),

    snapshotted_data as (

        select *,
            id as dbt_unique_key

        from "AIRBNB"."DEV"."SCD_RAW_LISTINGS"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            id as dbt_unique_key,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            nullif(updated_at, updated_at) as dbt_valid_to,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            id as dbt_unique_key,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            id as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.updated_at)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m11:29:51.538305 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2 seconds
[0m11:29:51.541693 [debug] [Thread-1  ]: Using snowflake connection "snapshot.dbtlearm.scd_raw_listings"
[0m11:29:51.541981 [debug] [Thread-1  ]: On snapshot.dbtlearm.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "snapshot.dbtlearm.scd_raw_listings"} */
describe table "AIRBNB"."DEV"."SCD_RAW_LISTINGS__dbt_tmp"
[0m11:29:51.818475 [debug] [Thread-1  ]: SQL status: SUCCESS 15 in 0 seconds
[0m11:29:51.824941 [debug] [Thread-1  ]: Using snowflake connection "snapshot.dbtlearm.scd_raw_listings"
[0m11:29:51.825269 [debug] [Thread-1  ]: On snapshot.dbtlearm.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "snapshot.dbtlearm.scd_raw_listings"} */
describe table "AIRBNB"."DEV"."SCD_RAW_LISTINGS"
[0m11:29:51.974445 [debug] [Thread-1  ]: SQL status: SUCCESS 13 in 0 seconds
[0m11:29:51.980124 [debug] [Thread-1  ]: Using snowflake connection "snapshot.dbtlearm.scd_raw_listings"
[0m11:29:51.980457 [debug] [Thread-1  ]: On snapshot.dbtlearm.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "snapshot.dbtlearm.scd_raw_listings"} */
describe table "AIRBNB"."DEV"."SCD_RAW_LISTINGS__dbt_tmp"
[0m11:29:52.132976 [debug] [Thread-1  ]: SQL status: SUCCESS 15 in 0 seconds
[0m11:29:52.138471 [debug] [Thread-1  ]: Using snowflake connection "snapshot.dbtlearm.scd_raw_listings"
[0m11:29:52.138756 [debug] [Thread-1  ]: On snapshot.dbtlearm.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "snapshot.dbtlearm.scd_raw_listings"} */
describe table "AIRBNB"."DEV"."SCD_RAW_LISTINGS"
[0m11:29:52.301475 [debug] [Thread-1  ]: SQL status: SUCCESS 13 in 0 seconds
[0m11:29:52.311357 [debug] [Thread-1  ]: Using snowflake connection "snapshot.dbtlearm.scd_raw_listings"
[0m11:29:52.311710 [debug] [Thread-1  ]: On snapshot.dbtlearm.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "snapshot.dbtlearm.scd_raw_listings"} */
describe table "AIRBNB"."DEV"."SCD_RAW_LISTINGS__dbt_tmp"
[0m11:29:52.439282 [debug] [Thread-1  ]: SQL status: SUCCESS 15 in 0 seconds
[0m11:29:52.452295 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.dbtlearm.scd_raw_listings"
[0m11:29:52.454409 [debug] [Thread-1  ]: Using snowflake connection "snapshot.dbtlearm.scd_raw_listings"
[0m11:29:52.454693 [debug] [Thread-1  ]: On snapshot.dbtlearm.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "snapshot.dbtlearm.scd_raw_listings"} */
BEGIN
[0m11:29:52.659782 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m11:29:52.660511 [debug] [Thread-1  ]: Using snowflake connection "snapshot.dbtlearm.scd_raw_listings"
[0m11:29:52.660948 [debug] [Thread-1  ]: On snapshot.dbtlearm.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "snapshot.dbtlearm.scd_raw_listings"} */
merge into "AIRBNB"."DEV"."SCD_RAW_LISTINGS" as DBT_INTERNAL_DEST
    using "AIRBNB"."DEV"."SCD_RAW_LISTINGS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     and DBT_INTERNAL_DEST.dbt_valid_to is null
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("ID", "LISTING_URL", "NAME", "ROOM_TYPE", "MINIMUM_NIGHTS", "HOST_ID", "PRICE", "CREATED_AT", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("ID", "LISTING_URL", "NAME", "ROOM_TYPE", "MINIMUM_NIGHTS", "HOST_ID", "PRICE", "CREATED_AT", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m11:29:53.732785 [debug] [Thread-1  ]: SQL status: SUCCESS 2 in 1 seconds
[0m11:29:53.733465 [debug] [Thread-1  ]: Using snowflake connection "snapshot.dbtlearm.scd_raw_listings"
[0m11:29:53.733855 [debug] [Thread-1  ]: On snapshot.dbtlearm.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "snapshot.dbtlearm.scd_raw_listings"} */
COMMIT
[0m11:29:54.106666 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m11:29:54.135904 [debug] [Thread-1  ]: Timing info for snapshot.dbtlearm.scd_raw_listings (execute): 2023-02-26 11:29:48.276875 => 2023-02-26 11:29:54.135839
[0m11:29:54.136264 [debug] [Thread-1  ]: On snapshot.dbtlearm.scd_raw_listings: Close
[0m11:29:54.387884 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41b9bd28-eb70-420a-855a-d24bc0e6f9ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc50be8c490>]}
[0m11:29:54.388634 [info ] [Thread-1  ]: 1 of 1 OK snapshotted dev.scd_raw_listings ..................................... [[32msuccess[0m in 6.16s]
[0m11:29:54.390593 [debug] [Thread-1  ]: Finished running node snapshot.dbtlearm.scd_raw_listings
[0m11:29:54.392606 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:29:54.393363 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:29:54.393664 [debug] [MainThread]: Connection 'snapshot.dbtlearm.scd_raw_listings' was properly closed.
[0m11:29:54.393961 [info ] [MainThread]: 
[0m11:29:54.394333 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 9.49 seconds (9.49s).
[0m11:29:54.394950 [debug] [MainThread]: Command end result
[0m11:29:54.403596 [info ] [MainThread]: 
[0m11:29:54.404033 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:29:54.404393 [info ] [MainThread]: 
[0m11:29:54.404741 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:29:54.405160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc50c0da040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc50ae46a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc50c062190>]}
[0m11:29:54.405517 [debug] [MainThread]: Flushing usage events


============================== 2023-02-26 11:32:35.455415 | 3bff732c-62e2-4c33-b48d-6d6b69d31d23 ==============================
[0m11:32:35.455415 [info ] [MainThread]: Running with dbt=1.4.1
[0m11:32:35.457683 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/mramirez/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'snapshot', 'rpc_method': 'snapshot', 'indirect_selection': 'eager'}
[0m11:32:35.457931 [debug] [MainThread]: Tracking: tracking
[0m11:32:35.458366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82cfc47100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82cfc47df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82cfc47d00>]}
[0m11:32:35.539003 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m11:32:35.539432 [debug] [MainThread]: Partial parsing: added file: dbtlearm://snapshots/scd_raw_hosts.sql
[0m11:32:35.577648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3bff732c-62e2-4c33-b48d-6d6b69d31d23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82cfded970>]}
[0m11:32:35.584959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3bff732c-62e2-4c33-b48d-6d6b69d31d23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82cfdcaf10>]}
[0m11:32:35.585353 [info ] [MainThread]: Found 8 models, 0 tests, 2 snapshots, 0 analyses, 304 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m11:32:35.585635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3bff732c-62e2-4c33-b48d-6d6b69d31d23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82cfdcae50>]}
[0m11:32:35.586945 [info ] [MainThread]: 
[0m11:32:35.588360 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:32:35.589277 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb'
[0m11:32:35.604306 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m11:32:35.604638 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m11:32:35.604905 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:32:37.138382 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2 seconds
[0m11:32:37.140631 [debug] [ThreadPool]: On list_airbnb: Close
[0m11:32:37.383477 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m11:32:37.392107 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m11:32:37.392610 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m11:32:37.392983 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:32:38.766055 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1 seconds
[0m11:32:38.768617 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m11:32:38.992791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3bff732c-62e2-4c33-b48d-6d6b69d31d23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82cfded100>]}
[0m11:32:38.993768 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:32:38.994177 [info ] [MainThread]: 
[0m11:32:39.000726 [debug] [Thread-1  ]: Began running node snapshot.dbtlearm.scd_raw_hosts
[0m11:32:39.001188 [debug] [Thread-2  ]: Began running node snapshot.dbtlearm.scd_raw_listings
[0m11:32:39.001571 [info ] [Thread-1  ]: 1 of 2 START snapshot dev.scd_raw_hosts ........................................ [RUN]
[0m11:32:39.002073 [info ] [Thread-2  ]: 2 of 2 START snapshot dev.scd_raw_listings ..................................... [RUN]
[0m11:32:39.002837 [debug] [Thread-1  ]: Acquiring new snowflake connection 'snapshot.dbtlearm.scd_raw_hosts'
[0m11:32:39.003489 [debug] [Thread-2  ]: Acquiring new snowflake connection 'snapshot.dbtlearm.scd_raw_listings'
[0m11:32:39.003832 [debug] [Thread-1  ]: Began compiling node snapshot.dbtlearm.scd_raw_hosts
[0m11:32:39.004192 [debug] [Thread-2  ]: Began compiling node snapshot.dbtlearm.scd_raw_listings
[0m11:32:39.008160 [debug] [Thread-1  ]: Timing info for snapshot.dbtlearm.scd_raw_hosts (compile): 2023-02-26 11:32:39.004463 => 2023-02-26 11:32:39.008080
[0m11:32:39.011871 [debug] [Thread-2  ]: Timing info for snapshot.dbtlearm.scd_raw_listings (compile): 2023-02-26 11:32:39.008440 => 2023-02-26 11:32:39.011803
[0m11:32:39.012275 [debug] [Thread-1  ]: Began executing node snapshot.dbtlearm.scd_raw_hosts
[0m11:32:39.012627 [debug] [Thread-2  ]: Began executing node snapshot.dbtlearm.scd_raw_listings
[0m11:32:39.119668 [debug] [Thread-2  ]: Using snowflake connection "snapshot.dbtlearm.scd_raw_listings"
[0m11:32:39.119958 [debug] [Thread-2  ]: On snapshot.dbtlearm.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "snapshot.dbtlearm.scd_raw_listings"} */
describe table "AIRBNB"."DEV"."SCD_RAW_LISTINGS"
[0m11:32:39.120448 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.dbtlearm.scd_raw_hosts"
[0m11:32:39.120614 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m11:32:39.122797 [debug] [Thread-1  ]: Using snowflake connection "snapshot.dbtlearm.scd_raw_hosts"
[0m11:32:39.123552 [debug] [Thread-1  ]: On snapshot.dbtlearm.scd_raw_hosts: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "snapshot.dbtlearm.scd_raw_hosts"} */
create or replace transient table airbnb.dev.scd_raw_hosts  as
        (

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        nullif(updated_at, updated_at) as dbt_valid_to
    from (
        



SELECT * FROM airbnb.raw.raw_hosts

    ) sbq



        );
[0m11:32:39.123760 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:32:40.153308 [debug] [Thread-2  ]: SQL status: SUCCESS 13 in 1 seconds
[0m11:32:40.183148 [debug] [Thread-2  ]: Using snowflake connection "snapshot.dbtlearm.scd_raw_listings"
[0m11:32:40.183455 [debug] [Thread-2  ]: On snapshot.dbtlearm.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "snapshot.dbtlearm.scd_raw_listings"} */
create or replace temporary table "AIRBNB"."DEV"."SCD_RAW_LISTINGS__dbt_tmp"  as
        (with snapshot_query as (

        



SELECT * FROM airbnb.raw.raw_listings


    ),

    snapshotted_data as (

        select *,
            id as dbt_unique_key

        from "AIRBNB"."DEV"."SCD_RAW_LISTINGS"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            id as dbt_unique_key,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            nullif(updated_at, updated_at) as dbt_valid_to,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            id as dbt_unique_key,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            id as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.updated_at)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m11:32:41.113434 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1 seconds
[0m11:32:41.117676 [debug] [Thread-2  ]: Using snowflake connection "snapshot.dbtlearm.scd_raw_listings"
[0m11:32:41.118004 [debug] [Thread-2  ]: On snapshot.dbtlearm.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "snapshot.dbtlearm.scd_raw_listings"} */
describe table "AIRBNB"."DEV"."SCD_RAW_LISTINGS__dbt_tmp"
[0m11:32:41.300919 [debug] [Thread-2  ]: SQL status: SUCCESS 15 in 0 seconds
[0m11:32:41.306550 [debug] [Thread-2  ]: Using snowflake connection "snapshot.dbtlearm.scd_raw_listings"
[0m11:32:41.306938 [debug] [Thread-2  ]: On snapshot.dbtlearm.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "snapshot.dbtlearm.scd_raw_listings"} */
describe table "AIRBNB"."DEV"."SCD_RAW_LISTINGS"
[0m11:32:41.476693 [debug] [Thread-2  ]: SQL status: SUCCESS 13 in 0 seconds
[0m11:32:41.482385 [debug] [Thread-2  ]: Using snowflake connection "snapshot.dbtlearm.scd_raw_listings"
[0m11:32:41.482694 [debug] [Thread-2  ]: On snapshot.dbtlearm.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "snapshot.dbtlearm.scd_raw_listings"} */
describe table "AIRBNB"."DEV"."SCD_RAW_LISTINGS__dbt_tmp"
[0m11:32:41.621686 [debug] [Thread-2  ]: SQL status: SUCCESS 15 in 0 seconds
[0m11:32:41.627527 [debug] [Thread-2  ]: Using snowflake connection "snapshot.dbtlearm.scd_raw_listings"
[0m11:32:41.627821 [debug] [Thread-2  ]: On snapshot.dbtlearm.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "snapshot.dbtlearm.scd_raw_listings"} */
describe table "AIRBNB"."DEV"."SCD_RAW_LISTINGS"
[0m11:32:41.833816 [debug] [Thread-2  ]: SQL status: SUCCESS 13 in 0 seconds
[0m11:32:41.844300 [debug] [Thread-2  ]: Using snowflake connection "snapshot.dbtlearm.scd_raw_listings"
[0m11:32:41.844645 [debug] [Thread-2  ]: On snapshot.dbtlearm.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "snapshot.dbtlearm.scd_raw_listings"} */
describe table "AIRBNB"."DEV"."SCD_RAW_LISTINGS__dbt_tmp"
[0m11:32:41.993495 [debug] [Thread-2  ]: SQL status: SUCCESS 15 in 0 seconds
[0m11:32:42.005543 [debug] [Thread-2  ]: Writing runtime sql for node "snapshot.dbtlearm.scd_raw_listings"
[0m11:32:42.007428 [debug] [Thread-2  ]: Using snowflake connection "snapshot.dbtlearm.scd_raw_listings"
[0m11:32:42.007703 [debug] [Thread-2  ]: On snapshot.dbtlearm.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "snapshot.dbtlearm.scd_raw_listings"} */
BEGIN
[0m11:32:42.171656 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m11:32:42.172310 [debug] [Thread-2  ]: Using snowflake connection "snapshot.dbtlearm.scd_raw_listings"
[0m11:32:42.172699 [debug] [Thread-2  ]: On snapshot.dbtlearm.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "snapshot.dbtlearm.scd_raw_listings"} */
merge into "AIRBNB"."DEV"."SCD_RAW_LISTINGS" as DBT_INTERNAL_DEST
    using "AIRBNB"."DEV"."SCD_RAW_LISTINGS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     and DBT_INTERNAL_DEST.dbt_valid_to is null
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("ID", "LISTING_URL", "NAME", "ROOM_TYPE", "MINIMUM_NIGHTS", "HOST_ID", "PRICE", "CREATED_AT", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("ID", "LISTING_URL", "NAME", "ROOM_TYPE", "MINIMUM_NIGHTS", "HOST_ID", "PRICE", "CREATED_AT", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m11:32:42.508442 [debug] [Thread-2  ]: SQL status: SUCCESS 0 in 0 seconds
[0m11:32:42.509084 [debug] [Thread-2  ]: Using snowflake connection "snapshot.dbtlearm.scd_raw_listings"
[0m11:32:42.509462 [debug] [Thread-2  ]: On snapshot.dbtlearm.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "snapshot.dbtlearm.scd_raw_listings"} */
COMMIT
[0m11:32:42.746687 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m11:32:42.775671 [debug] [Thread-2  ]: Timing info for snapshot.dbtlearm.scd_raw_listings (execute): 2023-02-26 11:32:39.034615 => 2023-02-26 11:32:42.775609
[0m11:32:42.776022 [debug] [Thread-2  ]: On snapshot.dbtlearm.scd_raw_listings: Close
[0m11:32:43.071060 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3bff732c-62e2-4c33-b48d-6d6b69d31d23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82d0125b50>]}
[0m11:32:43.071828 [info ] [Thread-2  ]: 2 of 2 OK snapshotted dev.scd_raw_listings ..................................... [[32msuccess[0m in 4.07s]
[0m11:32:43.073809 [debug] [Thread-2  ]: Finished running node snapshot.dbtlearm.scd_raw_listings
[0m11:32:45.620436 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 6 seconds
[0m11:32:45.628726 [debug] [Thread-1  ]: Timing info for snapshot.dbtlearm.scd_raw_hosts (execute): 2023-02-26 11:32:39.012877 => 2023-02-26 11:32:45.628662
[0m11:32:45.629066 [debug] [Thread-1  ]: On snapshot.dbtlearm.scd_raw_hosts: Close
[0m11:32:45.870648 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3bff732c-62e2-4c33-b48d-6d6b69d31d23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82d0094130>]}
[0m11:32:45.871395 [info ] [Thread-1  ]: 1 of 2 OK snapshotted dev.scd_raw_hosts ........................................ [[32msuccess[0m in 6.87s]
[0m11:32:45.871941 [debug] [Thread-1  ]: Finished running node snapshot.dbtlearm.scd_raw_hosts
[0m11:32:45.873755 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:32:45.874573 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:32:45.874852 [debug] [MainThread]: Connection 'snapshot.dbtlearm.scd_raw_hosts' was properly closed.
[0m11:32:45.875091 [debug] [MainThread]: Connection 'snapshot.dbtlearm.scd_raw_listings' was properly closed.
[0m11:32:45.875374 [info ] [MainThread]: 
[0m11:32:45.875738 [info ] [MainThread]: Finished running 2 snapshots in 0 hours 0 minutes and 10.29 seconds (10.29s).
[0m11:32:45.876399 [debug] [MainThread]: Command end result
[0m11:32:45.885980 [info ] [MainThread]: 
[0m11:32:45.886413 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:32:45.886766 [info ] [MainThread]: 
[0m11:32:45.887107 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m11:32:45.887520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82d000a760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82d00e19d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82d00e1ac0>]}
[0m11:32:45.887873 [debug] [MainThread]: Flushing usage events


============================== 2023-02-27 13:25:54.120704 | f0ee72d5-c0b8-4e52-a313-fa9300193faa ==============================
[0m13:25:54.120704 [info ] [MainThread]: Running with dbt=1.4.1
[0m13:25:54.123416 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/mramirez/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m13:25:54.123722 [debug] [MainThread]: Tracking: tracking
[0m13:25:54.124274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd156c47100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd156c47df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd156c47d00>]}
[0m13:25:54.395399 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m13:25:54.395958 [debug] [MainThread]: Partial parsing: added file: dbtlearm://models/schema.yml
[0m13:25:54.450469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f0ee72d5-c0b8-4e52-a313-fa9300193faa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd156e15fa0>]}
[0m13:25:54.466873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f0ee72d5-c0b8-4e52-a313-fa9300193faa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd156dcbfa0>]}
[0m13:25:54.467400 [info ] [MainThread]: Found 8 models, 2 tests, 2 snapshots, 0 analyses, 304 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m13:25:54.467779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0ee72d5-c0b8-4e52-a313-fa9300193faa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd156dcbfd0>]}
[0m13:25:54.469546 [info ] [MainThread]: 
[0m13:25:54.471310 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:25:54.472827 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m13:25:54.489417 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m13:25:54.489802 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m13:25:54.490182 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:25:57.240409 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 3 seconds
[0m13:25:57.243240 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m13:25:57.538628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0ee72d5-c0b8-4e52-a313-fa9300193faa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd156dcbe80>]}
[0m13:25:57.539630 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:25:57.540005 [info ] [MainThread]: 
[0m13:25:57.552822 [debug] [Thread-1  ]: Began running node test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m13:25:57.553199 [debug] [Thread-2  ]: Began running node test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m13:25:57.553567 [info ] [Thread-1  ]: 1 of 2 START test not_null_dim_listings_cleansed_listing_id .................... [RUN]
[0m13:25:57.554008 [info ] [Thread-2  ]: 2 of 2 START test unique_dim_listings_cleansed_listing_id ...................... [RUN]
[0m13:25:57.554788 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9'
[0m13:25:57.555416 [debug] [Thread-2  ]: Acquiring new snowflake connection 'test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e'
[0m13:25:57.555749 [debug] [Thread-1  ]: Began compiling node test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m13:25:57.556061 [debug] [Thread-2  ]: Began compiling node test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m13:25:57.571970 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m13:25:57.579959 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m13:25:57.581195 [debug] [Thread-2  ]: Timing info for test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e (compile): 2023-02-27 13:25:57.572269 => 2023-02-27 13:25:57.581102
[0m13:25:57.581484 [debug] [Thread-1  ]: Timing info for test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9 (compile): 2023-02-27 13:25:57.556301 => 2023-02-27 13:25:57.581420
[0m13:25:57.581786 [debug] [Thread-2  ]: Began executing node test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m13:25:57.582131 [debug] [Thread-1  ]: Began executing node test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m13:25:57.607129 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m13:25:57.610198 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m13:25:57.611866 [debug] [Thread-1  ]: Using snowflake connection "test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m13:25:57.612668 [debug] [Thread-2  ]: Using snowflake connection "test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m13:25:57.612870 [debug] [Thread-1  ]: On test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from airbnb.dev.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m13:25:57.613136 [debug] [Thread-2  ]: On test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from airbnb.dev.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:25:57.613403 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:25:57.613652 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m13:25:59.817697 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2 seconds
[0m13:25:59.841198 [debug] [Thread-1  ]: Timing info for test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9 (execute): 2023-02-27 13:25:57.607371 => 2023-02-27 13:25:59.841112
[0m13:25:59.841572 [debug] [Thread-1  ]: On test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m13:25:59.938528 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2 seconds
[0m13:25:59.941629 [debug] [Thread-2  ]: Timing info for test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e (execute): 2023-02-27 13:25:57.582368 => 2023-02-27 13:25:59.941549
[0m13:25:59.941989 [debug] [Thread-2  ]: On test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m13:26:00.123178 [info ] [Thread-1  ]: 1 of 2 PASS not_null_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 2.57s]
[0m13:26:00.125496 [debug] [Thread-1  ]: Finished running node test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m13:26:00.190779 [info ] [Thread-2  ]: 2 of 2 PASS unique_dim_listings_cleansed_listing_id ............................ [[32mPASS[0m in 2.64s]
[0m13:26:00.191409 [debug] [Thread-2  ]: Finished running node test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m13:26:00.193072 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:26:00.193730 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:26:00.193998 [debug] [MainThread]: Connection 'test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9' was properly closed.
[0m13:26:00.194234 [debug] [MainThread]: Connection 'test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m13:26:00.194505 [info ] [MainThread]: 
[0m13:26:00.194995 [info ] [MainThread]: Finished running 2 tests in 0 hours 0 minutes and 5.72 seconds (5.72s).
[0m13:26:00.195510 [debug] [MainThread]: Command end result
[0m13:26:00.209400 [info ] [MainThread]: 
[0m13:26:00.209981 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:26:00.210395 [info ] [MainThread]: 
[0m13:26:00.210771 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m13:26:00.211235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd156c625e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd156dcbc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd156dcb640>]}
[0m13:26:00.211594 [debug] [MainThread]: Flushing usage events


============================== 2023-02-27 13:29:55.513725 | 4ec31915-c269-4d60-9bae-3a092f7e8441 ==============================
[0m13:29:55.513725 [info ] [MainThread]: Running with dbt=1.4.1
[0m13:29:55.516760 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/mramirez/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m13:29:55.517069 [debug] [MainThread]: Tracking: tracking
[0m13:29:55.517700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce74346100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce74346df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce74346d00>]}
[0m13:29:55.610424 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:29:55.611326 [debug] [MainThread]: Partial parsing: updated file: dbtlearm://models/schema.yml
[0m13:29:55.634757 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m13:29:55.685255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce744f2dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce74503e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce74503d00>]}
[0m13:29:55.685629 [debug] [MainThread]: Flushing usage events
[0m13:29:56.166997 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid test config given in models/schema.yml:
  	test definition dictionary must have exactly one key, got [('accepted_values', None), ('values', ['Entire home/apt', 'Private room', 'Shared room', 'Hotel room'])] instead (2 keys)
  	@: UnparsedNodeUpdate(original_file_path='model...ne)


============================== 2023-02-27 13:30:24.722009 | b9e4e760-59cc-4836-b45d-7138de98e395 ==============================
[0m13:30:24.722009 [info ] [MainThread]: Running with dbt=1.4.1
[0m13:30:24.724521 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/mramirez/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m13:30:24.724855 [debug] [MainThread]: Tracking: tracking
[0m13:30:24.725345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a42a43100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a42a43df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a42a43d00>]}
[0m13:30:24.810192 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:30:24.810796 [debug] [MainThread]: Partial parsing: updated file: dbtlearm://models/schema.yml
[0m13:30:24.823952 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m13:30:24.888635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9e4e760-59cc-4836-b45d-7138de98e395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a42ddcdf0>]}
[0m13:30:24.896508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9e4e760-59cc-4836-b45d-7138de98e395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a42d56a00>]}
[0m13:30:24.896883 [info ] [MainThread]: Found 8 models, 5 tests, 2 snapshots, 0 analyses, 304 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m13:30:24.897187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9e4e760-59cc-4836-b45d-7138de98e395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a42d56ac0>]}
[0m13:30:24.898907 [info ] [MainThread]: 
[0m13:30:24.900630 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:30:24.902026 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m13:30:24.917196 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m13:30:24.917575 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m13:30:24.917857 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:30:27.345832 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 2 seconds
[0m13:30:27.348584 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m13:30:27.681444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9e4e760-59cc-4836-b45d-7138de98e395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a42d4bd30>]}
[0m13:30:27.682437 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:30:27.682857 [info ] [MainThread]: 
[0m13:30:27.689458 [debug] [Thread-1  ]: Began running node test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m13:30:27.689827 [debug] [Thread-2  ]: Began running node test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be
[0m13:30:27.690171 [debug] [Thread-3  ]: Began running node test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m13:30:27.690550 [debug] [Thread-4  ]: Began running node test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m13:30:27.690835 [info ] [Thread-1  ]: 1 of 5 START test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [RUN]
[0m13:30:27.691261 [info ] [Thread-2  ]: 2 of 5 START test not_null_dim_listings_cleansed_host_id ....................... [RUN]
[0m13:30:27.691665 [info ] [Thread-3  ]: 3 of 5 START test not_null_dim_listings_cleansed_listing_id .................... [RUN]
[0m13:30:27.692063 [info ] [Thread-4  ]: 4 of 5 START test relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [RUN]
[0m13:30:27.692861 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af'
[0m13:30:27.693538 [debug] [Thread-2  ]: Acquiring new snowflake connection 'test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be'
[0m13:30:27.694199 [debug] [Thread-3  ]: Acquiring new snowflake connection 'test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9'
[0m13:30:27.695916 [debug] [Thread-4  ]: Acquiring new snowflake connection 'test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad'
[0m13:30:27.696266 [debug] [Thread-1  ]: Began compiling node test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m13:30:27.696595 [debug] [Thread-2  ]: Began compiling node test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be
[0m13:30:27.696904 [debug] [Thread-3  ]: Began compiling node test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m13:30:27.697211 [debug] [Thread-4  ]: Began compiling node test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m13:30:27.705228 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m13:30:27.716179 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m13:30:27.721076 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m13:30:27.727553 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m13:30:27.728556 [debug] [Thread-2  ]: Timing info for test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be (compile): 2023-02-27 13:30:27.705644 => 2023-02-27 13:30:27.728456
[0m13:30:27.728955 [debug] [Thread-2  ]: Began executing node test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be
[0m13:30:27.729254 [debug] [Thread-1  ]: Timing info for test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (compile): 2023-02-27 13:30:27.697564 => 2023-02-27 13:30:27.729191
[0m13:30:27.729675 [debug] [Thread-4  ]: Timing info for test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (compile): 2023-02-27 13:30:27.721379 => 2023-02-27 13:30:27.729607
[0m13:30:27.735297 [debug] [Thread-3  ]: Timing info for test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9 (compile): 2023-02-27 13:30:27.716498 => 2023-02-27 13:30:27.735235
[0m13:30:27.741936 [debug] [Thread-1  ]: Began executing node test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m13:30:27.753339 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m13:30:27.753763 [debug] [Thread-4  ]: Began executing node test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m13:30:27.754068 [debug] [Thread-3  ]: Began executing node test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m13:30:27.756984 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m13:30:27.759789 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m13:30:27.762441 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m13:30:27.764202 [debug] [Thread-2  ]: Using snowflake connection "test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m13:30:27.765244 [debug] [Thread-1  ]: Using snowflake connection "test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m13:30:27.765597 [debug] [Thread-2  ]: On test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from airbnb.dev.dim_listings_cleansed
where host_id is null



      
    ) dbt_internal_test
[0m13:30:27.766475 [debug] [Thread-4  ]: Using snowflake connection "test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m13:30:27.766795 [debug] [Thread-1  ]: On test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        room_type as value_field,
        count(*) as n_records

    from airbnb.dev.dim_listings_cleansed
    group by room_type

)

select *
from all_values
where value_field not in (
    'Entire home/apt','Private room','Shared room','Hotel room'
)



      
    ) dbt_internal_test
[0m13:30:27.767344 [debug] [Thread-3  ]: Using snowflake connection "test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m13:30:27.767590 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m13:30:27.767839 [debug] [Thread-4  ]: On test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select host_id as from_field
    from airbnb.dev.dim_listings_cleansed
    where host_id is not null
),

parent as (
    select host_id as to_field
    from airbnb.dev.dim_hosts_cleansed
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m13:30:27.768081 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:30:27.768307 [debug] [Thread-3  ]: On test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from airbnb.dev.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m13:30:27.769771 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m13:30:27.772078 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:30:29.596332 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2 seconds
[0m13:30:29.620486 [debug] [Thread-3  ]: Timing info for test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9 (execute): 2023-02-27 13:30:27.760024 => 2023-02-27 13:30:29.620389
[0m13:30:29.620891 [debug] [Thread-3  ]: On test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m13:30:29.894434 [info ] [Thread-3  ]: 3 of 5 PASS not_null_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 2.20s]
[0m13:30:29.896610 [debug] [Thread-3  ]: Finished running node test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m13:30:29.897352 [debug] [Thread-3  ]: Began running node test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m13:30:29.897777 [info ] [Thread-3  ]: 5 of 5 START test unique_dim_listings_cleansed_listing_id ...................... [RUN]
[0m13:30:29.898661 [debug] [Thread-3  ]: Acquiring new snowflake connection 'test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e'
[0m13:30:29.899004 [debug] [Thread-3  ]: Began compiling node test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m13:30:29.907359 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m13:30:29.909957 [debug] [Thread-3  ]: Timing info for test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e (compile): 2023-02-27 13:30:29.899240 => 2023-02-27 13:30:29.909836
[0m13:30:29.910428 [debug] [Thread-3  ]: Began executing node test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m13:30:29.914642 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m13:30:29.916385 [debug] [Thread-3  ]: Using snowflake connection "test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m13:30:29.916692 [debug] [Thread-3  ]: On test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from airbnb.dev.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:30:29.916965 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m13:30:30.144023 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2 seconds
[0m13:30:30.146970 [debug] [Thread-2  ]: Timing info for test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be (execute): 2023-02-27 13:30:27.729859 => 2023-02-27 13:30:30.146890
[0m13:30:30.148285 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2 seconds
[0m13:30:30.148618 [debug] [Thread-2  ]: On test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be: Close
[0m13:30:30.150782 [debug] [Thread-1  ]: Timing info for test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (execute): 2023-02-27 13:30:27.754280 => 2023-02-27 13:30:30.150719
[0m13:30:30.152205 [debug] [Thread-1  ]: On test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: Close
[0m13:30:30.436154 [info ] [Thread-1  ]: 1 of 5 PASS accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[32mPASS[0m in 2.74s]
[0m13:30:30.437195 [debug] [Thread-1  ]: Finished running node test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m13:30:30.542391 [info ] [Thread-2  ]: 2 of 5 PASS not_null_dim_listings_cleansed_host_id ............................. [[32mPASS[0m in 2.85s]
[0m13:30:30.543046 [debug] [Thread-2  ]: Finished running node test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be
[0m13:30:30.853334 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1 seconds
[0m13:30:30.856435 [debug] [Thread-3  ]: Timing info for test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e (execute): 2023-02-27 13:30:29.910689 => 2023-02-27 13:30:30.856355
[0m13:30:30.856795 [debug] [Thread-3  ]: On test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m13:30:30.937405 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 3 seconds
[0m13:30:30.940135 [debug] [Thread-4  ]: Timing info for test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (execute): 2023-02-27 13:30:27.757361 => 2023-02-27 13:30:30.940056
[0m13:30:30.940496 [debug] [Thread-4  ]: On test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: Close
[0m13:30:31.140273 [info ] [Thread-3  ]: 5 of 5 PASS unique_dim_listings_cleansed_listing_id ............................ [[32mPASS[0m in 1.24s]
[0m13:30:31.140910 [debug] [Thread-3  ]: Finished running node test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m13:30:31.211972 [info ] [Thread-4  ]: 4 of 5 PASS relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [[32mPASS[0m in 3.52s]
[0m13:30:31.212598 [debug] [Thread-4  ]: Finished running node test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m13:30:31.214433 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:30:31.215291 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:30:31.215567 [debug] [MainThread]: Connection 'test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af' was properly closed.
[0m13:30:31.215813 [debug] [MainThread]: Connection 'test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be' was properly closed.
[0m13:30:31.216052 [debug] [MainThread]: Connection 'test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m13:30:31.216300 [debug] [MainThread]: Connection 'test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad' was properly closed.
[0m13:30:31.216591 [info ] [MainThread]: 
[0m13:30:31.216963 [info ] [MainThread]: Finished running 5 tests in 0 hours 0 minutes and 6.32 seconds (6.32s).
[0m13:30:31.217585 [debug] [MainThread]: Command end result
[0m13:30:31.226726 [info ] [MainThread]: 
[0m13:30:31.227246 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:30:31.227615 [info ] [MainThread]: 
[0m13:30:31.227959 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m13:30:31.228386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a42d56f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a42d57f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a438d8cd0>]}
[0m13:30:31.228749 [debug] [MainThread]: Flushing usage events


============================== 2023-02-27 13:34:40.263019 | db6c8b73-f841-4285-88c8-ad998e66389e ==============================
[0m13:34:40.263019 [info ] [MainThread]: Running with dbt=1.4.1
[0m13:34:40.265584 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/mramirez/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m13:34:40.265873 [debug] [MainThread]: Tracking: tracking
[0m13:34:40.266355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb645304100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb645304df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb645304d00>]}
[0m13:34:40.354128 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m13:34:40.354622 [debug] [MainThread]: Partial parsing: added file: dbtlearm://tests/dim_listings_minimum_nights.sql
[0m13:34:40.393787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'db6c8b73-f841-4285-88c8-ad998e66389e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6454f20d0>]}
[0m13:34:40.402724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'db6c8b73-f841-4285-88c8-ad998e66389e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb64549fdf0>]}
[0m13:34:40.403150 [info ] [MainThread]: Found 8 models, 6 tests, 2 snapshots, 0 analyses, 304 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m13:34:40.403502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db6c8b73-f841-4285-88c8-ad998e66389e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb64549fe20>]}
[0m13:34:40.405662 [info ] [MainThread]: 
[0m13:34:40.407482 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:34:40.408967 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m13:34:40.424795 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m13:34:40.425183 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m13:34:40.425461 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:34:41.940598 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 2 seconds
[0m13:34:41.943260 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m13:34:42.283552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db6c8b73-f841-4285-88c8-ad998e66389e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb645325c40>]}
[0m13:34:42.284586 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:34:42.284969 [info ] [MainThread]: 
[0m13:34:42.291984 [debug] [Thread-1  ]: Began running node test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m13:34:42.292362 [debug] [Thread-2  ]: Began running node test.dbtlearm.dim_listings_minimum_nights
[0m13:34:42.292695 [debug] [Thread-3  ]: Began running node test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be
[0m13:34:42.293115 [debug] [Thread-4  ]: Began running node test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m13:34:42.293467 [info ] [Thread-1  ]: 1 of 6 START test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [RUN]
[0m13:34:42.293899 [info ] [Thread-2  ]: 2 of 6 START test dim_listings_minimum_nights .................................. [RUN]
[0m13:34:42.294322 [info ] [Thread-3  ]: 3 of 6 START test not_null_dim_listings_cleansed_host_id ....................... [RUN]
[0m13:34:42.294752 [info ] [Thread-4  ]: 4 of 6 START test not_null_dim_listings_cleansed_listing_id .................... [RUN]
[0m13:34:42.295565 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af'
[0m13:34:42.296222 [debug] [Thread-2  ]: Acquiring new snowflake connection 'test.dbtlearm.dim_listings_minimum_nights'
[0m13:34:42.296899 [debug] [Thread-3  ]: Acquiring new snowflake connection 'test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be'
[0m13:34:42.297548 [debug] [Thread-4  ]: Acquiring new snowflake connection 'test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9'
[0m13:34:42.297881 [debug] [Thread-1  ]: Began compiling node test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m13:34:42.298229 [debug] [Thread-2  ]: Began compiling node test.dbtlearm.dim_listings_minimum_nights
[0m13:34:42.298546 [debug] [Thread-3  ]: Began compiling node test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be
[0m13:34:42.298858 [debug] [Thread-4  ]: Began compiling node test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m13:34:42.316331 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m13:34:42.319251 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearm.dim_listings_minimum_nights"
[0m13:34:42.331844 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m13:34:42.336456 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m13:34:42.337526 [debug] [Thread-1  ]: Timing info for test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (compile): 2023-02-27 13:34:42.299103 => 2023-02-27 13:34:42.337429
[0m13:34:42.338074 [debug] [Thread-1  ]: Began executing node test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m13:34:42.338511 [debug] [Thread-2  ]: Timing info for test.dbtlearm.dim_listings_minimum_nights (compile): 2023-02-27 13:34:42.316640 => 2023-02-27 13:34:42.338413
[0m13:34:42.338803 [debug] [Thread-3  ]: Timing info for test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be (compile): 2023-02-27 13:34:42.319554 => 2023-02-27 13:34:42.338741
[0m13:34:42.344467 [debug] [Thread-4  ]: Timing info for test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9 (compile): 2023-02-27 13:34:42.332066 => 2023-02-27 13:34:42.344388
[0m13:34:42.363383 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m13:34:42.363694 [debug] [Thread-2  ]: Began executing node test.dbtlearm.dim_listings_minimum_nights
[0m13:34:42.364014 [debug] [Thread-3  ]: Began executing node test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be
[0m13:34:42.364300 [debug] [Thread-4  ]: Began executing node test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m13:34:42.367383 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbtlearm.dim_listings_minimum_nights"
[0m13:34:42.370706 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m13:34:42.373677 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m13:34:42.374674 [debug] [Thread-1  ]: Using snowflake connection "test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m13:34:42.375497 [debug] [Thread-1  ]: On test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        room_type as value_field,
        count(*) as n_records

    from airbnb.dev.dim_listings_cleansed
    group by room_type

)

select *
from all_values
where value_field not in (
    'Entire home/apt','Private room','Shared room','Hotel room'
)



      
    ) dbt_internal_test
[0m13:34:42.375951 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:34:42.376594 [debug] [Thread-3  ]: Using snowflake connection "test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m13:34:42.377501 [debug] [Thread-2  ]: Using snowflake connection "test.dbtlearm.dim_listings_minimum_nights"
[0m13:34:42.378127 [debug] [Thread-4  ]: Using snowflake connection "test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m13:34:42.378709 [debug] [Thread-3  ]: On test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from airbnb.dev.dim_listings_cleansed
where host_id is null



      
    ) dbt_internal_test
[0m13:34:42.379662 [debug] [Thread-2  ]: On test.dbtlearm.dim_listings_minimum_nights: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "test.dbtlearm.dim_listings_minimum_nights"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- Singular test
SELECT  
    *
FROM
    airbnb.dev.dim_listings_cleansed
WHERE minimum_nights < 1
LIMIT 10
      
    ) dbt_internal_test
[0m13:34:42.380093 [debug] [Thread-4  ]: On test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from airbnb.dev.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m13:34:42.380376 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:34:42.381447 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m13:34:42.381712 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m13:34:43.611370 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m13:34:43.634470 [debug] [Thread-1  ]: Timing info for test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (execute): 2023-02-27 13:34:42.339020 => 2023-02-27 13:34:43.634381
[0m13:34:43.634854 [debug] [Thread-1  ]: On test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: Close
[0m13:34:43.886707 [info ] [Thread-1  ]: 1 of 6 PASS accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[32mPASS[0m in 1.59s]
[0m13:34:43.888907 [debug] [Thread-1  ]: Finished running node test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m13:34:43.889702 [debug] [Thread-1  ]: Began running node test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m13:34:43.890297 [info ] [Thread-1  ]: 5 of 6 START test relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [RUN]
[0m13:34:43.891203 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad'
[0m13:34:43.891530 [debug] [Thread-1  ]: Began compiling node test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m13:34:43.902430 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m13:34:43.903464 [debug] [Thread-1  ]: Timing info for test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (compile): 2023-02-27 13:34:43.891759 => 2023-02-27 13:34:43.903383
[0m13:34:43.903869 [debug] [Thread-1  ]: Began executing node test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m13:34:43.907325 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m13:34:43.909257 [debug] [Thread-1  ]: Using snowflake connection "test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m13:34:43.909587 [debug] [Thread-1  ]: On test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select host_id as from_field
    from airbnb.dev.dim_listings_cleansed
    where host_id is not null
),

parent as (
    select host_id as to_field
    from airbnb.dev.dim_hosts_cleansed
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m13:34:43.909940 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:34:43.970231 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 2 seconds
[0m13:34:43.971616 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2 seconds
[0m13:34:43.974390 [debug] [Thread-4  ]: Timing info for test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9 (execute): 2023-02-27 13:34:42.370979 => 2023-02-27 13:34:43.974307
[0m13:34:43.976977 [debug] [Thread-3  ]: Timing info for test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be (execute): 2023-02-27 13:34:42.367932 => 2023-02-27 13:34:43.976878
[0m13:34:43.977354 [debug] [Thread-4  ]: On test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m13:34:43.977672 [debug] [Thread-3  ]: On test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be: Close
[0m13:34:44.034932 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2 seconds
[0m13:34:44.037099 [debug] [Thread-2  ]: Timing info for test.dbtlearm.dim_listings_minimum_nights (execute): 2023-02-27 13:34:42.364663 => 2023-02-27 13:34:44.037036
[0m13:34:44.037375 [debug] [Thread-2  ]: On test.dbtlearm.dim_listings_minimum_nights: Close
[0m13:34:44.220319 [info ] [Thread-3  ]: 3 of 6 PASS not_null_dim_listings_cleansed_host_id ............................. [[32mPASS[0m in 1.92s]
[0m13:34:44.220945 [debug] [Thread-3  ]: Finished running node test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be
[0m13:34:44.221428 [debug] [Thread-3  ]: Began running node test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m13:34:44.221934 [info ] [Thread-3  ]: 6 of 6 START test unique_dim_listings_cleansed_listing_id ...................... [RUN]
[0m13:34:44.222941 [debug] [Thread-3  ]: Acquiring new snowflake connection 'test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e'
[0m13:34:44.224102 [debug] [Thread-3  ]: Began compiling node test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m13:34:44.233594 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m13:34:44.234788 [info ] [Thread-4  ]: 4 of 6 PASS not_null_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 1.94s]
[0m13:34:44.235461 [debug] [Thread-4  ]: Finished running node test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m13:34:44.241664 [debug] [Thread-3  ]: Timing info for test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e (compile): 2023-02-27 13:34:44.224436 => 2023-02-27 13:34:44.241569
[0m13:34:44.253910 [debug] [Thread-3  ]: Began executing node test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m13:34:44.269015 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m13:34:44.286340 [debug] [Thread-3  ]: Using snowflake connection "test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m13:34:44.291816 [debug] [Thread-3  ]: On test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from airbnb.dev.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:34:44.305266 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m13:34:44.325826 [info ] [Thread-2  ]: 2 of 6 PASS dim_listings_minimum_nights ........................................ [[32mPASS[0m in 2.03s]
[0m13:34:44.332369 [debug] [Thread-2  ]: Finished running node test.dbtlearm.dim_listings_minimum_nights
[0m13:34:45.117464 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m13:34:45.120657 [debug] [Thread-1  ]: Timing info for test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (execute): 2023-02-27 13:34:43.904120 => 2023-02-27 13:34:45.120567
[0m13:34:45.121055 [debug] [Thread-1  ]: On test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: Close
[0m13:34:45.183928 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1 seconds
[0m13:34:45.187006 [debug] [Thread-3  ]: Timing info for test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e (execute): 2023-02-27 13:34:44.265845 => 2023-02-27 13:34:45.186918
[0m13:34:45.187374 [debug] [Thread-3  ]: On test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m13:34:45.356244 [info ] [Thread-1  ]: 5 of 6 PASS relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [[32mPASS[0m in 1.47s]
[0m13:34:45.357222 [debug] [Thread-1  ]: Finished running node test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m13:34:45.455229 [info ] [Thread-3  ]: 6 of 6 PASS unique_dim_listings_cleansed_listing_id ............................ [[32mPASS[0m in 1.23s]
[0m13:34:45.455894 [debug] [Thread-3  ]: Finished running node test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m13:34:45.457908 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:34:45.458575 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:34:45.458850 [debug] [MainThread]: Connection 'test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad' was properly closed.
[0m13:34:45.459095 [debug] [MainThread]: Connection 'test.dbtlearm.dim_listings_minimum_nights' was properly closed.
[0m13:34:45.459332 [debug] [MainThread]: Connection 'test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m13:34:45.459561 [debug] [MainThread]: Connection 'test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9' was properly closed.
[0m13:34:45.459846 [info ] [MainThread]: 
[0m13:34:45.460207 [info ] [MainThread]: Finished running 6 tests in 0 hours 0 minutes and 5.05 seconds (5.05s).
[0m13:34:45.460893 [debug] [MainThread]: Command end result
[0m13:34:45.470359 [info ] [MainThread]: 
[0m13:34:45.470825 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:34:45.471211 [info ] [MainThread]: 
[0m13:34:45.471651 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m13:34:45.472085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb645304430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6458c1130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6458d6fd0>]}
[0m13:34:45.472449 [debug] [MainThread]: Flushing usage events


============================== 2023-02-27 13:38:22.124450 | 2b89568e-482c-4ab9-b0f4-0bce92491544 ==============================
[0m13:38:22.124450 [info ] [MainThread]: Running with dbt=1.4.1
[0m13:38:22.126611 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/mramirez/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m13:38:22.126954 [debug] [MainThread]: Tracking: tracking
[0m13:38:22.127507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc27c083100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc27c083df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc27c083d00>]}
[0m13:38:22.357061 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m13:38:22.357504 [debug] [MainThread]: Partial parsing: added file: dbtlearm://tests/consistent_created_at.sql
[0m13:38:22.384964 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbtlearm.consistent_created_at' (tests/consistent_created_at.sql) depends on a node named 'dim_listing_cleansed' in package '' which was not found
[0m13:38:22.394168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2b89568e-482c-4ab9-b0f4-0bce92491544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc27c36ae50>]}
[0m13:38:22.406623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2b89568e-482c-4ab9-b0f4-0bce92491544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc27c323f10>]}
[0m13:38:22.407126 [info ] [MainThread]: Found 8 models, 6 tests, 2 snapshots, 0 analyses, 304 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m13:38:22.407485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b89568e-482c-4ab9-b0f4-0bce92491544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc27c323af0>]}
[0m13:38:22.409317 [info ] [MainThread]: 
[0m13:38:22.410898 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:38:22.412329 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m13:38:22.427279 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m13:38:22.427634 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m13:38:22.427901 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:38:24.033803 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 2 seconds
[0m13:38:24.036275 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m13:38:24.323178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b89568e-482c-4ab9-b0f4-0bce92491544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc27c323af0>]}
[0m13:38:24.324159 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:38:24.324542 [info ] [MainThread]: 
[0m13:38:24.339281 [debug] [Thread-1  ]: Began running node test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m13:38:24.339665 [debug] [Thread-2  ]: Began running node test.dbtlearm.dim_listings_minimum_nights
[0m13:38:24.340000 [debug] [Thread-3  ]: Began running node test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be
[0m13:38:24.340417 [debug] [Thread-4  ]: Began running node test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m13:38:24.340774 [info ] [Thread-1  ]: 1 of 6 START test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [RUN]
[0m13:38:24.341193 [info ] [Thread-2  ]: 2 of 6 START test dim_listings_minimum_nights .................................. [RUN]
[0m13:38:24.341584 [info ] [Thread-3  ]: 3 of 6 START test not_null_dim_listings_cleansed_host_id ....................... [RUN]
[0m13:38:24.342020 [info ] [Thread-4  ]: 4 of 6 START test not_null_dim_listings_cleansed_listing_id .................... [RUN]
[0m13:38:24.342815 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af'
[0m13:38:24.343541 [debug] [Thread-2  ]: Acquiring new snowflake connection 'test.dbtlearm.dim_listings_minimum_nights'
[0m13:38:24.344192 [debug] [Thread-3  ]: Acquiring new snowflake connection 'test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be'
[0m13:38:24.344830 [debug] [Thread-4  ]: Acquiring new snowflake connection 'test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9'
[0m13:38:24.345175 [debug] [Thread-1  ]: Began compiling node test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m13:38:24.345507 [debug] [Thread-2  ]: Began compiling node test.dbtlearm.dim_listings_minimum_nights
[0m13:38:24.345813 [debug] [Thread-3  ]: Began compiling node test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be
[0m13:38:24.346150 [debug] [Thread-4  ]: Began compiling node test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m13:38:24.362974 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m13:38:24.366056 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearm.dim_listings_minimum_nights"
[0m13:38:24.377742 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m13:38:24.382429 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m13:38:24.386176 [debug] [Thread-3  ]: Timing info for test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be (compile): 2023-02-27 13:38:24.366358 => 2023-02-27 13:38:24.386072
[0m13:38:24.386490 [debug] [Thread-2  ]: Timing info for test.dbtlearm.dim_listings_minimum_nights (compile): 2023-02-27 13:38:24.363297 => 2023-02-27 13:38:24.386429
[0m13:38:24.386800 [debug] [Thread-3  ]: Began executing node test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be
[0m13:38:24.387080 [debug] [Thread-4  ]: Timing info for test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9 (compile): 2023-02-27 13:38:24.378035 => 2023-02-27 13:38:24.387030
[0m13:38:24.387310 [debug] [Thread-1  ]: Timing info for test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (compile): 2023-02-27 13:38:24.346403 => 2023-02-27 13:38:24.387247
[0m13:38:24.387621 [debug] [Thread-2  ]: Began executing node test.dbtlearm.dim_listings_minimum_nights
[0m13:38:24.410535 [debug] [Thread-4  ]: Began executing node test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m13:38:24.410387 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m13:38:24.411005 [debug] [Thread-1  ]: Began executing node test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m13:38:24.413762 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbtlearm.dim_listings_minimum_nights"
[0m13:38:24.416510 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m13:38:24.419428 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m13:38:24.420442 [debug] [Thread-3  ]: Using snowflake connection "test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m13:38:24.420828 [debug] [Thread-3  ]: On test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from airbnb.dev.dim_listings_cleansed
where host_id is null



      
    ) dbt_internal_test
[0m13:38:24.421070 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:38:24.422979 [debug] [Thread-2  ]: Using snowflake connection "test.dbtlearm.dim_listings_minimum_nights"
[0m13:38:24.423564 [debug] [Thread-4  ]: Using snowflake connection "test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m13:38:24.424022 [debug] [Thread-2  ]: On test.dbtlearm.dim_listings_minimum_nights: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "test.dbtlearm.dim_listings_minimum_nights"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- Singular test
SELECT  
    *
FROM
    airbnb.dev.dim_listings_cleansed
WHERE minimum_nights < 1
LIMIT 10
      
    ) dbt_internal_test
[0m13:38:24.425083 [debug] [Thread-1  ]: Using snowflake connection "test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m13:38:24.425337 [debug] [Thread-4  ]: On test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from airbnb.dev.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m13:38:24.426075 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m13:38:24.426341 [debug] [Thread-1  ]: On test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        room_type as value_field,
        count(*) as n_records

    from airbnb.dev.dim_listings_cleansed
    group by room_type

)

select *
from all_values
where value_field not in (
    'Entire home/apt','Private room','Shared room','Hotel room'
)



      
    ) dbt_internal_test
[0m13:38:24.426626 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m13:38:24.428094 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:38:25.639914 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m13:38:25.649828 [debug] [Thread-1  ]: Timing info for test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (execute): 2023-02-27 13:38:24.416877 => 2023-02-27 13:38:25.649747
[0m13:38:25.650181 [debug] [Thread-1  ]: On test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: Close
[0m13:38:25.894285 [info ] [Thread-1  ]: 1 of 6 PASS accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[32mPASS[0m in 1.55s]
[0m13:38:25.896352 [debug] [Thread-1  ]: Finished running node test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m13:38:25.897102 [debug] [Thread-1  ]: Began running node test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m13:38:25.897456 [info ] [Thread-1  ]: 5 of 6 START test relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [RUN]
[0m13:38:25.898320 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad'
[0m13:38:25.898665 [debug] [Thread-1  ]: Began compiling node test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m13:38:25.909231 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m13:38:25.912969 [debug] [Thread-1  ]: Timing info for test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (compile): 2023-02-27 13:38:25.898894 => 2023-02-27 13:38:25.912820
[0m13:38:25.913372 [debug] [Thread-1  ]: Began executing node test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m13:38:25.916966 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m13:38:25.920912 [debug] [Thread-1  ]: Using snowflake connection "test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m13:38:25.921204 [debug] [Thread-1  ]: On test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select host_id as from_field
    from airbnb.dev.dim_listings_cleansed
    where host_id is not null
),

parent as (
    select host_id as to_field
    from airbnb.dev.dim_hosts_cleansed
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m13:38:25.921458 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:38:25.968963 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 2 seconds
[0m13:38:25.971739 [debug] [Thread-4  ]: Timing info for test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9 (execute): 2023-02-27 13:38:24.413993 => 2023-02-27 13:38:25.971663
[0m13:38:25.972089 [debug] [Thread-4  ]: On test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m13:38:26.050643 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2 seconds
[0m13:38:26.052775 [debug] [Thread-3  ]: Timing info for test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be (execute): 2023-02-27 13:38:24.387845 => 2023-02-27 13:38:26.052710
[0m13:38:26.053055 [debug] [Thread-3  ]: On test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be: Close
[0m13:38:26.061005 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2 seconds
[0m13:38:26.063056 [debug] [Thread-2  ]: Timing info for test.dbtlearm.dim_listings_minimum_nights (execute): 2023-02-27 13:38:24.411212 => 2023-02-27 13:38:26.062995
[0m13:38:26.063325 [debug] [Thread-2  ]: On test.dbtlearm.dim_listings_minimum_nights: Close
[0m13:38:26.197580 [info ] [Thread-4  ]: 4 of 6 PASS not_null_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 1.85s]
[0m13:38:26.198209 [debug] [Thread-4  ]: Finished running node test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m13:38:26.198680 [debug] [Thread-4  ]: Began running node test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m13:38:26.199098 [info ] [Thread-4  ]: 6 of 6 START test unique_dim_listings_cleansed_listing_id ...................... [RUN]
[0m13:38:26.200072 [debug] [Thread-4  ]: Acquiring new snowflake connection 'test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e'
[0m13:38:26.200446 [debug] [Thread-4  ]: Began compiling node test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m13:38:26.208766 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m13:38:26.212348 [debug] [Thread-4  ]: Timing info for test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e (compile): 2023-02-27 13:38:26.200722 => 2023-02-27 13:38:26.212244
[0m13:38:26.212740 [debug] [Thread-4  ]: Began executing node test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m13:38:26.216796 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m13:38:26.220633 [debug] [Thread-4  ]: Using snowflake connection "test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m13:38:26.220949 [debug] [Thread-4  ]: On test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from airbnb.dev.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:38:26.221200 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m13:38:26.333516 [info ] [Thread-2  ]: 2 of 6 PASS dim_listings_minimum_nights ........................................ [[32mPASS[0m in 1.99s]
[0m13:38:26.334005 [debug] [Thread-2  ]: Finished running node test.dbtlearm.dim_listings_minimum_nights
[0m13:38:26.340399 [info ] [Thread-3  ]: 3 of 6 PASS not_null_dim_listings_cleansed_host_id ............................. [[32mPASS[0m in 2.00s]
[0m13:38:26.368927 [debug] [Thread-3  ]: Finished running node test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be
[0m13:38:26.872077 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m13:38:26.875211 [debug] [Thread-1  ]: Timing info for test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (execute): 2023-02-27 13:38:25.913605 => 2023-02-27 13:38:26.875131
[0m13:38:26.875565 [debug] [Thread-1  ]: On test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: Close
[0m13:38:27.076014 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1 seconds
[0m13:38:27.078830 [debug] [Thread-4  ]: Timing info for test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e (execute): 2023-02-27 13:38:26.212958 => 2023-02-27 13:38:27.078753
[0m13:38:27.079180 [debug] [Thread-4  ]: On test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m13:38:27.129504 [info ] [Thread-1  ]: 5 of 6 PASS relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [[32mPASS[0m in 1.23s]
[0m13:38:27.130188 [debug] [Thread-1  ]: Finished running node test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m13:38:27.361056 [info ] [Thread-4  ]: 6 of 6 PASS unique_dim_listings_cleansed_listing_id ............................ [[32mPASS[0m in 1.16s]
[0m13:38:27.361676 [debug] [Thread-4  ]: Finished running node test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m13:38:27.363584 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:38:27.364398 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:38:27.364697 [debug] [MainThread]: Connection 'test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad' was properly closed.
[0m13:38:27.364933 [debug] [MainThread]: Connection 'test.dbtlearm.dim_listings_minimum_nights' was properly closed.
[0m13:38:27.365160 [debug] [MainThread]: Connection 'test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be' was properly closed.
[0m13:38:27.365382 [debug] [MainThread]: Connection 'test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m13:38:27.365661 [info ] [MainThread]: 
[0m13:38:27.366085 [info ] [MainThread]: Finished running 6 tests in 0 hours 0 minutes and 4.96 seconds (4.96s).
[0m13:38:27.366762 [debug] [MainThread]: Command end result
[0m13:38:27.381287 [info ] [MainThread]: 
[0m13:38:27.381778 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:38:27.382127 [info ] [MainThread]: 
[0m13:38:27.382461 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m13:38:27.382885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc27c79e130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc27c84afd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc27c37d160>]}
[0m13:38:27.383250 [debug] [MainThread]: Flushing usage events


============================== 2023-02-27 13:38:52.364327 | 53ec4398-3a41-4efa-93a7-eb02952263d8 ==============================
[0m13:38:52.364327 [info ] [MainThread]: Running with dbt=1.4.1
[0m13:38:52.366730 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/mramirez/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m13:38:52.367117 [debug] [MainThread]: Tracking: tracking
[0m13:38:52.367565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79bf447100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79bf447df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79bf447d00>]}
[0m13:38:52.436814 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:38:52.437319 [debug] [MainThread]: Partial parsing: updated file: dbtlearm://tests/consistent_created_at.sql
[0m13:38:52.470556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '53ec4398-3a41-4efa-93a7-eb02952263d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79bf635940>]}
[0m13:38:52.478176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53ec4398-3a41-4efa-93a7-eb02952263d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79bf58a730>]}
[0m13:38:52.478561 [info ] [MainThread]: Found 8 models, 7 tests, 2 snapshots, 0 analyses, 304 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m13:38:52.478855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53ec4398-3a41-4efa-93a7-eb02952263d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79bf5e6c70>]}
[0m13:38:52.480571 [info ] [MainThread]: 
[0m13:38:52.482147 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:38:52.483480 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m13:38:52.498470 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m13:38:52.498843 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m13:38:52.499124 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:38:54.186177 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 2 seconds
[0m13:38:54.188645 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m13:38:54.457573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53ec4398-3a41-4efa-93a7-eb02952263d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79bf5e6cd0>]}
[0m13:38:54.458636 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:38:54.459023 [info ] [MainThread]: 
[0m13:38:54.464214 [debug] [Thread-1  ]: Began running node test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m13:38:54.464613 [info ] [Thread-1  ]: 1 of 7 START test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [RUN]
[0m13:38:54.465257 [debug] [Thread-2  ]: Began running node test.dbtlearm.consistent_created_at
[0m13:38:54.465572 [debug] [Thread-3  ]: Began running node test.dbtlearm.dim_listings_minimum_nights
[0m13:38:54.466209 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af'
[0m13:38:54.466512 [debug] [Thread-4  ]: Began running node test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be
[0m13:38:54.466915 [info ] [Thread-2  ]: 2 of 7 START test consistent_created_at ........................................ [RUN]
[0m13:38:54.467429 [info ] [Thread-3  ]: 3 of 7 START test dim_listings_minimum_nights .................................. [RUN]
[0m13:38:54.467930 [debug] [Thread-1  ]: Began compiling node test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m13:38:54.468276 [info ] [Thread-4  ]: 4 of 7 START test not_null_dim_listings_cleansed_host_id ....................... [RUN]
[0m13:38:54.469059 [debug] [Thread-2  ]: Acquiring new snowflake connection 'test.dbtlearm.consistent_created_at'
[0m13:38:54.469709 [debug] [Thread-3  ]: Acquiring new snowflake connection 'test.dbtlearm.dim_listings_minimum_nights'
[0m13:38:54.488333 [debug] [Thread-4  ]: Acquiring new snowflake connection 'test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be'
[0m13:38:54.487477 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m13:38:54.488727 [debug] [Thread-2  ]: Began compiling node test.dbtlearm.consistent_created_at
[0m13:38:54.489040 [debug] [Thread-3  ]: Began compiling node test.dbtlearm.dim_listings_minimum_nights
[0m13:38:54.489404 [debug] [Thread-4  ]: Began compiling node test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be
[0m13:38:54.492765 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearm.consistent_created_at"
[0m13:38:54.495404 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearm.dim_listings_minimum_nights"
[0m13:38:54.502168 [debug] [Thread-1  ]: Timing info for test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (compile): 2023-02-27 13:38:54.469967 => 2023-02-27 13:38:54.502064
[0m13:38:54.506705 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m13:38:54.507401 [debug] [Thread-1  ]: Began executing node test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m13:38:54.514021 [debug] [Thread-2  ]: Timing info for test.dbtlearm.consistent_created_at (compile): 2023-02-27 13:38:54.489796 => 2023-02-27 13:38:54.513949
[0m13:38:54.514293 [debug] [Thread-3  ]: Timing info for test.dbtlearm.dim_listings_minimum_nights (compile): 2023-02-27 13:38:54.493033 => 2023-02-27 13:38:54.514231
[0m13:38:54.530705 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m13:38:54.531036 [debug] [Thread-2  ]: Began executing node test.dbtlearm.consistent_created_at
[0m13:38:54.531302 [debug] [Thread-4  ]: Timing info for test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be (compile): 2023-02-27 13:38:54.495757 => 2023-02-27 13:38:54.531238
[0m13:38:54.531575 [debug] [Thread-3  ]: Began executing node test.dbtlearm.dim_listings_minimum_nights
[0m13:38:54.534489 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbtlearm.consistent_created_at"
[0m13:38:54.534801 [debug] [Thread-4  ]: Began executing node test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be
[0m13:38:54.537617 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbtlearm.dim_listings_minimum_nights"
[0m13:38:54.538383 [debug] [Thread-1  ]: Using snowflake connection "test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m13:38:54.541217 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m13:38:54.541691 [debug] [Thread-1  ]: On test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        room_type as value_field,
        count(*) as n_records

    from airbnb.dev.dim_listings_cleansed
    group by room_type

)

select *
from all_values
where value_field not in (
    'Entire home/apt','Private room','Shared room','Hotel room'
)



      
    ) dbt_internal_test
[0m13:38:54.542326 [debug] [Thread-2  ]: Using snowflake connection "test.dbtlearm.consistent_created_at"
[0m13:38:54.542820 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:38:54.543402 [debug] [Thread-3  ]: Using snowflake connection "test.dbtlearm.dim_listings_minimum_nights"
[0m13:38:54.543718 [debug] [Thread-2  ]: On test.dbtlearm.consistent_created_at: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "test.dbtlearm.consistent_created_at"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT *
FROM airbnb.dev.dim_listings_cleansed l
INNER JOIN airbnb.dev.fct_reviews r
USING (listing_id)
WHERE l.created_at >= r.review_date
      
    ) dbt_internal_test
[0m13:38:54.544260 [debug] [Thread-4  ]: Using snowflake connection "test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m13:38:54.546872 [debug] [Thread-3  ]: On test.dbtlearm.dim_listings_minimum_nights: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "test.dbtlearm.dim_listings_minimum_nights"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- Singular test
SELECT  
    *
FROM
    airbnb.dev.dim_listings_cleansed
WHERE minimum_nights < 1
LIMIT 10
      
    ) dbt_internal_test
[0m13:38:54.547314 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m13:38:54.547568 [debug] [Thread-4  ]: On test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from airbnb.dev.dim_listings_cleansed
where host_id is null



      
    ) dbt_internal_test
[0m13:38:54.548443 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:38:54.549377 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m13:38:55.960593 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1 seconds
[0m13:38:55.970009 [debug] [Thread-3  ]: Timing info for test.dbtlearm.dim_listings_minimum_nights (execute): 2023-02-27 13:38:54.535074 => 2023-02-27 13:38:55.969930
[0m13:38:55.970358 [debug] [Thread-3  ]: On test.dbtlearm.dim_listings_minimum_nights: Close
[0m13:38:55.990343 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m13:38:55.993310 [debug] [Thread-1  ]: Timing info for test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (execute): 2023-02-27 13:38:54.507970 => 2023-02-27 13:38:55.993234
[0m13:38:55.993673 [debug] [Thread-1  ]: On test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: Close
[0m13:38:56.198564 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 2 seconds
[0m13:38:56.201625 [debug] [Thread-4  ]: Timing info for test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be (execute): 2023-02-27 13:38:54.538737 => 2023-02-27 13:38:56.201546
[0m13:38:56.201980 [debug] [Thread-4  ]: On test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be: Close
[0m13:38:56.222071 [info ] [Thread-3  ]: 3 of 7 PASS dim_listings_minimum_nights ........................................ [[32mPASS[0m in 1.75s]
[0m13:38:56.224083 [debug] [Thread-3  ]: Finished running node test.dbtlearm.dim_listings_minimum_nights
[0m13:38:56.224734 [debug] [Thread-3  ]: Began running node test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m13:38:56.225176 [info ] [Thread-3  ]: 5 of 7 START test not_null_dim_listings_cleansed_listing_id .................... [RUN]
[0m13:38:56.225953 [debug] [Thread-3  ]: Acquiring new snowflake connection 'test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9'
[0m13:38:56.226275 [debug] [Thread-3  ]: Began compiling node test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m13:38:56.231620 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m13:38:56.232580 [debug] [Thread-3  ]: Timing info for test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9 (compile): 2023-02-27 13:38:56.226504 => 2023-02-27 13:38:56.232501
[0m13:38:56.232917 [debug] [Thread-3  ]: Began executing node test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m13:38:56.236267 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m13:38:56.237528 [debug] [Thread-3  ]: Using snowflake connection "test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m13:38:56.237803 [debug] [Thread-3  ]: On test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from airbnb.dev.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m13:38:56.238066 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m13:38:56.268110 [info ] [Thread-1  ]: 1 of 7 PASS accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[32mPASS[0m in 1.80s]
[0m13:38:56.268857 [debug] [Thread-1  ]: Finished running node test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m13:38:56.269342 [debug] [Thread-1  ]: Began running node test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m13:38:56.269764 [info ] [Thread-1  ]: 6 of 7 START test relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [RUN]
[0m13:38:56.270728 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad'
[0m13:38:56.271104 [debug] [Thread-1  ]: Began compiling node test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m13:38:56.281801 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m13:38:56.282826 [debug] [Thread-1  ]: Timing info for test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (compile): 2023-02-27 13:38:56.271384 => 2023-02-27 13:38:56.282744
[0m13:38:56.283171 [debug] [Thread-1  ]: Began executing node test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m13:38:56.286500 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m13:38:56.288152 [debug] [Thread-1  ]: Using snowflake connection "test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m13:38:56.288423 [debug] [Thread-1  ]: On test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select host_id as from_field
    from airbnb.dev.dim_listings_cleansed
    where host_id is not null
),

parent as (
    select host_id as to_field
    from airbnb.dev.dim_hosts_cleansed
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m13:38:56.288675 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:38:56.433290 [info ] [Thread-4  ]: 4 of 7 PASS not_null_dim_listings_cleansed_host_id ............................. [[32mPASS[0m in 1.95s]
[0m13:38:56.433796 [debug] [Thread-4  ]: Finished running node test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be
[0m13:38:56.434300 [debug] [Thread-4  ]: Began running node test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m13:38:56.434583 [info ] [Thread-4  ]: 7 of 7 START test unique_dim_listings_cleansed_listing_id ...................... [RUN]
[0m13:38:56.435120 [debug] [Thread-4  ]: Acquiring new snowflake connection 'test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e'
[0m13:38:56.435345 [debug] [Thread-4  ]: Began compiling node test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m13:38:56.441054 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m13:38:56.441897 [debug] [Thread-4  ]: Timing info for test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e (compile): 2023-02-27 13:38:56.435505 => 2023-02-27 13:38:56.441843
[0m13:38:56.442137 [debug] [Thread-4  ]: Began executing node test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m13:38:56.444408 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m13:38:56.445476 [debug] [Thread-4  ]: Using snowflake connection "test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m13:38:56.445678 [debug] [Thread-4  ]: On test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from airbnb.dev.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:38:56.445871 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m13:38:56.751612 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2 seconds
[0m13:38:56.797075 [debug] [Thread-2  ]: Timing info for test.dbtlearm.consistent_created_at (execute): 2023-02-27 13:38:54.531921 => 2023-02-27 13:38:56.797008
[0m13:38:56.831354 [debug] [Thread-2  ]: On test.dbtlearm.consistent_created_at: Close
[0m13:38:57.179410 [info ] [Thread-2  ]: 2 of 7 PASS consistent_created_at .............................................. [[32mPASS[0m in 2.71s]
[0m13:38:57.180152 [debug] [Thread-2  ]: Finished running node test.dbtlearm.consistent_created_at
[0m13:38:57.239531 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1 seconds
[0m13:38:57.242658 [debug] [Thread-3  ]: Timing info for test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9 (execute): 2023-02-27 13:38:56.233149 => 2023-02-27 13:38:57.242579
[0m13:38:57.243022 [debug] [Thread-3  ]: On test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m13:38:57.272676 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m13:38:57.275656 [debug] [Thread-1  ]: Timing info for test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (execute): 2023-02-27 13:38:56.283396 => 2023-02-27 13:38:57.275576
[0m13:38:57.276020 [debug] [Thread-1  ]: On test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: Close
[0m13:38:57.400000 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1 seconds
[0m13:38:57.402667 [debug] [Thread-4  ]: Timing info for test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e (execute): 2023-02-27 13:38:56.442299 => 2023-02-27 13:38:57.402595
[0m13:38:57.402990 [debug] [Thread-4  ]: On test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m13:38:57.562558 [info ] [Thread-1  ]: 6 of 7 PASS relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [[32mPASS[0m in 1.29s]
[0m13:38:57.563340 [debug] [Thread-1  ]: Finished running node test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m13:38:57.580376 [info ] [Thread-3  ]: 5 of 7 PASS not_null_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 1.35s]
[0m13:38:57.581004 [debug] [Thread-3  ]: Finished running node test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m13:38:57.673099 [info ] [Thread-4  ]: 7 of 7 PASS unique_dim_listings_cleansed_listing_id ............................ [[32mPASS[0m in 1.24s]
[0m13:38:57.673739 [debug] [Thread-4  ]: Finished running node test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m13:38:57.675701 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:38:57.676406 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:38:57.676677 [debug] [MainThread]: Connection 'test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad' was properly closed.
[0m13:38:57.676917 [debug] [MainThread]: Connection 'test.dbtlearm.consistent_created_at' was properly closed.
[0m13:38:57.677149 [debug] [MainThread]: Connection 'test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9' was properly closed.
[0m13:38:57.677378 [debug] [MainThread]: Connection 'test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m13:38:57.677654 [info ] [MainThread]: 
[0m13:38:57.678011 [info ] [MainThread]: Finished running 7 tests in 0 hours 0 minutes and 5.20 seconds (5.20s).
[0m13:38:57.678708 [debug] [MainThread]: Command end result
[0m13:38:57.689864 [info ] [MainThread]: 
[0m13:38:57.690493 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:38:57.690908 [info ] [MainThread]: 
[0m13:38:57.691269 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m13:38:57.691702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79c0292e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79c0292b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79c0292d90>]}
[0m13:38:57.692101 [debug] [MainThread]: Flushing usage events


============================== 2023-02-28 13:42:42.143766 | 39a80c2b-263a-46a1-8397-aa48195b6a0e ==============================
[0m13:42:42.143766 [info ] [MainThread]: Running with dbt=1.4.1
[0m13:42:42.146456 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/mramirez/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'select': ['dim_listings_cleansed'], 'which': 'test', 'rpc_method': 'test'}
[0m13:42:42.146757 [debug] [MainThread]: Tracking: tracking
[0m13:42:42.147273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff631fc4100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff631fc4df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff631fc4d00>]}
[0m13:42:42.406884 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m13:42:42.407392 [debug] [MainThread]: Partial parsing: added file: dbtlearm://tests/no_nulls_in_dim_listings.sql
[0m13:42:42.407666 [debug] [MainThread]: Partial parsing: added file: dbtlearm://macros/no_nulls_in_columns.sql
[0m13:42:42.452966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '39a80c2b-263a-46a1-8397-aa48195b6a0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6322e10d0>]}
[0m13:42:42.471346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '39a80c2b-263a-46a1-8397-aa48195b6a0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff63229fe50>]}
[0m13:42:42.471880 [info ] [MainThread]: Found 8 models, 8 tests, 2 snapshots, 0 analyses, 305 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m13:42:42.472261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39a80c2b-263a-46a1-8397-aa48195b6a0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff632296d30>]}
[0m13:42:42.474349 [info ] [MainThread]: 
[0m13:42:42.476339 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:42:42.477905 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m13:42:42.494226 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m13:42:42.494664 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m13:42:42.494957 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:42:45.208731 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 3 seconds
[0m13:42:45.211443 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m13:42:45.512980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39a80c2b-263a-46a1-8397-aa48195b6a0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff631fc41c0>]}
[0m13:42:45.513930 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:42:45.514350 [info ] [MainThread]: 
[0m13:42:45.533537 [debug] [Thread-1  ]: Began running node test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m13:42:45.534021 [info ] [Thread-1  ]: 1 of 8 START test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [RUN]
[0m13:42:45.534859 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af'
[0m13:42:45.535289 [debug] [Thread-2  ]: Began running node test.dbtlearm.consistent_created_at
[0m13:42:45.535570 [debug] [Thread-1  ]: Began compiling node test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m13:42:45.535870 [debug] [Thread-3  ]: Began running node test.dbtlearm.dim_listings_minimum_nights
[0m13:42:45.536205 [info ] [Thread-2  ]: 2 of 8 START test consistent_created_at ........................................ [RUN]
[0m13:42:45.536658 [debug] [Thread-4  ]: Began running node test.dbtlearm.no_nulls_in_dim_listings
[0m13:42:45.553104 [info ] [Thread-3  ]: 3 of 8 START test dim_listings_minimum_nights .................................. [RUN]
[0m13:42:45.555138 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m13:42:45.555818 [debug] [Thread-2  ]: Acquiring new snowflake connection 'test.dbtlearm.consistent_created_at'
[0m13:42:45.556146 [info ] [Thread-4  ]: 4 of 8 START test no_nulls_in_dim_listings ..................................... [RUN]
[0m13:42:45.556843 [debug] [Thread-3  ]: Acquiring new snowflake connection 'test.dbtlearm.dim_listings_minimum_nights'
[0m13:42:45.557290 [debug] [Thread-2  ]: Began compiling node test.dbtlearm.consistent_created_at
[0m13:42:45.557934 [debug] [Thread-4  ]: Acquiring new snowflake connection 'test.dbtlearm.no_nulls_in_dim_listings'
[0m13:42:45.558280 [debug] [Thread-3  ]: Began compiling node test.dbtlearm.dim_listings_minimum_nights
[0m13:42:45.562535 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearm.consistent_created_at"
[0m13:42:45.562961 [debug] [Thread-4  ]: Began compiling node test.dbtlearm.no_nulls_in_dim_listings
[0m13:42:45.563263 [debug] [Thread-1  ]: Timing info for test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (compile): 2023-02-28 13:42:45.536919 => 2023-02-28 13:42:45.563175
[0m13:42:45.565974 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearm.dim_listings_minimum_nights"
[0m13:42:45.579540 [debug] [Thread-4  ]: Using snowflake connection "test.dbtlearm.no_nulls_in_dim_listings"
[0m13:42:45.579868 [debug] [Thread-2  ]: Timing info for test.dbtlearm.consistent_created_at (compile): 2023-02-28 13:42:45.558520 => 2023-02-28 13:42:45.579791
[0m13:42:45.580141 [debug] [Thread-1  ]: Began executing node test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m13:42:45.580562 [debug] [Thread-4  ]: On test.dbtlearm.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "test.dbtlearm.no_nulls_in_dim_listings"} */
describe table airbnb.dev.dim_listings_cleansed
[0m13:42:45.580894 [debug] [Thread-2  ]: Began executing node test.dbtlearm.consistent_created_at
[0m13:42:45.605006 [debug] [Thread-3  ]: Timing info for test.dbtlearm.dim_listings_minimum_nights (compile): 2023-02-28 13:42:45.563488 => 2023-02-28 13:42:45.604926
[0m13:42:45.605234 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m13:42:45.607290 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m13:42:45.610289 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbtlearm.consistent_created_at"
[0m13:42:45.610625 [debug] [Thread-3  ]: Began executing node test.dbtlearm.dim_listings_minimum_nights
[0m13:42:45.615483 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbtlearm.dim_listings_minimum_nights"
[0m13:42:45.616893 [debug] [Thread-2  ]: Using snowflake connection "test.dbtlearm.consistent_created_at"
[0m13:42:45.617689 [debug] [Thread-1  ]: Using snowflake connection "test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m13:42:45.618017 [debug] [Thread-2  ]: On test.dbtlearm.consistent_created_at: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "test.dbtlearm.consistent_created_at"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT *
FROM airbnb.dev.dim_listings_cleansed l
INNER JOIN airbnb.dev.fct_reviews r
USING (listing_id)
WHERE l.created_at >= r.review_date
      
    ) dbt_internal_test
[0m13:42:45.618320 [debug] [Thread-1  ]: On test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        room_type as value_field,
        count(*) as n_records

    from airbnb.dev.dim_listings_cleansed
    group by room_type

)

select *
from all_values
where value_field not in (
    'Entire home/apt','Private room','Shared room','Hotel room'
)



      
    ) dbt_internal_test
[0m13:42:45.618596 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m13:42:45.618836 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:42:45.621143 [debug] [Thread-3  ]: Using snowflake connection "test.dbtlearm.dim_listings_minimum_nights"
[0m13:42:45.621526 [debug] [Thread-3  ]: On test.dbtlearm.dim_listings_minimum_nights: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "test.dbtlearm.dim_listings_minimum_nights"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- Singular test
SELECT  
    *
FROM
    airbnb.dev.dim_listings_cleansed
WHERE minimum_nights < 1
LIMIT 10
      
    ) dbt_internal_test
[0m13:42:45.622388 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:42:47.280119 [debug] [Thread-4  ]: SQL status: SUCCESS 8 in 2 seconds
[0m13:42:47.283213 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearm.no_nulls_in_dim_listings"
[0m13:42:47.284227 [debug] [Thread-4  ]: Timing info for test.dbtlearm.no_nulls_in_dim_listings (compile): 2023-02-28 13:42:45.566485 => 2023-02-28 13:42:47.284139
[0m13:42:47.284623 [debug] [Thread-4  ]: Began executing node test.dbtlearm.no_nulls_in_dim_listings
[0m13:42:47.288000 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbtlearm.no_nulls_in_dim_listings"
[0m13:42:47.289461 [debug] [Thread-4  ]: Using snowflake connection "test.dbtlearm.no_nulls_in_dim_listings"
[0m13:42:47.289742 [debug] [Thread-4  ]: On test.dbtlearm.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "test.dbtlearm.no_nulls_in_dim_listings"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    SELECT * FROM airbnb.dev.dim_listings_cleansed WHERE
    LISTING_ID IS NULL OR
    LISTING_NAME IS NULL OR
    ROOM_TYPE IS NULL OR
    MINIMUM_NIGHTS IS NULL OR
    HOST_ID IS NULL OR
    PRICE IS NULL OR
    CREATED_AT IS NULL OR
    UPDATED_AT IS NULL OR
    
    FALSE

      
    ) dbt_internal_test
[0m13:42:47.339528 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2 seconds
[0m13:42:47.357440 [debug] [Thread-3  ]: Timing info for test.dbtlearm.dim_listings_minimum_nights (execute): 2023-02-28 13:42:45.613063 => 2023-02-28 13:42:47.357355
[0m13:42:47.357824 [debug] [Thread-3  ]: On test.dbtlearm.dim_listings_minimum_nights: Close
[0m13:42:47.512588 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2 seconds
[0m13:42:47.515419 [debug] [Thread-1  ]: Timing info for test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (execute): 2023-02-28 13:42:45.581122 => 2023-02-28 13:42:47.515340
[0m13:42:47.515790 [debug] [Thread-1  ]: On test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: Close
[0m13:42:47.680464 [info ] [Thread-3  ]: 3 of 8 PASS dim_listings_minimum_nights ........................................ [[32mPASS[0m in 2.12s]
[0m13:42:47.682741 [debug] [Thread-3  ]: Finished running node test.dbtlearm.dim_listings_minimum_nights
[0m13:42:47.683487 [debug] [Thread-3  ]: Began running node test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be
[0m13:42:47.683881 [info ] [Thread-3  ]: 5 of 8 START test not_null_dim_listings_cleansed_host_id ....................... [RUN]
[0m13:42:47.684774 [debug] [Thread-3  ]: Acquiring new snowflake connection 'test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be'
[0m13:42:47.685089 [debug] [Thread-3  ]: Began compiling node test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be
[0m13:42:47.693729 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m13:42:47.697420 [debug] [Thread-3  ]: Timing info for test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be (compile): 2023-02-28 13:42:47.685311 => 2023-02-28 13:42:47.697309
[0m13:42:47.697824 [debug] [Thread-3  ]: Began executing node test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be
[0m13:42:47.701016 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m13:42:47.704714 [debug] [Thread-3  ]: Using snowflake connection "test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m13:42:47.705076 [debug] [Thread-3  ]: On test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from airbnb.dev.dim_listings_cleansed
where host_id is null



      
    ) dbt_internal_test
[0m13:42:47.705462 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m13:42:47.810187 [info ] [Thread-1  ]: 1 of 8 PASS accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[32mPASS[0m in 2.28s]
[0m13:42:47.810726 [debug] [Thread-1  ]: Finished running node test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m13:42:47.811129 [debug] [Thread-1  ]: Began running node test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m13:42:47.811514 [info ] [Thread-1  ]: 6 of 8 START test not_null_dim_listings_cleansed_listing_id .................... [RUN]
[0m13:42:47.812261 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9'
[0m13:42:47.812572 [debug] [Thread-1  ]: Began compiling node test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m13:42:47.818245 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m13:42:47.822496 [debug] [Thread-1  ]: Timing info for test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9 (compile): 2023-02-28 13:42:47.812797 => 2023-02-28 13:42:47.822369
[0m13:42:47.823046 [debug] [Thread-1  ]: Began executing node test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m13:42:47.826068 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m13:42:47.829399 [debug] [Thread-1  ]: Using snowflake connection "test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m13:42:47.829688 [debug] [Thread-1  ]: On test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from airbnb.dev.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m13:42:47.829944 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:42:48.497714 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1 seconds
[0m13:42:48.500778 [debug] [Thread-4  ]: Timing info for test.dbtlearm.no_nulls_in_dim_listings (execute): 2023-02-28 13:42:47.284885 => 2023-02-28 13:42:48.500696
[0m13:42:48.501149 [debug] [Thread-4  ]: On test.dbtlearm.no_nulls_in_dim_listings: Close
[0m13:42:48.572996 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1 seconds
[0m13:42:48.575835 [debug] [Thread-3  ]: Timing info for test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be (execute): 2023-02-28 13:42:47.698047 => 2023-02-28 13:42:48.575756
[0m13:42:48.576189 [debug] [Thread-3  ]: On test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be: Close
[0m13:42:48.695561 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m13:42:48.698165 [debug] [Thread-1  ]: Timing info for test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9 (execute): 2023-02-28 13:42:47.823281 => 2023-02-28 13:42:48.698086
[0m13:42:48.698523 [debug] [Thread-1  ]: On test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m13:42:48.768739 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 3 seconds
[0m13:42:48.771661 [debug] [Thread-2  ]: Timing info for test.dbtlearm.consistent_created_at (execute): 2023-02-28 13:42:45.607658 => 2023-02-28 13:42:48.771570
[0m13:42:48.772032 [debug] [Thread-2  ]: On test.dbtlearm.consistent_created_at: Close
[0m13:42:48.789255 [info ] [Thread-4  ]: 4 of 8 PASS no_nulls_in_dim_listings ........................................... [[32mPASS[0m in 3.23s]
[0m13:42:48.789878 [debug] [Thread-4  ]: Finished running node test.dbtlearm.no_nulls_in_dim_listings
[0m13:42:48.790419 [debug] [Thread-4  ]: Began running node test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m13:42:48.790882 [info ] [Thread-4  ]: 7 of 8 START test relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [RUN]
[0m13:42:48.791925 [debug] [Thread-4  ]: Acquiring new snowflake connection 'test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad'
[0m13:42:48.792338 [debug] [Thread-4  ]: Began compiling node test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m13:42:48.803101 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m13:42:48.807740 [info ] [Thread-3  ]: 5 of 8 PASS not_null_dim_listings_cleansed_host_id ............................. [[32mPASS[0m in 1.12s]
[0m13:42:48.808334 [debug] [Thread-3  ]: Finished running node test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be
[0m13:42:48.808858 [debug] [Thread-3  ]: Began running node test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m13:42:48.809186 [debug] [Thread-4  ]: Timing info for test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (compile): 2023-02-28 13:42:48.792597 => 2023-02-28 13:42:48.809118
[0m13:42:48.809527 [info ] [Thread-3  ]: 8 of 8 START test unique_dim_listings_cleansed_listing_id ...................... [RUN]
[0m13:42:48.809970 [debug] [Thread-4  ]: Began executing node test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m13:42:48.810739 [debug] [Thread-3  ]: Acquiring new snowflake connection 'test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e'
[0m13:42:48.814042 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m13:42:48.814407 [debug] [Thread-3  ]: Began compiling node test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m13:42:48.822129 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m13:42:48.823382 [debug] [Thread-4  ]: Using snowflake connection "test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m13:42:48.823682 [debug] [Thread-4  ]: On test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select host_id as from_field
    from airbnb.dev.dim_listings_cleansed
    where host_id is not null
),

parent as (
    select host_id as to_field
    from airbnb.dev.dim_hosts_cleansed
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m13:42:48.824022 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m13:42:48.827058 [debug] [Thread-3  ]: Timing info for test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e (compile): 2023-02-28 13:42:48.814785 => 2023-02-28 13:42:48.826962
[0m13:42:48.827445 [debug] [Thread-3  ]: Began executing node test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m13:42:48.830567 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m13:42:48.834797 [debug] [Thread-3  ]: Using snowflake connection "test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m13:42:48.835086 [debug] [Thread-3  ]: On test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from airbnb.dev.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:42:48.835354 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m13:42:48.932321 [info ] [Thread-1  ]: 6 of 8 PASS not_null_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 1.12s]
[0m13:42:48.932847 [debug] [Thread-1  ]: Finished running node test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m13:42:49.026149 [info ] [Thread-2  ]: 2 of 8 PASS consistent_created_at .............................................. [[32mPASS[0m in 3.47s]
[0m13:42:49.026753 [debug] [Thread-2  ]: Finished running node test.dbtlearm.consistent_created_at
[0m13:42:49.853476 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1 seconds
[0m13:42:49.857254 [debug] [Thread-3  ]: Timing info for test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e (execute): 2023-02-28 13:42:48.827719 => 2023-02-28 13:42:49.857157
[0m13:42:49.857702 [debug] [Thread-3  ]: On test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m13:42:50.087470 [info ] [Thread-3  ]: 8 of 8 PASS unique_dim_listings_cleansed_listing_id ............................ [[32mPASS[0m in 1.28s]
[0m13:42:50.088166 [debug] [Thread-3  ]: Finished running node test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m13:42:50.138151 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1 seconds
[0m13:42:50.141091 [debug] [Thread-4  ]: Timing info for test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (execute): 2023-02-28 13:42:48.811004 => 2023-02-28 13:42:50.141011
[0m13:42:50.141455 [debug] [Thread-4  ]: On test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: Close
[0m13:42:50.382546 [info ] [Thread-4  ]: 7 of 8 PASS relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [[32mPASS[0m in 1.59s]
[0m13:42:50.383175 [debug] [Thread-4  ]: Finished running node test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m13:42:50.385035 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:42:50.385777 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:42:50.386053 [debug] [MainThread]: Connection 'test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9' was properly closed.
[0m13:42:50.386300 [debug] [MainThread]: Connection 'test.dbtlearm.consistent_created_at' was properly closed.
[0m13:42:50.386541 [debug] [MainThread]: Connection 'test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m13:42:50.386778 [debug] [MainThread]: Connection 'test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad' was properly closed.
[0m13:42:50.387078 [info ] [MainThread]: 
[0m13:42:50.387448 [info ] [MainThread]: Finished running 8 tests in 0 hours 0 minutes and 7.91 seconds (7.91s).
[0m13:42:50.388211 [debug] [MainThread]: Command end result
[0m13:42:50.402540 [info ] [MainThread]: 
[0m13:42:50.403023 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:42:50.403376 [info ] [MainThread]: 
[0m13:42:50.403716 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m13:42:50.404142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6323d6280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6323d6f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6323d61f0>]}
[0m13:42:50.404502 [debug] [MainThread]: Flushing usage events


============================== 2023-03-01 13:19:27.839675 | d6549b82-0980-49e5-96db-031f8e17d9e9 ==============================
[0m13:19:27.839675 [info ] [MainThread]: Running with dbt=1.4.1
[0m13:19:27.842219 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/mramirez/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'select': ['dim_listings_cleansed'], 'which': 'test', 'rpc_method': 'test'}
[0m13:19:27.842508 [debug] [MainThread]: Tracking: tracking
[0m13:19:27.842972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff26fb48100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff26fb48df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff26fb48d00>]}
[0m13:19:28.182426 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m13:19:28.182991 [debug] [MainThread]: Partial parsing: added file: dbtlearm://macros/positive_value.sql
[0m13:19:28.183517 [debug] [MainThread]: Partial parsing: updated file: dbtlearm://models/schema.yml
[0m13:19:28.191281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff26fc836a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff26fbfc9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff26fbfcd00>]}
[0m13:19:28.191739 [debug] [MainThread]: Flushing usage events
[0m13:19:28.832941 [error] [MainThread]: Encountered an error:
Compilation Error
  expected token 'end of statement block', got '%'
    line 8
      {% endtest %%}


============================== 2023-03-01 13:19:45.564914 | 51be26fa-16e8-4f4f-b6de-3db8a52047a7 ==============================
[0m13:19:45.564914 [info ] [MainThread]: Running with dbt=1.4.1
[0m13:19:45.567442 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/mramirez/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'select': ['dim_listings_cleansed'], 'which': 'test', 'rpc_method': 'test'}
[0m13:19:45.567848 [debug] [MainThread]: Tracking: tracking
[0m13:19:45.568372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f967db89100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f967db89df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f967db89d00>]}
[0m13:19:45.651485 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m13:19:45.651939 [debug] [MainThread]: Partial parsing: added file: dbtlearm://macros/positive_value.sql
[0m13:19:45.652374 [debug] [MainThread]: Partial parsing: updated file: dbtlearm://models/schema.yml
[0m13:19:45.668736 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m13:19:45.762328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '51be26fa-16e8-4f4f-b6de-3db8a52047a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f967dbcf7c0>]}
[0m13:19:45.906718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '51be26fa-16e8-4f4f-b6de-3db8a52047a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f967dcce400>]}
[0m13:19:45.907126 [info ] [MainThread]: Found 8 models, 9 tests, 2 snapshots, 0 analyses, 306 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m13:19:45.907420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51be26fa-16e8-4f4f-b6de-3db8a52047a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f967dcce3a0>]}
[0m13:19:45.909104 [info ] [MainThread]: 
[0m13:19:45.910639 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:19:45.911935 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m13:19:45.924447 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m13:19:45.924769 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m13:19:45.925072 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:19:52.934508 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 7 seconds
[0m13:19:52.936853 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m13:19:53.209584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51be26fa-16e8-4f4f-b6de-3db8a52047a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f967dcce160>]}
[0m13:19:53.211154 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:19:53.211775 [info ] [MainThread]: 
[0m13:19:53.230702 [debug] [Thread-1  ]: Began running node test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m13:19:53.231113 [debug] [Thread-2  ]: Began running node test.dbtlearm.consistent_created_at
[0m13:19:53.231472 [debug] [Thread-3  ]: Began running node test.dbtlearm.dim_listings_minimum_nights
[0m13:19:53.231792 [debug] [Thread-4  ]: Began running node test.dbtlearm.no_nulls_in_dim_listings
[0m13:19:53.232055 [info ] [Thread-1  ]: 1 of 9 START test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [RUN]
[0m13:19:53.232468 [info ] [Thread-2  ]: 2 of 9 START test consistent_created_at ........................................ [RUN]
[0m13:19:53.232884 [info ] [Thread-3  ]: 3 of 9 START test dim_listings_minimum_nights .................................. [RUN]
[0m13:19:53.233314 [info ] [Thread-4  ]: 4 of 9 START test no_nulls_in_dim_listings ..................................... [RUN]
[0m13:19:53.234173 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af'
[0m13:19:53.234815 [debug] [Thread-2  ]: Acquiring new snowflake connection 'test.dbtlearm.consistent_created_at'
[0m13:19:53.235453 [debug] [Thread-3  ]: Acquiring new snowflake connection 'test.dbtlearm.dim_listings_minimum_nights'
[0m13:19:53.236212 [debug] [Thread-4  ]: Acquiring new snowflake connection 'test.dbtlearm.no_nulls_in_dim_listings'
[0m13:19:53.236548 [debug] [Thread-1  ]: Began compiling node test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m13:19:53.236868 [debug] [Thread-2  ]: Began compiling node test.dbtlearm.consistent_created_at
[0m13:19:53.237178 [debug] [Thread-3  ]: Began compiling node test.dbtlearm.dim_listings_minimum_nights
[0m13:19:53.237480 [debug] [Thread-4  ]: Began compiling node test.dbtlearm.no_nulls_in_dim_listings
[0m13:19:53.245642 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m13:19:53.249095 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearm.consistent_created_at"
[0m13:19:53.252123 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearm.dim_listings_minimum_nights"
[0m13:19:53.266896 [debug] [Thread-4  ]: Using snowflake connection "test.dbtlearm.no_nulls_in_dim_listings"
[0m13:19:53.267631 [debug] [Thread-4  ]: On test.dbtlearm.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "test.dbtlearm.no_nulls_in_dim_listings"} */
describe table airbnb.dev.dim_listings_cleansed
[0m13:19:53.267933 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m13:19:53.273581 [debug] [Thread-1  ]: Timing info for test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (compile): 2023-03-01 13:19:53.237723 => 2023-03-01 13:19:53.273442
[0m13:19:53.274017 [debug] [Thread-1  ]: Began executing node test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m13:19:53.298836 [debug] [Thread-2  ]: Timing info for test.dbtlearm.consistent_created_at (compile): 2023-03-01 13:19:53.245982 => 2023-03-01 13:19:53.298739
[0m13:19:53.299163 [debug] [Thread-3  ]: Timing info for test.dbtlearm.dim_listings_minimum_nights (compile): 2023-03-01 13:19:53.249418 => 2023-03-01 13:19:53.299095
[0m13:19:53.303829 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m13:19:53.304351 [debug] [Thread-2  ]: Began executing node test.dbtlearm.consistent_created_at
[0m13:19:53.304681 [debug] [Thread-3  ]: Began executing node test.dbtlearm.dim_listings_minimum_nights
[0m13:19:53.307793 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbtlearm.consistent_created_at"
[0m13:19:53.310707 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbtlearm.dim_listings_minimum_nights"
[0m13:19:53.311842 [debug] [Thread-1  ]: Using snowflake connection "test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m13:19:53.312291 [debug] [Thread-1  ]: On test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        room_type as value_field,
        count(*) as n_records

    from airbnb.dev.dim_listings_cleansed
    group by room_type

)

select *
from all_values
where value_field not in (
    'Entire home/apt','Private room','Shared room','Hotel room'
)



      
    ) dbt_internal_test
[0m13:19:53.312562 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:19:53.315805 [debug] [Thread-2  ]: Using snowflake connection "test.dbtlearm.consistent_created_at"
[0m13:19:53.316463 [debug] [Thread-3  ]: Using snowflake connection "test.dbtlearm.dim_listings_minimum_nights"
[0m13:19:53.316731 [debug] [Thread-2  ]: On test.dbtlearm.consistent_created_at: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "test.dbtlearm.consistent_created_at"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT *
FROM airbnb.dev.dim_listings_cleansed l
INNER JOIN airbnb.dev.fct_reviews r
USING (listing_id)
WHERE l.created_at >= r.review_date
      
    ) dbt_internal_test
[0m13:19:53.317066 [debug] [Thread-3  ]: On test.dbtlearm.dim_listings_minimum_nights: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "test.dbtlearm.dim_listings_minimum_nights"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- Singular test
SELECT  
    *
FROM
    airbnb.dev.dim_listings_cleansed
WHERE minimum_nights < 1
LIMIT 10
      
    ) dbt_internal_test
[0m13:19:53.317340 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m13:19:53.317598 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:19:54.445794 [debug] [Thread-4  ]: SQL status: SUCCESS 8 in 1 seconds
[0m13:19:54.449032 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearm.no_nulls_in_dim_listings"
[0m13:19:54.452968 [debug] [Thread-4  ]: Timing info for test.dbtlearm.no_nulls_in_dim_listings (compile): 2023-03-01 13:19:53.252433 => 2023-03-01 13:19:54.452839
[0m13:19:54.453440 [debug] [Thread-4  ]: Began executing node test.dbtlearm.no_nulls_in_dim_listings
[0m13:19:54.456958 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbtlearm.no_nulls_in_dim_listings"
[0m13:19:54.460970 [debug] [Thread-4  ]: Using snowflake connection "test.dbtlearm.no_nulls_in_dim_listings"
[0m13:19:54.461270 [debug] [Thread-4  ]: On test.dbtlearm.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "test.dbtlearm.no_nulls_in_dim_listings"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    SELECT * FROM airbnb.dev.dim_listings_cleansed WHERE
    LISTING_ID IS NULL OR
    LISTING_NAME IS NULL OR
    ROOM_TYPE IS NULL OR
    MINIMUM_NIGHTS IS NULL OR
    HOST_ID IS NULL OR
    PRICE IS NULL OR
    CREATED_AT IS NULL OR
    UPDATED_AT IS NULL OR
    
    FALSE

      
    ) dbt_internal_test
[0m13:19:55.933300 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3 seconds
[0m13:19:55.957479 [debug] [Thread-1  ]: Timing info for test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (execute): 2023-03-01 13:19:53.274264 => 2023-03-01 13:19:55.957388
[0m13:19:55.957899 [debug] [Thread-1  ]: On test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: Close
[0m13:19:55.979799 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 3 seconds
[0m13:19:55.982313 [debug] [Thread-3  ]: Timing info for test.dbtlearm.dim_listings_minimum_nights (execute): 2023-03-01 13:19:53.308112 => 2023-03-01 13:19:55.982230
[0m13:19:55.983571 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 2 seconds
[0m13:19:55.983865 [debug] [Thread-3  ]: On test.dbtlearm.dim_listings_minimum_nights: Close
[0m13:19:55.986099 [debug] [Thread-4  ]: Timing info for test.dbtlearm.no_nulls_in_dim_listings (execute): 2023-03-01 13:19:54.453715 => 2023-03-01 13:19:55.986040
[0m13:19:55.987479 [debug] [Thread-4  ]: On test.dbtlearm.no_nulls_in_dim_listings: Close
[0m13:19:56.207441 [info ] [Thread-1  ]: 1 of 9 PASS accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[32mPASS[0m in 2.97s]
[0m13:19:56.210010 [debug] [Thread-1  ]: Finished running node test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m13:19:56.210979 [debug] [Thread-1  ]: Began running node test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be
[0m13:19:56.214593 [info ] [Thread-1  ]: 5 of 9 START test not_null_dim_listings_cleansed_host_id ....................... [RUN]
[0m13:19:56.215409 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be'
[0m13:19:56.215730 [debug] [Thread-1  ]: Began compiling node test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be
[0m13:19:56.232121 [info ] [Thread-4  ]: 4 of 9 PASS no_nulls_in_dim_listings ........................................... [[32mPASS[0m in 3.00s]
[0m13:19:56.233855 [debug] [Thread-4  ]: Finished running node test.dbtlearm.no_nulls_in_dim_listings
[0m13:19:56.234541 [debug] [Thread-4  ]: Began running node test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m13:19:56.235017 [info ] [Thread-4  ]: 6 of 9 START test not_null_dim_listings_cleansed_listing_id .................... [RUN]
[0m13:19:56.236277 [debug] [Thread-4  ]: Acquiring new snowflake connection 'test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9'
[0m13:19:56.236828 [debug] [Thread-4  ]: Began compiling node test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m13:19:56.249988 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m13:19:56.252993 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m13:19:56.256721 [info ] [Thread-3  ]: 3 of 9 PASS dim_listings_minimum_nights ........................................ [[32mPASS[0m in 3.02s]
[0m13:19:56.257651 [debug] [Thread-3  ]: Finished running node test.dbtlearm.dim_listings_minimum_nights
[0m13:19:56.258322 [debug] [Thread-3  ]: Began running node test.dbtlearm.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m13:19:56.258874 [info ] [Thread-3  ]: 7 of 9 START test positive_value_dim_listings_cleansed_minimum_nights .......... [RUN]
[0m13:19:56.260334 [debug] [Thread-3  ]: Acquiring new snowflake connection 'test.dbtlearm.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313'
[0m13:19:56.261045 [debug] [Thread-3  ]: Began compiling node test.dbtlearm.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m13:19:56.267966 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearm.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m13:19:56.268747 [debug] [Thread-4  ]: Timing info for test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9 (compile): 2023-03-01 13:19:56.237322 => 2023-03-01 13:19:56.268664
[0m13:19:56.269014 [debug] [Thread-1  ]: Timing info for test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be (compile): 2023-03-01 13:19:56.215954 => 2023-03-01 13:19:56.268949
[0m13:19:56.269452 [debug] [Thread-4  ]: Began executing node test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m13:19:56.269761 [debug] [Thread-3  ]: Timing info for test.dbtlearm.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313 (compile): 2023-03-01 13:19:56.261460 => 2023-03-01 13:19:56.269704
[0m13:19:56.270053 [debug] [Thread-1  ]: Began executing node test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be
[0m13:19:56.273840 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m13:19:56.274342 [debug] [Thread-3  ]: Began executing node test.dbtlearm.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m13:19:56.278581 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m13:19:56.285064 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbtlearm.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m13:19:56.295690 [debug] [Thread-4  ]: Using snowflake connection "test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m13:19:56.297322 [debug] [Thread-4  ]: On test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from airbnb.dev.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m13:19:56.298034 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m13:19:56.301488 [debug] [Thread-3  ]: Using snowflake connection "test.dbtlearm.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m13:19:56.302327 [debug] [Thread-3  ]: On test.dbtlearm.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "test.dbtlearm.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
SELECT
    *
FROM
    airbnb.dev.dim_listings_cleansed
WHERE
    minimum_nights < 1

      
    ) dbt_internal_test
[0m13:19:56.303095 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m13:19:56.310882 [debug] [Thread-1  ]: Using snowflake connection "test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m13:19:56.311247 [debug] [Thread-1  ]: On test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from airbnb.dev.dim_listings_cleansed
where host_id is null



      
    ) dbt_internal_test
[0m13:19:56.311768 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:19:56.477514 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 3 seconds
[0m13:19:56.479340 [debug] [Thread-2  ]: Timing info for test.dbtlearm.consistent_created_at (execute): 2023-03-01 13:19:53.305037 => 2023-03-01 13:19:56.479281
[0m13:19:56.479577 [debug] [Thread-2  ]: On test.dbtlearm.consistent_created_at: Close
[0m13:19:56.751993 [info ] [Thread-2  ]: 2 of 9 PASS consistent_created_at .............................................. [[32mPASS[0m in 3.52s]
[0m13:19:56.787687 [debug] [Thread-2  ]: Finished running node test.dbtlearm.consistent_created_at
[0m13:19:56.854389 [debug] [Thread-2  ]: Began running node test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m13:19:56.884195 [info ] [Thread-2  ]: 8 of 9 START test relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [RUN]
[0m13:19:56.908309 [debug] [Thread-2  ]: Acquiring new snowflake connection 'test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad'
[0m13:19:56.944483 [debug] [Thread-2  ]: Began compiling node test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m13:19:56.972481 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m13:19:57.053661 [debug] [Thread-2  ]: Timing info for test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (compile): 2023-03-01 13:19:56.967702 => 2023-03-01 13:19:57.053576
[0m13:19:57.070923 [debug] [Thread-2  ]: Began executing node test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m13:19:57.073433 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m13:19:57.118018 [debug] [Thread-2  ]: Using snowflake connection "test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m13:19:57.118757 [debug] [Thread-2  ]: On test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select host_id as from_field
    from airbnb.dev.dim_listings_cleansed
    where host_id is not null
),

parent as (
    select host_id as to_field
    from airbnb.dev.dim_hosts_cleansed
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m13:19:57.118983 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m13:19:57.820095 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2 seconds
[0m13:19:57.822929 [debug] [Thread-3  ]: Timing info for test.dbtlearm.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313 (execute): 2023-03-01 13:19:56.279140 => 2023-03-01 13:19:57.822839
[0m13:19:57.823330 [debug] [Thread-3  ]: On test.dbtlearm.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313: Close
[0m13:19:57.947033 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 2 seconds
[0m13:19:57.949955 [debug] [Thread-4  ]: Timing info for test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9 (execute): 2023-03-01 13:19:56.270285 => 2023-03-01 13:19:57.949874
[0m13:19:57.950326 [debug] [Thread-4  ]: On test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m13:19:57.952718 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2 seconds
[0m13:19:57.954711 [debug] [Thread-1  ]: Timing info for test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be (execute): 2023-03-01 13:19:56.274618 => 2023-03-01 13:19:57.954643
[0m13:19:57.955096 [debug] [Thread-1  ]: On test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be: Close
[0m13:19:58.068890 [info ] [Thread-3  ]: 7 of 9 PASS positive_value_dim_listings_cleansed_minimum_nights ................ [[32mPASS[0m in 1.81s]
[0m13:19:58.069380 [debug] [Thread-3  ]: Finished running node test.dbtlearm.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m13:19:58.069764 [debug] [Thread-3  ]: Began running node test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m13:19:58.070118 [info ] [Thread-3  ]: 9 of 9 START test unique_dim_listings_cleansed_listing_id ...................... [RUN]
[0m13:19:58.070789 [debug] [Thread-3  ]: Acquiring new snowflake connection 'test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e'
[0m13:19:58.071085 [debug] [Thread-3  ]: Began compiling node test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m13:19:58.078956 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m13:19:58.082425 [debug] [Thread-3  ]: Timing info for test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e (compile): 2023-03-01 13:19:58.071295 => 2023-03-01 13:19:58.082322
[0m13:19:58.082801 [debug] [Thread-3  ]: Began executing node test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m13:19:58.085749 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m13:19:58.089555 [debug] [Thread-3  ]: Using snowflake connection "test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m13:19:58.089914 [debug] [Thread-3  ]: On test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from airbnb.dev.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:19:58.090253 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m13:19:58.174965 [info ] [Thread-4  ]: 6 of 9 PASS not_null_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 1.94s]
[0m13:19:58.175518 [debug] [Thread-4  ]: Finished running node test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m13:19:58.204243 [info ] [Thread-1  ]: 5 of 9 PASS not_null_dim_listings_cleansed_host_id ............................. [[32mPASS[0m in 1.99s]
[0m13:19:58.204763 [debug] [Thread-1  ]: Finished running node test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be
[0m13:19:58.281659 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1 seconds
[0m13:19:58.284169 [debug] [Thread-2  ]: Timing info for test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (execute): 2023-03-01 13:19:57.071168 => 2023-03-01 13:19:58.284093
[0m13:19:58.284509 [debug] [Thread-2  ]: On test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: Close
[0m13:19:58.542101 [info ] [Thread-2  ]: 8 of 9 PASS relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [[32mPASS[0m in 1.63s]
[0m13:19:58.564604 [debug] [Thread-2  ]: Finished running node test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m13:19:59.115921 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1 seconds
[0m13:19:59.118649 [debug] [Thread-3  ]: Timing info for test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e (execute): 2023-03-01 13:19:58.083034 => 2023-03-01 13:19:59.118565
[0m13:19:59.119021 [debug] [Thread-3  ]: On test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m13:19:59.381550 [info ] [Thread-3  ]: 9 of 9 PASS unique_dim_listings_cleansed_listing_id ............................ [[32mPASS[0m in 1.31s]
[0m13:19:59.382171 [debug] [Thread-3  ]: Finished running node test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m13:19:59.384576 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:19:59.385347 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:19:59.385621 [debug] [MainThread]: Connection 'test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be' was properly closed.
[0m13:19:59.385862 [debug] [MainThread]: Connection 'test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad' was properly closed.
[0m13:19:59.386097 [debug] [MainThread]: Connection 'test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m13:19:59.386329 [debug] [MainThread]: Connection 'test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9' was properly closed.
[0m13:19:59.386615 [info ] [MainThread]: 
[0m13:19:59.386977 [info ] [MainThread]: Finished running 9 tests in 0 hours 0 minutes and 13.48 seconds (13.48s).
[0m13:19:59.387764 [debug] [MainThread]: Command end result
[0m13:19:59.405149 [info ] [MainThread]: 
[0m13:19:59.405790 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:19:59.406378 [info ] [MainThread]: 
[0m13:19:59.406853 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m13:19:59.407327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f967dc00070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f967de5deb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f967e4cfc70>]}
[0m13:19:59.407733 [debug] [MainThread]: Flushing usage events


============================== 2023-03-01 13:24:20.486012 | a8c990b5-3825-414a-a012-8530d09fad30 ==============================
[0m13:24:20.486012 [info ] [MainThread]: Running with dbt=1.4.1
[0m13:24:20.487482 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/mramirez/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m13:24:20.487718 [debug] [MainThread]: Tracking: tracking
[0m13:24:20.507244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3fc70d100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3fc6ff400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3fc6fffa0>]}
[0m13:24:20.510108 [debug] [MainThread]: Set downloads directory='/var/folders/j5/f7qqc9x90_5bwn0pxybgkx5m0000gp/T/dbt-downloads-0tgpc9kz'
[0m13:24:20.511156 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m13:24:21.042668 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m13:24:21.043352 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m13:24:21.309470 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m13:24:21.371621 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m13:24:22.192209 [info ] [MainThread]:   Installed from version 1.0.0
[0m13:24:22.192917 [info ] [MainThread]:   Up to date!
[0m13:24:22.193696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a8c990b5-3825-414a-a012-8530d09fad30', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3fc6fffa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3fc77c0a0>]}
[0m13:24:22.196267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3fc7772e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3fc691670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3fc70dbe0>]}
[0m13:24:22.196915 [debug] [MainThread]: Flushing usage events


============================== 2023-03-01 13:28:37.856668 | 8ead2863-efdd-4c46-96e2-80da9ed8cb24 ==============================
[0m13:28:37.856668 [info ] [MainThread]: Running with dbt=1.4.1
[0m13:28:37.859371 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/mramirez/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:28:37.859981 [debug] [MainThread]: Tracking: tracking
[0m13:28:37.860917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbba3340d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbba3340dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbba334d0d0>]}
[0m13:28:37.901285 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m13:28:37.901733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8ead2863-efdd-4c46-96e2-80da9ed8cb24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbba335e940>]}
[0m13:28:39.045214 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_with_hosts.sql
[0m13:28:39.056321 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m13:28:39.058884 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m13:28:39.061691 [debug] [MainThread]: 1603: static parser failed on fct/fct_reviews.sql
[0m13:28:39.081940 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fct/fct_reviews.sql
[0m13:28:39.083316 [debug] [MainThread]: 1699: static parser successfully parsed mart/mart_fullmoon_review.sql
[0m13:28:39.085713 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m13:28:39.088103 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m13:28:39.090686 [debug] [MainThread]: 1699: static parser successfully parsed src/src_host.sql
[0m13:28:39.256270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8ead2863-efdd-4c46-96e2-80da9ed8cb24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbba38250d0>]}
[0m13:28:39.266991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8ead2863-efdd-4c46-96e2-80da9ed8cb24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb99f79e50>]}
[0m13:28:39.267414 [info ] [MainThread]: Found 8 models, 9 tests, 2 snapshots, 0 analyses, 418 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m13:28:39.267745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ead2863-efdd-4c46-96e2-80da9ed8cb24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbba375bfd0>]}
[0m13:28:39.269492 [info ] [MainThread]: 
[0m13:28:39.271119 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:28:39.272331 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb'
[0m13:28:39.287951 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m13:28:39.288493 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m13:28:39.288784 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:28:43.338356 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 4 seconds
[0m13:28:43.340670 [debug] [ThreadPool]: On list_airbnb: Close
[0m13:28:43.785898 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m13:28:43.844934 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m13:28:43.845371 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m13:28:43.845697 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:28:44.962569 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m13:28:44.964505 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m13:28:45.572448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ead2863-efdd-4c46-96e2-80da9ed8cb24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbba1e479a0>]}
[0m13:28:45.573446 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:28:45.573876 [info ] [MainThread]: 
[0m13:28:45.581757 [debug] [Thread-1  ]: Began running node model.dbtlearm.src_host
[0m13:28:45.582170 [debug] [Thread-2  ]: Began running node model.dbtlearm.src_listings
[0m13:28:45.582582 [debug] [Thread-3  ]: Began running node model.dbtlearm.src_reviews
[0m13:28:45.583217 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearm.src_host'
[0m13:28:45.583902 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearm.src_listings'
[0m13:28:45.584567 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearm.src_reviews'
[0m13:28:45.584904 [debug] [Thread-1  ]: Began compiling node model.dbtlearm.src_host
[0m13:28:45.585222 [debug] [Thread-2  ]: Began compiling node model.dbtlearm.src_listings
[0m13:28:45.585525 [debug] [Thread-3  ]: Began compiling node model.dbtlearm.src_reviews
[0m13:28:45.588951 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearm.src_host"
[0m13:28:45.591862 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearm.src_listings"
[0m13:28:45.595800 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearm.src_reviews"
[0m13:28:45.600309 [debug] [Thread-1  ]: Timing info for model.dbtlearm.src_host (compile): 2023-03-01 13:28:45.585770 => 2023-03-01 13:28:45.600199
[0m13:28:45.600595 [debug] [Thread-3  ]: Timing info for model.dbtlearm.src_reviews (compile): 2023-03-01 13:28:45.592126 => 2023-03-01 13:28:45.600531
[0m13:28:45.600842 [debug] [Thread-2  ]: Timing info for model.dbtlearm.src_listings (compile): 2023-03-01 13:28:45.589209 => 2023-03-01 13:28:45.600774
[0m13:28:45.602880 [debug] [Thread-1  ]: Finished running node model.dbtlearm.src_host
[0m13:28:45.603668 [debug] [Thread-3  ]: Finished running node model.dbtlearm.src_reviews
[0m13:28:45.604418 [debug] [Thread-2  ]: Finished running node model.dbtlearm.src_listings
[0m13:28:45.605129 [debug] [Thread-4  ]: Began running node model.dbtlearm.dim_hosts_cleansed
[0m13:28:45.605636 [debug] [Thread-1  ]: Began running node model.dbtlearm.fct_reviews
[0m13:28:45.606175 [debug] [Thread-3  ]: Began running node model.dbtlearm.dim_listings_cleansed
[0m13:28:45.606586 [info ] [Thread-4  ]: 1 of 5 START sql view model dev.dim_hosts_cleansed ............................. [RUN]
[0m13:28:45.607085 [info ] [Thread-1  ]: 2 of 5 START sql incremental model dev.fct_reviews ............................. [RUN]
[0m13:28:45.607580 [info ] [Thread-3  ]: 3 of 5 START sql view model dev.dim_listings_cleansed .......................... [RUN]
[0m13:28:45.608354 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtlearm.dim_hosts_cleansed'
[0m13:28:45.609133 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearm.fct_reviews'
[0m13:28:45.610008 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearm.dim_listings_cleansed'
[0m13:28:45.610510 [debug] [Thread-4  ]: Began compiling node model.dbtlearm.dim_hosts_cleansed
[0m13:28:45.610861 [debug] [Thread-1  ]: Began compiling node model.dbtlearm.fct_reviews
[0m13:28:45.611183 [debug] [Thread-3  ]: Began compiling node model.dbtlearm.dim_listings_cleansed
[0m13:28:45.620501 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearm.dim_hosts_cleansed"
[0m13:28:45.642991 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearm.dim_listings_cleansed"
[0m13:28:45.649009 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearm.fct_reviews"
[0m13:28:45.652451 [debug] [Thread-1  ]: Timing info for model.dbtlearm.fct_reviews (compile): 2023-03-01 13:28:45.620808 => 2023-03-01 13:28:45.652361
[0m13:28:45.652858 [debug] [Thread-1  ]: Began executing node model.dbtlearm.fct_reviews
[0m13:28:45.653169 [debug] [Thread-4  ]: Timing info for model.dbtlearm.dim_hosts_cleansed (compile): 2023-03-01 13:28:45.611444 => 2023-03-01 13:28:45.653109
[0m13:28:45.659546 [debug] [Thread-3  ]: Timing info for model.dbtlearm.dim_listings_cleansed (compile): 2023-03-01 13:28:45.626325 => 2023-03-01 13:28:45.659470
[0m13:28:45.676327 [debug] [Thread-4  ]: Began executing node model.dbtlearm.dim_hosts_cleansed
[0m13:28:45.694510 [debug] [Thread-3  ]: Began executing node model.dbtlearm.dim_listings_cleansed
[0m13:28:45.715846 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m13:28:45.725090 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtlearm.dim_hosts_cleansed"
[0m13:28:45.729195 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtlearm.dim_listings_cleansed"
[0m13:28:45.729532 [debug] [Thread-1  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
create or replace  temporary view airbnb.dev.fct_reviews__dbt_tmp
  
   as (
    -- Incremental Materialization

WITH  __dbt__cte__src_reviews as (
WITH raw_reviews AS(
	SELECT * FROM airbnb.raw.raw_reviews
)
SELECT
	listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
	raw_reviews
),src_reviews AS (
    SELECt * FROM __dbt__cte__src_reviews
)
SELECT 
    
    
md5(cast(coalesce(cast(listing_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(reviewer_name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_text as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as review_id,
    *
FROM src_reviews
WHERE review_text IS NOT NULL

  AND review_date > (SELECT MAX(review_date) FROM airbnb.dev.fct_reviews)

  );
[0m13:28:45.729984 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:28:45.735212 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearm.dim_listings_cleansed"
[0m13:28:45.736119 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearm.dim_hosts_cleansed"
[0m13:28:45.736375 [debug] [Thread-3  ]: On model.dbtlearm.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.dim_listings_cleansed"} */
create or replace   view airbnb.dev.dim_listings_cleansed
  
   as (
    -- Change Tables for views

WITH  __dbt__cte__src_listings as (
-- DBT knows this is a view
-- By default they are views
WITH raw_listings AS(
	SELECT * FROM airbnb.raw.raw_listings
)
SELECT
	id as listing_id,
    name as listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at
FROM
	raw_listings
),src_listings AS (
    SELECT * FROM __dbt__cte__src_listings
)
SELECT 
    listing_id,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights = 0 THEN 1
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE(
        price_str,
        '$'
    ) :: NUMBER (
        10,
        2
    ) AS price,
    created_at,
    updated_at
FROM
    src_listings
  );
[0m13:28:45.736622 [debug] [Thread-4  ]: On model.dbtlearm.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.dim_hosts_cleansed"} */
create or replace   view airbnb.dev.dim_hosts_cleansed
  
   as (
    -- Change Tables for views

WITH  __dbt__cte__src_host as (
WITH raw_hosts AS(
	SELECT * FROM airbnb.raw.raw_hosts
)
SELECT
	id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
	raw_hosts
),src_hosts AS(
    SELECT * FROM  __dbt__cte__src_host
)
SELECT
    host_id,
    NVL(
        host_name, 
        'Anonymous'
    ) AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
	src_hosts
  );
[0m13:28:45.736860 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:28:45.737092 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m13:28:47.092324 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1 seconds
[0m13:28:47.117012 [debug] [Thread-4  ]: Timing info for model.dbtlearm.dim_hosts_cleansed (execute): 2023-03-01 13:28:45.707001 => 2023-03-01 13:28:47.116944
[0m13:28:47.117381 [debug] [Thread-4  ]: On model.dbtlearm.dim_hosts_cleansed: Close
[0m13:28:47.339803 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ead2863-efdd-4c46-96e2-80da9ed8cb24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbba33bb280>]}
[0m13:28:47.340520 [info ] [Thread-4  ]: 1 of 5 OK created sql view model dev.dim_hosts_cleansed ........................ [[32mSUCCESS 1[0m in 1.73s]
[0m13:28:47.341088 [debug] [Thread-4  ]: Finished running node model.dbtlearm.dim_hosts_cleansed
[0m13:28:48.453981 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3 seconds
[0m13:28:48.466353 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m13:28:48.466729 [debug] [Thread-1  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
describe table airbnb.dev.fct_reviews__dbt_tmp
[0m13:28:48.601698 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0 seconds
[0m13:28:48.606653 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m13:28:48.606934 [debug] [Thread-1  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
describe table airbnb.dev.fct_reviews
[0m13:28:48.934388 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 3 seconds
[0m13:28:48.937790 [debug] [Thread-3  ]: Timing info for model.dbtlearm.dim_listings_cleansed (execute): 2023-03-01 13:28:45.725277 => 2023-03-01 13:28:48.937719
[0m13:28:48.938155 [debug] [Thread-3  ]: On model.dbtlearm.dim_listings_cleansed: Close
[0m13:28:49.195619 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ead2863-efdd-4c46-96e2-80da9ed8cb24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbba335e190>]}
[0m13:28:49.196393 [info ] [Thread-3  ]: 3 of 5 OK created sql view model dev.dim_listings_cleansed ..................... [[32mSUCCESS 1[0m in 3.59s]
[0m13:28:49.196958 [debug] [Thread-3  ]: Finished running node model.dbtlearm.dim_listings_cleansed
[0m13:28:49.197681 [debug] [Thread-2  ]: Began running node model.dbtlearm.dim_listings_with_hosts
[0m13:28:49.198109 [info ] [Thread-2  ]: 4 of 5 START sql table model dev.dim_listings_with_hosts ....................... [RUN]
[0m13:28:49.198890 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearm.dim_listings_with_hosts'
[0m13:28:49.199354 [debug] [Thread-2  ]: Began compiling node model.dbtlearm.dim_listings_with_hosts
[0m13:28:49.203890 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearm.dim_listings_with_hosts"
[0m13:28:49.207676 [debug] [Thread-2  ]: Timing info for model.dbtlearm.dim_listings_with_hosts (compile): 2023-03-01 13:28:49.199614 => 2023-03-01 13:28:49.207595
[0m13:28:49.208023 [debug] [Thread-2  ]: Began executing node model.dbtlearm.dim_listings_with_hosts
[0m13:28:49.235796 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtlearm.dim_listings_with_hosts"
[0m13:28:49.240223 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearm.dim_listings_with_hosts"
[0m13:28:49.240559 [debug] [Thread-2  ]: On model.dbtlearm.dim_listings_with_hosts: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.dim_listings_with_hosts"} */
create or replace transient table airbnb.dev.dim_listings_with_hosts  as
        (WITH
l AS (
    SELECT *
    FROM airbnb.dev.dim_listings_cleansed
),
h AS (
    SELECT *
    FROM airbnb.dev.dim_hosts_cleansed
)
SELECT
    l.listing_id,
    l.listing_name,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost AS host_is_superhost,
    l.created_at,
    GREATEST(l.updated_at, h.updated_at) AS updated_at
FROM l
LEFT JOIN h 
ON h.host_id = l.host_id
        );
[0m13:28:49.240815 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m13:28:49.468160 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 1 seconds
[0m13:28:49.486939 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m13:28:49.487306 [debug] [Thread-1  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
describe table airbnb.dev.fct_reviews__dbt_tmp
[0m13:28:49.636647 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0 seconds
[0m13:28:49.653668 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m13:28:49.659249 [debug] [Thread-1  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m13:28:49.851622 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0 seconds
[0m13:28:49.864319 [debug] [Thread-1  ]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: True
        Source columns not in target: [SnowflakeColumn(column='REVIEW_ID', dtype='VARCHAR', char_size=32, numeric_precision=None, numeric_scale=None)]
        Target columns not in source: []
        New column types: []
  
[0m13:28:49.864869 [debug] [Thread-1  ]: Timing info for model.dbtlearm.fct_reviews (execute): 2023-03-01 13:28:45.653379 => 2023-03-01 13:28:49.864795
[0m13:28:49.865168 [debug] [Thread-1  ]: On model.dbtlearm.fct_reviews: Close
[0m13:28:50.989656 [debug] [Thread-1  ]: Compilation Error in model fct_reviews (models/fct/fct_reviews.sql)
  
                The source and target schemas on this incremental model are out of sync!
                They can be reconciled in several ways:
                  - set the `on_schema_change` config to either append_new_columns or sync_all_columns, depending on your situation.
                  - Re-run the incremental model with `full_refresh: True` to update the target schema.
                  - update the schema manually and re-run the process.
  
                Additional troubleshooting context:
                   Source columns not in target: [SnowflakeColumn(column='REVIEW_ID', dtype='VARCHAR', char_size=32, numeric_precision=None, numeric_scale=None)]
                   Target columns not in source: []
                   New column types: []
            
  
  > in macro process_schema_changes (macros/materializations/models/incremental/on_schema_change.sql)
  > called by macro materialization_incremental_snowflake (macros/materializations/incremental.sql)
  > called by model fct_reviews (models/fct/fct_reviews.sql)
[0m13:28:50.990197 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ead2863-efdd-4c46-96e2-80da9ed8cb24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbba25a13d0>]}
[0m13:28:50.990715 [error] [Thread-1  ]: 2 of 5 ERROR creating sql incremental model dev.fct_reviews .................... [[31mERROR[0m in 5.38s]
[0m13:28:50.991154 [debug] [Thread-1  ]: Finished running node model.dbtlearm.fct_reviews
[0m13:28:50.992137 [debug] [Thread-3  ]: Began running node model.dbtlearm.mart_fullmoon_review
[0m13:28:50.992540 [info ] [Thread-3  ]: 5 of 5 SKIP relation dev.mart_fullmoon_review .................................. [[33mSKIP[0m]
[0m13:28:50.993135 [debug] [Thread-3  ]: Finished running node model.dbtlearm.mart_fullmoon_review
[0m13:28:56.265057 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 7 seconds
[0m13:28:56.274141 [debug] [Thread-2  ]: Timing info for model.dbtlearm.dim_listings_with_hosts (execute): 2023-03-01 13:28:49.208255 => 2023-03-01 13:28:56.274078
[0m13:28:56.274497 [debug] [Thread-2  ]: On model.dbtlearm.dim_listings_with_hosts: Close
[0m13:28:56.519776 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ead2863-efdd-4c46-96e2-80da9ed8cb24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbba3d20f70>]}
[0m13:28:56.520388 [info ] [Thread-2  ]: 4 of 5 OK created sql table model dev.dim_listings_with_hosts .................. [[32mSUCCESS 1[0m in 7.32s]
[0m13:28:56.520868 [debug] [Thread-2  ]: Finished running node model.dbtlearm.dim_listings_with_hosts
[0m13:28:56.522591 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:28:56.523285 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:28:56.523560 [debug] [MainThread]: Connection 'model.dbtlearm.fct_reviews' was properly closed.
[0m13:28:56.523796 [debug] [MainThread]: Connection 'model.dbtlearm.dim_listings_with_hosts' was properly closed.
[0m13:28:56.524028 [debug] [MainThread]: Connection 'model.dbtlearm.dim_listings_cleansed' was properly closed.
[0m13:28:56.524255 [debug] [MainThread]: Connection 'model.dbtlearm.dim_hosts_cleansed' was properly closed.
[0m13:28:56.524579 [info ] [MainThread]: 
[0m13:28:56.524947 [info ] [MainThread]: Finished running 2 view models, 1 incremental model, 2 table models in 0 hours 0 minutes and 17.25 seconds (17.25s).
[0m13:28:56.525549 [debug] [MainThread]: Command end result
[0m13:28:56.539525 [info ] [MainThread]: 
[0m13:28:56.539994 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:28:56.540330 [info ] [MainThread]: 
[0m13:28:56.540655 [error] [MainThread]: [33mCompilation Error in model fct_reviews (models/fct/fct_reviews.sql)[0m
[0m13:28:56.540970 [error] [MainThread]:   
[0m13:28:56.541272 [error] [MainThread]:                 The source and target schemas on this incremental model are out of sync!
[0m13:28:56.541571 [error] [MainThread]:                 They can be reconciled in several ways:
[0m13:28:56.541866 [error] [MainThread]:                   - set the `on_schema_change` config to either append_new_columns or sync_all_columns, depending on your situation.
[0m13:28:56.542163 [error] [MainThread]:                   - Re-run the incremental model with `full_refresh: True` to update the target schema.
[0m13:28:56.542463 [error] [MainThread]:                   - update the schema manually and re-run the process.
[0m13:28:56.542755 [error] [MainThread]:   
[0m13:28:56.543047 [error] [MainThread]:                 Additional troubleshooting context:
[0m13:28:56.543442 [error] [MainThread]:                    Source columns not in target: [SnowflakeColumn(column='REVIEW_ID', dtype='VARCHAR', char_size=32, numeric_precision=None, numeric_scale=None)]
[0m13:28:56.543767 [error] [MainThread]:                    Target columns not in source: []
[0m13:28:56.544072 [error] [MainThread]:                    New column types: []
[0m13:28:56.544373 [error] [MainThread]:             
[0m13:28:56.544674 [error] [MainThread]:   
[0m13:28:56.544972 [error] [MainThread]:   > in macro process_schema_changes (macros/materializations/models/incremental/on_schema_change.sql)
[0m13:28:56.545271 [error] [MainThread]:   > called by macro materialization_incremental_snowflake (macros/materializations/incremental.sql)
[0m13:28:56.545589 [error] [MainThread]:   > called by model fct_reviews (models/fct/fct_reviews.sql)
[0m13:28:56.545987 [info ] [MainThread]: 
[0m13:28:56.546348 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
[0m13:28:56.546775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbba3535c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbba3782b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbba3782280>]}
[0m13:28:56.547283 [debug] [MainThread]: Flushing usage events


============================== 2023-03-01 13:29:45.625610 | 2f31fec5-874d-4e8e-b02d-8e672549dead ==============================
[0m13:29:45.625610 [info ] [MainThread]: Running with dbt=1.4.1
[0m13:29:45.628244 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/mramirez/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:29:45.628678 [debug] [MainThread]: Tracking: tracking
[0m13:29:45.629174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe70ac40d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe70ac40dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe70ac4c0d0>]}
[0m13:29:45.805555 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:29:45.805887 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:29:45.831394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2f31fec5-874d-4e8e-b02d-8e672549dead', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe70ac880d0>]}
[0m13:29:45.843915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2f31fec5-874d-4e8e-b02d-8e672549dead', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe70ac40d60>]}
[0m13:29:45.844394 [info ] [MainThread]: Found 8 models, 9 tests, 2 snapshots, 0 analyses, 418 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m13:29:45.844806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f31fec5-874d-4e8e-b02d-8e672549dead', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe70ae78be0>]}
[0m13:29:45.846890 [info ] [MainThread]: 
[0m13:29:45.849097 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:29:45.850724 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb'
[0m13:29:45.867869 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m13:29:45.868249 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m13:29:45.868542 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:29:49.157811 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 3 seconds
[0m13:29:49.159461 [debug] [ThreadPool]: On list_airbnb: Close
[0m13:29:49.392860 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m13:29:49.401764 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m13:29:49.402127 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m13:29:49.402413 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:29:50.468636 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m13:29:50.471023 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m13:29:50.974921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f31fec5-874d-4e8e-b02d-8e672549dead', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe70ac4cac0>]}
[0m13:29:50.975578 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:29:50.975866 [info ] [MainThread]: 
[0m13:29:50.982872 [debug] [Thread-1  ]: Began running node model.dbtlearm.src_host
[0m13:29:50.983158 [debug] [Thread-2  ]: Began running node model.dbtlearm.src_listings
[0m13:29:50.983402 [debug] [Thread-3  ]: Began running node model.dbtlearm.src_reviews
[0m13:29:50.983946 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearm.src_host'
[0m13:29:50.984457 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearm.src_listings'
[0m13:29:50.984933 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearm.src_reviews'
[0m13:29:50.985183 [debug] [Thread-1  ]: Began compiling node model.dbtlearm.src_host
[0m13:29:50.985432 [debug] [Thread-2  ]: Began compiling node model.dbtlearm.src_listings
[0m13:29:50.985664 [debug] [Thread-3  ]: Began compiling node model.dbtlearm.src_reviews
[0m13:29:50.988978 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearm.src_host"
[0m13:29:50.991310 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearm.src_listings"
[0m13:29:50.993683 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearm.src_reviews"
[0m13:29:50.994746 [debug] [Thread-2  ]: Timing info for model.dbtlearm.src_listings (compile): 2023-03-01 13:29:50.989194 => 2023-03-01 13:29:50.994667
[0m13:29:50.994955 [debug] [Thread-3  ]: Timing info for model.dbtlearm.src_reviews (compile): 2023-03-01 13:29:50.991513 => 2023-03-01 13:29:50.994901
[0m13:29:50.996539 [debug] [Thread-2  ]: Finished running node model.dbtlearm.src_listings
[0m13:29:50.996743 [debug] [Thread-1  ]: Timing info for model.dbtlearm.src_host (compile): 2023-03-01 13:29:50.985850 => 2023-03-01 13:29:50.996694
[0m13:29:50.997379 [debug] [Thread-3  ]: Finished running node model.dbtlearm.src_reviews
[0m13:29:50.998132 [debug] [Thread-4  ]: Began running node model.dbtlearm.dim_listings_cleansed
[0m13:29:50.998749 [debug] [Thread-1  ]: Finished running node model.dbtlearm.src_host
[0m13:29:50.999242 [debug] [Thread-2  ]: Began running node model.dbtlearm.fct_reviews
[0m13:29:50.999558 [info ] [Thread-4  ]: 1 of 5 START sql view model dev.dim_listings_cleansed .......................... [RUN]
[0m13:29:51.000098 [debug] [Thread-3  ]: Began running node model.dbtlearm.dim_hosts_cleansed
[0m13:29:51.000424 [info ] [Thread-2  ]: 2 of 5 START sql incremental model dev.fct_reviews ............................. [RUN]
[0m13:29:51.001023 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtlearm.dim_listings_cleansed'
[0m13:29:51.001319 [info ] [Thread-3  ]: 3 of 5 START sql view model dev.dim_hosts_cleansed ............................. [RUN]
[0m13:29:51.001865 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearm.fct_reviews'
[0m13:29:51.002109 [debug] [Thread-4  ]: Began compiling node model.dbtlearm.dim_listings_cleansed
[0m13:29:51.002583 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearm.dim_hosts_cleansed'
[0m13:29:51.002836 [debug] [Thread-2  ]: Began compiling node model.dbtlearm.fct_reviews
[0m13:29:51.018386 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearm.dim_listings_cleansed"
[0m13:29:51.018715 [debug] [Thread-3  ]: Began compiling node model.dbtlearm.dim_hosts_cleansed
[0m13:29:51.046260 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearm.fct_reviews"
[0m13:29:51.055045 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearm.dim_hosts_cleansed"
[0m13:29:51.055451 [debug] [Thread-4  ]: Timing info for model.dbtlearm.dim_listings_cleansed (compile): 2023-03-01 13:29:51.003017 => 2023-03-01 13:29:51.055393
[0m13:29:51.055825 [debug] [Thread-4  ]: Began executing node model.dbtlearm.dim_listings_cleansed
[0m13:29:51.067970 [debug] [Thread-3  ]: Timing info for model.dbtlearm.dim_hosts_cleansed (compile): 2023-03-01 13:29:51.048602 => 2023-03-01 13:29:51.067880
[0m13:29:51.068343 [debug] [Thread-2  ]: Timing info for model.dbtlearm.fct_reviews (compile): 2023-03-01 13:29:51.018952 => 2023-03-01 13:29:51.068286
[0m13:29:51.084209 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtlearm.dim_listings_cleansed"
[0m13:29:51.084541 [debug] [Thread-3  ]: Began executing node model.dbtlearm.dim_hosts_cleansed
[0m13:29:51.084807 [debug] [Thread-2  ]: Began executing node model.dbtlearm.fct_reviews
[0m13:29:51.088019 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtlearm.dim_hosts_cleansed"
[0m13:29:51.114495 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearm.dim_listings_cleansed"
[0m13:29:51.131478 [debug] [Thread-4  ]: On model.dbtlearm.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.dim_listings_cleansed"} */
create or replace   view airbnb.dev.dim_listings_cleansed
  
   as (
    -- Change Tables for views

WITH  __dbt__cte__src_listings as (
-- DBT knows this is a view
-- By default they are views
WITH raw_listings AS(
	SELECT * FROM airbnb.raw.raw_listings
)
SELECT
	id as listing_id,
    name as listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at
FROM
	raw_listings
),src_listings AS (
    SELECT * FROM __dbt__cte__src_listings
)
SELECT 
    listing_id,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights = 0 THEN 1
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE(
        price_str,
        '$'
    ) :: NUMBER (
        10,
        2
    ) AS price,
    created_at,
    updated_at
FROM
    src_listings
  );
[0m13:29:51.140894 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtlearm.fct_reviews"
[0m13:29:51.141225 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m13:29:51.142325 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearm.dim_hosts_cleansed"
[0m13:29:51.143835 [debug] [Thread-3  ]: On model.dbtlearm.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.dim_hosts_cleansed"} */
create or replace   view airbnb.dev.dim_hosts_cleansed
  
   as (
    -- Change Tables for views

WITH  __dbt__cte__src_host as (
WITH raw_hosts AS(
	SELECT * FROM airbnb.raw.raw_hosts
)
SELECT
	id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
	raw_hosts
),src_hosts AS(
    SELECT * FROM  __dbt__cte__src_host
)
SELECT
    host_id,
    NVL(
        host_name, 
        'Anonymous'
    ) AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
	src_hosts
  );
[0m13:29:51.144238 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:29:51.235216 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m13:29:51.235567 [debug] [Thread-2  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
create or replace transient table airbnb.dev.fct_reviews  as
        (-- Incremental Materialization

WITH  __dbt__cte__src_reviews as (
WITH raw_reviews AS(
	SELECT * FROM airbnb.raw.raw_reviews
)
SELECT
	listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
	raw_reviews
),src_reviews AS (
    SELECt * FROM __dbt__cte__src_reviews
)
SELECT 
    
    
md5(cast(coalesce(cast(listing_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(reviewer_name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_text as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as review_id,
    *
FROM src_reviews
WHERE review_text IS NOT NULL

        );
[0m13:29:51.235830 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m13:29:52.754744 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 2 seconds
[0m13:29:52.776445 [debug] [Thread-4  ]: Timing info for model.dbtlearm.dim_listings_cleansed (execute): 2023-03-01 13:29:51.056032 => 2023-03-01 13:29:52.776381
[0m13:29:52.776779 [debug] [Thread-4  ]: On model.dbtlearm.dim_listings_cleansed: Close
[0m13:29:53.039370 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f31fec5-874d-4e8e-b02d-8e672549dead', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe70b3b0a60>]}
[0m13:29:53.039967 [info ] [Thread-4  ]: 1 of 5 OK created sql view model dev.dim_listings_cleansed ..................... [[32mSUCCESS 1[0m in 2.04s]
[0m13:29:53.040503 [debug] [Thread-4  ]: Finished running node model.dbtlearm.dim_listings_cleansed
[0m13:29:57.223594 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 6 seconds
[0m13:29:57.230925 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m13:29:57.231189 [debug] [Thread-2  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
drop view if exists airbnb.dev.fct_reviews__dbt_tmp cascade
[0m13:29:57.391841 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m13:29:57.399732 [debug] [Thread-2  ]: Timing info for model.dbtlearm.fct_reviews (execute): 2023-03-01 13:29:51.088325 => 2023-03-01 13:29:57.399666
[0m13:29:57.400089 [debug] [Thread-2  ]: On model.dbtlearm.fct_reviews: Close
[0m13:29:57.634718 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f31fec5-874d-4e8e-b02d-8e672549dead', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe70b3fc670>]}
[0m13:29:57.635295 [info ] [Thread-2  ]: 2 of 5 OK created sql incremental model dev.fct_reviews ........................ [[32mSUCCESS 1[0m in 6.63s]
[0m13:29:57.635746 [debug] [Thread-2  ]: Finished running node model.dbtlearm.fct_reviews
[0m13:29:57.636404 [debug] [Thread-1  ]: Began running node model.dbtlearm.mart_fullmoon_review
[0m13:29:57.636796 [info ] [Thread-1  ]: 4 of 5 START sql table model dev.mart_fullmoon_review .......................... [RUN]
[0m13:29:57.637705 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearm.mart_fullmoon_review'
[0m13:29:57.638034 [debug] [Thread-1  ]: Began compiling node model.dbtlearm.mart_fullmoon_review
[0m13:29:57.642035 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearm.mart_fullmoon_review"
[0m13:29:57.666912 [debug] [Thread-1  ]: Timing info for model.dbtlearm.mart_fullmoon_review (compile): 2023-03-01 13:29:57.638267 => 2023-03-01 13:29:57.666816
[0m13:29:57.667240 [debug] [Thread-1  ]: Began executing node model.dbtlearm.mart_fullmoon_review
[0m13:29:57.677108 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtlearm.mart_fullmoon_review"
[0m13:29:57.692613 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearm.mart_fullmoon_review"
[0m13:29:57.692891 [debug] [Thread-1  ]: On model.dbtlearm.mart_fullmoon_review: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.mart_fullmoon_review"} */
create or replace transient table airbnb.dev.mart_fullmoon_review  as
        (

WITH fct_reviews AS (
    SELECT * FROM airbnb.dev.fct_reviews
),

full_moon_dates AS (
    SELECT * FROM airbnb.dev.seed_full_moon_dates
)

SELECT
    r.*,
    CASE
        WHEN fm.full_moon_date IS NULL THEN 'not full moon'
        ELSE 'full moon'
    END AS is_full_moon
FROM
    fct_reviews r
    LEFT JOIN full_moon_dates fm
    ON (TO_DATE(r.review_date) = DATEADD(DAY, 1, fm.full_moon_date))
        );
[0m13:29:57.693104 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:29:57.773163 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 7 seconds
[0m13:29:57.778716 [debug] [Thread-3  ]: Timing info for model.dbtlearm.dim_hosts_cleansed (execute): 2023-03-01 13:29:51.085133 => 2023-03-01 13:29:57.778600
[0m13:29:57.779185 [debug] [Thread-3  ]: On model.dbtlearm.dim_hosts_cleansed: Close
[0m13:29:58.508512 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f31fec5-874d-4e8e-b02d-8e672549dead', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe70b29adf0>]}
[0m13:29:58.509011 [info ] [Thread-3  ]: 3 of 5 OK created sql view model dev.dim_hosts_cleansed ........................ [[32mSUCCESS 1[0m in 7.51s]
[0m13:29:58.509354 [debug] [Thread-3  ]: Finished running node model.dbtlearm.dim_hosts_cleansed
[0m13:29:58.509837 [debug] [Thread-2  ]: Began running node model.dbtlearm.dim_listings_with_hosts
[0m13:29:58.510142 [info ] [Thread-2  ]: 5 of 5 START sql table model dev.dim_listings_with_hosts ....................... [RUN]
[0m13:29:58.510698 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearm.dim_listings_with_hosts'
[0m13:29:58.510941 [debug] [Thread-2  ]: Began compiling node model.dbtlearm.dim_listings_with_hosts
[0m13:29:58.515051 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearm.dim_listings_with_hosts"
[0m13:29:58.516213 [debug] [Thread-2  ]: Timing info for model.dbtlearm.dim_listings_with_hosts (compile): 2023-03-01 13:29:58.511113 => 2023-03-01 13:29:58.516151
[0m13:29:58.516500 [debug] [Thread-2  ]: Began executing node model.dbtlearm.dim_listings_with_hosts
[0m13:29:58.519254 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtlearm.dim_listings_with_hosts"
[0m13:29:58.520763 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearm.dim_listings_with_hosts"
[0m13:29:58.521028 [debug] [Thread-2  ]: On model.dbtlearm.dim_listings_with_hosts: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.dim_listings_with_hosts"} */
create or replace transient table airbnb.dev.dim_listings_with_hosts  as
        (WITH
l AS (
    SELECT *
    FROM airbnb.dev.dim_listings_cleansed
),
h AS (
    SELECT *
    FROM airbnb.dev.dim_hosts_cleansed
)
SELECT
    l.listing_id,
    l.listing_name,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost AS host_is_superhost,
    l.created_at,
    GREATEST(l.updated_at, h.updated_at) AS updated_at
FROM l
LEFT JOIN h 
ON h.host_id = l.host_id
        );
[0m13:29:58.521238 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m13:30:01.558214 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 3 seconds
[0m13:30:01.561154 [debug] [Thread-2  ]: Timing info for model.dbtlearm.dim_listings_with_hosts (execute): 2023-03-01 13:29:58.516697 => 2023-03-01 13:30:01.561095
[0m13:30:01.561458 [debug] [Thread-2  ]: On model.dbtlearm.dim_listings_with_hosts: Close
[0m13:30:01.824619 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 4 seconds
[0m13:30:01.826676 [debug] [Thread-1  ]: Timing info for model.dbtlearm.mart_fullmoon_review (execute): 2023-03-01 13:29:57.667412 => 2023-03-01 13:30:01.826631
[0m13:30:01.826913 [debug] [Thread-1  ]: On model.dbtlearm.mart_fullmoon_review: Close
[0m13:30:01.838522 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f31fec5-874d-4e8e-b02d-8e672549dead', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe70b29e100>]}
[0m13:30:01.838982 [info ] [Thread-2  ]: 5 of 5 OK created sql table model dev.dim_listings_with_hosts .................. [[32mSUCCESS 1[0m in 3.33s]
[0m13:30:01.839338 [debug] [Thread-2  ]: Finished running node model.dbtlearm.dim_listings_with_hosts
[0m13:30:02.070784 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f31fec5-874d-4e8e-b02d-8e672549dead', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe70b6ff9a0>]}
[0m13:30:02.071360 [info ] [Thread-1  ]: 4 of 5 OK created sql table model dev.mart_fullmoon_review ..................... [[32mSUCCESS 1[0m in 4.43s]
[0m13:30:02.071808 [debug] [Thread-1  ]: Finished running node model.dbtlearm.mart_fullmoon_review
[0m13:30:02.073319 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:30:02.073941 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:30:02.074196 [debug] [MainThread]: Connection 'model.dbtlearm.mart_fullmoon_review' was properly closed.
[0m13:30:02.074422 [debug] [MainThread]: Connection 'model.dbtlearm.dim_listings_with_hosts' was properly closed.
[0m13:30:02.074649 [debug] [MainThread]: Connection 'model.dbtlearm.dim_hosts_cleansed' was properly closed.
[0m13:30:02.074867 [debug] [MainThread]: Connection 'model.dbtlearm.dim_listings_cleansed' was properly closed.
[0m13:30:02.075155 [info ] [MainThread]: 
[0m13:30:02.075500 [info ] [MainThread]: Finished running 2 view models, 1 incremental model, 2 table models in 0 hours 0 minutes and 16.23 seconds (16.23s).
[0m13:30:02.076094 [debug] [MainThread]: Command end result
[0m13:30:02.087875 [info ] [MainThread]: 
[0m13:30:02.088320 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:30:02.088654 [info ] [MainThread]: 
[0m13:30:02.088979 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m13:30:02.089393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe70b6d5bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe70ae78be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe70ac5ef10>]}
[0m13:30:02.089736 [debug] [MainThread]: Flushing usage events


============================== 2023-03-01 13:30:49.826112 | 7afd4a40-4a02-43b5-9953-49914e7444ea ==============================
[0m13:30:49.826112 [info ] [MainThread]: Running with dbt=1.4.1
[0m13:30:49.828334 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/mramirez/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['fct_reviews'], 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:30:49.828594 [debug] [MainThread]: Tracking: tracking
[0m13:30:49.829042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaf21ffdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaf21ffe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaf220ff40>]}
[0m13:30:51.145055 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:30:51.145388 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:30:51.158931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7afd4a40-4a02-43b5-9953-49914e7444ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaf224a0d0>]}
[0m13:30:51.200536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7afd4a40-4a02-43b5-9953-49914e7444ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaf238a220>]}
[0m13:30:51.200949 [info ] [MainThread]: Found 8 models, 9 tests, 2 snapshots, 0 analyses, 418 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m13:30:51.201249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7afd4a40-4a02-43b5-9953-49914e7444ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaf2438c70>]}
[0m13:30:51.202711 [info ] [MainThread]: 
[0m13:30:51.204159 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:30:51.204995 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb'
[0m13:30:51.218695 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m13:30:51.219009 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m13:30:51.219252 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:30:53.671551 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2 seconds
[0m13:30:53.673683 [debug] [ThreadPool]: On list_airbnb: Close
[0m13:30:53.928944 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m13:30:53.937607 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m13:30:53.937969 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m13:30:53.938252 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:30:54.821333 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m13:30:54.823817 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m13:30:55.148772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7afd4a40-4a02-43b5-9953-49914e7444ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaf2231400>]}
[0m13:30:55.149726 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:30:55.150284 [info ] [MainThread]: 
[0m13:30:55.187061 [debug] [Thread-1  ]: Began running node model.dbtlearm.fct_reviews
[0m13:30:55.187560 [info ] [Thread-1  ]: 1 of 1 START sql incremental model dev.fct_reviews ............................. [RUN]
[0m13:30:55.188324 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearm.fct_reviews'
[0m13:30:55.188643 [debug] [Thread-1  ]: Began compiling node model.dbtlearm.fct_reviews
[0m13:30:55.221626 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearm.fct_reviews"
[0m13:30:55.240662 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearm.fct_reviews"
[0m13:30:55.243787 [debug] [Thread-1  ]: Timing info for model.dbtlearm.fct_reviews (compile): 2023-03-01 13:30:55.188878 => 2023-03-01 13:30:55.243686
[0m13:30:55.244152 [debug] [Thread-1  ]: Began executing node model.dbtlearm.fct_reviews
[0m13:30:55.307267 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtlearm.fct_reviews"
[0m13:30:55.324345 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m13:30:55.324716 [debug] [Thread-1  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
create or replace transient table airbnb.dev.fct_reviews  as
        (-- Incremental Materialization

WITH  __dbt__cte__src_reviews as (
WITH raw_reviews AS(
	SELECT * FROM airbnb.raw.raw_reviews
)
SELECT
	listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
	raw_reviews
),src_reviews AS (
    SELECt * FROM __dbt__cte__src_reviews
)
SELECT 
    
    
md5(cast(coalesce(cast(listing_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(reviewer_name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_text as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as review_id,
    *
FROM src_reviews
WHERE review_text IS NOT NULL

        );
[0m13:30:55.324978 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:31:00.915128 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 6 seconds
[0m13:31:00.923037 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m13:31:00.923285 [debug] [Thread-1  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
drop view if exists airbnb.dev.fct_reviews__dbt_tmp cascade
[0m13:31:01.190507 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m13:31:01.223599 [debug] [Thread-1  ]: Timing info for model.dbtlearm.fct_reviews (execute): 2023-03-01 13:30:55.244369 => 2023-03-01 13:31:01.223545
[0m13:31:01.227317 [debug] [Thread-1  ]: On model.dbtlearm.fct_reviews: Close
[0m13:31:02.946366 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7afd4a40-4a02-43b5-9953-49914e7444ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaf2865430>]}
[0m13:31:02.946915 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental model dev.fct_reviews ........................ [[32mSUCCESS 1[0m in 7.76s]
[0m13:31:02.948484 [debug] [Thread-1  ]: Finished running node model.dbtlearm.fct_reviews
[0m13:31:02.950221 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:31:02.950865 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:31:02.951098 [debug] [MainThread]: Connection 'model.dbtlearm.fct_reviews' was properly closed.
[0m13:31:02.951340 [info ] [MainThread]: 
[0m13:31:02.951655 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 11.75 seconds (11.75s).
[0m13:31:02.952049 [debug] [MainThread]: Command end result
[0m13:31:03.134886 [info ] [MainThread]: 
[0m13:31:03.135370 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:31:03.135703 [info ] [MainThread]: 
[0m13:31:03.136026 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:31:03.136423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaf2231400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaf2231fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaf2231460>]}
[0m13:31:03.136773 [debug] [MainThread]: Flushing usage events


============================== 2023-03-03 13:21:28.482142 | 8042f9bf-eb4f-4790-9bee-e19c98ca31f0 ==============================
[0m13:21:28.482142 [info ] [MainThread]: Running with dbt=1.4.1
[0m13:21:28.484974 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/mramirez/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
[0m13:21:28.485594 [debug] [MainThread]: Tracking: tracking
[0m13:21:28.486417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdf19ffd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdf19ffdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdf1a0d0d0>]}
[0m13:21:28.977698 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m13:21:28.978474 [debug] [MainThread]: Partial parsing: updated file: dbtlearm://models/schema.yml
[0m13:21:28.978843 [debug] [MainThread]: Partial parsing: updated file: dbtlearm://models/fct/fct_reviews.sql
[0m13:21:29.004541 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m13:21:29.025588 [debug] [MainThread]: 1603: static parser failed on fct/fct_reviews.sql
[0m13:21:29.052907 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fct/fct_reviews.sql
[0m13:21:29.125393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdf1a48c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdf1a48e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdf1a53730>]}
[0m13:21:29.125820 [debug] [MainThread]: Flushing usage events
[0m13:21:29.863600 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid test config given in models/schema.yml:
  	test definition dictionary must have exactly one key, got [('accepted_values', None), ('values', ['positive', 'neutral', 'negative'])] instead (2 keys)
  	@: UnparsedNodeUpdate(original_file_path='model...ne)


============================== 2023-03-03 13:22:26.445509 | 0b2d8fdb-3f87-435c-9489-16fa6b9e3fc3 ==============================
[0m13:22:26.445509 [info ] [MainThread]: Running with dbt=1.4.1
[0m13:22:26.447438 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/mramirez/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m13:22:26.447672 [debug] [MainThread]: Tracking: tracking
[0m13:22:26.448127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98f122ed00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98f122efa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98f122ef70>]}
[0m13:22:26.552395 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m13:22:26.553075 [debug] [MainThread]: Partial parsing: updated file: dbtlearm://models/schema.yml
[0m13:22:26.553405 [debug] [MainThread]: Partial parsing: updated file: dbtlearm://models/fct/fct_reviews.sql
[0m13:22:26.567969 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m13:22:26.580316 [debug] [MainThread]: 1603: static parser failed on fct/fct_reviews.sql
[0m13:22:26.600647 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fct/fct_reviews.sql
[0m13:22:26.659643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98f12a2cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98f1298970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98f1298df0>]}
[0m13:22:26.660018 [debug] [MainThread]: Flushing usage events
[0m13:22:27.021752 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid test config given in models/schema.yml:
  	test definition dictionary must have exactly one key, got [('accepted_values', None), ('values', ['positive', 'neutral', 'negative'])] instead (2 keys)
  	@: UnparsedNodeUpdate(original_file_path='model...ne)


============================== 2023-03-03 13:23:16.986286 | 6457c401-9951-4907-907b-540e5729c29d ==============================
[0m13:23:16.986286 [info ] [MainThread]: Running with dbt=1.4.1
[0m13:23:16.988605 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/mramirez/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m13:23:16.989134 [debug] [MainThread]: Tracking: tracking
[0m13:23:16.989781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97da2bed30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97da2befd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97da2befa0>]}
[0m13:23:17.095680 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m13:23:17.096456 [debug] [MainThread]: Partial parsing: updated file: dbtlearm://models/schema.yml
[0m13:23:17.096833 [debug] [MainThread]: Partial parsing: updated file: dbtlearm://models/fct/fct_reviews.sql
[0m13:23:17.114317 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m13:23:17.129162 [debug] [MainThread]: 1603: static parser failed on fct/fct_reviews.sql
[0m13:23:17.153043 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fct/fct_reviews.sql
[0m13:23:17.214385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97da324130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97da314f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97da314cd0>]}
[0m13:23:17.214758 [debug] [MainThread]: Flushing usage events
[0m13:23:17.979401 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid test config given in models/schema.yml:
  	test definition dictionary must have exactly one key, got [('accepted_values', None), ('values', ['t', 'f'])] instead (2 keys)
  	@: UnparsedNodeUpdate(original_file_path='model...ne)


============================== 2023-03-03 13:23:31.726061 | 4b963e47-96e4-41e8-9d44-c46e400ed495 ==============================
[0m13:23:31.726061 [info ] [MainThread]: Running with dbt=1.4.1
[0m13:23:31.728069 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/mramirez/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m13:23:31.728327 [debug] [MainThread]: Tracking: tracking
[0m13:23:31.728731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe3533ed00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe3533efa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe3533ef70>]}
[0m13:23:31.831365 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m13:23:31.832039 [debug] [MainThread]: Partial parsing: updated file: dbtlearm://models/schema.yml
[0m13:23:31.832352 [debug] [MainThread]: Partial parsing: updated file: dbtlearm://models/fct/fct_reviews.sql
[0m13:23:31.847239 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m13:23:31.860141 [debug] [MainThread]: 1603: static parser failed on fct/fct_reviews.sql
[0m13:23:31.883542 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fct/fct_reviews.sql
[0m13:23:31.954227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe353a8040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe3559f970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe3559f3d0>]}
[0m13:23:31.954674 [debug] [MainThread]: Flushing usage events
[0m13:23:32.280486 [error] [MainThread]: Encountered an error:
Compilation Error
  Documentation for 'model.dbtlearm.dim_listings_cleansed' depends on doc 'dim_listing_cleansed__minimum_nights'  which was not found


============================== 2023-03-03 13:23:51.207622 | 25235359-df51-414f-91eb-41ef3cf4f015 ==============================
[0m13:23:51.207622 [info ] [MainThread]: Running with dbt=1.4.1
[0m13:23:51.209948 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/mramirez/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m13:23:51.210249 [debug] [MainThread]: Tracking: tracking
[0m13:23:51.210683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe585340d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe585340fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe585340fa0>]}
[0m13:23:51.313389 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m13:23:51.314068 [debug] [MainThread]: Partial parsing: updated file: dbtlearm://models/schema.yml
[0m13:23:51.314386 [debug] [MainThread]: Partial parsing: updated file: dbtlearm://models/fct/fct_reviews.sql
[0m13:23:51.328837 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m13:23:51.340832 [debug] [MainThread]: 1603: static parser failed on fct/fct_reviews.sql
[0m13:23:51.362486 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fct/fct_reviews.sql
[0m13:23:51.443445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '25235359-df51-414f-91eb-41ef3cf4f015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe58578ff10>]}
[0m13:23:51.464523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '25235359-df51-414f-91eb-41ef3cf4f015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5854b91c0>]}
[0m13:23:51.465004 [info ] [MainThread]: Found 8 models, 14 tests, 2 snapshots, 0 analyses, 418 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m13:23:51.465354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25235359-df51-414f-91eb-41ef3cf4f015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5854b9040>]}
[0m13:23:51.467810 [info ] [MainThread]: 
[0m13:23:51.469565 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:23:51.471100 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m13:23:51.486999 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m13:23:51.487370 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m13:23:51.487744 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:23:54.157001 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 3 seconds
[0m13:23:54.159991 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m13:23:54.429762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25235359-df51-414f-91eb-41ef3cf4f015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5854b91f0>]}
[0m13:23:54.430725 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:23:54.431101 [info ] [MainThread]: 
[0m13:23:54.444803 [debug] [Thread-1  ]: Began running node test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m13:23:54.445178 [debug] [Thread-2  ]: Began running node test.dbtlearm.consistent_created_at
[0m13:23:54.445506 [debug] [Thread-3  ]: Began running node test.dbtlearm.dim_listings_minimum_nights
[0m13:23:54.445831 [debug] [Thread-4  ]: Began running node test.dbtlearm.no_nulls_in_dim_listings
[0m13:23:54.446176 [info ] [Thread-1  ]: 1 of 14 START test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [RUN]
[0m13:23:54.446590 [info ] [Thread-2  ]: 2 of 14 START test consistent_created_at ....................................... [RUN]
[0m13:23:54.447006 [info ] [Thread-3  ]: 3 of 14 START test dim_listings_minimum_nights ................................. [RUN]
[0m13:23:54.447409 [info ] [Thread-4  ]: 4 of 14 START test no_nulls_in_dim_listings .................................... [RUN]
[0m13:23:54.448235 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af'
[0m13:23:54.448894 [debug] [Thread-2  ]: Acquiring new snowflake connection 'test.dbtlearm.consistent_created_at'
[0m13:23:54.449538 [debug] [Thread-3  ]: Acquiring new snowflake connection 'test.dbtlearm.dim_listings_minimum_nights'
[0m13:23:54.450200 [debug] [Thread-4  ]: Acquiring new snowflake connection 'test.dbtlearm.no_nulls_in_dim_listings'
[0m13:23:54.450546 [debug] [Thread-1  ]: Began compiling node test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m13:23:54.450893 [debug] [Thread-2  ]: Began compiling node test.dbtlearm.consistent_created_at
[0m13:23:54.451206 [debug] [Thread-3  ]: Began compiling node test.dbtlearm.dim_listings_minimum_nights
[0m13:23:54.451530 [debug] [Thread-4  ]: Began compiling node test.dbtlearm.no_nulls_in_dim_listings
[0m13:23:54.460820 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m13:23:54.464321 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearm.consistent_created_at"
[0m13:23:54.467274 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearm.dim_listings_minimum_nights"
[0m13:23:54.482049 [debug] [Thread-4  ]: Using snowflake connection "test.dbtlearm.no_nulls_in_dim_listings"
[0m13:23:54.482761 [debug] [Thread-4  ]: On test.dbtlearm.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "test.dbtlearm.no_nulls_in_dim_listings"} */
describe table airbnb.dev.dim_listings_cleansed
[0m13:23:54.483037 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m13:23:54.485940 [debug] [Thread-2  ]: Timing info for test.dbtlearm.consistent_created_at (compile): 2023-03-03 13:23:54.461150 => 2023-03-03 13:23:54.485818
[0m13:23:54.486383 [debug] [Thread-2  ]: Began executing node test.dbtlearm.consistent_created_at
[0m13:23:54.492774 [debug] [Thread-3  ]: Timing info for test.dbtlearm.dim_listings_minimum_nights (compile): 2023-03-03 13:23:54.464595 => 2023-03-03 13:23:54.492683
[0m13:23:54.493195 [debug] [Thread-1  ]: Timing info for test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (compile): 2023-03-03 13:23:54.451774 => 2023-03-03 13:23:54.493124
[0m13:23:54.506823 [debug] [Thread-3  ]: Began executing node test.dbtlearm.dim_listings_minimum_nights
[0m13:23:54.514489 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbtlearm.consistent_created_at"
[0m13:23:54.514991 [debug] [Thread-1  ]: Began executing node test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m13:23:54.518183 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbtlearm.dim_listings_minimum_nights"
[0m13:23:54.522145 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m13:23:54.523373 [debug] [Thread-2  ]: Using snowflake connection "test.dbtlearm.consistent_created_at"
[0m13:23:54.523909 [debug] [Thread-2  ]: On test.dbtlearm.consistent_created_at: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "test.dbtlearm.consistent_created_at"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT *
FROM airbnb.dev.dim_listings_cleansed l
INNER JOIN airbnb.dev.fct_reviews r
USING (listing_id)
WHERE l.created_at >= r.review_date
      
    ) dbt_internal_test
[0m13:23:54.524237 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m13:23:54.526610 [debug] [Thread-3  ]: Using snowflake connection "test.dbtlearm.dim_listings_minimum_nights"
[0m13:23:54.527687 [debug] [Thread-3  ]: On test.dbtlearm.dim_listings_minimum_nights: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "test.dbtlearm.dim_listings_minimum_nights"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- Singular test
SELECT  
    *
FROM
    airbnb.dev.dim_listings_cleansed
WHERE minimum_nights < 1
LIMIT 10
      
    ) dbt_internal_test
[0m13:23:54.528593 [debug] [Thread-1  ]: Using snowflake connection "test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m13:23:54.528927 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:23:54.529199 [debug] [Thread-1  ]: On test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        room_type as value_field,
        count(*) as n_records

    from airbnb.dev.dim_listings_cleansed
    group by room_type

)

select *
from all_values
where value_field not in (
    'Entire home/apt','Private room','Shared room','Hotel room'
)



      
    ) dbt_internal_test
[0m13:23:54.530999 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:23:55.908464 [debug] [Thread-4  ]: SQL status: SUCCESS 8 in 1 seconds
[0m13:23:55.911493 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearm.no_nulls_in_dim_listings"
[0m13:23:55.914832 [debug] [Thread-4  ]: Timing info for test.dbtlearm.no_nulls_in_dim_listings (compile): 2023-03-03 13:23:54.467535 => 2023-03-03 13:23:55.914753
[0m13:23:55.915187 [debug] [Thread-4  ]: Began executing node test.dbtlearm.no_nulls_in_dim_listings
[0m13:23:55.918528 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbtlearm.no_nulls_in_dim_listings"
[0m13:23:55.922061 [debug] [Thread-4  ]: Using snowflake connection "test.dbtlearm.no_nulls_in_dim_listings"
[0m13:23:55.922359 [debug] [Thread-4  ]: On test.dbtlearm.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "test.dbtlearm.no_nulls_in_dim_listings"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    SELECT * FROM airbnb.dev.dim_listings_cleansed WHERE
    LISTING_ID IS NULL OR
    LISTING_NAME IS NULL OR
    ROOM_TYPE IS NULL OR
    MINIMUM_NIGHTS IS NULL OR
    HOST_ID IS NULL OR
    PRICE IS NULL OR
    CREATED_AT IS NULL OR
    UPDATED_AT IS NULL OR
    
    FALSE

      
    ) dbt_internal_test
[0m13:23:57.483728 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3 seconds
[0m13:23:57.505992 [debug] [Thread-1  ]: Timing info for test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (execute): 2023-03-03 13:23:54.518567 => 2023-03-03 13:23:57.505895
[0m13:23:57.506465 [debug] [Thread-1  ]: On test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: Close
[0m13:23:57.761054 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 2 seconds
[0m13:23:57.763611 [debug] [Thread-4  ]: Timing info for test.dbtlearm.no_nulls_in_dim_listings (execute): 2023-03-03 13:23:55.915415 => 2023-03-03 13:23:57.763531
[0m13:23:57.763993 [debug] [Thread-4  ]: On test.dbtlearm.no_nulls_in_dim_listings: Close
[0m13:23:57.770180 [info ] [Thread-1  ]: 1 of 14 PASS accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[32mPASS[0m in 3.32s]
[0m13:23:57.771698 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 3 seconds
[0m13:23:57.773764 [debug] [Thread-1  ]: Finished running node test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m13:23:57.776172 [debug] [Thread-2  ]: Timing info for test.dbtlearm.consistent_created_at (execute): 2023-03-03 13:23:54.486651 => 2023-03-03 13:23:57.776102
[0m13:23:57.776622 [debug] [Thread-1  ]: Began running node test.dbtlearm.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m13:23:57.777035 [debug] [Thread-2  ]: On test.dbtlearm.consistent_created_at: Close
[0m13:23:57.777396 [info ] [Thread-1  ]: 5 of 14 START test not_null_dim_hosts_cleansed_host_id ......................... [RUN]
[0m13:23:57.779239 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbtlearm.not_null_dim_hosts_cleansed_host_id.de84c3da05'
[0m13:23:57.780122 [debug] [Thread-1  ]: Began compiling node test.dbtlearm.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m13:23:57.788867 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearm.not_null_dim_hosts_cleansed_host_id.de84c3da05"
[0m13:23:57.790636 [debug] [Thread-1  ]: Timing info for test.dbtlearm.not_null_dim_hosts_cleansed_host_id.de84c3da05 (compile): 2023-03-03 13:23:57.780406 => 2023-03-03 13:23:57.790520
[0m13:23:57.791205 [debug] [Thread-1  ]: Began executing node test.dbtlearm.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m13:23:57.794799 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbtlearm.not_null_dim_hosts_cleansed_host_id.de84c3da05"
[0m13:23:57.796135 [debug] [Thread-1  ]: Using snowflake connection "test.dbtlearm.not_null_dim_hosts_cleansed_host_id.de84c3da05"
[0m13:23:57.796412 [debug] [Thread-1  ]: On test.dbtlearm.not_null_dim_hosts_cleansed_host_id.de84c3da05: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "test.dbtlearm.not_null_dim_hosts_cleansed_host_id.de84c3da05"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from airbnb.dev.dim_hosts_cleansed
where host_id is null



      
    ) dbt_internal_test
[0m13:23:57.796669 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:23:57.837009 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 3 seconds
[0m13:23:57.839960 [debug] [Thread-3  ]: Timing info for test.dbtlearm.dim_listings_minimum_nights (execute): 2023-03-03 13:23:54.515248 => 2023-03-03 13:23:57.839875
[0m13:23:57.840349 [debug] [Thread-3  ]: On test.dbtlearm.dim_listings_minimum_nights: Close
[0m13:23:58.039063 [info ] [Thread-4  ]: 4 of 14 PASS no_nulls_in_dim_listings .......................................... [[32mPASS[0m in 3.59s]
[0m13:23:58.039707 [debug] [Thread-4  ]: Finished running node test.dbtlearm.no_nulls_in_dim_listings
[0m13:23:58.040209 [debug] [Thread-4  ]: Began running node test.dbtlearm.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m13:23:58.040722 [info ] [Thread-4  ]: 6 of 14 START test not_null_dim_hosts_cleansed_host_name ....................... [RUN]
[0m13:23:58.041933 [debug] [Thread-4  ]: Acquiring new snowflake connection 'test.dbtlearm.not_null_dim_hosts_cleansed_host_name.42386c5830'
[0m13:23:58.042356 [debug] [Thread-4  ]: Began compiling node test.dbtlearm.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m13:23:58.047522 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearm.not_null_dim_hosts_cleansed_host_name.42386c5830"
[0m13:23:58.048399 [debug] [Thread-4  ]: Timing info for test.dbtlearm.not_null_dim_hosts_cleansed_host_name.42386c5830 (compile): 2023-03-03 13:23:58.042600 => 2023-03-03 13:23:58.048328
[0m13:23:58.048721 [debug] [Thread-4  ]: Began executing node test.dbtlearm.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m13:23:58.051875 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbtlearm.not_null_dim_hosts_cleansed_host_name.42386c5830"
[0m13:23:58.053013 [debug] [Thread-4  ]: Using snowflake connection "test.dbtlearm.not_null_dim_hosts_cleansed_host_name.42386c5830"
[0m13:23:58.053293 [debug] [Thread-4  ]: On test.dbtlearm.not_null_dim_hosts_cleansed_host_name.42386c5830: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "test.dbtlearm.not_null_dim_hosts_cleansed_host_name.42386c5830"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_name
from airbnb.dev.dim_hosts_cleansed
where host_name is null



      
    ) dbt_internal_test
[0m13:23:58.053549 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m13:23:58.058934 [info ] [Thread-2  ]: 2 of 14 PASS consistent_created_at ............................................. [[32mPASS[0m in 3.61s]
[0m13:23:58.059479 [debug] [Thread-2  ]: Finished running node test.dbtlearm.consistent_created_at
[0m13:23:58.059879 [debug] [Thread-2  ]: Began running node test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be
[0m13:23:58.060268 [info ] [Thread-2  ]: 7 of 14 START test not_null_dim_listings_cleansed_host_id ...................... [RUN]
[0m13:23:58.060973 [debug] [Thread-2  ]: Acquiring new snowflake connection 'test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be'
[0m13:23:58.061274 [debug] [Thread-2  ]: Began compiling node test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be
[0m13:23:58.066310 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m13:23:58.069364 [debug] [Thread-2  ]: Timing info for test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be (compile): 2023-03-03 13:23:58.061492 => 2023-03-03 13:23:58.069289
[0m13:23:58.069733 [debug] [Thread-2  ]: Began executing node test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be
[0m13:23:58.074722 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m13:23:58.078287 [debug] [Thread-2  ]: Using snowflake connection "test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m13:23:58.078664 [debug] [Thread-2  ]: On test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from airbnb.dev.dim_listings_cleansed
where host_id is null



      
    ) dbt_internal_test
[0m13:23:58.078937 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m13:23:58.144066 [info ] [Thread-3  ]: 3 of 14 PASS dim_listings_minimum_nights ....................................... [[32mPASS[0m in 3.69s]
[0m13:23:58.144719 [debug] [Thread-3  ]: Finished running node test.dbtlearm.dim_listings_minimum_nights
[0m13:23:58.145121 [debug] [Thread-3  ]: Began running node test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m13:23:58.145530 [info ] [Thread-3  ]: 8 of 14 START test not_null_dim_listings_cleansed_listing_id ................... [RUN]
[0m13:23:58.146284 [debug] [Thread-3  ]: Acquiring new snowflake connection 'test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9'
[0m13:23:58.146589 [debug] [Thread-3  ]: Began compiling node test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m13:23:58.151590 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m13:23:58.155168 [debug] [Thread-3  ]: Timing info for test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9 (compile): 2023-03-03 13:23:58.146808 => 2023-03-03 13:23:58.155058
[0m13:23:58.155611 [debug] [Thread-3  ]: Began executing node test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m13:23:58.159289 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m13:23:58.162893 [debug] [Thread-3  ]: Using snowflake connection "test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m13:23:58.163223 [debug] [Thread-3  ]: On test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from airbnb.dev.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m13:23:58.163490 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m13:23:59.359137 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2 seconds
[0m13:23:59.361796 [debug] [Thread-1  ]: Timing info for test.dbtlearm.not_null_dim_hosts_cleansed_host_id.de84c3da05 (execute): 2023-03-03 13:23:57.791470 => 2023-03-03 13:23:59.361709
[0m13:23:59.362183 [debug] [Thread-1  ]: On test.dbtlearm.not_null_dim_hosts_cleansed_host_id.de84c3da05: Close
[0m13:23:59.466632 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1 seconds
[0m13:23:59.469497 [debug] [Thread-4  ]: Timing info for test.dbtlearm.not_null_dim_hosts_cleansed_host_name.42386c5830 (execute): 2023-03-03 13:23:58.048941 => 2023-03-03 13:23:59.469416
[0m13:23:59.469871 [debug] [Thread-4  ]: On test.dbtlearm.not_null_dim_hosts_cleansed_host_name.42386c5830: Close
[0m13:23:59.643889 [info ] [Thread-1  ]: 5 of 14 PASS not_null_dim_hosts_cleansed_host_id ............................... [[32mPASS[0m in 1.86s]
[0m13:23:59.644514 [debug] [Thread-1  ]: Finished running node test.dbtlearm.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m13:23:59.645008 [debug] [Thread-1  ]: Began running node test.dbtlearm.not_null_fct_reviews_reviewer_name.8204e43c88
[0m13:23:59.645452 [info ] [Thread-1  ]: 9 of 14 START test not_null_fct_reviews_reviewer_name .......................... [RUN]
[0m13:23:59.646225 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbtlearm.not_null_fct_reviews_reviewer_name.8204e43c88'
[0m13:23:59.646731 [debug] [Thread-1  ]: Began compiling node test.dbtlearm.not_null_fct_reviews_reviewer_name.8204e43c88
[0m13:23:59.652619 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearm.not_null_fct_reviews_reviewer_name.8204e43c88"
[0m13:23:59.653538 [debug] [Thread-1  ]: Timing info for test.dbtlearm.not_null_fct_reviews_reviewer_name.8204e43c88 (compile): 2023-03-03 13:23:59.646970 => 2023-03-03 13:23:59.653464
[0m13:23:59.653882 [debug] [Thread-1  ]: Began executing node test.dbtlearm.not_null_fct_reviews_reviewer_name.8204e43c88
[0m13:23:59.657250 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbtlearm.not_null_fct_reviews_reviewer_name.8204e43c88"
[0m13:23:59.658726 [debug] [Thread-1  ]: Using snowflake connection "test.dbtlearm.not_null_fct_reviews_reviewer_name.8204e43c88"
[0m13:23:59.659022 [debug] [Thread-1  ]: On test.dbtlearm.not_null_fct_reviews_reviewer_name.8204e43c88: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "test.dbtlearm.not_null_fct_reviews_reviewer_name.8204e43c88"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select reviewer_name
from airbnb.dev.fct_reviews
where reviewer_name is null



      
    ) dbt_internal_test
[0m13:23:59.659280 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:23:59.701209 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2 seconds
[0m13:23:59.703906 [debug] [Thread-3  ]: Timing info for test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9 (execute): 2023-03-03 13:23:58.155839 => 2023-03-03 13:23:59.703824
[0m13:23:59.704277 [debug] [Thread-3  ]: On test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m13:23:59.787256 [info ] [Thread-4  ]: 6 of 14 PASS not_null_dim_hosts_cleansed_host_name ............................. [[32mPASS[0m in 1.75s]
[0m13:23:59.787785 [debug] [Thread-4  ]: Finished running node test.dbtlearm.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m13:23:59.788188 [debug] [Thread-4  ]: Began running node test.dbtlearm.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m13:23:59.788681 [info ] [Thread-4  ]: 10 of 14 START test positive_value_dim_listings_cleansed_minimum_nights ........ [RUN]
[0m13:23:59.789653 [debug] [Thread-4  ]: Acquiring new snowflake connection 'test.dbtlearm.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313'
[0m13:23:59.790039 [debug] [Thread-4  ]: Began compiling node test.dbtlearm.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m13:23:59.795327 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearm.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m13:23:59.799107 [debug] [Thread-4  ]: Timing info for test.dbtlearm.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313 (compile): 2023-03-03 13:23:59.790278 => 2023-03-03 13:23:59.799013
[0m13:23:59.799484 [debug] [Thread-4  ]: Began executing node test.dbtlearm.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m13:23:59.802772 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbtlearm.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m13:23:59.806358 [debug] [Thread-4  ]: Using snowflake connection "test.dbtlearm.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m13:23:59.806660 [debug] [Thread-4  ]: On test.dbtlearm.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "test.dbtlearm.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
SELECT
    *
FROM
    airbnb.dev.dim_listings_cleansed
WHERE
    minimum_nights < 1

      
    ) dbt_internal_test
[0m13:23:59.806916 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m13:23:59.809394 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2 seconds
[0m13:23:59.811423 [debug] [Thread-2  ]: Timing info for test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be (execute): 2023-03-03 13:23:58.069976 => 2023-03-03 13:23:59.811356
[0m13:23:59.811926 [debug] [Thread-2  ]: On test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be: Close
[0m13:23:59.995424 [info ] [Thread-3  ]: 8 of 14 PASS not_null_dim_listings_cleansed_listing_id ......................... [[32mPASS[0m in 1.85s]
[0m13:23:59.995934 [debug] [Thread-3  ]: Finished running node test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m13:23:59.996295 [debug] [Thread-3  ]: Began running node test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m13:23:59.996656 [info ] [Thread-3  ]: 11 of 14 START test relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [RUN]
[0m13:23:59.997299 [debug] [Thread-3  ]: Acquiring new snowflake connection 'test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad'
[0m13:23:59.997588 [debug] [Thread-3  ]: Began compiling node test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m13:24:00.003921 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m13:24:00.007883 [debug] [Thread-3  ]: Timing info for test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (compile): 2023-03-03 13:23:59.997779 => 2023-03-03 13:24:00.007775
[0m13:24:00.008281 [debug] [Thread-3  ]: Began executing node test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m13:24:00.011768 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m13:24:00.015809 [debug] [Thread-3  ]: Using snowflake connection "test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m13:24:00.016120 [debug] [Thread-3  ]: On test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select host_id as from_field
    from airbnb.dev.dim_listings_cleansed
    where host_id is not null
),

parent as (
    select host_id as to_field
    from airbnb.dev.dim_hosts_cleansed
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m13:24:00.016371 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m13:24:00.113822 [info ] [Thread-2  ]: 7 of 14 PASS not_null_dim_listings_cleansed_host_id ............................ [[32mPASS[0m in 2.05s]
[0m13:24:00.114460 [debug] [Thread-2  ]: Finished running node test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be
[0m13:24:00.114858 [debug] [Thread-2  ]: Began running node test.dbtlearm.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe
[0m13:24:00.121268 [info ] [Thread-2  ]: 12 of 14 START test relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_  [RUN]
[0m13:24:00.139667 [debug] [Thread-2  ]: Acquiring new snowflake connection 'test.dbtlearm.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe'
[0m13:24:00.174184 [debug] [Thread-2  ]: Began compiling node test.dbtlearm.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe
[0m13:24:00.201695 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearm.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe"
[0m13:24:00.225220 [debug] [Thread-2  ]: Timing info for test.dbtlearm.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe (compile): 2023-03-03 13:24:00.186632 => 2023-03-03 13:24:00.225140
[0m13:24:00.226690 [debug] [Thread-2  ]: Began executing node test.dbtlearm.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe
[0m13:24:00.230375 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbtlearm.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe"
[0m13:24:00.241172 [debug] [Thread-2  ]: Using snowflake connection "test.dbtlearm.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe"
[0m13:24:00.241647 [debug] [Thread-2  ]: On test.dbtlearm.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "test.dbtlearm.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select listing_id as from_field
    from airbnb.dev.fct_reviews
    where listing_id is not null
),

parent as (
    select listing_id as to_field
    from airbnb.dev.dim_listings_cleansed
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m13:24:00.241926 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m13:24:00.767331 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m13:24:00.788033 [debug] [Thread-1  ]: Timing info for test.dbtlearm.not_null_fct_reviews_reviewer_name.8204e43c88 (execute): 2023-03-03 13:23:59.654115 => 2023-03-03 13:24:00.787965
[0m13:24:00.788314 [debug] [Thread-1  ]: On test.dbtlearm.not_null_fct_reviews_reviewer_name.8204e43c88: Close
[0m13:24:01.075931 [info ] [Thread-1  ]: 9 of 14 PASS not_null_fct_reviews_reviewer_name ................................ [[32mPASS[0m in 1.43s]
[0m13:24:01.076577 [debug] [Thread-1  ]: Finished running node test.dbtlearm.not_null_fct_reviews_reviewer_name.8204e43c88
[0m13:24:01.077068 [debug] [Thread-1  ]: Began running node test.dbtlearm.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m13:24:01.077527 [info ] [Thread-1  ]: 13 of 14 START test unique_dim_hosts_cleansed_host_id .......................... [RUN]
[0m13:24:01.078508 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbtlearm.unique_dim_hosts_cleansed_host_id.d7e4771347'
[0m13:24:01.079000 [debug] [Thread-1  ]: Began compiling node test.dbtlearm.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m13:24:01.086998 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearm.unique_dim_hosts_cleansed_host_id.d7e4771347"
[0m13:24:01.087876 [debug] [Thread-1  ]: Timing info for test.dbtlearm.unique_dim_hosts_cleansed_host_id.d7e4771347 (compile): 2023-03-03 13:24:01.079241 => 2023-03-03 13:24:01.087805
[0m13:24:01.088198 [debug] [Thread-1  ]: Began executing node test.dbtlearm.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m13:24:01.091903 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbtlearm.unique_dim_hosts_cleansed_host_id.d7e4771347"
[0m13:24:01.093364 [debug] [Thread-1  ]: Using snowflake connection "test.dbtlearm.unique_dim_hosts_cleansed_host_id.d7e4771347"
[0m13:24:01.093652 [debug] [Thread-1  ]: On test.dbtlearm.unique_dim_hosts_cleansed_host_id.d7e4771347: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "test.dbtlearm.unique_dim_hosts_cleansed_host_id.d7e4771347"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    host_id as unique_field,
    count(*) as n_records

from airbnb.dev.dim_hosts_cleansed
where host_id is not null
group by host_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:24:01.093911 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:24:01.294020 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1 seconds
[0m13:24:01.296595 [debug] [Thread-4  ]: Timing info for test.dbtlearm.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313 (execute): 2023-03-03 13:23:59.799704 => 2023-03-03 13:24:01.296527
[0m13:24:01.296905 [debug] [Thread-4  ]: On test.dbtlearm.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313: Close
[0m13:24:01.410775 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1 seconds
[0m13:24:01.413210 [debug] [Thread-2  ]: Timing info for test.dbtlearm.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe (execute): 2023-03-03 13:24:00.227918 => 2023-03-03 13:24:01.413142
[0m13:24:01.413525 [debug] [Thread-2  ]: On test.dbtlearm.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe: Close
[0m13:24:01.577831 [info ] [Thread-4  ]: 10 of 14 PASS positive_value_dim_listings_cleansed_minimum_nights .............. [[32mPASS[0m in 1.79s]
[0m13:24:01.584863 [debug] [Thread-4  ]: Finished running node test.dbtlearm.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m13:24:01.601435 [debug] [Thread-4  ]: Began running node test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m13:24:01.619602 [info ] [Thread-4  ]: 14 of 14 START test unique_dim_listings_cleansed_listing_id .................... [RUN]
[0m13:24:01.636213 [debug] [Thread-4  ]: Acquiring new snowflake connection 'test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e'
[0m13:24:01.636542 [debug] [Thread-4  ]: Began compiling node test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m13:24:01.646196 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m13:24:01.658312 [debug] [Thread-4  ]: Timing info for test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e (compile): 2023-03-03 13:24:01.641810 => 2023-03-03 13:24:01.658228
[0m13:24:01.666723 [debug] [Thread-4  ]: Began executing node test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m13:24:01.671214 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m13:24:01.692436 [debug] [Thread-4  ]: Using snowflake connection "test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m13:24:01.692755 [debug] [Thread-4  ]: On test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from airbnb.dev.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:24:01.692966 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m13:24:01.727533 [info ] [Thread-2  ]: 12 of 14 PASS relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_  [[32mPASS[0m in 1.59s]
[0m13:24:01.728182 [debug] [Thread-2  ]: Finished running node test.dbtlearm.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe
[0m13:24:02.051772 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2 seconds
[0m13:24:02.054700 [debug] [Thread-3  ]: Timing info for test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (execute): 2023-03-03 13:24:00.008499 => 2023-03-03 13:24:02.054620
[0m13:24:02.055080 [debug] [Thread-3  ]: On test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: Close
[0m13:24:02.376929 [info ] [Thread-3  ]: 11 of 14 PASS relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [[32mPASS[0m in 2.38s]
[0m13:24:02.377604 [debug] [Thread-3  ]: Finished running node test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m13:24:02.872946 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2 seconds
[0m13:24:02.876046 [debug] [Thread-1  ]: Timing info for test.dbtlearm.unique_dim_hosts_cleansed_host_id.d7e4771347 (execute): 2023-03-03 13:24:01.088417 => 2023-03-03 13:24:02.875951
[0m13:24:02.876481 [debug] [Thread-1  ]: On test.dbtlearm.unique_dim_hosts_cleansed_host_id.d7e4771347: Close
[0m13:24:03.170787 [info ] [Thread-1  ]: 13 of 14 PASS unique_dim_hosts_cleansed_host_id ................................ [[32mPASS[0m in 2.09s]
[0m13:24:03.171411 [debug] [Thread-1  ]: Finished running node test.dbtlearm.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m13:24:03.793601 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 2 seconds
[0m13:24:03.796215 [debug] [Thread-4  ]: Timing info for test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e (execute): 2023-03-03 13:24:01.668865 => 2023-03-03 13:24:03.796135
[0m13:24:03.796563 [debug] [Thread-4  ]: On test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m13:24:04.073821 [info ] [Thread-4  ]: 14 of 14 PASS unique_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 2.44s]
[0m13:24:04.074699 [debug] [Thread-4  ]: Finished running node test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m13:24:04.077044 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:24:04.077751 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:24:04.078028 [debug] [MainThread]: Connection 'test.dbtlearm.unique_dim_hosts_cleansed_host_id.d7e4771347' was properly closed.
[0m13:24:04.078268 [debug] [MainThread]: Connection 'test.dbtlearm.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe' was properly closed.
[0m13:24:04.078511 [debug] [MainThread]: Connection 'test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad' was properly closed.
[0m13:24:04.078746 [debug] [MainThread]: Connection 'test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m13:24:04.079040 [info ] [MainThread]: 
[0m13:24:04.079406 [info ] [MainThread]: Finished running 14 tests in 0 hours 0 minutes and 12.61 seconds (12.61s).
[0m13:24:04.080404 [debug] [MainThread]: Command end result
[0m13:24:04.096362 [info ] [MainThread]: 
[0m13:24:04.096821 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:24:04.097174 [info ] [MainThread]: 
[0m13:24:04.097510 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 TOTAL=14
[0m13:24:04.097927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe58578f0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe585b37e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe585930a60>]}
[0m13:24:04.098275 [debug] [MainThread]: Flushing usage events


============================== 2023-03-03 13:24:14.881129 | 52c37546-32c7-4935-86b4-66877ff90a22 ==============================
[0m13:24:14.881129 [info ] [MainThread]: Running with dbt=1.4.1
[0m13:24:14.882992 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/mramirez/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
[0m13:24:14.883270 [debug] [MainThread]: Tracking: tracking
[0m13:24:14.883707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc07f1fdd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc07f1fdfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc07f1fdfa0>]}
[0m13:24:14.987264 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:24:14.987549 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:24:14.995528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '52c37546-32c7-4935-86b4-66877ff90a22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc07f2540d0>]}
[0m13:24:15.006894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '52c37546-32c7-4935-86b4-66877ff90a22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc07f389c10>]}
[0m13:24:15.007324 [info ] [MainThread]: Found 8 models, 14 tests, 2 snapshots, 0 analyses, 418 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m13:24:15.007664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52c37546-32c7-4935-86b4-66877ff90a22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc07f389a60>]}
[0m13:24:15.009928 [info ] [MainThread]: 
[0m13:24:15.011580 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:24:15.012873 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m13:24:15.029153 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m13:24:15.029514 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m13:24:15.029793 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:24:16.677460 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 2 seconds
[0m13:24:16.680002 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m13:24:16.953528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52c37546-32c7-4935-86b4-66877ff90a22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc07f22ff70>]}
[0m13:24:16.954490 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:24:16.954892 [info ] [MainThread]: 
[0m13:24:16.960241 [debug] [Thread-1  ]: Began running node model.dbtlearm.src_host
[0m13:24:16.960621 [debug] [Thread-2  ]: Began running node model.dbtlearm.src_listings
[0m13:24:16.960964 [debug] [Thread-3  ]: Began running node model.dbtlearm.src_reviews
[0m13:24:16.961386 [debug] [Thread-4  ]: Began running node seed.dbtlearm.seed_full_moon_dates
[0m13:24:16.962077 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearm.src_host'
[0m13:24:16.962768 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearm.src_listings'
[0m13:24:16.963418 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearm.src_reviews'
[0m13:24:16.964062 [debug] [Thread-4  ]: Acquiring new snowflake connection 'seed.dbtlearm.seed_full_moon_dates'
[0m13:24:16.964397 [debug] [Thread-1  ]: Began compiling node model.dbtlearm.src_host
[0m13:24:16.964723 [debug] [Thread-2  ]: Began compiling node model.dbtlearm.src_listings
[0m13:24:16.965025 [debug] [Thread-3  ]: Began compiling node model.dbtlearm.src_reviews
[0m13:24:16.965314 [debug] [Thread-4  ]: Began compiling node seed.dbtlearm.seed_full_moon_dates
[0m13:24:16.968683 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearm.src_host"
[0m13:24:16.971763 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearm.src_listings"
[0m13:24:16.975331 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearm.src_reviews"
[0m13:24:16.978855 [debug] [Thread-4  ]: Timing info for seed.dbtlearm.seed_full_moon_dates (compile): 2023-03-03 13:24:16.975686 => 2023-03-03 13:24:16.978753
[0m13:24:16.979710 [debug] [Thread-4  ]: Began executing node seed.dbtlearm.seed_full_moon_dates
[0m13:24:16.980042 [debug] [Thread-4  ]: Timing info for seed.dbtlearm.seed_full_moon_dates (execute): 2023-03-03 13:24:16.979962 => 2023-03-03 13:24:16.979985
[0m13:24:16.982001 [debug] [Thread-4  ]: Finished running node seed.dbtlearm.seed_full_moon_dates
[0m13:24:16.982422 [debug] [Thread-4  ]: Began running node snapshot.dbtlearm.scd_raw_hosts
[0m13:24:16.983191 [debug] [Thread-4  ]: Acquiring new snowflake connection 'snapshot.dbtlearm.scd_raw_hosts'
[0m13:24:16.983769 [debug] [Thread-4  ]: Began compiling node snapshot.dbtlearm.scd_raw_hosts
[0m13:24:16.984096 [debug] [Thread-2  ]: Timing info for model.dbtlearm.src_listings (compile): 2023-03-03 13:24:16.968944 => 2023-03-03 13:24:16.984027
[0m13:24:16.984319 [debug] [Thread-1  ]: Timing info for model.dbtlearm.src_host (compile): 2023-03-03 13:24:16.965553 => 2023-03-03 13:24:16.984271
[0m13:24:16.988432 [debug] [Thread-4  ]: Timing info for snapshot.dbtlearm.scd_raw_hosts (compile): 2023-03-03 13:24:16.984524 => 2023-03-03 13:24:16.988373
[0m13:24:16.989321 [debug] [Thread-2  ]: Finished running node model.dbtlearm.src_listings
[0m13:24:16.989545 [debug] [Thread-3  ]: Timing info for model.dbtlearm.src_reviews (compile): 2023-03-03 13:24:16.972019 => 2023-03-03 13:24:16.989495
[0m13:24:16.990306 [debug] [Thread-1  ]: Finished running node model.dbtlearm.src_host
[0m13:24:16.990634 [debug] [Thread-4  ]: Began executing node snapshot.dbtlearm.scd_raw_hosts
[0m13:24:16.991077 [debug] [Thread-2  ]: Began running node snapshot.dbtlearm.scd_raw_listings
[0m13:24:16.992053 [debug] [Thread-3  ]: Finished running node model.dbtlearm.src_reviews
[0m13:24:16.992568 [debug] [Thread-1  ]: Began running node model.dbtlearm.dim_listings_cleansed
[0m13:24:16.993001 [debug] [Thread-4  ]: Timing info for snapshot.dbtlearm.scd_raw_hosts (execute): 2023-03-03 13:24:16.992926 => 2023-03-03 13:24:16.992938
[0m13:24:16.993790 [debug] [Thread-2  ]: Acquiring new snowflake connection 'snapshot.dbtlearm.scd_raw_listings'
[0m13:24:16.994231 [debug] [Thread-3  ]: Began running node model.dbtlearm.dim_hosts_cleansed
[0m13:24:16.995015 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearm.dim_listings_cleansed'
[0m13:24:16.995780 [debug] [Thread-4  ]: Finished running node snapshot.dbtlearm.scd_raw_hosts
[0m13:24:16.996128 [debug] [Thread-2  ]: Began compiling node snapshot.dbtlearm.scd_raw_listings
[0m13:24:16.996788 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearm.dim_hosts_cleansed'
[0m13:24:16.997112 [debug] [Thread-1  ]: Began compiling node model.dbtlearm.dim_listings_cleansed
[0m13:24:16.997505 [debug] [Thread-4  ]: Began running node model.dbtlearm.fct_reviews
[0m13:24:17.001688 [debug] [Thread-2  ]: Timing info for snapshot.dbtlearm.scd_raw_listings (compile): 2023-03-03 13:24:16.997794 => 2023-03-03 13:24:17.001626
[0m13:24:17.002029 [debug] [Thread-3  ]: Began compiling node model.dbtlearm.dim_hosts_cleansed
[0m13:24:17.020249 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearm.dim_listings_cleansed"
[0m13:24:17.020839 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtlearm.fct_reviews'
[0m13:24:17.021156 [debug] [Thread-2  ]: Began executing node snapshot.dbtlearm.scd_raw_listings
[0m13:24:17.028339 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearm.dim_hosts_cleansed"
[0m13:24:17.028842 [debug] [Thread-4  ]: Began compiling node model.dbtlearm.fct_reviews
[0m13:24:17.029149 [debug] [Thread-2  ]: Timing info for snapshot.dbtlearm.scd_raw_listings (execute): 2023-03-03 13:24:17.029077 => 2023-03-03 13:24:17.029090
[0m13:24:17.053911 [debug] [Thread-2  ]: Finished running node snapshot.dbtlearm.scd_raw_listings
[0m13:24:17.060016 [debug] [Thread-1  ]: Timing info for model.dbtlearm.dim_listings_cleansed (compile): 2023-03-03 13:24:17.002277 => 2023-03-03 13:24:17.059923
[0m13:24:17.064279 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearm.fct_reviews"
[0m13:24:17.064538 [debug] [Thread-3  ]: Timing info for model.dbtlearm.dim_hosts_cleansed (compile): 2023-03-03 13:24:17.021369 => 2023-03-03 13:24:17.064479
[0m13:24:17.064855 [debug] [Thread-1  ]: Began executing node model.dbtlearm.dim_listings_cleansed
[0m13:24:17.065278 [debug] [Thread-3  ]: Began executing node model.dbtlearm.dim_hosts_cleansed
[0m13:24:17.065562 [debug] [Thread-1  ]: Timing info for model.dbtlearm.dim_listings_cleansed (execute): 2023-03-03 13:24:17.065503 => 2023-03-03 13:24:17.065515
[0m13:24:17.065821 [debug] [Thread-3  ]: Timing info for model.dbtlearm.dim_hosts_cleansed (execute): 2023-03-03 13:24:17.065770 => 2023-03-03 13:24:17.065778
[0m13:24:17.066557 [debug] [Thread-1  ]: Finished running node model.dbtlearm.dim_listings_cleansed
[0m13:24:17.067220 [debug] [Thread-3  ]: Finished running node model.dbtlearm.dim_hosts_cleansed
[0m13:24:17.067992 [debug] [Thread-2  ]: Began running node test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m13:24:17.068274 [debug] [Thread-3  ]: Began running node test.dbtlearm.dim_listings_minimum_nights
[0m13:24:17.068507 [debug] [Thread-1  ]: Began running node test.dbtlearm.no_nulls_in_dim_listings
[0m13:24:17.068686 [debug] [Thread-4  ]: Timing info for model.dbtlearm.fct_reviews (compile): 2023-03-03 13:24:17.029528 => 2023-03-03 13:24:17.068643
[0m13:24:17.069343 [debug] [Thread-2  ]: Acquiring new snowflake connection 'test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af'
[0m13:24:17.070051 [debug] [Thread-3  ]: Acquiring new snowflake connection 'test.dbtlearm.dim_listings_minimum_nights'
[0m13:24:17.071906 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbtlearm.no_nulls_in_dim_listings'
[0m13:24:17.072223 [debug] [Thread-4  ]: Began executing node model.dbtlearm.fct_reviews
[0m13:24:17.072605 [debug] [Thread-2  ]: Began compiling node test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m13:24:17.072909 [debug] [Thread-3  ]: Began compiling node test.dbtlearm.dim_listings_minimum_nights
[0m13:24:17.073190 [debug] [Thread-1  ]: Began compiling node test.dbtlearm.no_nulls_in_dim_listings
[0m13:24:17.073497 [debug] [Thread-4  ]: Timing info for model.dbtlearm.fct_reviews (execute): 2023-03-03 13:24:17.073424 => 2023-03-03 13:24:17.073438
[0m13:24:17.088300 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m13:24:17.090927 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearm.dim_listings_minimum_nights"
[0m13:24:17.103876 [debug] [Thread-1  ]: Using snowflake connection "test.dbtlearm.no_nulls_in_dim_listings"
[0m13:24:17.104577 [debug] [Thread-4  ]: Finished running node model.dbtlearm.fct_reviews
[0m13:24:17.105055 [debug] [Thread-1  ]: On test.dbtlearm.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "test.dbtlearm.no_nulls_in_dim_listings"} */
describe table airbnb.dev.dim_listings_cleansed
[0m13:24:17.105451 [debug] [Thread-4  ]: Began running node test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be
[0m13:24:17.105870 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:24:17.106141 [debug] [Thread-2  ]: Timing info for test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (compile): 2023-03-03 13:24:17.073725 => 2023-03-03 13:24:17.106092
[0m13:24:17.106458 [debug] [Thread-3  ]: Timing info for test.dbtlearm.dim_listings_minimum_nights (compile): 2023-03-03 13:24:17.088543 => 2023-03-03 13:24:17.106408
[0m13:24:17.107009 [debug] [Thread-4  ]: Acquiring new snowflake connection 'test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be'
[0m13:24:17.108396 [debug] [Thread-2  ]: Began executing node test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m13:24:17.108799 [debug] [Thread-3  ]: Began executing node test.dbtlearm.dim_listings_minimum_nights
[0m13:24:17.109366 [debug] [Thread-4  ]: Began compiling node test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be
[0m13:24:17.109956 [debug] [Thread-2  ]: Timing info for test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (execute): 2023-03-03 13:24:17.109882 => 2023-03-03 13:24:17.109906
[0m13:24:17.110225 [debug] [Thread-3  ]: Timing info for test.dbtlearm.dim_listings_minimum_nights (execute): 2023-03-03 13:24:17.110167 => 2023-03-03 13:24:17.110176
[0m13:24:17.119914 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m13:24:17.120766 [debug] [Thread-2  ]: Finished running node test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m13:24:17.121445 [debug] [Thread-3  ]: Finished running node test.dbtlearm.dim_listings_minimum_nights
[0m13:24:17.121956 [debug] [Thread-2  ]: Began running node test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m13:24:17.122477 [debug] [Thread-3  ]: Began running node test.dbtlearm.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m13:24:17.122751 [debug] [Thread-4  ]: Timing info for test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be (compile): 2023-03-03 13:24:17.110448 => 2023-03-03 13:24:17.122699
[0m13:24:17.123427 [debug] [Thread-2  ]: Acquiring new snowflake connection 'test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9'
[0m13:24:17.123994 [debug] [Thread-3  ]: Acquiring new snowflake connection 'test.dbtlearm.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313'
[0m13:24:17.124306 [debug] [Thread-4  ]: Began executing node test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be
[0m13:24:17.124611 [debug] [Thread-2  ]: Began compiling node test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m13:24:17.124937 [debug] [Thread-3  ]: Began compiling node test.dbtlearm.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m13:24:17.125225 [debug] [Thread-4  ]: Timing info for test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be (execute): 2023-03-03 13:24:17.125158 => 2023-03-03 13:24:17.125170
[0m13:24:17.129732 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m13:24:17.135509 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearm.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m13:24:17.136202 [debug] [Thread-4  ]: Finished running node test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be
[0m13:24:17.136809 [debug] [Thread-4  ]: Began running node test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m13:24:17.137518 [debug] [Thread-4  ]: Acquiring new snowflake connection 'test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e'
[0m13:24:17.137817 [debug] [Thread-4  ]: Began compiling node test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m13:24:17.138096 [debug] [Thread-2  ]: Timing info for test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9 (compile): 2023-03-03 13:24:17.125438 => 2023-03-03 13:24:17.138036
[0m13:24:17.138306 [debug] [Thread-3  ]: Timing info for test.dbtlearm.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313 (compile): 2023-03-03 13:24:17.129976 => 2023-03-03 13:24:17.138250
[0m13:24:17.145337 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m13:24:17.145701 [debug] [Thread-2  ]: Began executing node test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m13:24:17.145981 [debug] [Thread-3  ]: Began executing node test.dbtlearm.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m13:24:17.146374 [debug] [Thread-2  ]: Timing info for test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9 (execute): 2023-03-03 13:24:17.146300 => 2023-03-03 13:24:17.146315
[0m13:24:17.146666 [debug] [Thread-3  ]: Timing info for test.dbtlearm.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313 (execute): 2023-03-03 13:24:17.146605 => 2023-03-03 13:24:17.146615
[0m13:24:17.147504 [debug] [Thread-2  ]: Finished running node test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m13:24:17.148203 [debug] [Thread-3  ]: Finished running node test.dbtlearm.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m13:24:17.148396 [debug] [Thread-4  ]: Timing info for test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e (compile): 2023-03-03 13:24:17.138463 => 2023-03-03 13:24:17.148352
[0m13:24:17.148762 [debug] [Thread-2  ]: Began running node model.dbtlearm.dim_listings_with_hosts
[0m13:24:17.149182 [debug] [Thread-3  ]: Began running node test.dbtlearm.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m13:24:17.149486 [debug] [Thread-4  ]: Began executing node test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m13:24:17.150087 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearm.dim_listings_with_hosts'
[0m13:24:17.150644 [debug] [Thread-3  ]: Acquiring new snowflake connection 'test.dbtlearm.not_null_dim_hosts_cleansed_host_id.de84c3da05'
[0m13:24:17.150910 [debug] [Thread-4  ]: Timing info for test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e (execute): 2023-03-03 13:24:17.150855 => 2023-03-03 13:24:17.150863
[0m13:24:17.151179 [debug] [Thread-2  ]: Began compiling node model.dbtlearm.dim_listings_with_hosts
[0m13:24:17.151442 [debug] [Thread-3  ]: Began compiling node test.dbtlearm.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m13:24:17.152084 [debug] [Thread-4  ]: Finished running node test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m13:24:17.155291 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearm.dim_listings_with_hosts"
[0m13:24:17.159759 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearm.not_null_dim_hosts_cleansed_host_id.de84c3da05"
[0m13:24:17.160240 [debug] [Thread-4  ]: Began running node test.dbtlearm.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m13:24:17.161133 [debug] [Thread-4  ]: Acquiring new snowflake connection 'test.dbtlearm.not_null_dim_hosts_cleansed_host_name.42386c5830'
[0m13:24:17.161471 [debug] [Thread-4  ]: Began compiling node test.dbtlearm.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m13:24:17.161690 [debug] [Thread-3  ]: Timing info for test.dbtlearm.not_null_dim_hosts_cleansed_host_id.de84c3da05 (compile): 2023-03-03 13:24:17.155517 => 2023-03-03 13:24:17.161631
[0m13:24:17.166077 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearm.not_null_dim_hosts_cleansed_host_name.42386c5830"
[0m13:24:17.166396 [debug] [Thread-3  ]: Began executing node test.dbtlearm.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m13:24:17.166740 [debug] [Thread-2  ]: Timing info for model.dbtlearm.dim_listings_with_hosts (compile): 2023-03-03 13:24:17.152290 => 2023-03-03 13:24:17.166685
[0m13:24:17.167080 [debug] [Thread-3  ]: Timing info for test.dbtlearm.not_null_dim_hosts_cleansed_host_id.de84c3da05 (execute): 2023-03-03 13:24:17.167016 => 2023-03-03 13:24:17.167029
[0m13:24:17.167387 [debug] [Thread-2  ]: Began executing node model.dbtlearm.dim_listings_with_hosts
[0m13:24:17.168150 [debug] [Thread-3  ]: Finished running node test.dbtlearm.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m13:24:17.168355 [debug] [Thread-4  ]: Timing info for test.dbtlearm.not_null_dim_hosts_cleansed_host_name.42386c5830 (compile): 2023-03-03 13:24:17.161890 => 2023-03-03 13:24:17.168304
[0m13:24:17.168614 [debug] [Thread-2  ]: Timing info for model.dbtlearm.dim_listings_with_hosts (execute): 2023-03-03 13:24:17.168562 => 2023-03-03 13:24:17.168570
[0m13:24:17.168954 [debug] [Thread-3  ]: Began running node test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m13:24:17.169291 [debug] [Thread-4  ]: Began executing node test.dbtlearm.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m13:24:17.169977 [debug] [Thread-2  ]: Finished running node model.dbtlearm.dim_listings_with_hosts
[0m13:24:17.170563 [debug] [Thread-3  ]: Acquiring new snowflake connection 'test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad'
[0m13:24:17.170838 [debug] [Thread-4  ]: Timing info for test.dbtlearm.not_null_dim_hosts_cleansed_host_name.42386c5830 (execute): 2023-03-03 13:24:17.170783 => 2023-03-03 13:24:17.170792
[0m13:24:17.171180 [debug] [Thread-2  ]: Began running node test.dbtlearm.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m13:24:17.171512 [debug] [Thread-3  ]: Began compiling node test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m13:24:17.172214 [debug] [Thread-4  ]: Finished running node test.dbtlearm.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m13:24:17.172874 [debug] [Thread-2  ]: Acquiring new snowflake connection 'test.dbtlearm.unique_dim_hosts_cleansed_host_id.d7e4771347'
[0m13:24:17.182098 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m13:24:17.182540 [debug] [Thread-4  ]: Began running node model.dbtlearm.mart_fullmoon_review
[0m13:24:17.182903 [debug] [Thread-2  ]: Began compiling node test.dbtlearm.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m13:24:17.183614 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtlearm.mart_fullmoon_review'
[0m13:24:17.187703 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearm.unique_dim_hosts_cleansed_host_id.d7e4771347"
[0m13:24:17.188080 [debug] [Thread-4  ]: Began compiling node model.dbtlearm.mart_fullmoon_review
[0m13:24:17.188391 [debug] [Thread-3  ]: Timing info for test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (compile): 2023-03-03 13:24:17.173152 => 2023-03-03 13:24:17.188330
[0m13:24:17.193464 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearm.mart_fullmoon_review"
[0m13:24:17.193920 [debug] [Thread-3  ]: Began executing node test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m13:24:17.194179 [debug] [Thread-2  ]: Timing info for test.dbtlearm.unique_dim_hosts_cleansed_host_id.d7e4771347 (compile): 2023-03-03 13:24:17.183849 => 2023-03-03 13:24:17.194114
[0m13:24:17.194564 [debug] [Thread-3  ]: Timing info for test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (execute): 2023-03-03 13:24:17.194497 => 2023-03-03 13:24:17.194513
[0m13:24:17.194876 [debug] [Thread-2  ]: Began executing node test.dbtlearm.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m13:24:17.195595 [debug] [Thread-3  ]: Finished running node test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m13:24:17.195888 [debug] [Thread-2  ]: Timing info for test.dbtlearm.unique_dim_hosts_cleansed_host_id.d7e4771347 (execute): 2023-03-03 13:24:17.195826 => 2023-03-03 13:24:17.195836
[0m13:24:17.196255 [debug] [Thread-3  ]: Began running node test.dbtlearm.consistent_created_at
[0m13:24:17.197007 [debug] [Thread-2  ]: Finished running node test.dbtlearm.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m13:24:17.197626 [debug] [Thread-3  ]: Acquiring new snowflake connection 'test.dbtlearm.consistent_created_at'
[0m13:24:17.197850 [debug] [Thread-4  ]: Timing info for model.dbtlearm.mart_fullmoon_review (compile): 2023-03-03 13:24:17.188679 => 2023-03-03 13:24:17.197793
[0m13:24:17.198196 [debug] [Thread-2  ]: Began running node test.dbtlearm.not_null_fct_reviews_reviewer_name.8204e43c88
[0m13:24:17.198514 [debug] [Thread-3  ]: Began compiling node test.dbtlearm.consistent_created_at
[0m13:24:17.198802 [debug] [Thread-4  ]: Began executing node model.dbtlearm.mart_fullmoon_review
[0m13:24:17.199355 [debug] [Thread-2  ]: Acquiring new snowflake connection 'test.dbtlearm.not_null_fct_reviews_reviewer_name.8204e43c88'
[0m13:24:17.202484 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearm.consistent_created_at"
[0m13:24:17.202765 [debug] [Thread-4  ]: Timing info for model.dbtlearm.mart_fullmoon_review (execute): 2023-03-03 13:24:17.202705 => 2023-03-03 13:24:17.202715
[0m13:24:17.203031 [debug] [Thread-2  ]: Began compiling node test.dbtlearm.not_null_fct_reviews_reviewer_name.8204e43c88
[0m13:24:17.203846 [debug] [Thread-4  ]: Finished running node model.dbtlearm.mart_fullmoon_review
[0m13:24:17.208310 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearm.not_null_fct_reviews_reviewer_name.8204e43c88"
[0m13:24:17.208575 [debug] [Thread-3  ]: Timing info for test.dbtlearm.consistent_created_at (compile): 2023-03-03 13:24:17.199564 => 2023-03-03 13:24:17.208510
[0m13:24:17.208971 [debug] [Thread-4  ]: Began running node test.dbtlearm.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe
[0m13:24:17.209455 [debug] [Thread-3  ]: Began executing node test.dbtlearm.consistent_created_at
[0m13:24:17.210144 [debug] [Thread-4  ]: Acquiring new snowflake connection 'test.dbtlearm.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe'
[0m13:24:17.210370 [debug] [Thread-2  ]: Timing info for test.dbtlearm.not_null_fct_reviews_reviewer_name.8204e43c88 (compile): 2023-03-03 13:24:17.204131 => 2023-03-03 13:24:17.210314
[0m13:24:17.210645 [debug] [Thread-3  ]: Timing info for test.dbtlearm.consistent_created_at (execute): 2023-03-03 13:24:17.210581 => 2023-03-03 13:24:17.210593
[0m13:24:17.210930 [debug] [Thread-4  ]: Began compiling node test.dbtlearm.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe
[0m13:24:17.211227 [debug] [Thread-2  ]: Began executing node test.dbtlearm.not_null_fct_reviews_reviewer_name.8204e43c88
[0m13:24:17.211885 [debug] [Thread-3  ]: Finished running node test.dbtlearm.consistent_created_at
[0m13:24:17.217667 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearm.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe"
[0m13:24:17.217962 [debug] [Thread-2  ]: Timing info for test.dbtlearm.not_null_fct_reviews_reviewer_name.8204e43c88 (execute): 2023-03-03 13:24:17.217904 => 2023-03-03 13:24:17.217914
[0m13:24:17.218902 [debug] [Thread-2  ]: Finished running node test.dbtlearm.not_null_fct_reviews_reviewer_name.8204e43c88
[0m13:24:17.219327 [debug] [Thread-4  ]: Timing info for test.dbtlearm.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe (compile): 2023-03-03 13:24:17.212093 => 2023-03-03 13:24:17.219276
[0m13:24:17.219592 [debug] [Thread-4  ]: Began executing node test.dbtlearm.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe
[0m13:24:17.219830 [debug] [Thread-4  ]: Timing info for test.dbtlearm.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe (execute): 2023-03-03 13:24:17.219779 => 2023-03-03 13:24:17.219787
[0m13:24:17.220458 [debug] [Thread-4  ]: Finished running node test.dbtlearm.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe
[0m13:24:18.272201 [debug] [Thread-1  ]: SQL status: SUCCESS 8 in 1 seconds
[0m13:24:18.275721 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearm.no_nulls_in_dim_listings"
[0m13:24:18.277001 [debug] [Thread-1  ]: Timing info for test.dbtlearm.no_nulls_in_dim_listings (compile): 2023-03-03 13:24:17.091273 => 2023-03-03 13:24:18.276903
[0m13:24:18.277418 [debug] [Thread-1  ]: Began executing node test.dbtlearm.no_nulls_in_dim_listings
[0m13:24:18.277761 [debug] [Thread-1  ]: Timing info for test.dbtlearm.no_nulls_in_dim_listings (execute): 2023-03-03 13:24:18.277691 => 2023-03-03 13:24:18.277706
[0m13:24:18.278046 [debug] [Thread-1  ]: On test.dbtlearm.no_nulls_in_dim_listings: Close
[0m13:24:18.566213 [debug] [Thread-1  ]: Finished running node test.dbtlearm.no_nulls_in_dim_listings
[0m13:24:18.567664 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:24:18.567987 [debug] [MainThread]: Connection 'test.dbtlearm.no_nulls_in_dim_listings' was properly closed.
[0m13:24:18.568261 [debug] [MainThread]: Connection 'test.dbtlearm.not_null_fct_reviews_reviewer_name.8204e43c88' was properly closed.
[0m13:24:18.568543 [debug] [MainThread]: Connection 'test.dbtlearm.consistent_created_at' was properly closed.
[0m13:24:18.568760 [debug] [MainThread]: Connection 'test.dbtlearm.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe' was properly closed.
[0m13:24:18.569900 [debug] [MainThread]: Command end result
[0m13:24:18.582069 [info ] [MainThread]: Done.
[0m13:24:18.738527 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m13:24:18.738830 [info ] [MainThread]: Building catalog
[0m13:24:18.741149 [debug] [ThreadPool]: Acquiring new snowflake connection 'airbnb.information_schema'
[0m13:24:18.749703 [debug] [ThreadPool]: Using snowflake connection "airbnb.information_schema"
[0m13:24:18.750000 [debug] [ThreadPool]: On airbnb.information_schema: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "connection_name": "airbnb.information_schema"} */
with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from airbnb.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from airbnb.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('raw') or upper("table_schema") = upper('dev'))
      order by "column_index"
[0m13:24:18.750235 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:24:21.422548 [debug] [ThreadPool]: SQL status: SUCCESS 77 in 3 seconds
[0m13:24:21.450152 [debug] [ThreadPool]: On airbnb.information_schema: Close
[0m13:24:21.757720 [info ] [MainThread]: Catalog written to /Users/mramirez/Documents/DBT/dbtlearm/target/catalog.json
[0m13:24:21.758655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc07f1fdd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0800907f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc080287940>]}
[0m13:24:21.759398 [debug] [MainThread]: Flushing usage events
[0m13:24:22.131011 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m13:24:22.131433 [debug] [MainThread]: Connection 'airbnb.information_schema' was properly closed.


============================== 2023-03-03 13:26:49.192623 | c8dcad52-3e0a-453f-b3d2-9a2de925ba99 ==============================
[0m13:26:49.192623 [info ] [MainThread]: Running with dbt=1.4.1
[0m13:26:49.195670 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/mramirez/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
[0m13:26:49.196386 [debug] [MainThread]: Tracking: tracking
[0m13:26:49.197178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd34b33cd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd34b33cdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd34b34a0d0>]}
[0m13:26:49.200775 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
[0m13:26:49.201185 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
[0m13:26:49.201509 [info ] [MainThread]: 
[0m13:26:49.201813 [info ] [MainThread]: 
[0m13:26:49.202103 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2023-03-04 11:33:48.807791 | 6cb1ce70-18ef-4559-a99d-3764e8e29608 ==============================
[0m11:33:48.807791 [info ] [MainThread]: Running with dbt=1.4.1
[0m11:33:48.812493 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/mramirez/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
[0m11:33:48.812838 [debug] [MainThread]: Tracking: tracking
[0m11:33:48.813329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8378afdd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8378afddc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8378b0b0d0>]}
[0m11:33:49.237101 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m11:33:49.237667 [debug] [MainThread]: Partial parsing: added file: dbtlearm://models/docs.md
[0m11:33:49.238240 [debug] [MainThread]: Partial parsing: updated file: dbtlearm://models/schema.yml
[0m11:33:49.258984 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m11:33:49.353707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6cb1ce70-18ef-4559-a99d-3764e8e29608', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8378e1edc0>]}
[0m11:33:49.376549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6cb1ce70-18ef-4559-a99d-3764e8e29608', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8378d6d100>]}
[0m11:33:49.377050 [info ] [MainThread]: Found 8 models, 14 tests, 2 snapshots, 0 analyses, 418 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m11:33:49.377432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6cb1ce70-18ef-4559-a99d-3764e8e29608', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8378b56dc0>]}
[0m11:33:49.380002 [info ] [MainThread]: 
[0m11:33:49.381873 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:33:49.383328 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m11:33:49.400487 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m11:33:49.400892 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m11:33:49.401225 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:33:52.513882 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 3 seconds
[0m11:33:52.516331 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m11:33:52.893308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6cb1ce70-18ef-4559-a99d-3764e8e29608', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8378db6d90>]}
[0m11:33:52.894166 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:33:52.894532 [info ] [MainThread]: 
[0m11:33:52.907090 [debug] [Thread-1  ]: Began running node model.dbtlearm.src_host
[0m11:33:52.907543 [debug] [Thread-2  ]: Began running node model.dbtlearm.src_listings
[0m11:33:52.907860 [debug] [Thread-3  ]: Began running node model.dbtlearm.src_reviews
[0m11:33:52.908495 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearm.src_host'
[0m11:33:52.908805 [debug] [Thread-4  ]: Began running node seed.dbtlearm.seed_full_moon_dates
[0m11:33:52.909490 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearm.src_listings'
[0m11:33:52.910157 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearm.src_reviews'
[0m11:33:52.910491 [debug] [Thread-1  ]: Began compiling node model.dbtlearm.src_host
[0m11:33:52.911154 [debug] [Thread-4  ]: Acquiring new snowflake connection 'seed.dbtlearm.seed_full_moon_dates'
[0m11:33:52.911479 [debug] [Thread-2  ]: Began compiling node model.dbtlearm.src_listings
[0m11:33:52.911785 [debug] [Thread-3  ]: Began compiling node model.dbtlearm.src_reviews
[0m11:33:52.915387 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearm.src_host"
[0m11:33:52.915753 [debug] [Thread-4  ]: Began compiling node seed.dbtlearm.seed_full_moon_dates
[0m11:33:52.919584 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearm.src_listings"
[0m11:33:52.923186 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearm.src_reviews"
[0m11:33:52.925465 [debug] [Thread-4  ]: Timing info for seed.dbtlearm.seed_full_moon_dates (compile): 2023-03-04 11:33:52.923663 => 2023-03-04 11:33:52.925380
[0m11:33:52.926101 [debug] [Thread-4  ]: Began executing node seed.dbtlearm.seed_full_moon_dates
[0m11:33:52.926427 [debug] [Thread-4  ]: Timing info for seed.dbtlearm.seed_full_moon_dates (execute): 2023-03-04 11:33:52.926349 => 2023-03-04 11:33:52.926373
[0m11:33:52.929472 [debug] [Thread-4  ]: Finished running node seed.dbtlearm.seed_full_moon_dates
[0m11:33:52.929903 [debug] [Thread-4  ]: Began running node snapshot.dbtlearm.scd_raw_hosts
[0m11:33:52.930601 [debug] [Thread-4  ]: Acquiring new snowflake connection 'snapshot.dbtlearm.scd_raw_hosts'
[0m11:33:52.931187 [debug] [Thread-3  ]: Timing info for model.dbtlearm.src_reviews (compile): 2023-03-04 11:33:52.919972 => 2023-03-04 11:33:52.931114
[0m11:33:52.931442 [debug] [Thread-4  ]: Began compiling node snapshot.dbtlearm.scd_raw_hosts
[0m11:33:52.931800 [debug] [Thread-1  ]: Timing info for model.dbtlearm.src_host (compile): 2023-03-04 11:33:52.912178 => 2023-03-04 11:33:52.931736
[0m11:33:52.932483 [debug] [Thread-3  ]: Finished running node model.dbtlearm.src_reviews
[0m11:33:52.932690 [debug] [Thread-2  ]: Timing info for model.dbtlearm.src_listings (compile): 2023-03-04 11:33:52.915996 => 2023-03-04 11:33:52.932643
[0m11:33:52.936801 [debug] [Thread-4  ]: Timing info for snapshot.dbtlearm.scd_raw_hosts (compile): 2023-03-04 11:33:52.932921 => 2023-03-04 11:33:52.936726
[0m11:33:52.937690 [debug] [Thread-1  ]: Finished running node model.dbtlearm.src_host
[0m11:33:52.938126 [debug] [Thread-3  ]: Began running node snapshot.dbtlearm.scd_raw_listings
[0m11:33:52.939083 [debug] [Thread-2  ]: Finished running node model.dbtlearm.src_listings
[0m11:33:52.939401 [debug] [Thread-4  ]: Began executing node snapshot.dbtlearm.scd_raw_hosts
[0m11:33:52.939789 [debug] [Thread-1  ]: Began running node model.dbtlearm.fct_reviews
[0m11:33:52.940548 [debug] [Thread-3  ]: Acquiring new snowflake connection 'snapshot.dbtlearm.scd_raw_listings'
[0m11:33:52.940936 [debug] [Thread-2  ]: Began running node model.dbtlearm.dim_hosts_cleansed
[0m11:33:52.941369 [debug] [Thread-4  ]: Timing info for snapshot.dbtlearm.scd_raw_hosts (execute): 2023-03-04 11:33:52.941301 => 2023-03-04 11:33:52.941312
[0m11:33:52.941998 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearm.fct_reviews'
[0m11:33:52.942314 [debug] [Thread-3  ]: Began compiling node snapshot.dbtlearm.scd_raw_listings
[0m11:33:52.942913 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearm.dim_hosts_cleansed'
[0m11:33:52.943654 [debug] [Thread-4  ]: Finished running node snapshot.dbtlearm.scd_raw_hosts
[0m11:33:52.943959 [debug] [Thread-1  ]: Began compiling node model.dbtlearm.fct_reviews
[0m11:33:52.947935 [debug] [Thread-3  ]: Timing info for snapshot.dbtlearm.scd_raw_listings (compile): 2023-03-04 11:33:52.944184 => 2023-03-04 11:33:52.947879
[0m11:33:52.948261 [debug] [Thread-2  ]: Began compiling node model.dbtlearm.dim_hosts_cleansed
[0m11:33:52.948663 [debug] [Thread-4  ]: Began running node model.dbtlearm.dim_listings_cleansed
[0m11:33:52.961682 [debug] [Thread-3  ]: Began executing node snapshot.dbtlearm.scd_raw_listings
[0m11:33:52.991012 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearm.fct_reviews"
[0m11:33:52.992076 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearm.dim_hosts_cleansed"
[0m11:33:52.992720 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtlearm.dim_listings_cleansed'
[0m11:33:52.993019 [debug] [Thread-3  ]: Timing info for snapshot.dbtlearm.scd_raw_listings (execute): 2023-03-04 11:33:52.992951 => 2023-03-04 11:33:52.992963
[0m11:33:52.993575 [debug] [Thread-4  ]: Began compiling node model.dbtlearm.dim_listings_cleansed
[0m11:33:52.994281 [debug] [Thread-3  ]: Finished running node snapshot.dbtlearm.scd_raw_listings
[0m11:33:53.003973 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearm.dim_listings_cleansed"
[0m11:33:53.004429 [debug] [Thread-1  ]: Timing info for model.dbtlearm.fct_reviews (compile): 2023-03-04 11:33:52.948963 => 2023-03-04 11:33:53.004357
[0m11:33:53.004967 [debug] [Thread-2  ]: Timing info for model.dbtlearm.dim_hosts_cleansed (compile): 2023-03-04 11:33:52.984528 => 2023-03-04 11:33:53.004907
[0m11:33:53.005326 [debug] [Thread-1  ]: Began executing node model.dbtlearm.fct_reviews
[0m11:33:53.005619 [debug] [Thread-2  ]: Began executing node model.dbtlearm.dim_hosts_cleansed
[0m11:33:53.005895 [debug] [Thread-1  ]: Timing info for model.dbtlearm.fct_reviews (execute): 2023-03-04 11:33:53.005834 => 2023-03-04 11:33:53.005846
[0m11:33:53.006153 [debug] [Thread-2  ]: Timing info for model.dbtlearm.dim_hosts_cleansed (execute): 2023-03-04 11:33:53.006100 => 2023-03-04 11:33:53.006108
[0m11:33:53.006891 [debug] [Thread-1  ]: Finished running node model.dbtlearm.fct_reviews
[0m11:33:53.007574 [debug] [Thread-2  ]: Finished running node model.dbtlearm.dim_hosts_cleansed
[0m11:33:53.008269 [debug] [Thread-2  ]: Began running node model.dbtlearm.mart_fullmoon_review
[0m11:33:53.008657 [debug] [Thread-3  ]: Began running node test.dbtlearm.not_null_fct_reviews_reviewer_name.8204e43c88
[0m11:33:53.009388 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearm.mart_fullmoon_review'
[0m11:33:53.009673 [debug] [Thread-1  ]: Began running node test.dbtlearm.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m11:33:53.009882 [debug] [Thread-4  ]: Timing info for model.dbtlearm.dim_listings_cleansed (compile): 2023-03-04 11:33:52.994494 => 2023-03-04 11:33:53.009830
[0m11:33:53.010443 [debug] [Thread-3  ]: Acquiring new snowflake connection 'test.dbtlearm.not_null_fct_reviews_reviewer_name.8204e43c88'
[0m11:33:53.010732 [debug] [Thread-2  ]: Began compiling node model.dbtlearm.mart_fullmoon_review
[0m11:33:53.011289 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbtlearm.not_null_dim_hosts_cleansed_host_id.de84c3da05'
[0m11:33:53.011577 [debug] [Thread-4  ]: Began executing node model.dbtlearm.dim_listings_cleansed
[0m11:33:53.011856 [debug] [Thread-3  ]: Began compiling node test.dbtlearm.not_null_fct_reviews_reviewer_name.8204e43c88
[0m11:33:53.016638 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearm.mart_fullmoon_review"
[0m11:33:53.017027 [debug] [Thread-1  ]: Began compiling node test.dbtlearm.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m11:33:53.017353 [debug] [Thread-4  ]: Timing info for model.dbtlearm.dim_listings_cleansed (execute): 2023-03-04 11:33:53.017279 => 2023-03-04 11:33:53.017292
[0m11:33:53.027678 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearm.not_null_fct_reviews_reviewer_name.8204e43c88"
[0m11:33:53.032302 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearm.not_null_dim_hosts_cleansed_host_id.de84c3da05"
[0m11:33:53.033138 [debug] [Thread-4  ]: Finished running node model.dbtlearm.dim_listings_cleansed
[0m11:33:53.033369 [debug] [Thread-2  ]: Timing info for model.dbtlearm.mart_fullmoon_review (compile): 2023-03-04 11:33:53.012066 => 2023-03-04 11:33:53.033308
[0m11:33:53.034109 [debug] [Thread-4  ]: Began running node test.dbtlearm.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m11:33:53.034877 [debug] [Thread-2  ]: Began executing node model.dbtlearm.mart_fullmoon_review
[0m11:33:53.035810 [debug] [Thread-4  ]: Acquiring new snowflake connection 'test.dbtlearm.not_null_dim_hosts_cleansed_host_name.42386c5830'
[0m11:33:53.036149 [debug] [Thread-2  ]: Timing info for model.dbtlearm.mart_fullmoon_review (execute): 2023-03-04 11:33:53.036079 => 2023-03-04 11:33:53.036091
[0m11:33:53.036453 [debug] [Thread-4  ]: Began compiling node test.dbtlearm.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m11:33:53.037196 [debug] [Thread-2  ]: Finished running node model.dbtlearm.mart_fullmoon_review
[0m11:33:53.042020 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearm.not_null_dim_hosts_cleansed_host_name.42386c5830"
[0m11:33:53.042343 [debug] [Thread-3  ]: Timing info for test.dbtlearm.not_null_fct_reviews_reviewer_name.8204e43c88 (compile): 2023-03-04 11:33:53.017574 => 2023-03-04 11:33:53.042285
[0m11:33:53.042598 [debug] [Thread-1  ]: Timing info for test.dbtlearm.not_null_dim_hosts_cleansed_host_id.de84c3da05 (compile): 2023-03-04 11:33:53.028125 => 2023-03-04 11:33:53.042538
[0m11:33:53.042978 [debug] [Thread-2  ]: Began running node test.dbtlearm.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m11:33:53.043511 [debug] [Thread-3  ]: Began executing node test.dbtlearm.not_null_fct_reviews_reviewer_name.8204e43c88
[0m11:33:53.043813 [debug] [Thread-1  ]: Began executing node test.dbtlearm.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m11:33:53.044424 [debug] [Thread-2  ]: Acquiring new snowflake connection 'test.dbtlearm.unique_dim_hosts_cleansed_host_id.d7e4771347'
[0m11:33:53.044731 [debug] [Thread-3  ]: Timing info for test.dbtlearm.not_null_fct_reviews_reviewer_name.8204e43c88 (execute): 2023-03-04 11:33:53.044665 => 2023-03-04 11:33:53.044676
[0m11:33:53.045007 [debug] [Thread-1  ]: Timing info for test.dbtlearm.not_null_dim_hosts_cleansed_host_id.de84c3da05 (execute): 2023-03-04 11:33:53.044952 => 2023-03-04 11:33:53.044960
[0m11:33:53.045292 [debug] [Thread-2  ]: Began compiling node test.dbtlearm.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m11:33:53.045995 [debug] [Thread-3  ]: Finished running node test.dbtlearm.not_null_fct_reviews_reviewer_name.8204e43c88
[0m11:33:53.046677 [debug] [Thread-1  ]: Finished running node test.dbtlearm.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m11:33:53.052603 [debug] [Thread-4  ]: Timing info for test.dbtlearm.not_null_dim_hosts_cleansed_host_name.42386c5830 (compile): 2023-03-04 11:33:53.037533 => 2023-03-04 11:33:53.052529
[0m11:33:53.054311 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearm.unique_dim_hosts_cleansed_host_id.d7e4771347"
[0m11:33:53.054726 [debug] [Thread-3  ]: Began running node model.dbtlearm.dim_listings_with_hosts
[0m11:33:53.055181 [debug] [Thread-1  ]: Began running node test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m11:33:53.055544 [debug] [Thread-4  ]: Began executing node test.dbtlearm.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m11:33:53.056248 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearm.dim_listings_with_hosts'
[0m11:33:53.056839 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af'
[0m11:33:53.057118 [debug] [Thread-4  ]: Timing info for test.dbtlearm.not_null_dim_hosts_cleansed_host_name.42386c5830 (execute): 2023-03-04 11:33:53.057058 => 2023-03-04 11:33:53.057068
[0m11:33:53.057393 [debug] [Thread-3  ]: Began compiling node model.dbtlearm.dim_listings_with_hosts
[0m11:33:53.057659 [debug] [Thread-1  ]: Began compiling node test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m11:33:53.058329 [debug] [Thread-4  ]: Finished running node test.dbtlearm.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m11:33:53.061562 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearm.dim_listings_with_hosts"
[0m11:33:53.068592 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m11:33:53.068942 [debug] [Thread-2  ]: Timing info for test.dbtlearm.unique_dim_hosts_cleansed_host_id.d7e4771347 (compile): 2023-03-04 11:33:53.046962 => 2023-03-04 11:33:53.068868
[0m11:33:53.069388 [debug] [Thread-4  ]: Began running node test.dbtlearm.consistent_created_at
[0m11:33:53.070117 [debug] [Thread-2  ]: Began executing node test.dbtlearm.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m11:33:53.070757 [debug] [Thread-4  ]: Acquiring new snowflake connection 'test.dbtlearm.consistent_created_at'
[0m11:33:53.071046 [debug] [Thread-2  ]: Timing info for test.dbtlearm.unique_dim_hosts_cleansed_host_id.d7e4771347 (execute): 2023-03-04 11:33:53.070984 => 2023-03-04 11:33:53.070994
[0m11:33:53.071402 [debug] [Thread-4  ]: Began compiling node test.dbtlearm.consistent_created_at
[0m11:33:53.072138 [debug] [Thread-2  ]: Finished running node test.dbtlearm.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m11:33:53.076743 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearm.consistent_created_at"
[0m11:33:53.077337 [debug] [Thread-2  ]: Began running node test.dbtlearm.dim_listings_minimum_nights
[0m11:33:53.077541 [debug] [Thread-1  ]: Timing info for test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (compile): 2023-03-04 11:33:53.061860 => 2023-03-04 11:33:53.077493
[0m11:33:53.077774 [debug] [Thread-3  ]: Timing info for model.dbtlearm.dim_listings_with_hosts (compile): 2023-03-04 11:33:53.058554 => 2023-03-04 11:33:53.077717
[0m11:33:53.078557 [debug] [Thread-2  ]: Acquiring new snowflake connection 'test.dbtlearm.dim_listings_minimum_nights'
[0m11:33:53.078876 [debug] [Thread-1  ]: Began executing node test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m11:33:53.079165 [debug] [Thread-3  ]: Began executing node model.dbtlearm.dim_listings_with_hosts
[0m11:33:53.079436 [debug] [Thread-2  ]: Began compiling node test.dbtlearm.dim_listings_minimum_nights
[0m11:33:53.079695 [debug] [Thread-1  ]: Timing info for test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (execute): 2023-03-04 11:33:53.079641 => 2023-03-04 11:33:53.079650
[0m11:33:53.079944 [debug] [Thread-3  ]: Timing info for model.dbtlearm.dim_listings_with_hosts (execute): 2023-03-04 11:33:53.079894 => 2023-03-04 11:33:53.079902
[0m11:33:53.082605 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearm.dim_listings_minimum_nights"
[0m11:33:53.083428 [debug] [Thread-1  ]: Finished running node test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m11:33:53.083644 [debug] [Thread-4  ]: Timing info for test.dbtlearm.consistent_created_at (compile): 2023-03-04 11:33:53.072369 => 2023-03-04 11:33:53.083588
[0m11:33:53.084387 [debug] [Thread-3  ]: Finished running node model.dbtlearm.dim_listings_with_hosts
[0m11:33:53.084906 [debug] [Thread-1  ]: Began running node test.dbtlearm.no_nulls_in_dim_listings
[0m11:33:53.085342 [debug] [Thread-4  ]: Began executing node test.dbtlearm.consistent_created_at
[0m11:33:53.085749 [debug] [Thread-3  ]: Began running node test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be
[0m11:33:53.086448 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbtlearm.no_nulls_in_dim_listings'
[0m11:33:53.086783 [debug] [Thread-4  ]: Timing info for test.dbtlearm.consistent_created_at (execute): 2023-03-04 11:33:53.086695 => 2023-03-04 11:33:53.086707
[0m11:33:53.087444 [debug] [Thread-3  ]: Acquiring new snowflake connection 'test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be'
[0m11:33:53.087751 [debug] [Thread-1  ]: Began compiling node test.dbtlearm.no_nulls_in_dim_listings
[0m11:33:53.087977 [debug] [Thread-2  ]: Timing info for test.dbtlearm.dim_listings_minimum_nights (compile): 2023-03-04 11:33:53.080143 => 2023-03-04 11:33:53.087920
[0m11:33:53.088661 [debug] [Thread-4  ]: Finished running node test.dbtlearm.consistent_created_at
[0m11:33:53.088949 [debug] [Thread-3  ]: Began compiling node test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be
[0m11:33:53.102532 [debug] [Thread-1  ]: Using snowflake connection "test.dbtlearm.no_nulls_in_dim_listings"
[0m11:33:53.102837 [debug] [Thread-2  ]: Began executing node test.dbtlearm.dim_listings_minimum_nights
[0m11:33:53.103249 [debug] [Thread-4  ]: Began running node test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m11:33:53.107557 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m11:33:53.107883 [debug] [Thread-1  ]: On test.dbtlearm.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "test.dbtlearm.no_nulls_in_dim_listings"} */
describe table airbnb.dev.dim_listings_cleansed
[0m11:33:53.108276 [debug] [Thread-2  ]: Timing info for test.dbtlearm.dim_listings_minimum_nights (execute): 2023-03-04 11:33:53.108203 => 2023-03-04 11:33:53.108216
[0m11:33:53.108866 [debug] [Thread-4  ]: Acquiring new snowflake connection 'test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9'
[0m11:33:53.109255 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:33:53.109971 [debug] [Thread-2  ]: Finished running node test.dbtlearm.dim_listings_minimum_nights
[0m11:33:53.110256 [debug] [Thread-4  ]: Began compiling node test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m11:33:53.112064 [debug] [Thread-2  ]: Began running node test.dbtlearm.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m11:33:53.113353 [debug] [Thread-3  ]: Timing info for test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be (compile): 2023-03-04 11:33:53.103475 => 2023-03-04 11:33:53.113289
[0m11:33:53.117888 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m11:33:53.118720 [debug] [Thread-2  ]: Acquiring new snowflake connection 'test.dbtlearm.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313'
[0m11:33:53.119069 [debug] [Thread-3  ]: Began executing node test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be
[0m11:33:53.119537 [debug] [Thread-2  ]: Began compiling node test.dbtlearm.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m11:33:53.119920 [debug] [Thread-3  ]: Timing info for test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be (execute): 2023-03-04 11:33:53.119847 => 2023-03-04 11:33:53.119861
[0m11:33:53.124556 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearm.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m11:33:53.125471 [debug] [Thread-3  ]: Finished running node test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be
[0m11:33:53.125817 [debug] [Thread-4  ]: Timing info for test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9 (compile): 2023-03-04 11:33:53.113536 => 2023-03-04 11:33:53.125747
[0m11:33:53.126278 [debug] [Thread-3  ]: Began running node test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m11:33:53.126667 [debug] [Thread-4  ]: Began executing node test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m11:33:53.127269 [debug] [Thread-3  ]: Acquiring new snowflake connection 'test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad'
[0m11:33:53.127602 [debug] [Thread-4  ]: Timing info for test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9 (execute): 2023-03-04 11:33:53.127538 => 2023-03-04 11:33:53.127549
[0m11:33:53.127923 [debug] [Thread-3  ]: Began compiling node test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m11:33:53.128598 [debug] [Thread-4  ]: Finished running node test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m11:33:53.136478 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m11:33:53.137046 [debug] [Thread-4  ]: Began running node test.dbtlearm.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe
[0m11:33:53.137270 [debug] [Thread-2  ]: Timing info for test.dbtlearm.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313 (compile): 2023-03-04 11:33:53.120192 => 2023-03-04 11:33:53.137217
[0m11:33:53.138079 [debug] [Thread-4  ]: Acquiring new snowflake connection 'test.dbtlearm.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe'
[0m11:33:53.138385 [debug] [Thread-2  ]: Began executing node test.dbtlearm.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m11:33:53.138672 [debug] [Thread-4  ]: Began compiling node test.dbtlearm.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe
[0m11:33:53.138944 [debug] [Thread-2  ]: Timing info for test.dbtlearm.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313 (execute): 2023-03-04 11:33:53.138888 => 2023-03-04 11:33:53.138898
[0m11:33:53.145070 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearm.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe"
[0m11:33:53.145381 [debug] [Thread-3  ]: Timing info for test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (compile): 2023-03-04 11:33:53.128809 => 2023-03-04 11:33:53.145328
[0m11:33:53.146052 [debug] [Thread-2  ]: Finished running node test.dbtlearm.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m11:33:53.146494 [debug] [Thread-3  ]: Began executing node test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m11:33:53.146857 [debug] [Thread-2  ]: Began running node test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m11:33:53.147200 [debug] [Thread-3  ]: Timing info for test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (execute): 2023-03-04 11:33:53.147136 => 2023-03-04 11:33:53.147146
[0m11:33:53.147844 [debug] [Thread-2  ]: Acquiring new snowflake connection 'test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e'
[0m11:33:53.148539 [debug] [Thread-3  ]: Finished running node test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m11:33:53.148853 [debug] [Thread-2  ]: Began compiling node test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m11:33:53.149341 [debug] [Thread-4  ]: Timing info for test.dbtlearm.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe (compile): 2023-03-04 11:33:53.139172 => 2023-03-04 11:33:53.149281
[0m11:33:53.154657 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m11:33:53.155076 [debug] [Thread-4  ]: Began executing node test.dbtlearm.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe
[0m11:33:53.155530 [debug] [Thread-4  ]: Timing info for test.dbtlearm.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe (execute): 2023-03-04 11:33:53.155451 => 2023-03-04 11:33:53.155466
[0m11:33:53.156296 [debug] [Thread-4  ]: Finished running node test.dbtlearm.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe
[0m11:33:53.157877 [debug] [Thread-2  ]: Timing info for test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e (compile): 2023-03-04 11:33:53.149580 => 2023-03-04 11:33:53.157816
[0m11:33:53.158169 [debug] [Thread-2  ]: Began executing node test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m11:33:53.158425 [debug] [Thread-2  ]: Timing info for test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e (execute): 2023-03-04 11:33:53.158370 => 2023-03-04 11:33:53.158379
[0m11:33:53.159146 [debug] [Thread-2  ]: Finished running node test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m11:33:54.268128 [debug] [Thread-1  ]: SQL status: SUCCESS 8 in 1 seconds
[0m11:33:54.271365 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearm.no_nulls_in_dim_listings"
[0m11:33:54.277086 [debug] [Thread-1  ]: Timing info for test.dbtlearm.no_nulls_in_dim_listings (compile): 2023-03-04 11:33:53.089163 => 2023-03-04 11:33:54.276979
[0m11:33:54.277620 [debug] [Thread-1  ]: Began executing node test.dbtlearm.no_nulls_in_dim_listings
[0m11:33:54.278021 [debug] [Thread-1  ]: Timing info for test.dbtlearm.no_nulls_in_dim_listings (execute): 2023-03-04 11:33:54.277940 => 2023-03-04 11:33:54.277957
[0m11:33:54.278359 [debug] [Thread-1  ]: On test.dbtlearm.no_nulls_in_dim_listings: Close
[0m11:33:54.538985 [debug] [Thread-1  ]: Finished running node test.dbtlearm.no_nulls_in_dim_listings
[0m11:33:54.540437 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:33:54.540766 [debug] [MainThread]: Connection 'test.dbtlearm.no_nulls_in_dim_listings' was properly closed.
[0m11:33:54.541049 [debug] [MainThread]: Connection 'test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m11:33:54.541318 [debug] [MainThread]: Connection 'test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad' was properly closed.
[0m11:33:54.541583 [debug] [MainThread]: Connection 'test.dbtlearm.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe' was properly closed.
[0m11:33:54.542733 [debug] [MainThread]: Command end result
[0m11:33:54.559765 [info ] [MainThread]: Done.
[0m11:33:54.870771 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m11:33:54.871098 [info ] [MainThread]: Building catalog
[0m11:33:54.873412 [debug] [ThreadPool]: Acquiring new snowflake connection 'airbnb.information_schema'
[0m11:33:54.881755 [debug] [ThreadPool]: Using snowflake connection "airbnb.information_schema"
[0m11:33:54.882076 [debug] [ThreadPool]: On airbnb.information_schema: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "connection_name": "airbnb.information_schema"} */
with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from airbnb.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from airbnb.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('dev') or upper("table_schema") = upper('raw'))
      order by "column_index"
[0m11:33:54.882341 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:33:57.820861 [debug] [ThreadPool]: SQL status: SUCCESS 77 in 3 seconds
[0m11:33:57.861380 [debug] [ThreadPool]: On airbnb.information_schema: Close
[0m11:33:58.140840 [info ] [MainThread]: Catalog written to /Users/mramirez/Documents/DBT/dbtlearm/target/catalog.json
[0m11:33:58.141417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8378afdd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83795c4310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83795c4dc0>]}
[0m11:33:58.141784 [debug] [MainThread]: Flushing usage events
[0m11:33:58.898633 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m11:33:58.899155 [debug] [MainThread]: Connection 'airbnb.information_schema' was properly closed.


============================== 2023-03-04 11:34:20.530384 | 0a910403-198e-4ff1-ba40-4bbea13f2925 ==============================
[0m11:34:20.530384 [info ] [MainThread]: Running with dbt=1.4.1
[0m11:34:20.532557 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/mramirez/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
[0m11:34:20.532930 [debug] [MainThread]: Tracking: tracking
[0m11:34:20.533398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe649b00cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe649b00f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe649b00f40>]}
[0m11:34:20.536267 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
[0m11:34:20.536747 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
[0m11:34:20.537091 [info ] [MainThread]: 
[0m11:34:20.537378 [info ] [MainThread]: 
[0m11:34:20.537650 [info ] [MainThread]: Press Ctrl+C to exit.
[0m11:35:49.195080 [debug] [MainThread]: Flushing usage events
[0m11:35:49.937253 [info ] [MainThread]: ctrl-c


============================== 2023-03-04 11:35:54.879149 | 20769da3-a597-42f6-9426-8cf5a22fdaf0 ==============================
[0m11:35:54.879149 [info ] [MainThread]: Running with dbt=1.4.1
[0m11:35:54.881314 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/mramirez/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
[0m11:35:54.881608 [debug] [MainThread]: Tracking: tracking
[0m11:35:54.882039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89332fbd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89332fbdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f893330c100>]}
[0m11:35:54.997590 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m11:35:54.998082 [debug] [MainThread]: Partial parsing: added file: dbtlearm://models/overview.md
[0m11:35:55.012402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '20769da3-a597-42f6-9426-8cf5a22fdaf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f893334d0d0>]}
[0m11:35:55.023370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '20769da3-a597-42f6-9426-8cf5a22fdaf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8933653e20>]}
[0m11:35:55.023739 [info ] [MainThread]: Found 8 models, 14 tests, 2 snapshots, 0 analyses, 418 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m11:35:55.024061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20769da3-a597-42f6-9426-8cf5a22fdaf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89332fbeb0>]}
[0m11:35:55.026007 [info ] [MainThread]: 
[0m11:35:55.027412 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:35:55.028500 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m11:35:55.042965 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m11:35:55.043277 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m11:35:55.043510 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:35:56.716234 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 2 seconds
[0m11:35:56.717980 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m11:35:56.965322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20769da3-a597-42f6-9426-8cf5a22fdaf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8933653c40>]}
[0m11:35:56.965974 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:35:56.966269 [info ] [MainThread]: 
[0m11:35:56.970815 [debug] [Thread-1  ]: Began running node model.dbtlearm.src_host
[0m11:35:56.971130 [debug] [Thread-2  ]: Began running node model.dbtlearm.src_listings
[0m11:35:56.971392 [debug] [Thread-3  ]: Began running node model.dbtlearm.src_reviews
[0m11:35:56.971642 [debug] [Thread-4  ]: Began running node seed.dbtlearm.seed_full_moon_dates
[0m11:35:56.972182 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearm.src_host'
[0m11:35:56.972692 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearm.src_listings'
[0m11:35:56.974025 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearm.src_reviews'
[0m11:35:56.974529 [debug] [Thread-4  ]: Acquiring new snowflake connection 'seed.dbtlearm.seed_full_moon_dates'
[0m11:35:56.974788 [debug] [Thread-1  ]: Began compiling node model.dbtlearm.src_host
[0m11:35:56.975040 [debug] [Thread-2  ]: Began compiling node model.dbtlearm.src_listings
[0m11:35:56.975286 [debug] [Thread-3  ]: Began compiling node model.dbtlearm.src_reviews
[0m11:35:56.975528 [debug] [Thread-4  ]: Began compiling node seed.dbtlearm.seed_full_moon_dates
[0m11:35:56.978159 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearm.src_host"
[0m11:35:56.980553 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearm.src_listings"
[0m11:35:56.982934 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearm.src_reviews"
[0m11:35:56.984744 [debug] [Thread-4  ]: Timing info for seed.dbtlearm.seed_full_moon_dates (compile): 2023-03-04 11:35:56.983252 => 2023-03-04 11:35:56.984664
[0m11:35:56.985665 [debug] [Thread-4  ]: Began executing node seed.dbtlearm.seed_full_moon_dates
[0m11:35:56.986266 [debug] [Thread-4  ]: Timing info for seed.dbtlearm.seed_full_moon_dates (execute): 2023-03-04 11:35:56.986153 => 2023-03-04 11:35:56.986184
[0m11:35:56.986657 [debug] [Thread-1  ]: Timing info for model.dbtlearm.src_host (compile): 2023-03-04 11:35:56.975722 => 2023-03-04 11:35:56.986564
[0m11:35:56.987140 [debug] [Thread-2  ]: Timing info for model.dbtlearm.src_listings (compile): 2023-03-04 11:35:56.978368 => 2023-03-04 11:35:56.987071
[0m11:35:56.987355 [debug] [Thread-3  ]: Timing info for model.dbtlearm.src_reviews (compile): 2023-03-04 11:35:56.980756 => 2023-03-04 11:35:56.987305
[0m11:35:56.989164 [debug] [Thread-4  ]: Finished running node seed.dbtlearm.seed_full_moon_dates
[0m11:35:56.989849 [debug] [Thread-1  ]: Finished running node model.dbtlearm.src_host
[0m11:35:56.990406 [debug] [Thread-2  ]: Finished running node model.dbtlearm.src_listings
[0m11:35:56.991009 [debug] [Thread-3  ]: Finished running node model.dbtlearm.src_reviews
[0m11:35:56.991338 [debug] [Thread-4  ]: Began running node snapshot.dbtlearm.scd_raw_hosts
[0m11:35:56.991704 [debug] [Thread-1  ]: Began running node snapshot.dbtlearm.scd_raw_listings
[0m11:35:56.992128 [debug] [Thread-2  ]: Began running node model.dbtlearm.dim_hosts_cleansed
[0m11:35:56.992513 [debug] [Thread-3  ]: Began running node model.dbtlearm.dim_listings_cleansed
[0m11:35:56.993100 [debug] [Thread-4  ]: Acquiring new snowflake connection 'snapshot.dbtlearm.scd_raw_hosts'
[0m11:35:56.993685 [debug] [Thread-1  ]: Acquiring new snowflake connection 'snapshot.dbtlearm.scd_raw_listings'
[0m11:35:56.994200 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearm.dim_hosts_cleansed'
[0m11:35:56.994727 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearm.dim_listings_cleansed'
[0m11:35:56.995001 [debug] [Thread-4  ]: Began compiling node snapshot.dbtlearm.scd_raw_hosts
[0m11:35:56.995295 [debug] [Thread-1  ]: Began compiling node snapshot.dbtlearm.scd_raw_listings
[0m11:35:56.995556 [debug] [Thread-2  ]: Began compiling node model.dbtlearm.dim_hosts_cleansed
[0m11:35:56.995833 [debug] [Thread-3  ]: Began compiling node model.dbtlearm.dim_listings_cleansed
[0m11:35:56.999110 [debug] [Thread-4  ]: Timing info for snapshot.dbtlearm.scd_raw_hosts (compile): 2023-03-04 11:35:56.996080 => 2023-03-04 11:35:56.999062
[0m11:35:57.002085 [debug] [Thread-1  ]: Timing info for snapshot.dbtlearm.scd_raw_listings (compile): 2023-03-04 11:35:56.999334 => 2023-03-04 11:35:57.002040
[0m11:35:57.015868 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearm.dim_hosts_cleansed"
[0m11:35:57.024233 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearm.dim_listings_cleansed"
[0m11:35:57.024622 [debug] [Thread-4  ]: Began executing node snapshot.dbtlearm.scd_raw_hosts
[0m11:35:57.024974 [debug] [Thread-1  ]: Began executing node snapshot.dbtlearm.scd_raw_listings
[0m11:35:57.025531 [debug] [Thread-4  ]: Timing info for snapshot.dbtlearm.scd_raw_hosts (execute): 2023-03-04 11:35:57.025453 => 2023-03-04 11:35:57.025465
[0m11:35:57.025948 [debug] [Thread-1  ]: Timing info for snapshot.dbtlearm.scd_raw_listings (execute): 2023-03-04 11:35:57.025893 => 2023-03-04 11:35:57.025902
[0m11:35:57.026606 [debug] [Thread-4  ]: Finished running node snapshot.dbtlearm.scd_raw_hosts
[0m11:35:57.026783 [debug] [Thread-3  ]: Timing info for model.dbtlearm.dim_listings_cleansed (compile): 2023-03-04 11:35:57.016102 => 2023-03-04 11:35:57.026737
[0m11:35:57.026960 [debug] [Thread-2  ]: Timing info for model.dbtlearm.dim_hosts_cleansed (compile): 2023-03-04 11:35:57.002281 => 2023-03-04 11:35:57.026921
[0m11:35:57.027529 [debug] [Thread-1  ]: Finished running node snapshot.dbtlearm.scd_raw_listings
[0m11:35:57.027840 [debug] [Thread-4  ]: Began running node model.dbtlearm.fct_reviews
[0m11:35:57.028148 [debug] [Thread-3  ]: Began executing node model.dbtlearm.dim_listings_cleansed
[0m11:35:57.028393 [debug] [Thread-2  ]: Began executing node model.dbtlearm.dim_hosts_cleansed
[0m11:35:57.029046 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtlearm.fct_reviews'
[0m11:35:57.029278 [debug] [Thread-3  ]: Timing info for model.dbtlearm.dim_listings_cleansed (execute): 2023-03-04 11:35:57.029229 => 2023-03-04 11:35:57.029236
[0m11:35:57.029513 [debug] [Thread-2  ]: Timing info for model.dbtlearm.dim_hosts_cleansed (execute): 2023-03-04 11:35:57.029464 => 2023-03-04 11:35:57.029471
[0m11:35:57.029763 [debug] [Thread-4  ]: Began compiling node model.dbtlearm.fct_reviews
[0m11:35:57.030331 [debug] [Thread-3  ]: Finished running node model.dbtlearm.dim_listings_cleansed
[0m11:35:57.030897 [debug] [Thread-2  ]: Finished running node model.dbtlearm.dim_hosts_cleansed
[0m11:35:57.060006 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearm.fct_reviews"
[0m11:35:57.060556 [debug] [Thread-1  ]: Began running node test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m11:35:57.060835 [debug] [Thread-2  ]: Began running node test.dbtlearm.dim_listings_minimum_nights
[0m11:35:57.061069 [debug] [Thread-3  ]: Began running node test.dbtlearm.no_nulls_in_dim_listings
[0m11:35:57.061867 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af'
[0m11:35:57.062396 [debug] [Thread-2  ]: Acquiring new snowflake connection 'test.dbtlearm.dim_listings_minimum_nights'
[0m11:35:57.062588 [debug] [Thread-4  ]: Timing info for model.dbtlearm.fct_reviews (compile): 2023-03-04 11:35:57.031076 => 2023-03-04 11:35:57.062537
[0m11:35:57.063066 [debug] [Thread-3  ]: Acquiring new snowflake connection 'test.dbtlearm.no_nulls_in_dim_listings'
[0m11:35:57.063324 [debug] [Thread-1  ]: Began compiling node test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m11:35:57.063569 [debug] [Thread-2  ]: Began compiling node test.dbtlearm.dim_listings_minimum_nights
[0m11:35:57.063816 [debug] [Thread-4  ]: Began executing node model.dbtlearm.fct_reviews
[0m11:35:57.064049 [debug] [Thread-3  ]: Began compiling node test.dbtlearm.no_nulls_in_dim_listings
[0m11:35:57.076924 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m11:35:57.079303 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearm.dim_listings_minimum_nights"
[0m11:35:57.079594 [debug] [Thread-4  ]: Timing info for model.dbtlearm.fct_reviews (execute): 2023-03-04 11:35:57.079528 => 2023-03-04 11:35:57.079540
[0m11:35:57.091609 [debug] [Thread-3  ]: Using snowflake connection "test.dbtlearm.no_nulls_in_dim_listings"
[0m11:35:57.092538 [debug] [Thread-4  ]: Finished running node model.dbtlearm.fct_reviews
[0m11:35:57.092832 [debug] [Thread-3  ]: On test.dbtlearm.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "test.dbtlearm.no_nulls_in_dim_listings"} */
describe table airbnb.dev.dim_listings_cleansed
[0m11:35:57.093170 [debug] [Thread-4  ]: Began running node test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be
[0m11:35:57.093354 [debug] [Thread-1  ]: Timing info for test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (compile): 2023-03-04 11:35:57.064235 => 2023-03-04 11:35:57.093303
[0m11:35:57.093544 [debug] [Thread-2  ]: Timing info for test.dbtlearm.dim_listings_minimum_nights (compile): 2023-03-04 11:35:57.077161 => 2023-03-04 11:35:57.093499
[0m11:35:57.093926 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m11:35:57.094410 [debug] [Thread-4  ]: Acquiring new snowflake connection 'test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be'
[0m11:35:57.094661 [debug] [Thread-1  ]: Began executing node test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m11:35:57.094904 [debug] [Thread-2  ]: Began executing node test.dbtlearm.dim_listings_minimum_nights
[0m11:35:57.095729 [debug] [Thread-4  ]: Began compiling node test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be
[0m11:35:57.096402 [debug] [Thread-1  ]: Timing info for test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (execute): 2023-03-04 11:35:57.096348 => 2023-03-04 11:35:57.096358
[0m11:35:57.096756 [debug] [Thread-2  ]: Timing info for test.dbtlearm.dim_listings_minimum_nights (execute): 2023-03-04 11:35:57.096702 => 2023-03-04 11:35:57.096711
[0m11:35:57.105594 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m11:35:57.106656 [debug] [Thread-1  ]: Finished running node test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m11:35:57.107308 [debug] [Thread-2  ]: Finished running node test.dbtlearm.dim_listings_minimum_nights
[0m11:35:57.107732 [debug] [Thread-1  ]: Began running node test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m11:35:57.108133 [debug] [Thread-2  ]: Began running node test.dbtlearm.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m11:35:57.108366 [debug] [Thread-4  ]: Timing info for test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be (compile): 2023-03-04 11:35:57.097188 => 2023-03-04 11:35:57.108317
[0m11:35:57.108867 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9'
[0m11:35:57.109349 [debug] [Thread-2  ]: Acquiring new snowflake connection 'test.dbtlearm.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313'
[0m11:35:57.109602 [debug] [Thread-4  ]: Began executing node test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be
[0m11:35:57.109849 [debug] [Thread-1  ]: Began compiling node test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m11:35:57.110082 [debug] [Thread-2  ]: Began compiling node test.dbtlearm.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m11:35:57.110325 [debug] [Thread-4  ]: Timing info for test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be (execute): 2023-03-04 11:35:57.110272 => 2023-03-04 11:35:57.110281
[0m11:35:57.114226 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m11:35:57.118349 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearm.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m11:35:57.119017 [debug] [Thread-4  ]: Finished running node test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be
[0m11:35:57.119892 [debug] [Thread-4  ]: Began running node test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m11:35:57.120627 [debug] [Thread-4  ]: Acquiring new snowflake connection 'test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e'
[0m11:35:57.120828 [debug] [Thread-2  ]: Timing info for test.dbtlearm.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313 (compile): 2023-03-04 11:35:57.114443 => 2023-03-04 11:35:57.120772
[0m11:35:57.121017 [debug] [Thread-1  ]: Timing info for test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9 (compile): 2023-03-04 11:35:57.110514 => 2023-03-04 11:35:57.120968
[0m11:35:57.121258 [debug] [Thread-4  ]: Began compiling node test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m11:35:57.121501 [debug] [Thread-2  ]: Began executing node test.dbtlearm.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m11:35:57.121749 [debug] [Thread-1  ]: Began executing node test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m11:35:57.127694 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m11:35:57.127961 [debug] [Thread-2  ]: Timing info for test.dbtlearm.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313 (execute): 2023-03-04 11:35:57.127902 => 2023-03-04 11:35:57.127913
[0m11:35:57.128204 [debug] [Thread-1  ]: Timing info for test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9 (execute): 2023-03-04 11:35:57.128153 => 2023-03-04 11:35:57.128161
[0m11:35:57.128876 [debug] [Thread-2  ]: Finished running node test.dbtlearm.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m11:35:57.129476 [debug] [Thread-1  ]: Finished running node test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m11:35:57.129658 [debug] [Thread-4  ]: Timing info for test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e (compile): 2023-03-04 11:35:57.121933 => 2023-03-04 11:35:57.129610
[0m11:35:57.129964 [debug] [Thread-2  ]: Began running node model.dbtlearm.dim_listings_with_hosts
[0m11:35:57.130370 [debug] [Thread-1  ]: Began running node test.dbtlearm.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m11:35:57.130661 [debug] [Thread-4  ]: Began executing node test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m11:35:57.131140 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearm.dim_listings_with_hosts'
[0m11:35:57.131628 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbtlearm.not_null_dim_hosts_cleansed_host_id.de84c3da05'
[0m11:35:57.131859 [debug] [Thread-4  ]: Timing info for test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e (execute): 2023-03-04 11:35:57.131812 => 2023-03-04 11:35:57.131819
[0m11:35:57.132101 [debug] [Thread-2  ]: Began compiling node model.dbtlearm.dim_listings_with_hosts
[0m11:35:57.132351 [debug] [Thread-1  ]: Began compiling node test.dbtlearm.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m11:35:57.132922 [debug] [Thread-4  ]: Finished running node test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m11:35:57.135881 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearm.dim_listings_with_hosts"
[0m11:35:57.139640 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearm.not_null_dim_hosts_cleansed_host_id.de84c3da05"
[0m11:35:57.140036 [debug] [Thread-4  ]: Began running node test.dbtlearm.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m11:35:57.140795 [debug] [Thread-4  ]: Acquiring new snowflake connection 'test.dbtlearm.not_null_dim_hosts_cleansed_host_name.42386c5830'
[0m11:35:57.141120 [debug] [Thread-4  ]: Began compiling node test.dbtlearm.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m11:35:57.145948 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearm.not_null_dim_hosts_cleansed_host_name.42386c5830"
[0m11:35:57.146174 [debug] [Thread-1  ]: Timing info for test.dbtlearm.not_null_dim_hosts_cleansed_host_id.de84c3da05 (compile): 2023-03-04 11:35:57.136128 => 2023-03-04 11:35:57.146116
[0m11:35:57.146361 [debug] [Thread-2  ]: Timing info for model.dbtlearm.dim_listings_with_hosts (compile): 2023-03-04 11:35:57.133106 => 2023-03-04 11:35:57.146311
[0m11:35:57.146720 [debug] [Thread-1  ]: Began executing node test.dbtlearm.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m11:35:57.146999 [debug] [Thread-2  ]: Began executing node model.dbtlearm.dim_listings_with_hosts
[0m11:35:57.147182 [debug] [Thread-4  ]: Timing info for test.dbtlearm.not_null_dim_hosts_cleansed_host_name.42386c5830 (compile): 2023-03-04 11:35:57.141325 => 2023-03-04 11:35:57.147135
[0m11:35:57.147417 [debug] [Thread-1  ]: Timing info for test.dbtlearm.not_null_dim_hosts_cleansed_host_id.de84c3da05 (execute): 2023-03-04 11:35:57.147365 => 2023-03-04 11:35:57.147375
[0m11:35:57.147649 [debug] [Thread-2  ]: Timing info for model.dbtlearm.dim_listings_with_hosts (execute): 2023-03-04 11:35:57.147602 => 2023-03-04 11:35:57.147609
[0m11:35:57.147894 [debug] [Thread-4  ]: Began executing node test.dbtlearm.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m11:35:57.148497 [debug] [Thread-1  ]: Finished running node test.dbtlearm.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m11:35:57.149067 [debug] [Thread-2  ]: Finished running node model.dbtlearm.dim_listings_with_hosts
[0m11:35:57.149290 [debug] [Thread-4  ]: Timing info for test.dbtlearm.not_null_dim_hosts_cleansed_host_name.42386c5830 (execute): 2023-03-04 11:35:57.149244 => 2023-03-04 11:35:57.149250
[0m11:35:57.149589 [debug] [Thread-1  ]: Began running node test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m11:35:57.149947 [debug] [Thread-2  ]: Began running node test.dbtlearm.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m11:35:57.150558 [debug] [Thread-4  ]: Finished running node test.dbtlearm.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m11:35:57.151053 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad'
[0m11:35:57.151530 [debug] [Thread-2  ]: Acquiring new snowflake connection 'test.dbtlearm.unique_dim_hosts_cleansed_host_id.d7e4771347'
[0m11:35:57.151841 [debug] [Thread-4  ]: Began running node model.dbtlearm.mart_fullmoon_review
[0m11:35:57.152133 [debug] [Thread-1  ]: Began compiling node test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m11:35:57.152377 [debug] [Thread-2  ]: Began compiling node test.dbtlearm.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m11:35:57.152868 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtlearm.mart_fullmoon_review'
[0m11:35:57.161065 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m11:35:57.164662 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearm.unique_dim_hosts_cleansed_host_id.d7e4771347"
[0m11:35:57.164962 [debug] [Thread-4  ]: Began compiling node model.dbtlearm.mart_fullmoon_review
[0m11:35:57.167897 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearm.mart_fullmoon_review"
[0m11:35:57.168246 [debug] [Thread-1  ]: Timing info for test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (compile): 2023-03-04 11:35:57.153086 => 2023-03-04 11:35:57.168175
[0m11:35:57.168490 [debug] [Thread-2  ]: Timing info for test.dbtlearm.unique_dim_hosts_cleansed_host_id.d7e4771347 (compile): 2023-03-04 11:35:57.161341 => 2023-03-04 11:35:57.168441
[0m11:35:57.168740 [debug] [Thread-1  ]: Began executing node test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m11:35:57.169007 [debug] [Thread-2  ]: Began executing node test.dbtlearm.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m11:35:57.169178 [debug] [Thread-4  ]: Timing info for model.dbtlearm.mart_fullmoon_review (compile): 2023-03-04 11:35:57.165327 => 2023-03-04 11:35:57.169139
[0m11:35:57.169410 [debug] [Thread-1  ]: Timing info for test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (execute): 2023-03-04 11:35:57.169352 => 2023-03-04 11:35:57.169363
[0m11:35:57.169671 [debug] [Thread-2  ]: Timing info for test.dbtlearm.unique_dim_hosts_cleansed_host_id.d7e4771347 (execute): 2023-03-04 11:35:57.169621 => 2023-03-04 11:35:57.169629
[0m11:35:57.169920 [debug] [Thread-4  ]: Began executing node model.dbtlearm.mart_fullmoon_review
[0m11:35:57.170551 [debug] [Thread-1  ]: Finished running node test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m11:35:57.171116 [debug] [Thread-2  ]: Finished running node test.dbtlearm.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m11:35:57.171339 [debug] [Thread-4  ]: Timing info for model.dbtlearm.mart_fullmoon_review (execute): 2023-03-04 11:35:57.171293 => 2023-03-04 11:35:57.171300
[0m11:35:57.171659 [debug] [Thread-1  ]: Began running node test.dbtlearm.consistent_created_at
[0m11:35:57.172009 [debug] [Thread-2  ]: Began running node test.dbtlearm.not_null_fct_reviews_reviewer_name.8204e43c88
[0m11:35:57.172619 [debug] [Thread-4  ]: Finished running node model.dbtlearm.mart_fullmoon_review
[0m11:35:57.173097 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbtlearm.consistent_created_at'
[0m11:35:57.173582 [debug] [Thread-2  ]: Acquiring new snowflake connection 'test.dbtlearm.not_null_fct_reviews_reviewer_name.8204e43c88'
[0m11:35:57.173904 [debug] [Thread-4  ]: Began running node test.dbtlearm.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe
[0m11:35:57.174177 [debug] [Thread-1  ]: Began compiling node test.dbtlearm.consistent_created_at
[0m11:35:57.174418 [debug] [Thread-2  ]: Began compiling node test.dbtlearm.not_null_fct_reviews_reviewer_name.8204e43c88
[0m11:35:57.174891 [debug] [Thread-4  ]: Acquiring new snowflake connection 'test.dbtlearm.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe'
[0m11:35:57.177569 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearm.consistent_created_at"
[0m11:35:57.181223 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearm.not_null_fct_reviews_reviewer_name.8204e43c88"
[0m11:35:57.181517 [debug] [Thread-4  ]: Began compiling node test.dbtlearm.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe
[0m11:35:57.186996 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearm.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe"
[0m11:35:57.187508 [debug] [Thread-2  ]: Timing info for test.dbtlearm.not_null_fct_reviews_reviewer_name.8204e43c88 (compile): 2023-03-04 11:35:57.177792 => 2023-03-04 11:35:57.187446
[0m11:35:57.187726 [debug] [Thread-1  ]: Timing info for test.dbtlearm.consistent_created_at (compile): 2023-03-04 11:35:57.175070 => 2023-03-04 11:35:57.187676
[0m11:35:57.187995 [debug] [Thread-2  ]: Began executing node test.dbtlearm.not_null_fct_reviews_reviewer_name.8204e43c88
[0m11:35:57.188296 [debug] [Thread-1  ]: Began executing node test.dbtlearm.consistent_created_at
[0m11:35:57.188473 [debug] [Thread-4  ]: Timing info for test.dbtlearm.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe (compile): 2023-03-04 11:35:57.181902 => 2023-03-04 11:35:57.188433
[0m11:35:57.188720 [debug] [Thread-2  ]: Timing info for test.dbtlearm.not_null_fct_reviews_reviewer_name.8204e43c88 (execute): 2023-03-04 11:35:57.188663 => 2023-03-04 11:35:57.188676
[0m11:35:57.188965 [debug] [Thread-1  ]: Timing info for test.dbtlearm.consistent_created_at (execute): 2023-03-04 11:35:57.188912 => 2023-03-04 11:35:57.188921
[0m11:35:57.189221 [debug] [Thread-4  ]: Began executing node test.dbtlearm.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe
[0m11:35:57.189871 [debug] [Thread-2  ]: Finished running node test.dbtlearm.not_null_fct_reviews_reviewer_name.8204e43c88
[0m11:35:57.190448 [debug] [Thread-1  ]: Finished running node test.dbtlearm.consistent_created_at
[0m11:35:57.190675 [debug] [Thread-4  ]: Timing info for test.dbtlearm.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe (execute): 2023-03-04 11:35:57.190626 => 2023-03-04 11:35:57.190633
[0m11:35:57.191510 [debug] [Thread-4  ]: Finished running node test.dbtlearm.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe
[0m11:35:58.015309 [debug] [Thread-3  ]: SQL status: SUCCESS 8 in 1 seconds
[0m11:35:58.020489 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearm.no_nulls_in_dim_listings"
[0m11:35:58.026173 [debug] [Thread-3  ]: Timing info for test.dbtlearm.no_nulls_in_dim_listings (compile): 2023-03-04 11:35:57.079789 => 2023-03-04 11:35:58.026010
[0m11:35:58.026835 [debug] [Thread-3  ]: Began executing node test.dbtlearm.no_nulls_in_dim_listings
[0m11:35:58.027466 [debug] [Thread-3  ]: Timing info for test.dbtlearm.no_nulls_in_dim_listings (execute): 2023-03-04 11:35:58.027304 => 2023-03-04 11:35:58.027328
[0m11:35:58.027985 [debug] [Thread-3  ]: On test.dbtlearm.no_nulls_in_dim_listings: Close
[0m11:35:58.272745 [debug] [Thread-3  ]: Finished running node test.dbtlearm.no_nulls_in_dim_listings
[0m11:35:58.273700 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:35:58.273906 [debug] [MainThread]: Connection 'test.dbtlearm.consistent_created_at' was properly closed.
[0m11:35:58.274078 [debug] [MainThread]: Connection 'test.dbtlearm.not_null_fct_reviews_reviewer_name.8204e43c88' was properly closed.
[0m11:35:58.274256 [debug] [MainThread]: Connection 'test.dbtlearm.no_nulls_in_dim_listings' was properly closed.
[0m11:35:58.274419 [debug] [MainThread]: Connection 'test.dbtlearm.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe' was properly closed.
[0m11:35:58.275293 [debug] [MainThread]: Command end result
[0m11:35:58.284795 [info ] [MainThread]: Done.
[0m11:35:58.288155 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m11:35:58.288421 [info ] [MainThread]: Building catalog
[0m11:35:58.290439 [debug] [ThreadPool]: Acquiring new snowflake connection 'airbnb.information_schema'
[0m11:35:58.297615 [debug] [ThreadPool]: Using snowflake connection "airbnb.information_schema"
[0m11:35:58.297886 [debug] [ThreadPool]: On airbnb.information_schema: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "connection_name": "airbnb.information_schema"} */
with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from airbnb.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from airbnb.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('raw') or upper("table_schema") = upper('dev'))
      order by "column_index"
[0m11:35:58.298098 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:36:01.755258 [debug] [ThreadPool]: SQL status: SUCCESS 77 in 3 seconds
[0m11:36:01.773000 [debug] [ThreadPool]: On airbnb.information_schema: Close
[0m11:36:02.055357 [info ] [MainThread]: Catalog written to /Users/mramirez/Documents/DBT/dbtlearm/target/catalog.json
[0m11:36:02.055873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89332fbd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8933bb1d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8933bb1d00>]}
[0m11:36:02.056166 [debug] [MainThread]: Flushing usage events
[0m11:36:03.251146 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m11:36:03.251423 [debug] [MainThread]: Connection 'airbnb.information_schema' was properly closed.


============================== 2023-03-04 11:36:07.735096 | c1027b84-dfe7-43f0-92ad-04a1dffbf6f8 ==============================
[0m11:36:07.735096 [info ] [MainThread]: Running with dbt=1.4.1
[0m11:36:07.737185 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/mramirez/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
[0m11:36:07.737608 [debug] [MainThread]: Tracking: tracking
[0m11:36:07.738295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f914133dd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f914133ddf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f914134a100>]}
[0m11:36:07.740499 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
[0m11:36:07.740849 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
[0m11:36:07.741114 [info ] [MainThread]: 
[0m11:36:07.741362 [info ] [MainThread]: 
[0m11:36:07.741602 [info ] [MainThread]: Press Ctrl+C to exit.
[0m11:37:57.263531 [debug] [MainThread]: Flushing usage events
[0m11:37:57.976312 [info ] [MainThread]: ctrl-c


============================== 2023-03-04 11:39:14.111427 | 8b1a721d-b39d-42d2-b1cd-9d8d4fa05a01 ==============================
[0m11:39:14.111427 [info ] [MainThread]: Running with dbt=1.4.1
[0m11:39:14.113657 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/mramirez/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
[0m11:39:14.113938 [debug] [MainThread]: Tracking: tracking
[0m11:39:14.114367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce62af9c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce62af9f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce62af9eb0>]}
[0m11:39:14.150872 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m11:39:14.151292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8b1a721d-b39d-42d2-b1cd-9d8d4fa05a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce62b0c700>]}
[0m11:39:15.129641 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_with_hosts.sql
[0m11:39:15.140980 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m11:39:15.143749 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m11:39:15.146193 [debug] [MainThread]: 1603: static parser failed on fct/fct_reviews.sql
[0m11:39:15.166953 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fct/fct_reviews.sql
[0m11:39:15.168353 [debug] [MainThread]: 1699: static parser successfully parsed mart/mart_fullmoon_review.sql
[0m11:39:15.170856 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m11:39:15.173704 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m11:39:15.176316 [debug] [MainThread]: 1699: static parser successfully parsed src/src_host.sql
[0m11:39:15.357924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8b1a721d-b39d-42d2-b1cd-9d8d4fa05a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce62e9a0d0>]}
[0m11:39:15.368720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8b1a721d-b39d-42d2-b1cd-9d8d4fa05a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce60bb7fa0>]}
[0m11:39:15.369120 [info ] [MainThread]: Found 8 models, 14 tests, 2 snapshots, 0 analyses, 418 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m11:39:15.369432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b1a721d-b39d-42d2-b1cd-9d8d4fa05a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce62bbbe80>]}
[0m11:39:15.371847 [info ] [MainThread]: 
[0m11:39:15.373556 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:39:15.374753 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m11:39:15.389447 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m11:39:15.389822 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m11:39:15.390085 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:39:17.086925 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 2 seconds
[0m11:39:17.089728 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m11:39:17.377755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b1a721d-b39d-42d2-b1cd-9d8d4fa05a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce62ea9790>]}
[0m11:39:17.378725 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:39:17.379157 [info ] [MainThread]: 
[0m11:39:17.387901 [debug] [Thread-1  ]: Began running node model.dbtlearm.src_host
[0m11:39:17.388305 [debug] [Thread-2  ]: Began running node model.dbtlearm.src_listings
[0m11:39:17.388813 [debug] [Thread-3  ]: Began running node model.dbtlearm.src_reviews
[0m11:39:17.389306 [debug] [Thread-4  ]: Began running node seed.dbtlearm.seed_full_moon_dates
[0m11:39:17.390217 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearm.src_host'
[0m11:39:17.390955 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearm.src_listings'
[0m11:39:17.391649 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearm.src_reviews'
[0m11:39:17.392329 [debug] [Thread-4  ]: Acquiring new snowflake connection 'seed.dbtlearm.seed_full_moon_dates'
[0m11:39:17.392674 [debug] [Thread-1  ]: Began compiling node model.dbtlearm.src_host
[0m11:39:17.392991 [debug] [Thread-2  ]: Began compiling node model.dbtlearm.src_listings
[0m11:39:17.393289 [debug] [Thread-3  ]: Began compiling node model.dbtlearm.src_reviews
[0m11:39:17.393586 [debug] [Thread-4  ]: Began compiling node seed.dbtlearm.seed_full_moon_dates
[0m11:39:17.397859 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearm.src_host"
[0m11:39:17.401096 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearm.src_listings"
[0m11:39:17.404642 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearm.src_reviews"
[0m11:39:17.406766 [debug] [Thread-4  ]: Timing info for seed.dbtlearm.seed_full_moon_dates (compile): 2023-03-04 11:39:17.404949 => 2023-03-04 11:39:17.406645
[0m11:39:17.407588 [debug] [Thread-4  ]: Began executing node seed.dbtlearm.seed_full_moon_dates
[0m11:39:17.408003 [debug] [Thread-4  ]: Timing info for seed.dbtlearm.seed_full_moon_dates (execute): 2023-03-04 11:39:17.407916 => 2023-03-04 11:39:17.407944
[0m11:39:17.410170 [debug] [Thread-4  ]: Finished running node seed.dbtlearm.seed_full_moon_dates
[0m11:39:17.410461 [debug] [Thread-1  ]: Timing info for model.dbtlearm.src_host (compile): 2023-03-04 11:39:17.393825 => 2023-03-04 11:39:17.410394
[0m11:39:17.410727 [debug] [Thread-3  ]: Timing info for model.dbtlearm.src_reviews (compile): 2023-03-04 11:39:17.401403 => 2023-03-04 11:39:17.410665
[0m11:39:17.410961 [debug] [Thread-2  ]: Timing info for model.dbtlearm.src_listings (compile): 2023-03-04 11:39:17.398186 => 2023-03-04 11:39:17.410900
[0m11:39:17.411377 [debug] [Thread-4  ]: Began running node snapshot.dbtlearm.scd_raw_hosts
[0m11:39:17.412210 [debug] [Thread-1  ]: Finished running node model.dbtlearm.src_host
[0m11:39:17.412969 [debug] [Thread-3  ]: Finished running node model.dbtlearm.src_reviews
[0m11:39:17.413726 [debug] [Thread-2  ]: Finished running node model.dbtlearm.src_listings
[0m11:39:17.414358 [debug] [Thread-4  ]: Acquiring new snowflake connection 'snapshot.dbtlearm.scd_raw_hosts'
[0m11:39:17.414769 [debug] [Thread-1  ]: Began running node snapshot.dbtlearm.scd_raw_listings
[0m11:39:17.415402 [debug] [Thread-3  ]: Began running node model.dbtlearm.dim_hosts_cleansed
[0m11:39:17.415861 [debug] [Thread-2  ]: Began running node model.dbtlearm.fct_reviews
[0m11:39:17.416285 [debug] [Thread-4  ]: Began compiling node snapshot.dbtlearm.scd_raw_hosts
[0m11:39:17.416933 [debug] [Thread-1  ]: Acquiring new snowflake connection 'snapshot.dbtlearm.scd_raw_listings'
[0m11:39:17.417579 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearm.dim_hosts_cleansed'
[0m11:39:17.418486 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearm.fct_reviews'
[0m11:39:17.422579 [debug] [Thread-4  ]: Timing info for snapshot.dbtlearm.scd_raw_hosts (compile): 2023-03-04 11:39:17.418745 => 2023-03-04 11:39:17.422492
[0m11:39:17.423000 [debug] [Thread-1  ]: Began compiling node snapshot.dbtlearm.scd_raw_listings
[0m11:39:17.423315 [debug] [Thread-3  ]: Began compiling node model.dbtlearm.dim_hosts_cleansed
[0m11:39:17.423608 [debug] [Thread-2  ]: Began compiling node model.dbtlearm.fct_reviews
[0m11:39:17.423907 [debug] [Thread-4  ]: Began executing node snapshot.dbtlearm.scd_raw_hosts
[0m11:39:17.427803 [debug] [Thread-1  ]: Timing info for snapshot.dbtlearm.scd_raw_listings (compile): 2023-03-04 11:39:17.424132 => 2023-03-04 11:39:17.427744
[0m11:39:17.435403 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearm.dim_hosts_cleansed"
[0m11:39:17.453604 [debug] [Thread-4  ]: Timing info for snapshot.dbtlearm.scd_raw_hosts (execute): 2023-03-04 11:39:17.453514 => 2023-03-04 11:39:17.453531
[0m11:39:17.455190 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearm.fct_reviews"
[0m11:39:17.455619 [debug] [Thread-1  ]: Began executing node snapshot.dbtlearm.scd_raw_listings
[0m11:39:17.456579 [debug] [Thread-4  ]: Finished running node snapshot.dbtlearm.scd_raw_hosts
[0m11:39:17.457054 [debug] [Thread-1  ]: Timing info for snapshot.dbtlearm.scd_raw_listings (execute): 2023-03-04 11:39:17.456985 => 2023-03-04 11:39:17.456997
[0m11:39:17.457298 [debug] [Thread-3  ]: Timing info for model.dbtlearm.dim_hosts_cleansed (compile): 2023-03-04 11:39:17.428053 => 2023-03-04 11:39:17.457239
[0m11:39:17.457623 [debug] [Thread-2  ]: Timing info for model.dbtlearm.fct_reviews (compile): 2023-03-04 11:39:17.435707 => 2023-03-04 11:39:17.457566
[0m11:39:17.457937 [debug] [Thread-4  ]: Began running node model.dbtlearm.dim_listings_cleansed
[0m11:39:17.458617 [debug] [Thread-1  ]: Finished running node snapshot.dbtlearm.scd_raw_listings
[0m11:39:17.458976 [debug] [Thread-3  ]: Began executing node model.dbtlearm.dim_hosts_cleansed
[0m11:39:17.459242 [debug] [Thread-2  ]: Began executing node model.dbtlearm.fct_reviews
[0m11:39:17.459794 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtlearm.dim_listings_cleansed'
[0m11:39:17.460229 [debug] [Thread-3  ]: Timing info for model.dbtlearm.dim_hosts_cleansed (execute): 2023-03-04 11:39:17.460173 => 2023-03-04 11:39:17.460181
[0m11:39:17.460492 [debug] [Thread-2  ]: Timing info for model.dbtlearm.fct_reviews (execute): 2023-03-04 11:39:17.460439 => 2023-03-04 11:39:17.460448
[0m11:39:17.460763 [debug] [Thread-4  ]: Began compiling node model.dbtlearm.dim_listings_cleansed
[0m11:39:17.461461 [debug] [Thread-3  ]: Finished running node model.dbtlearm.dim_hosts_cleansed
[0m11:39:17.462184 [debug] [Thread-2  ]: Finished running node model.dbtlearm.fct_reviews
[0m11:39:17.471597 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearm.dim_listings_cleansed"
[0m11:39:17.472322 [debug] [Thread-1  ]: Began running node test.dbtlearm.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m11:39:17.472616 [debug] [Thread-2  ]: Began running node test.dbtlearm.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m11:39:17.472851 [debug] [Thread-3  ]: Began running node test.dbtlearm.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m11:39:17.473809 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbtlearm.not_null_dim_hosts_cleansed_host_id.de84c3da05'
[0m11:39:17.474375 [debug] [Thread-2  ]: Acquiring new snowflake connection 'test.dbtlearm.not_null_dim_hosts_cleansed_host_name.42386c5830'
[0m11:39:17.475020 [debug] [Thread-3  ]: Acquiring new snowflake connection 'test.dbtlearm.unique_dim_hosts_cleansed_host_id.d7e4771347'
[0m11:39:17.475285 [debug] [Thread-4  ]: Timing info for model.dbtlearm.dim_listings_cleansed (compile): 2023-03-04 11:39:17.462416 => 2023-03-04 11:39:17.475217
[0m11:39:17.475575 [debug] [Thread-1  ]: Began compiling node test.dbtlearm.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m11:39:17.475875 [debug] [Thread-2  ]: Began compiling node test.dbtlearm.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m11:39:17.476157 [debug] [Thread-3  ]: Began compiling node test.dbtlearm.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m11:39:17.476430 [debug] [Thread-4  ]: Began executing node model.dbtlearm.dim_listings_cleansed
[0m11:39:17.486070 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearm.not_null_dim_hosts_cleansed_host_id.de84c3da05"
[0m11:39:17.490653 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearm.not_null_dim_hosts_cleansed_host_name.42386c5830"
[0m11:39:17.497440 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearm.unique_dim_hosts_cleansed_host_id.d7e4771347"
[0m11:39:17.497763 [debug] [Thread-4  ]: Timing info for model.dbtlearm.dim_listings_cleansed (execute): 2023-03-04 11:39:17.497690 => 2023-03-04 11:39:17.497704
[0m11:39:17.498852 [debug] [Thread-4  ]: Finished running node model.dbtlearm.dim_listings_cleansed
[0m11:39:17.499263 [debug] [Thread-4  ]: Began running node model.dbtlearm.mart_fullmoon_review
[0m11:39:17.500040 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtlearm.mart_fullmoon_review'
[0m11:39:17.500348 [debug] [Thread-4  ]: Began compiling node model.dbtlearm.mart_fullmoon_review
[0m11:39:17.500606 [debug] [Thread-2  ]: Timing info for test.dbtlearm.not_null_dim_hosts_cleansed_host_name.42386c5830 (compile): 2023-03-04 11:39:17.486312 => 2023-03-04 11:39:17.500548
[0m11:39:17.504289 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearm.mart_fullmoon_review"
[0m11:39:17.504498 [debug] [Thread-1  ]: Timing info for test.dbtlearm.not_null_dim_hosts_cleansed_host_id.de84c3da05 (compile): 2023-03-04 11:39:17.476637 => 2023-03-04 11:39:17.504451
[0m11:39:17.504679 [debug] [Thread-3  ]: Timing info for test.dbtlearm.unique_dim_hosts_cleansed_host_id.d7e4771347 (compile): 2023-03-04 11:39:17.490966 => 2023-03-04 11:39:17.504637
[0m11:39:17.504985 [debug] [Thread-2  ]: Began executing node test.dbtlearm.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m11:39:17.505471 [debug] [Thread-1  ]: Began executing node test.dbtlearm.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m11:39:17.505805 [debug] [Thread-3  ]: Began executing node test.dbtlearm.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m11:39:17.506168 [debug] [Thread-2  ]: Timing info for test.dbtlearm.not_null_dim_hosts_cleansed_host_name.42386c5830 (execute): 2023-03-04 11:39:17.506108 => 2023-03-04 11:39:17.506120
[0m11:39:17.506351 [debug] [Thread-4  ]: Timing info for model.dbtlearm.mart_fullmoon_review (compile): 2023-03-04 11:39:17.501141 => 2023-03-04 11:39:17.506310
[0m11:39:17.506630 [debug] [Thread-1  ]: Timing info for test.dbtlearm.not_null_dim_hosts_cleansed_host_id.de84c3da05 (execute): 2023-03-04 11:39:17.506565 => 2023-03-04 11:39:17.506574
[0m11:39:17.506879 [debug] [Thread-3  ]: Timing info for test.dbtlearm.unique_dim_hosts_cleansed_host_id.d7e4771347 (execute): 2023-03-04 11:39:17.506830 => 2023-03-04 11:39:17.506838
[0m11:39:17.507621 [debug] [Thread-2  ]: Finished running node test.dbtlearm.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m11:39:17.507909 [debug] [Thread-4  ]: Began executing node model.dbtlearm.mart_fullmoon_review
[0m11:39:17.508566 [debug] [Thread-1  ]: Finished running node test.dbtlearm.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m11:39:17.509278 [debug] [Thread-3  ]: Finished running node test.dbtlearm.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m11:39:17.509646 [debug] [Thread-2  ]: Began running node test.dbtlearm.not_null_fct_reviews_reviewer_name.8204e43c88
[0m11:39:17.509972 [debug] [Thread-4  ]: Timing info for model.dbtlearm.mart_fullmoon_review (execute): 2023-03-04 11:39:17.509916 => 2023-03-04 11:39:17.509924
[0m11:39:17.510319 [debug] [Thread-1  ]: Began running node model.dbtlearm.dim_listings_with_hosts
[0m11:39:17.510737 [debug] [Thread-3  ]: Began running node test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m11:39:17.511322 [debug] [Thread-2  ]: Acquiring new snowflake connection 'test.dbtlearm.not_null_fct_reviews_reviewer_name.8204e43c88'
[0m11:39:17.512031 [debug] [Thread-4  ]: Finished running node model.dbtlearm.mart_fullmoon_review
[0m11:39:17.512599 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearm.dim_listings_with_hosts'
[0m11:39:17.513161 [debug] [Thread-3  ]: Acquiring new snowflake connection 'test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af'
[0m11:39:17.513441 [debug] [Thread-2  ]: Began compiling node test.dbtlearm.not_null_fct_reviews_reviewer_name.8204e43c88
[0m11:39:17.513793 [debug] [Thread-4  ]: Began running node test.dbtlearm.consistent_created_at
[0m11:39:17.514123 [debug] [Thread-1  ]: Began compiling node model.dbtlearm.dim_listings_with_hosts
[0m11:39:17.514398 [debug] [Thread-3  ]: Began compiling node test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m11:39:17.520284 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearm.not_null_fct_reviews_reviewer_name.8204e43c88"
[0m11:39:17.520929 [debug] [Thread-4  ]: Acquiring new snowflake connection 'test.dbtlearm.consistent_created_at'
[0m11:39:17.524107 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearm.dim_listings_with_hosts"
[0m11:39:17.530606 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m11:39:17.531077 [debug] [Thread-4  ]: Began compiling node test.dbtlearm.consistent_created_at
[0m11:39:17.531705 [debug] [Thread-2  ]: Timing info for test.dbtlearm.not_null_fct_reviews_reviewer_name.8204e43c88 (compile): 2023-03-04 11:39:17.514600 => 2023-03-04 11:39:17.531633
[0m11:39:17.534743 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearm.consistent_created_at"
[0m11:39:17.535181 [debug] [Thread-2  ]: Began executing node test.dbtlearm.not_null_fct_reviews_reviewer_name.8204e43c88
[0m11:39:17.535386 [debug] [Thread-1  ]: Timing info for model.dbtlearm.dim_listings_with_hosts (compile): 2023-03-04 11:39:17.521179 => 2023-03-04 11:39:17.535335
[0m11:39:17.535563 [debug] [Thread-3  ]: Timing info for test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (compile): 2023-03-04 11:39:17.524377 => 2023-03-04 11:39:17.535523
[0m11:39:17.535955 [debug] [Thread-2  ]: Timing info for test.dbtlearm.not_null_fct_reviews_reviewer_name.8204e43c88 (execute): 2023-03-04 11:39:17.535892 => 2023-03-04 11:39:17.535905
[0m11:39:17.536327 [debug] [Thread-1  ]: Began executing node model.dbtlearm.dim_listings_with_hosts
[0m11:39:17.536520 [debug] [Thread-4  ]: Timing info for test.dbtlearm.consistent_created_at (compile): 2023-03-04 11:39:17.531872 => 2023-03-04 11:39:17.536476
[0m11:39:17.536793 [debug] [Thread-3  ]: Began executing node test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m11:39:17.537486 [debug] [Thread-2  ]: Finished running node test.dbtlearm.not_null_fct_reviews_reviewer_name.8204e43c88
[0m11:39:17.537756 [debug] [Thread-1  ]: Timing info for model.dbtlearm.dim_listings_with_hosts (execute): 2023-03-04 11:39:17.537701 => 2023-03-04 11:39:17.537710
[0m11:39:17.538059 [debug] [Thread-4  ]: Began executing node test.dbtlearm.consistent_created_at
[0m11:39:17.538347 [debug] [Thread-3  ]: Timing info for test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (execute): 2023-03-04 11:39:17.538287 => 2023-03-04 11:39:17.538297
[0m11:39:17.538758 [debug] [Thread-2  ]: Began running node test.dbtlearm.dim_listings_minimum_nights
[0m11:39:17.539582 [debug] [Thread-1  ]: Finished running node model.dbtlearm.dim_listings_with_hosts
[0m11:39:17.539956 [debug] [Thread-4  ]: Timing info for test.dbtlearm.consistent_created_at (execute): 2023-03-04 11:39:17.539893 => 2023-03-04 11:39:17.539903
[0m11:39:17.540660 [debug] [Thread-3  ]: Finished running node test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m11:39:17.541243 [debug] [Thread-2  ]: Acquiring new snowflake connection 'test.dbtlearm.dim_listings_minimum_nights'
[0m11:39:17.541605 [debug] [Thread-1  ]: Began running node test.dbtlearm.no_nulls_in_dim_listings
[0m11:39:17.542306 [debug] [Thread-4  ]: Finished running node test.dbtlearm.consistent_created_at
[0m11:39:17.542650 [debug] [Thread-3  ]: Began running node test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be
[0m11:39:17.542971 [debug] [Thread-2  ]: Began compiling node test.dbtlearm.dim_listings_minimum_nights
[0m11:39:17.543762 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbtlearm.no_nulls_in_dim_listings'
[0m11:39:17.544110 [debug] [Thread-4  ]: Began running node test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m11:39:17.544702 [debug] [Thread-3  ]: Acquiring new snowflake connection 'test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be'
[0m11:39:17.547557 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearm.dim_listings_minimum_nights"
[0m11:39:17.547868 [debug] [Thread-1  ]: Began compiling node test.dbtlearm.no_nulls_in_dim_listings
[0m11:39:17.548423 [debug] [Thread-4  ]: Acquiring new snowflake connection 'test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9'
[0m11:39:17.548711 [debug] [Thread-3  ]: Began compiling node test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be
[0m11:39:17.559946 [debug] [Thread-1  ]: Using snowflake connection "test.dbtlearm.no_nulls_in_dim_listings"
[0m11:39:17.560476 [debug] [Thread-4  ]: Began compiling node test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m11:39:17.560701 [debug] [Thread-2  ]: Timing info for test.dbtlearm.dim_listings_minimum_nights (compile): 2023-03-04 11:39:17.544920 => 2023-03-04 11:39:17.560641
[0m11:39:17.564884 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m11:39:17.565163 [debug] [Thread-1  ]: On test.dbtlearm.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "test.dbtlearm.no_nulls_in_dim_listings"} */
describe table airbnb.dev.dim_listings_cleansed
[0m11:39:17.570595 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m11:39:17.570901 [debug] [Thread-2  ]: Began executing node test.dbtlearm.dim_listings_minimum_nights
[0m11:39:17.571326 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:39:17.571984 [debug] [Thread-2  ]: Timing info for test.dbtlearm.dim_listings_minimum_nights (execute): 2023-03-04 11:39:17.571884 => 2023-03-04 11:39:17.571905
[0m11:39:17.572274 [debug] [Thread-3  ]: Timing info for test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be (compile): 2023-03-04 11:39:17.560916 => 2023-03-04 11:39:17.572215
[0m11:39:17.573837 [debug] [Thread-4  ]: Timing info for test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9 (compile): 2023-03-04 11:39:17.565375 => 2023-03-04 11:39:17.573772
[0m11:39:17.574771 [debug] [Thread-2  ]: Finished running node test.dbtlearm.dim_listings_minimum_nights
[0m11:39:17.575393 [debug] [Thread-3  ]: Began executing node test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be
[0m11:39:17.575991 [debug] [Thread-4  ]: Began executing node test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m11:39:17.576357 [debug] [Thread-2  ]: Began running node test.dbtlearm.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m11:39:17.576704 [debug] [Thread-3  ]: Timing info for test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be (execute): 2023-03-04 11:39:17.576643 => 2023-03-04 11:39:17.576653
[0m11:39:17.577048 [debug] [Thread-4  ]: Timing info for test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9 (execute): 2023-03-04 11:39:17.576987 => 2023-03-04 11:39:17.576998
[0m11:39:17.577627 [debug] [Thread-2  ]: Acquiring new snowflake connection 'test.dbtlearm.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313'
[0m11:39:17.578314 [debug] [Thread-3  ]: Finished running node test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be
[0m11:39:17.578965 [debug] [Thread-4  ]: Finished running node test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m11:39:17.579247 [debug] [Thread-2  ]: Began compiling node test.dbtlearm.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m11:39:17.579595 [debug] [Thread-3  ]: Began running node test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m11:39:17.580003 [debug] [Thread-4  ]: Began running node test.dbtlearm.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe
[0m11:39:17.584419 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearm.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m11:39:17.585024 [debug] [Thread-3  ]: Acquiring new snowflake connection 'test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad'
[0m11:39:17.585567 [debug] [Thread-4  ]: Acquiring new snowflake connection 'test.dbtlearm.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe'
[0m11:39:17.585988 [debug] [Thread-3  ]: Began compiling node test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m11:39:17.586268 [debug] [Thread-4  ]: Began compiling node test.dbtlearm.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe
[0m11:39:17.592556 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m11:39:17.592899 [debug] [Thread-2  ]: Timing info for test.dbtlearm.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313 (compile): 2023-03-04 11:39:17.580262 => 2023-03-04 11:39:17.592830
[0m11:39:17.598544 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearm.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe"
[0m11:39:17.599092 [debug] [Thread-2  ]: Began executing node test.dbtlearm.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m11:39:17.599537 [debug] [Thread-3  ]: Timing info for test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (compile): 2023-03-04 11:39:17.586534 => 2023-03-04 11:39:17.599465
[0m11:39:17.599843 [debug] [Thread-2  ]: Timing info for test.dbtlearm.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313 (execute): 2023-03-04 11:39:17.599783 => 2023-03-04 11:39:17.599795
[0m11:39:17.600143 [debug] [Thread-4  ]: Timing info for test.dbtlearm.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe (compile): 2023-03-04 11:39:17.593063 => 2023-03-04 11:39:17.600092
[0m11:39:17.600368 [debug] [Thread-3  ]: Began executing node test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m11:39:17.601101 [debug] [Thread-2  ]: Finished running node test.dbtlearm.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m11:39:17.601385 [debug] [Thread-4  ]: Began executing node test.dbtlearm.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe
[0m11:39:17.601646 [debug] [Thread-3  ]: Timing info for test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (execute): 2023-03-04 11:39:17.601591 => 2023-03-04 11:39:17.601599
[0m11:39:17.602002 [debug] [Thread-2  ]: Began running node test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m11:39:17.602268 [debug] [Thread-4  ]: Timing info for test.dbtlearm.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe (execute): 2023-03-04 11:39:17.602215 => 2023-03-04 11:39:17.602223
[0m11:39:17.603032 [debug] [Thread-3  ]: Finished running node test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m11:39:17.603637 [debug] [Thread-2  ]: Acquiring new snowflake connection 'test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e'
[0m11:39:17.604300 [debug] [Thread-4  ]: Finished running node test.dbtlearm.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe
[0m11:39:17.604802 [debug] [Thread-2  ]: Began compiling node test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m11:39:17.610043 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m11:39:17.610933 [debug] [Thread-2  ]: Timing info for test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e (compile): 2023-03-04 11:39:17.605236 => 2023-03-04 11:39:17.610860
[0m11:39:17.611260 [debug] [Thread-2  ]: Began executing node test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m11:39:17.611524 [debug] [Thread-2  ]: Timing info for test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e (execute): 2023-03-04 11:39:17.611466 => 2023-03-04 11:39:17.611477
[0m11:39:17.612213 [debug] [Thread-2  ]: Finished running node test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m11:39:18.671920 [debug] [Thread-1  ]: SQL status: SUCCESS 8 in 1 seconds
[0m11:39:18.675225 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearm.no_nulls_in_dim_listings"
[0m11:39:18.676366 [debug] [Thread-1  ]: Timing info for test.dbtlearm.no_nulls_in_dim_listings (compile): 2023-03-04 11:39:17.549053 => 2023-03-04 11:39:18.676275
[0m11:39:18.676769 [debug] [Thread-1  ]: Began executing node test.dbtlearm.no_nulls_in_dim_listings
[0m11:39:18.677111 [debug] [Thread-1  ]: Timing info for test.dbtlearm.no_nulls_in_dim_listings (execute): 2023-03-04 11:39:18.677044 => 2023-03-04 11:39:18.677059
[0m11:39:18.677399 [debug] [Thread-1  ]: On test.dbtlearm.no_nulls_in_dim_listings: Close
[0m11:39:18.960090 [debug] [Thread-1  ]: Finished running node test.dbtlearm.no_nulls_in_dim_listings
[0m11:39:18.961604 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:39:18.961883 [debug] [MainThread]: Connection 'test.dbtlearm.no_nulls_in_dim_listings' was properly closed.
[0m11:39:18.962119 [debug] [MainThread]: Connection 'test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m11:39:18.962345 [debug] [MainThread]: Connection 'test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad' was properly closed.
[0m11:39:18.962573 [debug] [MainThread]: Connection 'test.dbtlearm.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe' was properly closed.
[0m11:39:18.963752 [debug] [MainThread]: Command end result
[0m11:39:18.977254 [info ] [MainThread]: Done.
[0m11:39:18.982550 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m11:39:18.982858 [info ] [MainThread]: Building catalog
[0m11:39:18.985407 [debug] [ThreadPool]: Acquiring new snowflake connection 'airbnb.information_schema'
[0m11:39:18.994859 [debug] [ThreadPool]: Using snowflake connection "airbnb.information_schema"
[0m11:39:18.995259 [debug] [ThreadPool]: On airbnb.information_schema: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "connection_name": "airbnb.information_schema"} */
with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from airbnb.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from airbnb.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('raw') or upper("table_schema") = upper('dev'))
      order by "column_index"
[0m11:39:18.995563 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:39:21.460743 [debug] [ThreadPool]: SQL status: SUCCESS 77 in 2 seconds
[0m11:39:21.484979 [debug] [ThreadPool]: On airbnb.information_schema: Close
[0m11:39:21.794502 [info ] [MainThread]: Catalog written to /Users/mramirez/Documents/DBT/dbtlearm/target/catalog.json
[0m11:39:21.795214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce62af9c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce62d666a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce62aa7d30>]}
[0m11:39:21.795657 [debug] [MainThread]: Flushing usage events
[0m11:39:22.456656 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m11:39:22.457190 [debug] [MainThread]: Connection 'airbnb.information_schema' was properly closed.


============================== 2023-03-04 11:39:28.360279 | dee87771-dac8-4185-82a0-11b9cf72913a ==============================
[0m11:39:28.360279 [info ] [MainThread]: Running with dbt=1.4.1
[0m11:39:28.362228 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/mramirez/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
[0m11:39:28.362614 [debug] [MainThread]: Tracking: tracking
[0m11:39:28.363054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92f0277ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92f0277f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92f0277f10>]}
[0m11:39:28.365428 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
[0m11:39:28.365815 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
[0m11:39:28.366100 [info ] [MainThread]: 
[0m11:39:28.366394 [info ] [MainThread]: 
[0m11:39:28.366660 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2023-03-06 13:23:09.590517 | b7bfbd7b-92e4-42a2-a633-0493294c6825 ==============================
[0m13:23:09.590517 [info ] [MainThread]: Running with dbt=1.4.1
[0m13:23:09.594444 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/mramirez/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
[0m13:23:09.594749 [debug] [MainThread]: Tracking: tracking
[0m13:23:09.595358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feff043ac10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feff043af40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feff043ae80>]}
[0m13:23:10.078668 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m13:23:10.079211 [debug] [MainThread]: Partial parsing: added file: dbtlearm://analyses/fool_moon_no_sleep.sql
[0m13:23:10.079740 [debug] [MainThread]: Partial parsing: updated file: dbtlearm://models/schema.yml
[0m13:23:10.101040 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m13:23:10.161677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feff06bd670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feff04bde50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feff06eb5e0>]}
[0m13:23:10.162114 [debug] [MainThread]: Flushing usage events
[0m13:23:10.848947 [error] [MainThread]: Encountered an error:
Compilation Error
  Analysis 'analysis.dbtlearm.fool_moon_no_sleep' (analyses/fool_moon_no_sleep.sql) depends on a node named 'mart_fullmoon_reviews' which was not found


============================== 2023-03-06 13:26:16.606777 | 5070b93f-accb-4001-9791-74d7e30e337c ==============================
[0m13:26:16.606777 [info ] [MainThread]: Running with dbt=1.4.1
[0m13:26:16.609192 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/mramirez/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
[0m13:26:16.609484 [debug] [MainThread]: Tracking: tracking
[0m13:26:16.609943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3743f9c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3743f9f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3743f9ee0>]}
[0m13:26:16.716560 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m13:26:16.717034 [debug] [MainThread]: Partial parsing: added file: dbtlearm://analyses/fool_moon_no_sleep.sql
[0m13:26:16.717509 [debug] [MainThread]: Partial parsing: updated file: dbtlearm://models/schema.yml
[0m13:26:16.733427 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m13:26:16.804419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5070b93f-accb-4001-9791-74d7e30e337c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc37477a0d0>]}
[0m13:26:16.827692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5070b93f-accb-4001-9791-74d7e30e337c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc374583160>]}
[0m13:26:16.828199 [info ] [MainThread]: Found 8 models, 14 tests, 2 snapshots, 1 analysis, 418 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m13:26:16.828572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5070b93f-accb-4001-9791-74d7e30e337c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3745830d0>]}
[0m13:26:16.831045 [info ] [MainThread]: 
[0m13:26:16.832794 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:26:16.834503 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m13:26:16.850895 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m13:26:16.851336 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m13:26:16.851691 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:26:19.868416 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 3 seconds
[0m13:26:19.871434 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m13:26:20.133786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5070b93f-accb-4001-9791-74d7e30e337c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc374753df0>]}
[0m13:26:20.134669 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:26:20.135073 [info ] [MainThread]: 
[0m13:26:20.146023 [debug] [Thread-1  ]: Began running node model.dbtlearm.src_host
[0m13:26:20.146380 [debug] [Thread-2  ]: Began running node model.dbtlearm.src_listings
[0m13:26:20.146707 [debug] [Thread-3  ]: Began running node model.dbtlearm.src_reviews
[0m13:26:20.147020 [debug] [Thread-4  ]: Began running node seed.dbtlearm.seed_full_moon_dates
[0m13:26:20.147709 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearm.src_host'
[0m13:26:20.148377 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearm.src_listings'
[0m13:26:20.149032 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearm.src_reviews'
[0m13:26:20.149666 [debug] [Thread-4  ]: Acquiring new snowflake connection 'seed.dbtlearm.seed_full_moon_dates'
[0m13:26:20.150001 [debug] [Thread-1  ]: Began compiling node model.dbtlearm.src_host
[0m13:26:20.150319 [debug] [Thread-2  ]: Began compiling node model.dbtlearm.src_listings
[0m13:26:20.150630 [debug] [Thread-3  ]: Began compiling node model.dbtlearm.src_reviews
[0m13:26:20.151095 [debug] [Thread-4  ]: Began compiling node seed.dbtlearm.seed_full_moon_dates
[0m13:26:20.156393 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearm.src_host"
[0m13:26:20.159927 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearm.src_listings"
[0m13:26:20.163101 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearm.src_reviews"
[0m13:26:20.165115 [debug] [Thread-4  ]: Timing info for seed.dbtlearm.seed_full_moon_dates (compile): 2023-03-06 13:26:20.163400 => 2023-03-06 13:26:20.165036
[0m13:26:20.165901 [debug] [Thread-4  ]: Began executing node seed.dbtlearm.seed_full_moon_dates
[0m13:26:20.166233 [debug] [Thread-4  ]: Timing info for seed.dbtlearm.seed_full_moon_dates (execute): 2023-03-06 13:26:20.166157 => 2023-03-06 13:26:20.166180
[0m13:26:20.168646 [debug] [Thread-4  ]: Finished running node seed.dbtlearm.seed_full_moon_dates
[0m13:26:20.169212 [debug] [Thread-4  ]: Began running node snapshot.dbtlearm.scd_raw_hosts
[0m13:26:20.170161 [debug] [Thread-4  ]: Acquiring new snowflake connection 'snapshot.dbtlearm.scd_raw_hosts'
[0m13:26:20.170702 [debug] [Thread-3  ]: Timing info for model.dbtlearm.src_reviews (compile): 2023-03-06 13:26:20.160215 => 2023-03-06 13:26:20.170632
[0m13:26:20.170961 [debug] [Thread-4  ]: Began compiling node snapshot.dbtlearm.scd_raw_hosts
[0m13:26:20.171167 [debug] [Thread-2  ]: Timing info for model.dbtlearm.src_listings (compile): 2023-03-06 13:26:20.156760 => 2023-03-06 13:26:20.171119
[0m13:26:20.171454 [debug] [Thread-1  ]: Timing info for model.dbtlearm.src_host (compile): 2023-03-06 13:26:20.151356 => 2023-03-06 13:26:20.171392
[0m13:26:20.172235 [debug] [Thread-3  ]: Finished running node model.dbtlearm.src_reviews
[0m13:26:20.176303 [debug] [Thread-4  ]: Timing info for snapshot.dbtlearm.scd_raw_hosts (compile): 2023-03-06 13:26:20.172475 => 2023-03-06 13:26:20.176242
[0m13:26:20.177110 [debug] [Thread-2  ]: Finished running node model.dbtlearm.src_listings
[0m13:26:20.177853 [debug] [Thread-1  ]: Finished running node model.dbtlearm.src_host
[0m13:26:20.178312 [debug] [Thread-3  ]: Began running node snapshot.dbtlearm.scd_raw_listings
[0m13:26:20.178881 [debug] [Thread-4  ]: Began executing node snapshot.dbtlearm.scd_raw_hosts
[0m13:26:20.179407 [debug] [Thread-2  ]: Began running node model.dbtlearm.fct_reviews
[0m13:26:20.179983 [debug] [Thread-1  ]: Began running node model.dbtlearm.dim_listings_cleansed
[0m13:26:20.180771 [debug] [Thread-3  ]: Acquiring new snowflake connection 'snapshot.dbtlearm.scd_raw_listings'
[0m13:26:20.181113 [debug] [Thread-4  ]: Timing info for snapshot.dbtlearm.scd_raw_hosts (execute): 2023-03-06 13:26:20.181041 => 2023-03-06 13:26:20.181053
[0m13:26:20.181743 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearm.fct_reviews'
[0m13:26:20.182585 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearm.dim_listings_cleansed'
[0m13:26:20.182908 [debug] [Thread-3  ]: Began compiling node snapshot.dbtlearm.scd_raw_listings
[0m13:26:20.183666 [debug] [Thread-4  ]: Finished running node snapshot.dbtlearm.scd_raw_hosts
[0m13:26:20.184072 [debug] [Thread-2  ]: Began compiling node model.dbtlearm.fct_reviews
[0m13:26:20.184408 [debug] [Thread-1  ]: Began compiling node model.dbtlearm.dim_listings_cleansed
[0m13:26:20.188839 [debug] [Thread-3  ]: Timing info for snapshot.dbtlearm.scd_raw_listings (compile): 2023-03-06 13:26:20.184651 => 2023-03-06 13:26:20.188758
[0m13:26:20.189355 [debug] [Thread-4  ]: Began running node model.dbtlearm.dim_hosts_cleansed
[0m13:26:20.229494 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearm.dim_listings_cleansed"
[0m13:26:20.239031 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearm.fct_reviews"
[0m13:26:20.239410 [debug] [Thread-3  ]: Began executing node snapshot.dbtlearm.scd_raw_listings
[0m13:26:20.240053 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtlearm.dim_hosts_cleansed'
[0m13:26:20.240616 [debug] [Thread-3  ]: Timing info for snapshot.dbtlearm.scd_raw_listings (execute): 2023-03-06 13:26:20.240539 => 2023-03-06 13:26:20.240553
[0m13:26:20.240916 [debug] [Thread-4  ]: Began compiling node model.dbtlearm.dim_hosts_cleansed
[0m13:26:20.241606 [debug] [Thread-3  ]: Finished running node snapshot.dbtlearm.scd_raw_listings
[0m13:26:20.248903 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearm.dim_hosts_cleansed"
[0m13:26:20.249633 [debug] [Thread-2  ]: Timing info for model.dbtlearm.fct_reviews (compile): 2023-03-06 13:26:20.189709 => 2023-03-06 13:26:20.249565
[0m13:26:20.249972 [debug] [Thread-2  ]: Began executing node model.dbtlearm.fct_reviews
[0m13:26:20.250201 [debug] [Thread-1  ]: Timing info for model.dbtlearm.dim_listings_cleansed (compile): 2023-03-06 13:26:20.213161 => 2023-03-06 13:26:20.250130
[0m13:26:20.250487 [debug] [Thread-2  ]: Timing info for model.dbtlearm.fct_reviews (execute): 2023-03-06 13:26:20.250430 => 2023-03-06 13:26:20.250441
[0m13:26:20.250831 [debug] [Thread-1  ]: Began executing node model.dbtlearm.dim_listings_cleansed
[0m13:26:20.251699 [debug] [Thread-2  ]: Finished running node model.dbtlearm.fct_reviews
[0m13:26:20.252094 [debug] [Thread-1  ]: Timing info for model.dbtlearm.dim_listings_cleansed (execute): 2023-03-06 13:26:20.251995 => 2023-03-06 13:26:20.252009
[0m13:26:20.252834 [debug] [Thread-3  ]: Began running node model.dbtlearm.mart_fullmoon_review
[0m13:26:20.253206 [debug] [Thread-2  ]: Began running node test.dbtlearm.not_null_fct_reviews_reviewer_name.8204e43c88
[0m13:26:20.254034 [debug] [Thread-1  ]: Finished running node model.dbtlearm.dim_listings_cleansed
[0m13:26:20.254703 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearm.mart_fullmoon_review'
[0m13:26:20.255290 [debug] [Thread-2  ]: Acquiring new snowflake connection 'test.dbtlearm.not_null_fct_reviews_reviewer_name.8204e43c88'
[0m13:26:20.255507 [debug] [Thread-4  ]: Timing info for model.dbtlearm.dim_hosts_cleansed (compile): 2023-03-06 13:26:20.241860 => 2023-03-06 13:26:20.255451
[0m13:26:20.256287 [debug] [Thread-1  ]: Began running node test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m13:26:20.256536 [debug] [Thread-3  ]: Began compiling node model.dbtlearm.mart_fullmoon_review
[0m13:26:20.256840 [debug] [Thread-2  ]: Began compiling node test.dbtlearm.not_null_fct_reviews_reviewer_name.8204e43c88
[0m13:26:20.257151 [debug] [Thread-4  ]: Began executing node model.dbtlearm.dim_hosts_cleansed
[0m13:26:20.257739 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af'
[0m13:26:20.261317 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearm.mart_fullmoon_review"
[0m13:26:20.275103 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearm.not_null_fct_reviews_reviewer_name.8204e43c88"
[0m13:26:20.275468 [debug] [Thread-4  ]: Timing info for model.dbtlearm.dim_hosts_cleansed (execute): 2023-03-06 13:26:20.275394 => 2023-03-06 13:26:20.275407
[0m13:26:20.275788 [debug] [Thread-1  ]: Began compiling node test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m13:26:20.276791 [debug] [Thread-4  ]: Finished running node model.dbtlearm.dim_hosts_cleansed
[0m13:26:20.288283 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m13:26:20.288873 [debug] [Thread-4  ]: Began running node test.dbtlearm.consistent_created_at
[0m13:26:20.289171 [debug] [Thread-2  ]: Timing info for test.dbtlearm.not_null_fct_reviews_reviewer_name.8204e43c88 (compile): 2023-03-06 13:26:20.261555 => 2023-03-06 13:26:20.289106
[0m13:26:20.289735 [debug] [Thread-3  ]: Timing info for model.dbtlearm.mart_fullmoon_review (compile): 2023-03-06 13:26:20.257983 => 2023-03-06 13:26:20.289676
[0m13:26:20.290364 [debug] [Thread-4  ]: Acquiring new snowflake connection 'test.dbtlearm.consistent_created_at'
[0m13:26:20.290668 [debug] [Thread-2  ]: Began executing node test.dbtlearm.not_null_fct_reviews_reviewer_name.8204e43c88
[0m13:26:20.290954 [debug] [Thread-3  ]: Began executing node model.dbtlearm.mart_fullmoon_review
[0m13:26:20.291231 [debug] [Thread-4  ]: Began compiling node test.dbtlearm.consistent_created_at
[0m13:26:20.291496 [debug] [Thread-2  ]: Timing info for test.dbtlearm.not_null_fct_reviews_reviewer_name.8204e43c88 (execute): 2023-03-06 13:26:20.291439 => 2023-03-06 13:26:20.291449
[0m13:26:20.291753 [debug] [Thread-3  ]: Timing info for model.dbtlearm.mart_fullmoon_review (execute): 2023-03-06 13:26:20.291701 => 2023-03-06 13:26:20.291709
[0m13:26:20.294989 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearm.consistent_created_at"
[0m13:26:20.295837 [debug] [Thread-2  ]: Finished running node test.dbtlearm.not_null_fct_reviews_reviewer_name.8204e43c88
[0m13:26:20.296136 [debug] [Thread-1  ]: Timing info for test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (compile): 2023-03-06 13:26:20.277034 => 2023-03-06 13:26:20.296076
[0m13:26:20.296763 [debug] [Thread-3  ]: Finished running node model.dbtlearm.mart_fullmoon_review
[0m13:26:20.297272 [debug] [Thread-2  ]: Began running node test.dbtlearm.dim_listings_minimum_nights
[0m13:26:20.297664 [debug] [Thread-1  ]: Began executing node test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m13:26:20.298056 [debug] [Thread-3  ]: Began running node test.dbtlearm.no_nulls_in_dim_listings
[0m13:26:20.298763 [debug] [Thread-2  ]: Acquiring new snowflake connection 'test.dbtlearm.dim_listings_minimum_nights'
[0m13:26:20.299073 [debug] [Thread-1  ]: Timing info for test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (execute): 2023-03-06 13:26:20.299015 => 2023-03-06 13:26:20.299024
[0m13:26:20.299627 [debug] [Thread-3  ]: Acquiring new snowflake connection 'test.dbtlearm.no_nulls_in_dim_listings'
[0m13:26:20.299920 [debug] [Thread-2  ]: Began compiling node test.dbtlearm.dim_listings_minimum_nights
[0m13:26:20.300670 [debug] [Thread-1  ]: Finished running node test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m13:26:20.301006 [debug] [Thread-3  ]: Began compiling node test.dbtlearm.no_nulls_in_dim_listings
[0m13:26:20.301294 [debug] [Thread-4  ]: Timing info for test.dbtlearm.consistent_created_at (compile): 2023-03-06 13:26:20.291968 => 2023-03-06 13:26:20.301233
[0m13:26:20.305610 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearm.dim_listings_minimum_nights"
[0m13:26:20.306044 [debug] [Thread-1  ]: Began running node test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be
[0m13:26:20.318857 [debug] [Thread-3  ]: Using snowflake connection "test.dbtlearm.no_nulls_in_dim_listings"
[0m13:26:20.319235 [debug] [Thread-4  ]: Began executing node test.dbtlearm.consistent_created_at
[0m13:26:20.319982 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be'
[0m13:26:20.320239 [debug] [Thread-3  ]: On test.dbtlearm.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "test.dbtlearm.no_nulls_in_dim_listings"} */
describe table airbnb.dev.dim_listings_cleansed
[0m13:26:20.320511 [debug] [Thread-4  ]: Timing info for test.dbtlearm.consistent_created_at (execute): 2023-03-06 13:26:20.320447 => 2023-03-06 13:26:20.320458
[0m13:26:20.320784 [debug] [Thread-1  ]: Began compiling node test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be
[0m13:26:20.321038 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:26:20.321720 [debug] [Thread-4  ]: Finished running node test.dbtlearm.consistent_created_at
[0m13:26:20.326293 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m13:26:20.326569 [debug] [Thread-2  ]: Timing info for test.dbtlearm.dim_listings_minimum_nights (compile): 2023-03-06 13:26:20.301460 => 2023-03-06 13:26:20.326506
[0m13:26:20.328211 [debug] [Thread-4  ]: Began running node test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m13:26:20.328904 [debug] [Thread-2  ]: Began executing node test.dbtlearm.dim_listings_minimum_nights
[0m13:26:20.330233 [debug] [Thread-4  ]: Acquiring new snowflake connection 'test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9'
[0m13:26:20.330576 [debug] [Thread-2  ]: Timing info for test.dbtlearm.dim_listings_minimum_nights (execute): 2023-03-06 13:26:20.330500 => 2023-03-06 13:26:20.330514
[0m13:26:20.330943 [debug] [Thread-4  ]: Began compiling node test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m13:26:20.331684 [debug] [Thread-2  ]: Finished running node test.dbtlearm.dim_listings_minimum_nights
[0m13:26:20.336686 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m13:26:20.336992 [debug] [Thread-1  ]: Timing info for test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be (compile): 2023-03-06 13:26:20.321996 => 2023-03-06 13:26:20.336919
[0m13:26:20.337419 [debug] [Thread-2  ]: Began running node test.dbtlearm.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m13:26:20.337940 [debug] [Thread-1  ]: Began executing node test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be
[0m13:26:20.338569 [debug] [Thread-2  ]: Acquiring new snowflake connection 'test.dbtlearm.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313'
[0m13:26:20.338871 [debug] [Thread-1  ]: Timing info for test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be (execute): 2023-03-06 13:26:20.338806 => 2023-03-06 13:26:20.338818
[0m13:26:20.339171 [debug] [Thread-2  ]: Began compiling node test.dbtlearm.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m13:26:20.339906 [debug] [Thread-1  ]: Finished running node test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be
[0m13:26:20.345374 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearm.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m13:26:20.345836 [debug] [Thread-1  ]: Began running node test.dbtlearm.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe
[0m13:26:20.346383 [debug] [Thread-4  ]: Timing info for test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9 (compile): 2023-03-06 13:26:20.331965 => 2023-03-06 13:26:20.346319
[0m13:26:20.346925 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbtlearm.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe'
[0m13:26:20.347232 [debug] [Thread-4  ]: Began executing node test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m13:26:20.347519 [debug] [Thread-1  ]: Began compiling node test.dbtlearm.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe
[0m13:26:20.347828 [debug] [Thread-4  ]: Timing info for test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9 (execute): 2023-03-06 13:26:20.347757 => 2023-03-06 13:26:20.347769
[0m13:26:20.357892 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearm.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe"
[0m13:26:20.358674 [debug] [Thread-4  ]: Finished running node test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m13:26:20.359123 [debug] [Thread-2  ]: Timing info for test.dbtlearm.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313 (compile): 2023-03-06 13:26:20.340143 => 2023-03-06 13:26:20.359054
[0m13:26:20.359581 [debug] [Thread-4  ]: Began running node test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m13:26:20.360000 [debug] [Thread-2  ]: Began executing node test.dbtlearm.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m13:26:20.360628 [debug] [Thread-4  ]: Acquiring new snowflake connection 'test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e'
[0m13:26:20.360925 [debug] [Thread-2  ]: Timing info for test.dbtlearm.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313 (execute): 2023-03-06 13:26:20.360862 => 2023-03-06 13:26:20.360873
[0m13:26:20.361240 [debug] [Thread-4  ]: Began compiling node test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m13:26:20.361946 [debug] [Thread-2  ]: Finished running node test.dbtlearm.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m13:26:20.370605 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m13:26:20.370923 [debug] [Thread-1  ]: Timing info for test.dbtlearm.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe (compile): 2023-03-06 13:26:20.348059 => 2023-03-06 13:26:20.370851
[0m13:26:20.371357 [debug] [Thread-2  ]: Began running node model.dbtlearm.dim_listings_with_hosts
[0m13:26:20.371871 [debug] [Thread-1  ]: Began executing node test.dbtlearm.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe
[0m13:26:20.372517 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearm.dim_listings_with_hosts'
[0m13:26:20.372821 [debug] [Thread-1  ]: Timing info for test.dbtlearm.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe (execute): 2023-03-06 13:26:20.372759 => 2023-03-06 13:26:20.372770
[0m13:26:20.373112 [debug] [Thread-2  ]: Began compiling node model.dbtlearm.dim_listings_with_hosts
[0m13:26:20.373837 [debug] [Thread-1  ]: Finished running node test.dbtlearm.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe
[0m13:26:20.377273 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearm.dim_listings_with_hosts"
[0m13:26:20.377593 [debug] [Thread-4  ]: Timing info for test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e (compile): 2023-03-06 13:26:20.362226 => 2023-03-06 13:26:20.377530
[0m13:26:20.377941 [debug] [Thread-1  ]: Began running node test.dbtlearm.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m13:26:20.378482 [debug] [Thread-4  ]: Began executing node test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m13:26:20.379103 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbtlearm.not_null_dim_hosts_cleansed_host_id.de84c3da05'
[0m13:26:20.379399 [debug] [Thread-4  ]: Timing info for test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e (execute): 2023-03-06 13:26:20.379337 => 2023-03-06 13:26:20.379348
[0m13:26:20.379683 [debug] [Thread-1  ]: Began compiling node test.dbtlearm.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m13:26:20.380453 [debug] [Thread-4  ]: Finished running node test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m13:26:20.385270 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearm.not_null_dim_hosts_cleansed_host_id.de84c3da05"
[0m13:26:20.386043 [debug] [Thread-4  ]: Began running node test.dbtlearm.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m13:26:20.386408 [debug] [Thread-2  ]: Timing info for model.dbtlearm.dim_listings_with_hosts (compile): 2023-03-06 13:26:20.374123 => 2023-03-06 13:26:20.386347
[0m13:26:20.387275 [debug] [Thread-4  ]: Acquiring new snowflake connection 'test.dbtlearm.not_null_dim_hosts_cleansed_host_name.42386c5830'
[0m13:26:20.387626 [debug] [Thread-2  ]: Began executing node model.dbtlearm.dim_listings_with_hosts
[0m13:26:20.387943 [debug] [Thread-4  ]: Began compiling node test.dbtlearm.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m13:26:20.388257 [debug] [Thread-2  ]: Timing info for model.dbtlearm.dim_listings_with_hosts (execute): 2023-03-06 13:26:20.388188 => 2023-03-06 13:26:20.388200
[0m13:26:20.392960 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearm.not_null_dim_hosts_cleansed_host_name.42386c5830"
[0m13:26:20.393782 [debug] [Thread-2  ]: Finished running node model.dbtlearm.dim_listings_with_hosts
[0m13:26:20.394194 [debug] [Thread-1  ]: Timing info for test.dbtlearm.not_null_dim_hosts_cleansed_host_id.de84c3da05 (compile): 2023-03-06 13:26:20.380681 => 2023-03-06 13:26:20.394135
[0m13:26:20.394579 [debug] [Thread-2  ]: Began running node test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m13:26:20.394960 [debug] [Thread-1  ]: Began executing node test.dbtlearm.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m13:26:20.395560 [debug] [Thread-2  ]: Acquiring new snowflake connection 'test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad'
[0m13:26:20.395862 [debug] [Thread-1  ]: Timing info for test.dbtlearm.not_null_dim_hosts_cleansed_host_id.de84c3da05 (execute): 2023-03-06 13:26:20.395802 => 2023-03-06 13:26:20.395812
[0m13:26:20.396149 [debug] [Thread-2  ]: Began compiling node test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m13:26:20.396899 [debug] [Thread-1  ]: Finished running node test.dbtlearm.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m13:26:20.404055 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m13:26:20.404653 [debug] [Thread-1  ]: Began running node test.dbtlearm.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m13:26:20.404920 [debug] [Thread-4  ]: Timing info for test.dbtlearm.not_null_dim_hosts_cleansed_host_name.42386c5830 (compile): 2023-03-06 13:26:20.388488 => 2023-03-06 13:26:20.404853
[0m13:26:20.405789 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbtlearm.unique_dim_hosts_cleansed_host_id.d7e4771347'
[0m13:26:20.406116 [debug] [Thread-4  ]: Began executing node test.dbtlearm.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m13:26:20.406436 [debug] [Thread-1  ]: Began compiling node test.dbtlearm.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m13:26:20.406736 [debug] [Thread-4  ]: Timing info for test.dbtlearm.not_null_dim_hosts_cleansed_host_name.42386c5830 (execute): 2023-03-06 13:26:20.406674 => 2023-03-06 13:26:20.406685
[0m13:26:20.411567 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearm.unique_dim_hosts_cleansed_host_id.d7e4771347"
[0m13:26:20.412553 [debug] [Thread-4  ]: Finished running node test.dbtlearm.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m13:26:20.412784 [debug] [Thread-2  ]: Timing info for test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (compile): 2023-03-06 13:26:20.397168 => 2023-03-06 13:26:20.412731
[0m13:26:20.413351 [debug] [Thread-4  ]: Began running node analysis.dbtlearm.fool_moon_no_sleep
[0m13:26:20.413847 [debug] [Thread-2  ]: Began executing node test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m13:26:20.414555 [debug] [Thread-4  ]: Acquiring new snowflake connection 'analysis.dbtlearm.fool_moon_no_sleep'
[0m13:26:20.415131 [debug] [Thread-2  ]: Timing info for test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (execute): 2023-03-06 13:26:20.415053 => 2023-03-06 13:26:20.415067
[0m13:26:20.415782 [debug] [Thread-4  ]: Began compiling node analysis.dbtlearm.fool_moon_no_sleep
[0m13:26:20.416587 [debug] [Thread-2  ]: Finished running node test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m13:26:20.420436 [debug] [Thread-4  ]: Writing injected SQL for node "analysis.dbtlearm.fool_moon_no_sleep"
[0m13:26:20.421055 [debug] [Thread-1  ]: Timing info for test.dbtlearm.unique_dim_hosts_cleansed_host_id.d7e4771347 (compile): 2023-03-06 13:26:20.406959 => 2023-03-06 13:26:20.420981
[0m13:26:20.421590 [debug] [Thread-1  ]: Began executing node test.dbtlearm.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m13:26:20.421902 [debug] [Thread-1  ]: Timing info for test.dbtlearm.unique_dim_hosts_cleansed_host_id.d7e4771347 (execute): 2023-03-06 13:26:20.421834 => 2023-03-06 13:26:20.421846
[0m13:26:20.422679 [debug] [Thread-1  ]: Finished running node test.dbtlearm.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m13:26:20.423213 [debug] [Thread-4  ]: Timing info for analysis.dbtlearm.fool_moon_no_sleep (compile): 2023-03-06 13:26:20.417117 => 2023-03-06 13:26:20.423152
[0m13:26:20.423531 [debug] [Thread-4  ]: Began executing node analysis.dbtlearm.fool_moon_no_sleep
[0m13:26:20.423814 [debug] [Thread-4  ]: Timing info for analysis.dbtlearm.fool_moon_no_sleep (execute): 2023-03-06 13:26:20.423754 => 2023-03-06 13:26:20.423764
[0m13:26:20.424561 [debug] [Thread-4  ]: Finished running node analysis.dbtlearm.fool_moon_no_sleep
[0m13:26:21.383760 [debug] [Thread-3  ]: SQL status: SUCCESS 8 in 1 seconds
[0m13:26:21.388084 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearm.no_nulls_in_dim_listings"
[0m13:26:21.393841 [debug] [Thread-3  ]: Timing info for test.dbtlearm.no_nulls_in_dim_listings (compile): 2023-03-06 13:26:20.306350 => 2023-03-06 13:26:21.393716
[0m13:26:21.394519 [debug] [Thread-3  ]: Began executing node test.dbtlearm.no_nulls_in_dim_listings
[0m13:26:21.395058 [debug] [Thread-3  ]: Timing info for test.dbtlearm.no_nulls_in_dim_listings (execute): 2023-03-06 13:26:21.394927 => 2023-03-06 13:26:21.394955
[0m13:26:21.395774 [debug] [Thread-3  ]: On test.dbtlearm.no_nulls_in_dim_listings: Close
[0m13:26:21.626079 [debug] [Thread-3  ]: Finished running node test.dbtlearm.no_nulls_in_dim_listings
[0m13:26:21.627409 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:26:21.627700 [debug] [MainThread]: Connection 'test.dbtlearm.unique_dim_hosts_cleansed_host_id.d7e4771347' was properly closed.
[0m13:26:21.627938 [debug] [MainThread]: Connection 'test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad' was properly closed.
[0m13:26:21.628168 [debug] [MainThread]: Connection 'test.dbtlearm.no_nulls_in_dim_listings' was properly closed.
[0m13:26:21.628393 [debug] [MainThread]: Connection 'analysis.dbtlearm.fool_moon_no_sleep' was properly closed.
[0m13:26:21.629603 [debug] [MainThread]: Command end result
[0m13:26:21.646797 [info ] [MainThread]: Done.
[0m13:26:21.647392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3753eefd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3753eed30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3753ee4c0>]}
[0m13:26:21.647802 [debug] [MainThread]: Flushing usage events


============================== 2023-03-06 13:45:03.916781 | 6ffe3dde-e696-448b-9400-0712edfece15 ==============================
[0m13:45:03.916781 [info ] [MainThread]: Running with dbt=1.4.1
[0m13:45:03.919132 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/mramirez/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:45:03.919441 [debug] [MainThread]: Tracking: tracking
[0m13:45:03.919942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1c7bffd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1c7bffdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1c7d0b0d0>]}
[0m13:45:03.968685 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:45:03.969129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6ffe3dde-e696-448b-9400-0712edfece15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1c7d1e4f0>]}
[0m13:45:05.232858 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_with_hosts.sql
[0m13:45:05.247667 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m13:45:05.252892 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m13:45:05.258303 [debug] [MainThread]: 1603: static parser failed on fct/fct_reviews.sql
[0m13:45:05.280903 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fct/fct_reviews.sql
[0m13:45:05.282495 [debug] [MainThread]: 1699: static parser successfully parsed mart/mart_fullmoon_review.sql
[0m13:45:05.287245 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m13:45:05.292069 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m13:45:05.297205 [debug] [MainThread]: 1699: static parser successfully parsed src/src_host.sql
[0m13:45:05.507761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ffe3dde-e696-448b-9400-0712edfece15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1c80ca0d0>]}
[0m13:45:05.523981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6ffe3dde-e696-448b-9400-0712edfece15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1c7f42640>]}
[0m13:45:05.524454 [info ] [MainThread]: Found 8 models, 14 tests, 2 snapshots, 1 analysis, 418 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m13:45:05.524786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ffe3dde-e696-448b-9400-0712edfece15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1c7ff3fa0>]}
[0m13:45:05.526868 [info ] [MainThread]: 
[0m13:45:05.528553 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:45:05.529751 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb'
[0m13:45:05.545400 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m13:45:05.545769 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m13:45:05.546036 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:45:07.577620 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2 seconds
[0m13:45:07.579633 [debug] [ThreadPool]: On list_airbnb: Close
[0m13:45:07.829324 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m13:45:07.837725 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m13:45:07.838066 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m13:45:07.838490 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:45:08.655161 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m13:45:08.657828 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m13:45:08.886781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ffe3dde-e696-448b-9400-0712edfece15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1c80ca190>]}
[0m13:45:08.887665 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:45:08.888042 [info ] [MainThread]: 
[0m13:45:08.904149 [debug] [Thread-1  ]: Began running node model.dbtlearm.src_host
[0m13:45:08.904507 [debug] [Thread-2  ]: Began running node model.dbtlearm.src_listings
[0m13:45:08.905229 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearm.src_host'
[0m13:45:08.905592 [debug] [Thread-3  ]: Began running node model.dbtlearm.src_reviews
[0m13:45:08.906377 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearm.src_listings'
[0m13:45:08.906743 [debug] [Thread-1  ]: Began compiling node model.dbtlearm.src_host
[0m13:45:08.907551 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearm.src_reviews'
[0m13:45:08.907925 [debug] [Thread-2  ]: Began compiling node model.dbtlearm.src_listings
[0m13:45:08.912939 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearm.src_host"
[0m13:45:08.913343 [debug] [Thread-3  ]: Began compiling node model.dbtlearm.src_reviews
[0m13:45:08.916329 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearm.src_listings"
[0m13:45:08.919672 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearm.src_reviews"
[0m13:45:08.920323 [debug] [Thread-1  ]: Timing info for model.dbtlearm.src_host (compile): 2023-03-06 13:45:08.908191 => 2023-03-06 13:45:08.920231
[0m13:45:08.922489 [debug] [Thread-1  ]: Finished running node model.dbtlearm.src_host
[0m13:45:08.923387 [debug] [Thread-4  ]: Began running node model.dbtlearm.dim_hosts_cleansed
[0m13:45:08.924083 [info ] [Thread-4  ]: 1 of 5 START sql view model dev.dim_hosts_cleansed ............................. [RUN]
[0m13:45:08.925182 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtlearm.dim_hosts_cleansed'
[0m13:45:08.925557 [debug] [Thread-2  ]: Timing info for model.dbtlearm.src_listings (compile): 2023-03-06 13:45:08.913580 => 2023-03-06 13:45:08.925481
[0m13:45:08.925986 [debug] [Thread-4  ]: Began compiling node model.dbtlearm.dim_hosts_cleansed
[0m13:45:08.926236 [debug] [Thread-3  ]: Timing info for model.dbtlearm.src_reviews (compile): 2023-03-06 13:45:08.916729 => 2023-03-06 13:45:08.926171
[0m13:45:08.927013 [debug] [Thread-2  ]: Finished running node model.dbtlearm.src_listings
[0m13:45:08.935069 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearm.dim_hosts_cleansed"
[0m13:45:08.935832 [debug] [Thread-3  ]: Finished running node model.dbtlearm.src_reviews
[0m13:45:08.936480 [debug] [Thread-1  ]: Began running node model.dbtlearm.dim_listings_cleansed
[0m13:45:08.937261 [debug] [Thread-2  ]: Began running node model.dbtlearm.fct_reviews
[0m13:45:08.937586 [info ] [Thread-1  ]: 2 of 5 START sql view model dev.dim_listings_cleansed .......................... [RUN]
[0m13:45:08.938064 [info ] [Thread-2  ]: 3 of 5 START sql incremental model dev.fct_reviews ............................. [RUN]
[0m13:45:08.938766 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearm.dim_listings_cleansed'
[0m13:45:08.939493 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearm.fct_reviews'
[0m13:45:08.939904 [debug] [Thread-1  ]: Began compiling node model.dbtlearm.dim_listings_cleansed
[0m13:45:08.940233 [debug] [Thread-2  ]: Began compiling node model.dbtlearm.fct_reviews
[0m13:45:08.947031 [debug] [Thread-4  ]: Timing info for model.dbtlearm.dim_hosts_cleansed (compile): 2023-03-06 13:45:08.927266 => 2023-03-06 13:45:08.946940
[0m13:45:08.951740 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearm.dim_listings_cleansed"
[0m13:45:08.969606 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearm.fct_reviews"
[0m13:45:08.969903 [debug] [Thread-4  ]: Began executing node model.dbtlearm.dim_hosts_cleansed
[0m13:45:09.003889 [debug] [Thread-1  ]: Timing info for model.dbtlearm.dim_listings_cleansed (compile): 2023-03-06 13:45:08.940636 => 2023-03-06 13:45:09.003806
[0m13:45:09.004181 [debug] [Thread-2  ]: Timing info for model.dbtlearm.fct_reviews (compile): 2023-03-06 13:45:08.951992 => 2023-03-06 13:45:09.004123
[0m13:45:09.005288 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtlearm.dim_hosts_cleansed"
[0m13:45:09.005648 [debug] [Thread-1  ]: Began executing node model.dbtlearm.dim_listings_cleansed
[0m13:45:09.006044 [debug] [Thread-2  ]: Began executing node model.dbtlearm.fct_reviews
[0m13:45:09.010252 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtlearm.dim_listings_cleansed"
[0m13:45:09.035744 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearm.dim_hosts_cleansed"
[0m13:45:09.047518 [debug] [Thread-4  ]: On model.dbtlearm.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.dim_hosts_cleansed"} */
create or replace   view airbnb.dev.dim_hosts_cleansed
  
   as (
    -- Change Tables for views

WITH  __dbt__cte__src_host as (
WITH raw_hosts AS(
	SELECT * FROM airbnb.raw.raw_hosts
)
SELECT
	id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
	raw_hosts
),src_hosts AS(
    SELECT * FROM  __dbt__cte__src_host
)
SELECT
    host_id,
    NVL(
        host_name, 
        'Anonymous'
    ) AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
	src_hosts
  );
[0m13:45:09.053205 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m13:45:09.054403 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearm.dim_listings_cleansed"
[0m13:45:09.054786 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m13:45:09.055045 [debug] [Thread-2  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
create or replace  temporary view airbnb.dev.fct_reviews__dbt_tmp
  
   as (
    -- Incremental Materialization

WITH  __dbt__cte__src_reviews as (
WITH raw_reviews AS(
	SELECT * FROM airbnb.raw.raw_reviews
)
SELECT
	listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
	raw_reviews
),src_reviews AS (
    SELECt * FROM __dbt__cte__src_reviews
)
SELECT
    -- It creates a unique identifier
    
    
md5(cast(coalesce(cast(listing_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(reviewer_name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_text as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as review_id,
    *
FROM src_reviews
WHERE review_text IS NOT NULL

  AND review_date > (SELECT MAX(review_date) FROM airbnb.dev.fct_reviews)

  );
[0m13:45:09.055278 [debug] [Thread-1  ]: On model.dbtlearm.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.dim_listings_cleansed"} */
create or replace   view airbnb.dev.dim_listings_cleansed
  
   as (
    -- Change Tables for views

WITH  __dbt__cte__src_listings as (
-- DBT knows this is a view
-- By default they are views
WITH raw_listings AS(
	SELECT * FROM airbnb.raw.raw_listings
)
SELECT
	id as listing_id,
    name as listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at
FROM
	raw_listings
),src_listings AS (
    SELECT * FROM __dbt__cte__src_listings
)
SELECT 
    listing_id,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights = 0 THEN 1
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE(
        price_str,
        '$'
    ) :: NUMBER (
        10,
        2
    ) AS price,
    created_at,
    updated_at
FROM
    src_listings
  );
[0m13:45:09.056325 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m13:45:09.057256 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:45:10.336376 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1 seconds
[0m13:45:10.355323 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearm.dim_hosts_cleansed"
[0m13:45:10.367273 [debug] [Thread-4  ]: On model.dbtlearm.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.dim_hosts_cleansed"} */
GRANT SELECT ON airbnb.dev.dim_hosts_cleansed TO ROLE REPORTER
[0m13:45:10.565178 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2 seconds
[0m13:45:10.568734 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearm.dim_listings_cleansed"
[0m13:45:10.569062 [debug] [Thread-1  ]: On model.dbtlearm.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.dim_listings_cleansed"} */
GRANT SELECT ON airbnb.dev.dim_listings_cleansed TO ROLE REPORTER
[0m13:45:10.607537 [debug] [Thread-4  ]: Snowflake adapter: Snowflake query id: 01aac3f9-0001-0072-0003-87ea00024046
[0m13:45:10.607893 [debug] [Thread-4  ]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Role 'REPORTER' does not exist or not authorized.
[0m13:45:10.608293 [debug] [Thread-4  ]: Timing info for model.dbtlearm.dim_hosts_cleansed (execute): 2023-03-06 13:45:08.970397 => 2023-03-06 13:45:10.608224
[0m13:45:10.608578 [debug] [Thread-4  ]: On model.dbtlearm.dim_hosts_cleansed: Close
[0m13:45:10.670971 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2 seconds
[0m13:45:10.682367 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m13:45:10.682733 [debug] [Thread-2  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
describe table airbnb.dev.fct_reviews__dbt_tmp
[0m13:45:10.726211 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01aac3f9-0001-0072-0003-87ea0002404a
[0m13:45:10.726852 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Role 'REPORTER' does not exist or not authorized.
[0m13:45:10.727339 [debug] [Thread-1  ]: Timing info for model.dbtlearm.dim_listings_cleansed (execute): 2023-03-06 13:45:09.006478 => 2023-03-06 13:45:10.727259
[0m13:45:10.727675 [debug] [Thread-1  ]: On model.dbtlearm.dim_listings_cleansed: Close
[0m13:45:10.849670 [debug] [Thread-2  ]: SQL status: SUCCESS 6 in 0 seconds
[0m13:45:10.854597 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m13:45:10.855075 [debug] [Thread-2  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
describe table airbnb.dev.fct_reviews
[0m13:45:10.864039 [debug] [Thread-4  ]: Database Error in model dim_hosts_cleansed (models/dim/dim_hosts_cleansed.sql)
  002003 (02000): SQL compilation error:
  Role 'REPORTER' does not exist or not authorized.
  compiled Code at target/run/dbtlearm/models/dim/dim_hosts_cleansed.sql
[0m13:45:10.864600 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ffe3dde-e696-448b-9400-0712edfece15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1c839a5e0>]}
[0m13:45:10.865490 [error] [Thread-4  ]: 1 of 5 ERROR creating sql view model dev.dim_hosts_cleansed .................... [[31mERROR[0m in 1.94s]
[0m13:45:10.866018 [debug] [Thread-4  ]: Finished running node model.dbtlearm.dim_hosts_cleansed
[0m13:45:11.010746 [debug] [Thread-1  ]: Database Error in model dim_listings_cleansed (models/dim/dim_listings_cleansed.sql)
  002003 (02000): SQL compilation error:
  Role 'REPORTER' does not exist or not authorized.
  compiled Code at target/run/dbtlearm/models/dim/dim_listings_cleansed.sql
[0m13:45:11.011332 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ffe3dde-e696-448b-9400-0712edfece15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1c8076e50>]}
[0m13:45:11.011928 [error] [Thread-1  ]: 2 of 5 ERROR creating sql view model dev.dim_listings_cleansed ................. [[31mERROR[0m in 2.07s]
[0m13:45:11.012435 [debug] [Thread-1  ]: Finished running node model.dbtlearm.dim_listings_cleansed
[0m13:45:11.013271 [debug] [Thread-3  ]: Began running node model.dbtlearm.dim_listings_with_hosts
[0m13:45:11.013683 [info ] [Thread-3  ]: 4 of 5 SKIP relation dev.dim_listings_with_hosts ............................... [[33mSKIP[0m]
[0m13:45:11.014125 [debug] [Thread-3  ]: Finished running node model.dbtlearm.dim_listings_with_hosts
[0m13:45:11.034139 [debug] [Thread-2  ]: SQL status: SUCCESS 6 in 0 seconds
[0m13:45:11.053693 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m13:45:11.054041 [debug] [Thread-2  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
describe table airbnb.dev.fct_reviews__dbt_tmp
[0m13:45:11.200882 [debug] [Thread-2  ]: SQL status: SUCCESS 6 in 0 seconds
[0m13:45:11.206605 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m13:45:11.206969 [debug] [Thread-2  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m13:45:11.355860 [debug] [Thread-2  ]: SQL status: SUCCESS 6 in 0 seconds
[0m13:45:11.369621 [debug] [Thread-2  ]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m13:45:11.389943 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtlearm.fct_reviews"
[0m13:45:11.394348 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m13:45:11.394668 [debug] [Thread-2  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m13:45:11.572325 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m13:45:11.572975 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m13:45:11.573369 [debug] [Thread-2  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
insert into airbnb.dev.fct_reviews ("REVIEW_ID", "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "REVIEW_ID", "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from airbnb.dev.fct_reviews__dbt_tmp
        );
[0m13:45:12.720113 [debug] [Thread-2  ]: SQL status: SUCCESS 0 in 1 seconds
[0m13:45:12.720769 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m13:45:12.721153 [debug] [Thread-2  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
COMMIT
[0m13:45:12.925506 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m13:45:12.935406 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m13:45:12.935749 [debug] [Thread-2  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
drop view if exists airbnb.dev.fct_reviews__dbt_tmp cascade
[0m13:45:13.117099 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m13:45:13.120389 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m13:45:13.120717 [debug] [Thread-2  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
GRANT SELECT ON airbnb.dev.fct_reviews TO ROLE REPORTER
[0m13:45:13.318973 [debug] [Thread-2  ]: Snowflake adapter: Snowflake query id: 01aac3f9-0001-008b-0003-87ea00022026
[0m13:45:13.319445 [debug] [Thread-2  ]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Role 'REPORTER' does not exist or not authorized.
[0m13:45:13.320020 [debug] [Thread-2  ]: Timing info for model.dbtlearm.fct_reviews (execute): 2023-03-06 13:45:09.010559 => 2023-03-06 13:45:13.319921
[0m13:45:13.320438 [debug] [Thread-2  ]: On model.dbtlearm.fct_reviews: Close
[0m13:45:13.604428 [debug] [Thread-2  ]: Database Error in model fct_reviews (models/fct/fct_reviews.sql)
  002003 (02000): SQL compilation error:
  Role 'REPORTER' does not exist or not authorized.
  compiled Code at target/run/dbtlearm/models/fct/fct_reviews.sql
[0m13:45:13.605023 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ffe3dde-e696-448b-9400-0712edfece15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1c840de80>]}
[0m13:45:13.605653 [error] [Thread-2  ]: 3 of 5 ERROR creating sql incremental model dev.fct_reviews .................... [[31mERROR[0m in 4.67s]
[0m13:45:13.606377 [debug] [Thread-2  ]: Finished running node model.dbtlearm.fct_reviews
[0m13:45:13.607503 [debug] [Thread-1  ]: Began running node model.dbtlearm.mart_fullmoon_review
[0m13:45:13.608267 [info ] [Thread-1  ]: 5 of 5 SKIP relation dev.mart_fullmoon_review .................................. [[33mSKIP[0m]
[0m13:45:13.608735 [debug] [Thread-1  ]: Finished running node model.dbtlearm.mart_fullmoon_review
[0m13:45:13.610339 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:45:13.610993 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:45:13.611262 [debug] [MainThread]: Connection 'model.dbtlearm.dim_listings_cleansed' was properly closed.
[0m13:45:13.611502 [debug] [MainThread]: Connection 'model.dbtlearm.fct_reviews' was properly closed.
[0m13:45:13.611735 [debug] [MainThread]: Connection 'model.dbtlearm.src_reviews' was properly closed.
[0m13:45:13.611963 [debug] [MainThread]: Connection 'model.dbtlearm.dim_hosts_cleansed' was properly closed.
[0m13:45:13.612263 [info ] [MainThread]: 
[0m13:45:13.612621 [info ] [MainThread]: Finished running 2 view models, 2 table models, 1 incremental model in 0 hours 0 minutes and 8.08 seconds (8.08s).
[0m13:45:13.613162 [debug] [MainThread]: Command end result
[0m13:45:13.631245 [info ] [MainThread]: 
[0m13:45:13.631725 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m13:45:13.632061 [info ] [MainThread]: 
[0m13:45:13.632394 [error] [MainThread]: [33mDatabase Error in model dim_hosts_cleansed (models/dim/dim_hosts_cleansed.sql)[0m
[0m13:45:13.632717 [error] [MainThread]:   002003 (02000): SQL compilation error:
[0m13:45:13.633030 [error] [MainThread]:   Role 'REPORTER' does not exist or not authorized.
[0m13:45:13.633331 [error] [MainThread]:   compiled Code at target/run/dbtlearm/models/dim/dim_hosts_cleansed.sql
[0m13:45:13.633639 [info ] [MainThread]: 
[0m13:45:13.633956 [error] [MainThread]: [33mDatabase Error in model dim_listings_cleansed (models/dim/dim_listings_cleansed.sql)[0m
[0m13:45:13.634261 [error] [MainThread]:   002003 (02000): SQL compilation error:
[0m13:45:13.634564 [error] [MainThread]:   Role 'REPORTER' does not exist or not authorized.
[0m13:45:13.634976 [error] [MainThread]:   compiled Code at target/run/dbtlearm/models/dim/dim_listings_cleansed.sql
[0m13:45:13.635323 [info ] [MainThread]: 
[0m13:45:13.635658 [error] [MainThread]: [33mDatabase Error in model fct_reviews (models/fct/fct_reviews.sql)[0m
[0m13:45:13.635968 [error] [MainThread]:   002003 (02000): SQL compilation error:
[0m13:45:13.636275 [error] [MainThread]:   Role 'REPORTER' does not exist or not authorized.
[0m13:45:13.636684 [error] [MainThread]:   compiled Code at target/run/dbtlearm/models/fct/fct_reviews.sql
[0m13:45:13.637021 [info ] [MainThread]: 
[0m13:45:13.637351 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=2 TOTAL=5
[0m13:45:13.637758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1c7e1ed60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1c7d311c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1c8009b20>]}
[0m13:45:13.638103 [debug] [MainThread]: Flushing usage events


============================== 2023-03-06 13:47:42.861782 | 987ac8c3-4ac7-45b9-a36c-8329e1359019 ==============================
[0m13:47:42.861782 [info ] [MainThread]: Running with dbt=1.4.1
[0m13:47:42.864372 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/mramirez/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:47:42.864692 [debug] [MainThread]: Tracking: tracking
[0m13:47:42.865128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf63a80d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf63a80fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf63a80fa0>]}
[0m13:47:43.151281 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:47:43.151600 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:47:43.160437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '987ac8c3-4ac7-45b9-a36c-8329e1359019', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf63ade0d0>]}
[0m13:47:43.181478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '987ac8c3-4ac7-45b9-a36c-8329e1359019', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf63c0f700>]}
[0m13:47:43.182043 [info ] [MainThread]: Found 8 models, 14 tests, 2 snapshots, 1 analysis, 418 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m13:47:43.182511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '987ac8c3-4ac7-45b9-a36c-8329e1359019', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf63c0f550>]}
[0m13:47:43.184735 [info ] [MainThread]: 
[0m13:47:43.186603 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:47:43.188100 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb'
[0m13:47:43.205526 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m13:47:43.205915 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m13:47:43.206219 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:47:45.329363 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2 seconds
[0m13:47:45.330822 [debug] [ThreadPool]: On list_airbnb: Close
[0m13:47:45.554118 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m13:47:45.561998 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m13:47:45.562331 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m13:47:45.562694 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:47:46.592751 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m13:47:46.594661 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m13:47:46.821468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '987ac8c3-4ac7-45b9-a36c-8329e1359019', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf63ec8df0>]}
[0m13:47:46.822107 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:47:46.822413 [info ] [MainThread]: 
[0m13:47:46.830284 [debug] [Thread-1  ]: Began running node model.dbtlearm.src_host
[0m13:47:46.830553 [debug] [Thread-2  ]: Began running node model.dbtlearm.src_listings
[0m13:47:46.830790 [debug] [Thread-3  ]: Began running node model.dbtlearm.src_reviews
[0m13:47:46.831318 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearm.src_host'
[0m13:47:46.831818 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearm.src_listings'
[0m13:47:46.832290 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearm.src_reviews'
[0m13:47:46.832537 [debug] [Thread-1  ]: Began compiling node model.dbtlearm.src_host
[0m13:47:46.832803 [debug] [Thread-2  ]: Began compiling node model.dbtlearm.src_listings
[0m13:47:46.833026 [debug] [Thread-3  ]: Began compiling node model.dbtlearm.src_reviews
[0m13:47:46.835586 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearm.src_host"
[0m13:47:46.838659 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearm.src_listings"
[0m13:47:46.841482 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearm.src_reviews"
[0m13:47:46.926165 [debug] [Thread-2  ]: Timing info for model.dbtlearm.src_listings (compile): 2023-03-06 13:47:46.835775 => 2023-03-06 13:47:46.926064
[0m13:47:46.927742 [debug] [Thread-2  ]: Finished running node model.dbtlearm.src_listings
[0m13:47:46.928207 [debug] [Thread-4  ]: Began running node model.dbtlearm.dim_listings_cleansed
[0m13:47:46.928512 [info ] [Thread-4  ]: 1 of 5 START sql view model dev.dim_listings_cleansed .......................... [RUN]
[0m13:47:46.929071 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtlearm.dim_listings_cleansed'
[0m13:47:46.929289 [debug] [Thread-4  ]: Began compiling node model.dbtlearm.dim_listings_cleansed
[0m13:47:46.945060 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearm.dim_listings_cleansed"
[0m13:47:46.946162 [debug] [Thread-4  ]: Timing info for model.dbtlearm.dim_listings_cleansed (compile): 2023-03-06 13:47:46.929448 => 2023-03-06 13:47:46.946097
[0m13:47:46.946430 [debug] [Thread-4  ]: Began executing node model.dbtlearm.dim_listings_cleansed
[0m13:47:46.974489 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtlearm.dim_listings_cleansed"
[0m13:47:46.976870 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearm.dim_listings_cleansed"
[0m13:47:46.977082 [debug] [Thread-1  ]: Timing info for model.dbtlearm.src_host (compile): 2023-03-06 13:47:46.833203 => 2023-03-06 13:47:46.977019
[0m13:47:46.977299 [debug] [Thread-4  ]: On model.dbtlearm.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.dim_listings_cleansed"} */
create or replace   view airbnb.dev.dim_listings_cleansed
  
   as (
    -- Change Tables for views

WITH  __dbt__cte__src_listings as (
-- DBT knows this is a view
-- By default they are views
WITH raw_listings AS(
	SELECT * FROM airbnb.raw.raw_listings
)
SELECT
	id as listing_id,
    name as listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at
FROM
	raw_listings
),src_listings AS (
    SELECT * FROM __dbt__cte__src_listings
)
SELECT 
    listing_id,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights = 0 THEN 1
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE(
        price_str,
        '$'
    ) :: NUMBER (
        10,
        2
    ) AS price,
    created_at,
    updated_at
FROM
    src_listings
  );
[0m13:47:46.977911 [debug] [Thread-1  ]: Finished running node model.dbtlearm.src_host
[0m13:47:46.978132 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m13:47:46.978612 [debug] [Thread-2  ]: Began running node model.dbtlearm.dim_hosts_cleansed
[0m13:47:46.979512 [info ] [Thread-2  ]: 2 of 5 START sql view model dev.dim_hosts_cleansed ............................. [RUN]
[0m13:47:46.980484 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearm.dim_hosts_cleansed'
[0m13:47:46.980842 [debug] [Thread-2  ]: Began compiling node model.dbtlearm.dim_hosts_cleansed
[0m13:47:46.987497 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearm.dim_hosts_cleansed"
[0m13:47:46.988392 [debug] [Thread-2  ]: Timing info for model.dbtlearm.dim_hosts_cleansed (compile): 2023-03-06 13:47:46.981278 => 2023-03-06 13:47:46.988324
[0m13:47:46.988679 [debug] [Thread-2  ]: Began executing node model.dbtlearm.dim_hosts_cleansed
[0m13:47:46.993222 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtlearm.dim_hosts_cleansed"
[0m13:47:46.994642 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearm.dim_hosts_cleansed"
[0m13:47:46.994898 [debug] [Thread-2  ]: On model.dbtlearm.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.dim_hosts_cleansed"} */
create or replace   view airbnb.dev.dim_hosts_cleansed
  
   as (
    -- Change Tables for views

WITH  __dbt__cte__src_host as (
WITH raw_hosts AS(
	SELECT * FROM airbnb.raw.raw_hosts
)
SELECT
	id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
	raw_hosts
),src_hosts AS(
    SELECT * FROM  __dbt__cte__src_host
)
SELECT
    host_id,
    NVL(
        host_name, 
        'Anonymous'
    ) AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
	src_hosts
  );
[0m13:47:46.995096 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m13:47:47.026092 [debug] [Thread-3  ]: Timing info for model.dbtlearm.src_reviews (compile): 2023-03-06 13:47:46.838960 => 2023-03-06 13:47:47.025998
[0m13:47:47.026870 [debug] [Thread-3  ]: Finished running node model.dbtlearm.src_reviews
[0m13:47:47.027359 [debug] [Thread-1  ]: Began running node model.dbtlearm.fct_reviews
[0m13:47:47.027677 [info ] [Thread-1  ]: 3 of 5 START sql incremental model dev.fct_reviews ............................. [RUN]
[0m13:47:47.028205 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearm.fct_reviews'
[0m13:47:47.028430 [debug] [Thread-1  ]: Began compiling node model.dbtlearm.fct_reviews
[0m13:47:47.056099 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearm.fct_reviews"
[0m13:47:47.057192 [debug] [Thread-1  ]: Timing info for model.dbtlearm.fct_reviews (compile): 2023-03-06 13:47:47.028590 => 2023-03-06 13:47:47.057127
[0m13:47:47.057463 [debug] [Thread-1  ]: Began executing node model.dbtlearm.fct_reviews
[0m13:47:47.091171 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m13:47:47.091531 [debug] [Thread-1  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
create or replace  temporary view airbnb.dev.fct_reviews__dbt_tmp
  
   as (
    -- Incremental Materialization

WITH  __dbt__cte__src_reviews as (
WITH raw_reviews AS(
	SELECT * FROM airbnb.raw.raw_reviews
)
SELECT
	listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
	raw_reviews
),src_reviews AS (
    SELECt * FROM __dbt__cte__src_reviews
)
SELECT
    -- It creates a unique identifier
    
    
md5(cast(coalesce(cast(listing_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(reviewer_name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_text as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as review_id,
    *
FROM src_reviews
WHERE review_text IS NOT NULL

  AND review_date > (SELECT MAX(review_date) FROM airbnb.dev.fct_reviews)

  );
[0m13:47:47.091748 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:47:48.115403 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1 seconds
[0m13:47:48.128978 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearm.dim_listings_cleansed"
[0m13:47:48.129239 [debug] [Thread-4  ]: On model.dbtlearm.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.dim_listings_cleansed"} */
GRANT SELECT ON airbnb.dev.dim_listings_cleansed TO ROLE REPORTER
[0m13:47:48.647130 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2 seconds
[0m13:47:48.649666 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearm.dim_hosts_cleansed"
[0m13:47:48.649881 [debug] [Thread-2  ]: On model.dbtlearm.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.dim_hosts_cleansed"} */
GRANT SELECT ON airbnb.dev.dim_hosts_cleansed TO ROLE REPORTER
[0m13:47:48.746484 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1 seconds
[0m13:47:48.752228 [debug] [Thread-4  ]: Timing info for model.dbtlearm.dim_listings_cleansed (execute): 2023-03-06 13:47:46.946607 => 2023-03-06 13:47:48.752178
[0m13:47:48.752496 [debug] [Thread-4  ]: On model.dbtlearm.dim_listings_cleansed: Close
[0m13:47:48.808900 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m13:47:48.810338 [debug] [Thread-2  ]: Timing info for model.dbtlearm.dim_hosts_cleansed (execute): 2023-03-06 13:47:46.988850 => 2023-03-06 13:47:48.810291
[0m13:47:48.810569 [debug] [Thread-2  ]: On model.dbtlearm.dim_hosts_cleansed: Close
[0m13:47:49.092755 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '987ac8c3-4ac7-45b9-a36c-8329e1359019', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf63f935e0>]}
[0m13:47:49.093221 [info ] [Thread-4  ]: 1 of 5 OK created sql view model dev.dim_listings_cleansed ..................... [[32mSUCCESS 1[0m in 2.16s]
[0m13:47:49.093639 [debug] [Thread-4  ]: Finished running node model.dbtlearm.dim_listings_cleansed
[0m13:47:49.684112 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3 seconds
[0m13:47:49.696179 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m13:47:49.696518 [debug] [Thread-1  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
describe table airbnb.dev.fct_reviews__dbt_tmp
[0m13:47:49.833450 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0 seconds
[0m13:47:49.838996 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m13:47:49.839307 [debug] [Thread-1  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
describe table airbnb.dev.fct_reviews
[0m13:47:49.843525 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '987ac8c3-4ac7-45b9-a36c-8329e1359019', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf63f755e0>]}
[0m13:47:49.844048 [info ] [Thread-2  ]: 2 of 5 OK created sql view model dev.dim_hosts_cleansed ........................ [[32mSUCCESS 1[0m in 2.86s]
[0m13:47:49.844497 [debug] [Thread-2  ]: Finished running node model.dbtlearm.dim_hosts_cleansed
[0m13:47:49.845092 [debug] [Thread-3  ]: Began running node model.dbtlearm.dim_listings_with_hosts
[0m13:47:49.845503 [info ] [Thread-3  ]: 4 of 5 START sql table model dev.dim_listings_with_hosts ....................... [RUN]
[0m13:47:49.846233 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearm.dim_listings_with_hosts'
[0m13:47:49.846562 [debug] [Thread-3  ]: Began compiling node model.dbtlearm.dim_listings_with_hosts
[0m13:47:49.850128 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearm.dim_listings_with_hosts"
[0m13:47:49.857276 [debug] [Thread-3  ]: Timing info for model.dbtlearm.dim_listings_with_hosts (compile): 2023-03-06 13:47:49.846789 => 2023-03-06 13:47:49.857185
[0m13:47:49.857628 [debug] [Thread-3  ]: Began executing node model.dbtlearm.dim_listings_with_hosts
[0m13:47:49.883596 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtlearm.dim_listings_with_hosts"
[0m13:47:49.888240 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearm.dim_listings_with_hosts"
[0m13:47:49.888569 [debug] [Thread-3  ]: On model.dbtlearm.dim_listings_with_hosts: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.dim_listings_with_hosts"} */
create or replace transient table airbnb.dev.dim_listings_with_hosts  as
        (WITH
l AS (
    SELECT *
    FROM airbnb.dev.dim_listings_cleansed
),
h AS (
    SELECT *
    FROM airbnb.dev.dim_hosts_cleansed
)
SELECT
    l.listing_id,
    l.listing_name,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost AS host_is_superhost,
    l.created_at,
    GREATEST(l.updated_at, h.updated_at) AS updated_at
FROM l
LEFT JOIN h 
ON h.host_id = l.host_id
        );
[0m13:47:49.888811 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:47:50.092164 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0 seconds
[0m13:47:50.110393 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m13:47:50.110724 [debug] [Thread-1  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
describe table airbnb.dev.fct_reviews__dbt_tmp
[0m13:47:50.272551 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0 seconds
[0m13:47:50.283255 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m13:47:50.294134 [debug] [Thread-1  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m13:47:50.481926 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0 seconds
[0m13:47:50.494357 [debug] [Thread-1  ]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m13:47:50.513847 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtlearm.fct_reviews"
[0m13:47:50.529669 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m13:47:50.529899 [debug] [Thread-1  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m13:47:50.677592 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m13:47:50.677966 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m13:47:50.678197 [debug] [Thread-1  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
insert into airbnb.dev.fct_reviews ("REVIEW_ID", "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "REVIEW_ID", "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from airbnb.dev.fct_reviews__dbt_tmp
        );
[0m13:47:51.408024 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 1 seconds
[0m13:47:51.408461 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m13:47:51.408716 [debug] [Thread-1  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
COMMIT
[0m13:47:51.613049 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m13:47:51.619542 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m13:47:51.619756 [debug] [Thread-1  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
drop view if exists airbnb.dev.fct_reviews__dbt_tmp cascade
[0m13:47:51.774395 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m13:47:51.777614 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearm.fct_reviews"
[0m13:47:51.777939 [debug] [Thread-1  ]: On model.dbtlearm.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.fct_reviews"} */
GRANT SELECT ON airbnb.dev.fct_reviews TO ROLE REPORTER
[0m13:47:51.950803 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m13:47:51.958403 [debug] [Thread-1  ]: Timing info for model.dbtlearm.fct_reviews (execute): 2023-03-06 13:47:47.057631 => 2023-03-06 13:47:51.958338
[0m13:47:51.958745 [debug] [Thread-1  ]: On model.dbtlearm.fct_reviews: Close
[0m13:47:52.209801 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '987ac8c3-4ac7-45b9-a36c-8329e1359019', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf64126a60>]}
[0m13:47:52.210382 [info ] [Thread-1  ]: 3 of 5 OK created sql incremental model dev.fct_reviews ........................ [[32mSUCCESS 0[0m in 5.18s]
[0m13:47:52.210845 [debug] [Thread-1  ]: Finished running node model.dbtlearm.fct_reviews
[0m13:47:52.211463 [debug] [Thread-2  ]: Began running node model.dbtlearm.mart_fullmoon_review
[0m13:47:52.211885 [info ] [Thread-2  ]: 5 of 5 START sql table model dev.mart_fullmoon_review .......................... [RUN]
[0m13:47:52.212786 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearm.mart_fullmoon_review'
[0m13:47:52.213112 [debug] [Thread-2  ]: Began compiling node model.dbtlearm.mart_fullmoon_review
[0m13:47:52.217071 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearm.mart_fullmoon_review"
[0m13:47:52.233833 [debug] [Thread-2  ]: Timing info for model.dbtlearm.mart_fullmoon_review (compile): 2023-03-06 13:47:52.213333 => 2023-03-06 13:47:52.233705
[0m13:47:52.234340 [debug] [Thread-2  ]: Began executing node model.dbtlearm.mart_fullmoon_review
[0m13:47:52.238436 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtlearm.mart_fullmoon_review"
[0m13:47:52.242459 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearm.mart_fullmoon_review"
[0m13:47:52.242784 [debug] [Thread-2  ]: On model.dbtlearm.mart_fullmoon_review: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.mart_fullmoon_review"} */
create or replace transient table airbnb.dev.mart_fullmoon_review  as
        (

WITH fct_reviews AS (
    SELECT * FROM airbnb.dev.fct_reviews
),

full_moon_dates AS (
    SELECT * FROM airbnb.dev.seed_full_moon_dates
)

SELECT
    r.*,
    CASE
        WHEN fm.full_moon_date IS NULL THEN 'not full moon'
        ELSE 'full moon'
    END AS is_full_moon
FROM
    fct_reviews r
    LEFT JOIN full_moon_dates fm
    ON (TO_DATE(r.review_date) = DATEADD(DAY, 1, fm.full_moon_date))
        );
[0m13:47:52.243046 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m13:47:52.988831 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 3 seconds
[0m13:47:52.991340 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearm.dim_listings_with_hosts"
[0m13:47:52.991631 [debug] [Thread-3  ]: On model.dbtlearm.dim_listings_with_hosts: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.dim_listings_with_hosts"} */
GRANT SELECT ON airbnb.dev.dim_listings_with_hosts TO ROLE REPORTER
[0m13:47:53.129070 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m13:47:53.132514 [debug] [Thread-3  ]: Timing info for model.dbtlearm.dim_listings_with_hosts (execute): 2023-03-06 13:47:49.857852 => 2023-03-06 13:47:53.132442
[0m13:47:53.132887 [debug] [Thread-3  ]: On model.dbtlearm.dim_listings_with_hosts: Close
[0m13:47:53.357271 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '987ac8c3-4ac7-45b9-a36c-8329e1359019', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf6414d550>]}
[0m13:47:53.357876 [info ] [Thread-3  ]: 4 of 5 OK created sql table model dev.dim_listings_with_hosts .................. [[32mSUCCESS 1[0m in 3.51s]
[0m13:47:53.358360 [debug] [Thread-3  ]: Finished running node model.dbtlearm.dim_listings_with_hosts
[0m13:47:56.721245 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 4 seconds
[0m13:47:56.723370 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearm.mart_fullmoon_review"
[0m13:47:56.723608 [debug] [Thread-2  ]: On model.dbtlearm.mart_fullmoon_review: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "model.dbtlearm.mart_fullmoon_review"} */
GRANT SELECT ON airbnb.dev.mart_fullmoon_review TO ROLE REPORTER
[0m13:47:56.901209 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m13:47:56.904094 [debug] [Thread-2  ]: Timing info for model.dbtlearm.mart_fullmoon_review (execute): 2023-03-06 13:47:52.234646 => 2023-03-06 13:47:56.904039
[0m13:47:56.904375 [debug] [Thread-2  ]: On model.dbtlearm.mart_fullmoon_review: Close
[0m13:47:57.138684 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '987ac8c3-4ac7-45b9-a36c-8329e1359019', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf641d5b20>]}
[0m13:47:57.139350 [info ] [Thread-2  ]: 5 of 5 OK created sql table model dev.mart_fullmoon_review ..................... [[32mSUCCESS 1[0m in 4.93s]
[0m13:47:57.139966 [debug] [Thread-2  ]: Finished running node model.dbtlearm.mart_fullmoon_review
[0m13:47:57.141963 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:47:57.142666 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:47:57.142937 [debug] [MainThread]: Connection 'model.dbtlearm.fct_reviews' was properly closed.
[0m13:47:57.143172 [debug] [MainThread]: Connection 'model.dbtlearm.mart_fullmoon_review' was properly closed.
[0m13:47:57.143401 [debug] [MainThread]: Connection 'model.dbtlearm.dim_listings_with_hosts' was properly closed.
[0m13:47:57.143628 [debug] [MainThread]: Connection 'model.dbtlearm.dim_listings_cleansed' was properly closed.
[0m13:47:57.143938 [info ] [MainThread]: 
[0m13:47:57.144300 [info ] [MainThread]: Finished running 2 view models, 1 incremental model, 2 table models in 0 hours 0 minutes and 13.96 seconds (13.96s).
[0m13:47:57.144931 [debug] [MainThread]: Command end result
[0m13:47:57.158366 [info ] [MainThread]: 
[0m13:47:57.158823 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:47:57.159174 [info ] [MainThread]: 
[0m13:47:57.159486 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m13:47:57.159870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf63ec8df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf6413ea60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf6413e610>]}
[0m13:47:57.160211 [debug] [MainThread]: Flushing usage events


============================== 2023-03-08 13:52:01.964268 | 37dce9cb-a749-4852-ba36-246d9f03ebb9 ==============================
[0m13:52:01.964268 [info ] [MainThread]: Running with dbt=1.4.1
[0m13:52:01.967311 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/mramirez/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
[0m13:52:01.968016 [debug] [MainThread]: Tracking: tracking
[0m13:52:01.968933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde1b47dd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde1b47ddc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde1b48b0d0>]}
[0m13:52:02.434352 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m13:52:02.435310 [debug] [MainThread]: Partial parsing: added file: dbtlearm://models/dashboards.yml
[0m13:52:02.448081 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Starting in v1.3, the 'name' of an exposure should contain only letters,
numbers, and underscores. Exposures support a new property, 'label', which may
contain spaces, capital letters, and special characters. Executive Dashboard
does not follow this pattern. Please update the 'name', and use the 'label'
property for a human-friendly title. This will raise an error in a future
version of dbt-core.
[0m13:52:02.448467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '37dce9cb-a749-4852-ba36-246d9f03ebb9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde1b4df760>]}
[0m13:52:02.456715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde1b6ed160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde1b60bcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde1b60bc10>]}
[0m13:52:02.457177 [debug] [MainThread]: Flushing usage events
[0m13:52:03.225937 [error] [MainThread]: Encountered an error:
Compilation Error
  Exposure 'exposure.dbtlearm.Executive Dashboard' (models/dashboards.yml) depends on a node named 'dim_listings_w_hosts' which was not found


============================== 2023-03-08 13:52:51.605574 | 1e5e4c3b-0043-4875-a8d2-7c99304ecda3 ==============================
[0m13:52:51.605574 [info ] [MainThread]: Running with dbt=1.4.1
[0m13:52:51.607645 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/mramirez/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
[0m13:52:51.607965 [debug] [MainThread]: Tracking: tracking
[0m13:52:51.608432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6e6678d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6e6678df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6e668a100>]}
[0m13:52:51.708313 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m13:52:51.708806 [debug] [MainThread]: Partial parsing: added file: dbtlearm://models/dashboards.yml
[0m13:52:51.719115 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Starting in v1.3, the 'name' of an exposure should contain only letters,
numbers, and underscores. Exposures support a new property, 'label', which may
contain spaces, capital letters, and special characters. Executive Dashboard
does not follow this pattern. Please update the 'name', and use the 'label'
property for a human-friendly title. This will raise an error in a future
version of dbt-core.
[0m13:52:51.719440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1e5e4c3b-0043-4875-a8d2-7c99304ecda3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6e66df7c0>]}
[0m13:52:51.735951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e5e4c3b-0043-4875-a8d2-7c99304ecda3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6e6a2a0d0>]}
[0m13:52:51.755713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e5e4c3b-0043-4875-a8d2-7c99304ecda3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6e69e26d0>]}
[0m13:52:51.756157 [info ] [MainThread]: Found 8 models, 14 tests, 2 snapshots, 1 analysis, 418 macros, 0 operations, 1 seed file, 3 sources, 1 exposure, 0 metrics
[0m13:52:51.756485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e5e4c3b-0043-4875-a8d2-7c99304ecda3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6e6678eb0>]}
[0m13:52:51.758747 [info ] [MainThread]: 
[0m13:52:51.760485 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:52:51.761876 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m13:52:51.776974 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m13:52:51.777326 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m13:52:51.777598 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:52:54.426133 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 3 seconds
[0m13:52:54.428395 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m13:52:54.658442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e5e4c3b-0043-4875-a8d2-7c99304ecda3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6e66afa30>]}
[0m13:52:54.659392 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:52:54.659759 [info ] [MainThread]: 
[0m13:52:54.678254 [debug] [Thread-1  ]: Began running node model.dbtlearm.src_host
[0m13:52:54.678691 [debug] [Thread-2  ]: Began running node model.dbtlearm.src_listings
[0m13:52:54.679477 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearm.src_host'
[0m13:52:54.679781 [debug] [Thread-3  ]: Began running node model.dbtlearm.src_reviews
[0m13:52:54.680138 [debug] [Thread-4  ]: Began running node seed.dbtlearm.seed_full_moon_dates
[0m13:52:54.680798 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearm.src_listings'
[0m13:52:54.681207 [debug] [Thread-1  ]: Began compiling node model.dbtlearm.src_host
[0m13:52:54.682032 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearm.src_reviews'
[0m13:52:54.682713 [debug] [Thread-4  ]: Acquiring new snowflake connection 'seed.dbtlearm.seed_full_moon_dates'
[0m13:52:54.683054 [debug] [Thread-2  ]: Began compiling node model.dbtlearm.src_listings
[0m13:52:54.686696 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearm.src_host"
[0m13:52:54.687065 [debug] [Thread-3  ]: Began compiling node model.dbtlearm.src_reviews
[0m13:52:54.687373 [debug] [Thread-4  ]: Began compiling node seed.dbtlearm.seed_full_moon_dates
[0m13:52:54.690589 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearm.src_listings"
[0m13:52:54.693854 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearm.src_reviews"
[0m13:52:54.695965 [debug] [Thread-4  ]: Timing info for seed.dbtlearm.seed_full_moon_dates (compile): 2023-03-08 13:52:54.694237 => 2023-03-08 13:52:54.695882
[0m13:52:54.696260 [debug] [Thread-1  ]: Timing info for model.dbtlearm.src_host (compile): 2023-03-08 13:52:54.683294 => 2023-03-08 13:52:54.696187
[0m13:52:54.696875 [debug] [Thread-4  ]: Began executing node seed.dbtlearm.seed_full_moon_dates
[0m13:52:54.699048 [debug] [Thread-1  ]: Finished running node model.dbtlearm.src_host
[0m13:52:54.699542 [debug] [Thread-4  ]: Timing info for seed.dbtlearm.seed_full_moon_dates (execute): 2023-03-08 13:52:54.699466 => 2023-03-08 13:52:54.699479
[0m13:52:54.700048 [debug] [Thread-1  ]: Began running node snapshot.dbtlearm.scd_raw_hosts
[0m13:52:54.700274 [debug] [Thread-3  ]: Timing info for model.dbtlearm.src_reviews (compile): 2023-03-08 13:52:54.690990 => 2023-03-08 13:52:54.700224
[0m13:52:54.700499 [debug] [Thread-2  ]: Timing info for model.dbtlearm.src_listings (compile): 2023-03-08 13:52:54.687602 => 2023-03-08 13:52:54.700449
[0m13:52:54.701462 [debug] [Thread-4  ]: Finished running node seed.dbtlearm.seed_full_moon_dates
[0m13:52:54.702128 [debug] [Thread-1  ]: Acquiring new snowflake connection 'snapshot.dbtlearm.scd_raw_hosts'
[0m13:52:54.702873 [debug] [Thread-3  ]: Finished running node model.dbtlearm.src_reviews
[0m13:52:54.703589 [debug] [Thread-2  ]: Finished running node model.dbtlearm.src_listings
[0m13:52:54.704023 [debug] [Thread-4  ]: Began running node snapshot.dbtlearm.scd_raw_listings
[0m13:52:54.704442 [debug] [Thread-1  ]: Began compiling node snapshot.dbtlearm.scd_raw_hosts
[0m13:52:54.704838 [debug] [Thread-3  ]: Began running node model.dbtlearm.dim_hosts_cleansed
[0m13:52:54.705841 [debug] [Thread-4  ]: Acquiring new snowflake connection 'snapshot.dbtlearm.scd_raw_listings'
[0m13:52:54.706147 [debug] [Thread-2  ]: Began running node model.dbtlearm.dim_listings_cleansed
[0m13:52:54.711216 [debug] [Thread-1  ]: Timing info for snapshot.dbtlearm.scd_raw_hosts (compile): 2023-03-08 13:52:54.706378 => 2023-03-08 13:52:54.711154
[0m13:52:54.711855 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearm.dim_hosts_cleansed'
[0m13:52:54.712175 [debug] [Thread-4  ]: Began compiling node snapshot.dbtlearm.scd_raw_listings
[0m13:52:54.712917 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearm.dim_listings_cleansed'
[0m13:52:54.713328 [debug] [Thread-1  ]: Began executing node snapshot.dbtlearm.scd_raw_hosts
[0m13:52:54.713660 [debug] [Thread-3  ]: Began compiling node model.dbtlearm.dim_hosts_cleansed
[0m13:52:54.717497 [debug] [Thread-4  ]: Timing info for snapshot.dbtlearm.scd_raw_listings (compile): 2023-03-08 13:52:54.713895 => 2023-03-08 13:52:54.717433
[0m13:52:54.717845 [debug] [Thread-2  ]: Began compiling node model.dbtlearm.dim_listings_cleansed
[0m13:52:54.718136 [debug] [Thread-1  ]: Timing info for snapshot.dbtlearm.scd_raw_hosts (execute): 2023-03-08 13:52:54.718075 => 2023-03-08 13:52:54.718087
[0m13:52:54.732670 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearm.dim_hosts_cleansed"
[0m13:52:54.732964 [debug] [Thread-4  ]: Began executing node snapshot.dbtlearm.scd_raw_listings
[0m13:52:54.741935 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearm.dim_listings_cleansed"
[0m13:52:54.742677 [debug] [Thread-1  ]: Finished running node snapshot.dbtlearm.scd_raw_hosts
[0m13:52:54.743088 [debug] [Thread-4  ]: Timing info for snapshot.dbtlearm.scd_raw_listings (execute): 2023-03-08 13:52:54.743022 => 2023-03-08 13:52:54.743034
[0m13:52:54.743620 [debug] [Thread-1  ]: Began running node model.dbtlearm.fct_reviews
[0m13:52:54.744414 [debug] [Thread-4  ]: Finished running node snapshot.dbtlearm.scd_raw_listings
[0m13:52:54.744976 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearm.fct_reviews'
[0m13:52:54.745437 [debug] [Thread-1  ]: Began compiling node model.dbtlearm.fct_reviews
[0m13:52:54.777366 [debug] [Thread-2  ]: Timing info for model.dbtlearm.dim_listings_cleansed (compile): 2023-03-08 13:52:54.733171 => 2023-03-08 13:52:54.777274
[0m13:52:54.777809 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearm.fct_reviews"
[0m13:52:54.778013 [debug] [Thread-2  ]: Began executing node model.dbtlearm.dim_listings_cleansed
[0m13:52:54.778165 [debug] [Thread-3  ]: Timing info for model.dbtlearm.dim_hosts_cleansed (compile): 2023-03-08 13:52:54.718356 => 2023-03-08 13:52:54.778129
[0m13:52:54.778501 [debug] [Thread-2  ]: Timing info for model.dbtlearm.dim_listings_cleansed (execute): 2023-03-08 13:52:54.778445 => 2023-03-08 13:52:54.778457
[0m13:52:54.778775 [debug] [Thread-3  ]: Began executing node model.dbtlearm.dim_hosts_cleansed
[0m13:52:54.779400 [debug] [Thread-2  ]: Finished running node model.dbtlearm.dim_listings_cleansed
[0m13:52:54.779621 [debug] [Thread-3  ]: Timing info for model.dbtlearm.dim_hosts_cleansed (execute): 2023-03-08 13:52:54.779577 => 2023-03-08 13:52:54.779584
[0m13:52:54.780736 [debug] [Thread-3  ]: Finished running node model.dbtlearm.dim_hosts_cleansed
[0m13:52:54.781154 [debug] [Thread-4  ]: Began running node test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m13:52:54.781399 [debug] [Thread-2  ]: Began running node test.dbtlearm.dim_listings_minimum_nights
[0m13:52:54.781729 [debug] [Thread-3  ]: Began running node test.dbtlearm.no_nulls_in_dim_listings
[0m13:52:54.782222 [debug] [Thread-4  ]: Acquiring new snowflake connection 'test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af'
[0m13:52:54.782397 [debug] [Thread-1  ]: Timing info for model.dbtlearm.fct_reviews (compile): 2023-03-08 13:52:54.745639 => 2023-03-08 13:52:54.782353
[0m13:52:54.783109 [debug] [Thread-2  ]: Acquiring new snowflake connection 'test.dbtlearm.dim_listings_minimum_nights'
[0m13:52:54.783575 [debug] [Thread-3  ]: Acquiring new snowflake connection 'test.dbtlearm.no_nulls_in_dim_listings'
[0m13:52:54.783831 [debug] [Thread-4  ]: Began compiling node test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m13:52:54.784069 [debug] [Thread-1  ]: Began executing node model.dbtlearm.fct_reviews
[0m13:52:54.784299 [debug] [Thread-2  ]: Began compiling node test.dbtlearm.dim_listings_minimum_nights
[0m13:52:54.784523 [debug] [Thread-3  ]: Began compiling node test.dbtlearm.no_nulls_in_dim_listings
[0m13:52:54.797682 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m13:52:54.797915 [debug] [Thread-1  ]: Timing info for model.dbtlearm.fct_reviews (execute): 2023-03-08 13:52:54.797863 => 2023-03-08 13:52:54.797872
[0m13:52:54.800093 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearm.dim_listings_minimum_nights"
[0m13:52:54.810396 [debug] [Thread-3  ]: Using snowflake connection "test.dbtlearm.no_nulls_in_dim_listings"
[0m13:52:54.811164 [debug] [Thread-1  ]: Finished running node model.dbtlearm.fct_reviews
[0m13:52:54.811484 [debug] [Thread-3  ]: On test.dbtlearm.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "test.dbtlearm.no_nulls_in_dim_listings"} */
describe table airbnb.dev.dim_listings_cleansed
[0m13:52:54.811993 [debug] [Thread-1  ]: Began running node test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be
[0m13:52:54.812442 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:52:54.812920 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be'
[0m13:52:54.814920 [debug] [Thread-2  ]: Timing info for test.dbtlearm.dim_listings_minimum_nights (compile): 2023-03-08 13:52:54.798088 => 2023-03-08 13:52:54.814843
[0m13:52:54.815107 [debug] [Thread-4  ]: Timing info for test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (compile): 2023-03-08 13:52:54.784691 => 2023-03-08 13:52:54.815060
[0m13:52:54.815311 [debug] [Thread-1  ]: Began compiling node test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be
[0m13:52:54.816050 [debug] [Thread-2  ]: Began executing node test.dbtlearm.dim_listings_minimum_nights
[0m13:52:54.816298 [debug] [Thread-4  ]: Began executing node test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m13:52:54.824717 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m13:52:54.824920 [debug] [Thread-2  ]: Timing info for test.dbtlearm.dim_listings_minimum_nights (execute): 2023-03-08 13:52:54.824867 => 2023-03-08 13:52:54.824877
[0m13:52:54.825145 [debug] [Thread-4  ]: Timing info for test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (execute): 2023-03-08 13:52:54.825103 => 2023-03-08 13:52:54.825109
[0m13:52:54.825927 [debug] [Thread-2  ]: Finished running node test.dbtlearm.dim_listings_minimum_nights
[0m13:52:54.826484 [debug] [Thread-4  ]: Finished running node test.dbtlearm.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m13:52:54.826786 [debug] [Thread-2  ]: Began running node test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m13:52:54.827257 [debug] [Thread-4  ]: Began running node test.dbtlearm.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m13:52:54.827849 [debug] [Thread-2  ]: Acquiring new snowflake connection 'test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9'
[0m13:52:54.828368 [debug] [Thread-4  ]: Acquiring new snowflake connection 'test.dbtlearm.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313'
[0m13:52:54.828542 [debug] [Thread-1  ]: Timing info for test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be (compile): 2023-03-08 13:52:54.816507 => 2023-03-08 13:52:54.828496
[0m13:52:54.828780 [debug] [Thread-2  ]: Began compiling node test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m13:52:54.829001 [debug] [Thread-4  ]: Began compiling node test.dbtlearm.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m13:52:54.829222 [debug] [Thread-1  ]: Began executing node test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be
[0m13:52:54.833099 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m13:52:54.837240 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearm.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m13:52:54.837499 [debug] [Thread-1  ]: Timing info for test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be (execute): 2023-03-08 13:52:54.837446 => 2023-03-08 13:52:54.837455
[0m13:52:54.838541 [debug] [Thread-1  ]: Finished running node test.dbtlearm.not_null_dim_listings_cleansed_host_id.084e4105be
[0m13:52:54.838991 [debug] [Thread-1  ]: Began running node test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m13:52:54.839503 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e'
[0m13:52:54.839734 [debug] [Thread-1  ]: Began compiling node test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m13:52:54.846467 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m13:52:54.847057 [debug] [Thread-4  ]: Timing info for test.dbtlearm.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313 (compile): 2023-03-08 13:52:54.833298 => 2023-03-08 13:52:54.846998
[0m13:52:54.847328 [debug] [Thread-2  ]: Timing info for test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9 (compile): 2023-03-08 13:52:54.829388 => 2023-03-08 13:52:54.847281
[0m13:52:54.847574 [debug] [Thread-4  ]: Began executing node test.dbtlearm.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m13:52:54.847802 [debug] [Thread-2  ]: Began executing node test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m13:52:54.848040 [debug] [Thread-4  ]: Timing info for test.dbtlearm.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313 (execute): 2023-03-08 13:52:54.847985 => 2023-03-08 13:52:54.847996
[0m13:52:54.848258 [debug] [Thread-2  ]: Timing info for test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9 (execute): 2023-03-08 13:52:54.848216 => 2023-03-08 13:52:54.848222
[0m13:52:54.848820 [debug] [Thread-4  ]: Finished running node test.dbtlearm.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m13:52:54.849355 [debug] [Thread-2  ]: Finished running node test.dbtlearm.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m13:52:54.849694 [debug] [Thread-4  ]: Began running node model.dbtlearm.dim_listings_with_hosts
[0m13:52:54.850092 [debug] [Thread-2  ]: Began running node test.dbtlearm.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m13:52:54.850251 [debug] [Thread-1  ]: Timing info for test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e (compile): 2023-03-08 13:52:54.839914 => 2023-03-08 13:52:54.850215
[0m13:52:54.850833 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtlearm.dim_listings_with_hosts'
[0m13:52:54.851286 [debug] [Thread-2  ]: Acquiring new snowflake connection 'test.dbtlearm.not_null_dim_hosts_cleansed_host_id.de84c3da05'
[0m13:52:54.851521 [debug] [Thread-1  ]: Began executing node test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m13:52:54.851749 [debug] [Thread-4  ]: Began compiling node model.dbtlearm.dim_listings_with_hosts
[0m13:52:54.851989 [debug] [Thread-2  ]: Began compiling node test.dbtlearm.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m13:52:54.852209 [debug] [Thread-1  ]: Timing info for test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e (execute): 2023-03-08 13:52:54.852164 => 2023-03-08 13:52:54.852171
[0m13:52:54.854873 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearm.dim_listings_with_hosts"
[0m13:52:54.858305 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearm.not_null_dim_hosts_cleansed_host_id.de84c3da05"
[0m13:52:54.858883 [debug] [Thread-1  ]: Finished running node test.dbtlearm.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m13:52:54.859478 [debug] [Thread-1  ]: Began running node test.dbtlearm.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m13:52:54.860253 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbtlearm.not_null_dim_hosts_cleansed_host_name.42386c5830'
[0m13:52:54.860478 [debug] [Thread-1  ]: Began compiling node test.dbtlearm.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m13:52:54.864465 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearm.not_null_dim_hosts_cleansed_host_name.42386c5830"
[0m13:52:54.865001 [debug] [Thread-4  ]: Timing info for model.dbtlearm.dim_listings_with_hosts (compile): 2023-03-08 13:52:54.852373 => 2023-03-08 13:52:54.864923
[0m13:52:54.865277 [debug] [Thread-2  ]: Timing info for test.dbtlearm.not_null_dim_hosts_cleansed_host_id.de84c3da05 (compile): 2023-03-08 13:52:54.855072 => 2023-03-08 13:52:54.865189
[0m13:52:54.865695 [debug] [Thread-4  ]: Began executing node model.dbtlearm.dim_listings_with_hosts
[0m13:52:54.865931 [debug] [Thread-2  ]: Began executing node test.dbtlearm.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m13:52:54.866145 [debug] [Thread-4  ]: Timing info for model.dbtlearm.dim_listings_with_hosts (execute): 2023-03-08 13:52:54.866098 => 2023-03-08 13:52:54.866108
[0m13:52:54.866373 [debug] [Thread-2  ]: Timing info for test.dbtlearm.not_null_dim_hosts_cleansed_host_id.de84c3da05 (execute): 2023-03-08 13:52:54.866324 => 2023-03-08 13:52:54.866332
[0m13:52:54.866963 [debug] [Thread-4  ]: Finished running node model.dbtlearm.dim_listings_with_hosts
[0m13:52:54.867720 [debug] [Thread-2  ]: Finished running node test.dbtlearm.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m13:52:54.868154 [debug] [Thread-4  ]: Began running node test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m13:52:54.868458 [debug] [Thread-1  ]: Timing info for test.dbtlearm.not_null_dim_hosts_cleansed_host_name.42386c5830 (compile): 2023-03-08 13:52:54.860634 => 2023-03-08 13:52:54.868416
[0m13:52:54.868733 [debug] [Thread-2  ]: Began running node test.dbtlearm.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m13:52:54.869285 [debug] [Thread-4  ]: Acquiring new snowflake connection 'test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad'
[0m13:52:54.869546 [debug] [Thread-1  ]: Began executing node test.dbtlearm.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m13:52:54.870015 [debug] [Thread-2  ]: Acquiring new snowflake connection 'test.dbtlearm.unique_dim_hosts_cleansed_host_id.d7e4771347'
[0m13:52:54.870279 [debug] [Thread-4  ]: Began compiling node test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m13:52:54.870503 [debug] [Thread-1  ]: Timing info for test.dbtlearm.not_null_dim_hosts_cleansed_host_name.42386c5830 (execute): 2023-03-08 13:52:54.870457 => 2023-03-08 13:52:54.870465
[0m13:52:54.870726 [debug] [Thread-2  ]: Began compiling node test.dbtlearm.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m13:52:54.878518 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m13:52:54.879145 [debug] [Thread-1  ]: Finished running node test.dbtlearm.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m13:52:54.882577 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearm.unique_dim_hosts_cleansed_host_id.d7e4771347"
[0m13:52:54.883031 [debug] [Thread-1  ]: Began running node model.dbtlearm.mart_fullmoon_review
[0m13:52:54.883750 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearm.mart_fullmoon_review'
[0m13:52:54.883992 [debug] [Thread-1  ]: Began compiling node model.dbtlearm.mart_fullmoon_review
[0m13:52:54.886912 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearm.mart_fullmoon_review"
[0m13:52:54.887347 [debug] [Thread-4  ]: Timing info for test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (compile): 2023-03-08 13:52:54.870896 => 2023-03-08 13:52:54.887291
[0m13:52:54.887723 [debug] [Thread-4  ]: Began executing node test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m13:52:54.887917 [debug] [Thread-2  ]: Timing info for test.dbtlearm.unique_dim_hosts_cleansed_host_id.d7e4771347 (compile): 2023-03-08 13:52:54.879334 => 2023-03-08 13:52:54.887870
[0m13:52:54.888134 [debug] [Thread-4  ]: Timing info for test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (execute): 2023-03-08 13:52:54.888088 => 2023-03-08 13:52:54.888097
[0m13:52:54.888365 [debug] [Thread-2  ]: Began executing node test.dbtlearm.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m13:52:54.888942 [debug] [Thread-4  ]: Finished running node test.dbtlearm.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m13:52:54.889168 [debug] [Thread-2  ]: Timing info for test.dbtlearm.unique_dim_hosts_cleansed_host_id.d7e4771347 (execute): 2023-03-08 13:52:54.889124 => 2023-03-08 13:52:54.889130
[0m13:52:54.889462 [debug] [Thread-4  ]: Began running node test.dbtlearm.consistent_created_at
[0m13:52:54.890154 [debug] [Thread-2  ]: Finished running node test.dbtlearm.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m13:52:54.890656 [debug] [Thread-4  ]: Acquiring new snowflake connection 'test.dbtlearm.consistent_created_at'
[0m13:52:54.890973 [debug] [Thread-2  ]: Began running node test.dbtlearm.not_null_fct_reviews_reviewer_name.8204e43c88
[0m13:52:54.891252 [debug] [Thread-4  ]: Began compiling node test.dbtlearm.consistent_created_at
[0m13:52:54.891761 [debug] [Thread-2  ]: Acquiring new snowflake connection 'test.dbtlearm.not_null_fct_reviews_reviewer_name.8204e43c88'
[0m13:52:54.891943 [debug] [Thread-1  ]: Timing info for model.dbtlearm.mart_fullmoon_review (compile): 2023-03-08 13:52:54.884156 => 2023-03-08 13:52:54.891899
[0m13:52:54.895466 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearm.consistent_created_at"
[0m13:52:54.895755 [debug] [Thread-2  ]: Began compiling node test.dbtlearm.not_null_fct_reviews_reviewer_name.8204e43c88
[0m13:52:54.896028 [debug] [Thread-1  ]: Began executing node model.dbtlearm.mart_fullmoon_review
[0m13:52:54.900755 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearm.not_null_fct_reviews_reviewer_name.8204e43c88"
[0m13:52:54.901169 [debug] [Thread-1  ]: Timing info for model.dbtlearm.mart_fullmoon_review (execute): 2023-03-08 13:52:54.901091 => 2023-03-08 13:52:54.901106
[0m13:52:54.901609 [debug] [Thread-4  ]: Timing info for test.dbtlearm.consistent_created_at (compile): 2023-03-08 13:52:54.892114 => 2023-03-08 13:52:54.901548
[0m13:52:54.902467 [debug] [Thread-1  ]: Finished running node model.dbtlearm.mart_fullmoon_review
[0m13:52:54.902770 [debug] [Thread-4  ]: Began executing node test.dbtlearm.consistent_created_at
[0m13:52:54.903118 [debug] [Thread-1  ]: Began running node test.dbtlearm.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe
[0m13:52:54.903687 [debug] [Thread-4  ]: Timing info for test.dbtlearm.consistent_created_at (execute): 2023-03-08 13:52:54.903612 => 2023-03-08 13:52:54.903625
[0m13:52:54.904351 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbtlearm.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe'
[0m13:52:54.905106 [debug] [Thread-4  ]: Finished running node test.dbtlearm.consistent_created_at
[0m13:52:54.905556 [debug] [Thread-1  ]: Began compiling node test.dbtlearm.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe
[0m13:52:54.905794 [debug] [Thread-2  ]: Timing info for test.dbtlearm.not_null_fct_reviews_reviewer_name.8204e43c88 (compile): 2023-03-08 13:52:54.896313 => 2023-03-08 13:52:54.905726
[0m13:52:54.906190 [debug] [Thread-4  ]: Began running node analysis.dbtlearm.fool_moon_no_sleep
[0m13:52:54.912934 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearm.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe"
[0m13:52:54.913341 [debug] [Thread-2  ]: Began executing node test.dbtlearm.not_null_fct_reviews_reviewer_name.8204e43c88
[0m13:52:54.913968 [debug] [Thread-4  ]: Acquiring new snowflake connection 'analysis.dbtlearm.fool_moon_no_sleep'
[0m13:52:54.914444 [debug] [Thread-2  ]: Timing info for test.dbtlearm.not_null_fct_reviews_reviewer_name.8204e43c88 (execute): 2023-03-08 13:52:54.914354 => 2023-03-08 13:52:54.914371
[0m13:52:54.914834 [debug] [Thread-4  ]: Began compiling node analysis.dbtlearm.fool_moon_no_sleep
[0m13:52:54.915780 [debug] [Thread-2  ]: Finished running node test.dbtlearm.not_null_fct_reviews_reviewer_name.8204e43c88
[0m13:52:54.919226 [debug] [Thread-4  ]: Writing injected SQL for node "analysis.dbtlearm.fool_moon_no_sleep"
[0m13:52:54.920114 [debug] [Thread-1  ]: Timing info for test.dbtlearm.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe (compile): 2023-03-08 13:52:54.906494 => 2023-03-08 13:52:54.920040
[0m13:52:54.921014 [debug] [Thread-1  ]: Began executing node test.dbtlearm.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe
[0m13:52:54.921349 [debug] [Thread-1  ]: Timing info for test.dbtlearm.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe (execute): 2023-03-08 13:52:54.921277 => 2023-03-08 13:52:54.921290
[0m13:52:54.922137 [debug] [Thread-1  ]: Finished running node test.dbtlearm.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe
[0m13:52:54.924428 [debug] [Thread-4  ]: Timing info for analysis.dbtlearm.fool_moon_no_sleep (compile): 2023-03-08 13:52:54.916117 => 2023-03-08 13:52:54.924324
[0m13:52:54.924828 [debug] [Thread-4  ]: Began executing node analysis.dbtlearm.fool_moon_no_sleep
[0m13:52:54.925104 [debug] [Thread-4  ]: Timing info for analysis.dbtlearm.fool_moon_no_sleep (execute): 2023-03-08 13:52:54.925041 => 2023-03-08 13:52:54.925053
[0m13:52:54.925862 [debug] [Thread-4  ]: Finished running node analysis.dbtlearm.fool_moon_no_sleep
[0m13:52:55.971003 [debug] [Thread-3  ]: SQL status: SUCCESS 8 in 1 seconds
[0m13:52:55.973944 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearm.no_nulls_in_dim_listings"
[0m13:52:55.978344 [debug] [Thread-3  ]: Timing info for test.dbtlearm.no_nulls_in_dim_listings (compile): 2023-03-08 13:52:54.800286 => 2023-03-08 13:52:55.978219
[0m13:52:55.978787 [debug] [Thread-3  ]: Began executing node test.dbtlearm.no_nulls_in_dim_listings
[0m13:52:55.979105 [debug] [Thread-3  ]: Timing info for test.dbtlearm.no_nulls_in_dim_listings (execute): 2023-03-08 13:52:55.979035 => 2023-03-08 13:52:55.979050
[0m13:52:55.979411 [debug] [Thread-3  ]: On test.dbtlearm.no_nulls_in_dim_listings: Close
[0m13:52:56.241276 [debug] [Thread-3  ]: Finished running node test.dbtlearm.no_nulls_in_dim_listings
[0m13:52:56.242527 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:52:56.242805 [debug] [MainThread]: Connection 'test.dbtlearm.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe' was properly closed.
[0m13:52:56.243044 [debug] [MainThread]: Connection 'test.dbtlearm.not_null_fct_reviews_reviewer_name.8204e43c88' was properly closed.
[0m13:52:56.243275 [debug] [MainThread]: Connection 'test.dbtlearm.no_nulls_in_dim_listings' was properly closed.
[0m13:52:56.243499 [debug] [MainThread]: Connection 'analysis.dbtlearm.fool_moon_no_sleep' was properly closed.
[0m13:52:56.244736 [debug] [MainThread]: Command end result
[0m13:52:56.260360 [info ] [MainThread]: Done.
[0m13:52:56.562236 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m13:52:56.562516 [info ] [MainThread]: Building catalog
[0m13:52:56.564774 [debug] [ThreadPool]: Acquiring new snowflake connection 'airbnb.information_schema'
[0m13:52:56.573541 [debug] [ThreadPool]: Using snowflake connection "airbnb.information_schema"
[0m13:52:56.573896 [debug] [ThreadPool]: On airbnb.information_schema: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "connection_name": "airbnb.information_schema"} */
with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from airbnb.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from airbnb.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('raw') or upper("table_schema") = upper('dev'))
      order by "column_index"
[0m13:52:56.574159 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:52:59.223663 [debug] [ThreadPool]: SQL status: SUCCESS 77 in 3 seconds
[0m13:52:59.256112 [debug] [ThreadPool]: On airbnb.information_schema: Close
[0m13:52:59.548394 [info ] [MainThread]: Catalog written to /Users/mramirez/Documents/DBT/dbtlearm/target/catalog.json
[0m13:52:59.548992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6e6678d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6e6ff7c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6e6d6d610>]}
[0m13:52:59.549361 [debug] [MainThread]: Flushing usage events
[0m13:52:59.881211 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m13:52:59.881743 [debug] [MainThread]: Connection 'airbnb.information_schema' was properly closed.


============================== 2023-03-10 13:16:13.297494 | 3c7e7ee7-8645-4f73-9afd-75464dc7ebde ==============================
[0m13:16:13.297494 [info ] [MainThread]: Running with dbt=1.4.1
[0m13:16:13.299801 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/mramirez/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m13:16:13.300071 [debug] [MainThread]: Tracking: tracking
[0m13:16:13.325644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda876fe4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda87675790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda876fe2e0>]}
[0m13:16:13.328679 [debug] [MainThread]: Set downloads directory='/var/folders/j5/f7qqc9x90_5bwn0pxybgkx5m0000gp/T/dbt-downloads-0a5m2scl'
[0m13:16:13.329571 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m13:16:13.786429 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m13:16:13.787154 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m13:16:14.026588 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m13:16:14.060860 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m13:16:14.275211 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m13:16:14.292488 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m13:16:14.517320 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m13:16:14.594537 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m13:16:15.556967 [info ] [MainThread]:   Installed from version 1.0.0
[0m13:16:15.557716 [info ] [MainThread]:   Up to date!
[0m13:16:15.558469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '3c7e7ee7-8645-4f73-9afd-75464dc7ebde', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda87708c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda8777d0a0>]}
[0m13:16:15.559070 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m13:16:16.681542 [info ] [MainThread]:   Installed from version 0.8.2
[0m13:16:16.682353 [info ] [MainThread]:   Up to date!
[0m13:16:16.683112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '3c7e7ee7-8645-4f73-9afd-75464dc7ebde', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda8777d0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda8777afd0>]}
[0m13:16:16.683726 [info ] [MainThread]: Installing calogica/dbt_date
[0m13:16:17.177037 [info ] [MainThread]:   Installed from version 0.7.2
[0m13:16:17.177766 [info ] [MainThread]:   Up to date!
[0m13:16:17.178425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '3c7e7ee7-8645-4f73-9afd-75464dc7ebde', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda8777aee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda8777ab20>]}
[0m13:16:17.183265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda87698fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda8777d0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda87708cd0>]}
[0m13:16:17.183981 [debug] [MainThread]: Flushing usage events


============================== 2023-03-10 13:27:43.001312 | d437cba2-b9b6-4db5-9377-513fa8cf3ef8 ==============================
[0m13:27:43.001312 [info ] [MainThread]: Running with dbt=1.4.1
[0m13:27:43.003710 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/mramirez/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'select': ['dim_listings_with_hosts'], 'which': 'test', 'rpc_method': 'test'}
[0m13:27:43.004122 [debug] [MainThread]: Tracking: tracking
[0m13:27:43.004648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1ebb3ae20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1ebb3ae80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1ebb4fee0>]}
[0m13:27:43.077674 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m13:27:43.078313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd437cba2-b9b6-4db5-9377-513fa8cf3ef8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1ebb4cca0>]}
[0m13:27:45.116026 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_with_hosts.sql
[0m13:27:45.130892 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m13:27:45.137132 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m13:27:45.142963 [debug] [MainThread]: 1603: static parser failed on fct/fct_reviews.sql
[0m13:27:45.170383 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fct/fct_reviews.sql
[0m13:27:45.172193 [debug] [MainThread]: 1699: static parser successfully parsed mart/mart_fullmoon_review.sql
[0m13:27:45.178265 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m13:27:45.185080 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m13:27:45.190941 [debug] [MainThread]: 1699: static parser successfully parsed src/src_host.sql
[0m13:27:45.467014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1ec020a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1ebae9a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1ebae9610>]}
[0m13:27:45.467428 [debug] [MainThread]: Flushing usage events
[0m13:27:46.240975 [error] [MainThread]: Encountered an error:
Compilation Error in test dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_with_hosts_source_airbnb_listings_ (models/schema.yml)
  macro 'dbt_macro__test_expect_table_row_count_to_equal_other_table' takes no keyword argument 'compared_model'


============================== 2023-03-10 13:28:02.648437 | 17b5b945-d7f6-4baa-a027-1696aff5ffb2 ==============================
[0m13:28:02.648437 [info ] [MainThread]: Running with dbt=1.4.1
[0m13:28:02.650396 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/mramirez/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'select': ['dim_listings_with_hosts'], 'which': 'test', 'rpc_method': 'test'}
[0m13:28:02.650631 [debug] [MainThread]: Tracking: tracking
[0m13:28:02.651027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88fa0fbd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88fa0fbdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88fa10d100>]}
[0m13:28:02.705130 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m13:28:02.705537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '17b5b945-d7f6-4baa-a027-1696aff5ffb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88fa10d1f0>]}
[0m13:28:04.144837 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_with_hosts.sql
[0m13:28:04.159439 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m13:28:04.165130 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m13:28:04.170216 [debug] [MainThread]: 1603: static parser failed on fct/fct_reviews.sql
[0m13:28:04.192297 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fct/fct_reviews.sql
[0m13:28:04.193894 [debug] [MainThread]: 1699: static parser successfully parsed mart/mart_fullmoon_review.sql
[0m13:28:04.199658 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m13:28:04.204604 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m13:28:04.209427 [debug] [MainThread]: 1699: static parser successfully parsed src/src_host.sql
[0m13:28:04.473353 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Starting in v1.3, the 'name' of an exposure should contain only letters,
numbers, and underscores. Exposures support a new property, 'label', which may
contain spaces, capital letters, and special characters. Executive Dashboard
does not follow this pattern. Please update the 'name', and use the 'label'
property for a human-friendly title. This will raise an error in a future
version of dbt-core.
[0m13:28:04.473726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '17b5b945-d7f6-4baa-a027-1696aff5ffb2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88fa67c0d0>]}
[0m13:28:04.535405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '17b5b945-d7f6-4baa-a027-1696aff5ffb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88fa3bbe50>]}
[0m13:28:04.558192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '17b5b945-d7f6-4baa-a027-1696aff5ffb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88fa124a60>]}
[0m13:28:04.558649 [info ] [MainThread]: Found 8 models, 15 tests, 2 snapshots, 1 analysis, 640 macros, 0 operations, 1 seed file, 3 sources, 1 exposure, 0 metrics
[0m13:28:04.558982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17b5b945-d7f6-4baa-a027-1696aff5ffb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88fa0fbdf0>]}
[0m13:28:04.560637 [info ] [MainThread]: 
[0m13:28:04.562436 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:28:04.564002 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m13:28:04.579996 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m13:28:04.580426 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m13:28:04.580842 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:28:08.638157 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 4 seconds
[0m13:28:08.640880 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m13:28:08.918642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17b5b945-d7f6-4baa-a027-1696aff5ffb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88fa124370>]}
[0m13:28:08.919536 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:28:08.919910 [info ] [MainThread]: 
[0m13:28:08.939964 [debug] [Thread-1  ]: Began running node test.dbtlearm.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_with_hosts_source_airbnb_listings_.6df199e214
[0m13:28:08.940392 [info ] [Thread-1  ]: 1 of 1 START test dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_with_hosts_source_airbnb_listings_  [RUN]
[0m13:28:08.941168 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbtlearm.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_with_hosts_source_airbnb_listings_.6df199e214'
[0m13:28:08.941493 [debug] [Thread-1  ]: Began compiling node test.dbtlearm.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_with_hosts_source_airbnb_listings_.6df199e214
[0m13:28:08.950681 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearm.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_with_hosts_source_airbnb_listings_.6df199e214"
[0m13:28:08.951688 [debug] [Thread-1  ]: Timing info for test.dbtlearm.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_with_hosts_source_airbnb_listings_.6df199e214 (compile): 2023-03-10 13:28:08.941731 => 2023-03-10 13:28:08.951591
[0m13:28:08.952039 [debug] [Thread-1  ]: Began executing node test.dbtlearm.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_with_hosts_source_airbnb_listings_.6df199e214
[0m13:28:08.980436 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbtlearm.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_with_hosts_source_airbnb_listings_.6df199e214"
[0m13:28:08.982642 [debug] [Thread-1  ]: Using snowflake connection "test.dbtlearm.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_with_hosts_source_airbnb_listings_.6df199e214"
[0m13:28:08.982918 [debug] [Thread-1  ]: On test.dbtlearm.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_with_hosts_source_airbnb_listings_.6df199e214: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearm", "target_name": "dev", "node_id": "test.dbtlearm.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_with_hosts_source_airbnb_listings_.6df199e214"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    with a as (
        
    select
        
        count(*) as expression
    from
        airbnb.dev.dim_listings_with_hosts
    

    ),
    b as (
        
    select
        
        count(*) * 1 as expression
    from
        airbnb.raw.raw_listings
    

    ),
    final as (

        select
            
            a.expression,
            b.expression as compare_expression,
            abs(coalesce(a.expression, 0) - coalesce(b.expression, 0)) as expression_difference,
            abs(coalesce(a.expression, 0) - coalesce(b.expression, 0))/
                nullif(a.expression * 1.0, 0) as expression_difference_percent
        from
        
            a cross join b
        
    )
    -- DEBUG:
    -- select * from final
    select
        *
    from final
    where
        
        expression_difference > 0.0
        

      
    ) dbt_internal_test
[0m13:28:08.983167 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:28:11.446369 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2 seconds
[0m13:28:11.458025 [debug] [Thread-1  ]: Timing info for test.dbtlearm.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_with_hosts_source_airbnb_listings_.6df199e214 (execute): 2023-03-10 13:28:08.952277 => 2023-03-10 13:28:11.457943
[0m13:28:11.458402 [debug] [Thread-1  ]: On test.dbtlearm.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_with_hosts_source_airbnb_listings_.6df199e214: Close
[0m13:28:11.700935 [info ] [Thread-1  ]: 1 of 1 PASS dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_with_hosts_source_airbnb_listings_  [[32mPASS[0m in 2.76s]
[0m13:28:11.703326 [debug] [Thread-1  ]: Finished running node test.dbtlearm.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_with_hosts_source_airbnb_listings_.6df199e214
[0m13:28:11.705271 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:28:11.705941 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:28:11.706211 [debug] [MainThread]: Connection 'test.dbtlearm.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_with_hosts_source_airbnb_listings_.6df199e214' was properly closed.
[0m13:28:11.706489 [info ] [MainThread]: 
[0m13:28:11.706850 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 7.15 seconds (7.15s).
[0m13:28:11.707306 [debug] [MainThread]: Command end result
[0m13:28:11.729196 [info ] [MainThread]: 
[0m13:28:11.729709 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:28:11.730072 [info ] [MainThread]: 
[0m13:28:11.730417 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:28:11.730836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88fa55ddc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88face3790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88face3370>]}
[0m13:28:11.731203 [debug] [MainThread]: Flushing usage events
